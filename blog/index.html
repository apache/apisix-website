<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache APISIXâ„¢ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache APISIXâ„¢ Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIXâ„¢" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Blog | Apache APISIXâ„¢</title><meta data-react-helmet="true" property="og:title" content="Blog | Apache APISIXâ„¢"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://ZHVP417Y1Y-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/styles.70b11359.css">
<link rel="preload" href="/styles.992e9cec.js" as="script">
<link rel="preload" href="/runtime~main.a7fa1084.js" as="script">
<link rel="preload" href="/main.3e136775.js" as="script">
<link rel="preload" href="/common.2d967526.js" as="script">
<link rel="preload" href="/2.54f5630c.js" as="script">
<link rel="preload" href="/30.163c5ee4.js" as="script">
<link rel="preload" href="/2d8fe9ee.30394a0b.js" as="script">
<link rel="preload" href="/514de2af.539501a7.js" as="script">
<link rel="preload" href="/5bb67ffc.2fa3b45c.js" as="script">
<link rel="preload" href="/e02da2c5.0f2eca6c.js" as="script">
<link rel="preload" href="/37e3b3ea.f669081a.js" as="script">
<link rel="preload" href="/b2b675dd.42a652db.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Apache APISIXâ„¢" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="Apache APISIXâ„¢" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Apache APISIXâ„¢</strong></a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/downloads">Downloads</a><a class="navbar__item navbar__link" href="/docs/team">Team</a><a class="navbar__item navbar__link" href="/help">Help</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Apache APISIXâ„¢" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="Apache APISIXâ„¢" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Apache APISIXâ„¢</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/downloads">Downloads</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/team">Team</a></li><li class="menu__list-item"><a class="menu__link" href="/help">Help</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_SWld thin-scrollbar"><h3 class="sidebarItemTitle_Km2m">Recent posts</h3><ul class="sidebarItemList_3UpA"><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2021/01/21/run-ingress-apisix-on-amazon-eks">Run Ingress APISIX on Amazon EKS</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2020/12/18/a-first-look-at-kubernetes-service-api">åˆæ¢ Kubernetes Service APIs</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2020/12/16/another-way-to-implement-envoy-filter">Envoy and Apache APISIX: Another way to implement the Envoy filter</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2020/08/22/new-website">New website for Apache APISIX</a></li></ul></div></div><main class="col col--8"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2021/01/21/run-ingress-apisix-on-amazon-eks">Run Ingress APISIX on Amazon EKS</a></h2><div class="margin-vert--md"><time datetime="2021-01-21T00:00:00.000Z" class="blogPostDate_Ta7i">January 21, 2021  Â· 5 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/tokers" target="_blank" rel="noreferrer noopener"><img src="https://avatars0.githubusercontent.com/u/10428333?s=60&amp;v=4" alt="Chao Zhang"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/tokers" target="_blank" rel="noreferrer noopener">Chao Zhang</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><blockquote><p><a href="https://github.com/tokers" target="_blank" rel="noopener noreferrer">@Chao Zhang</a>, Apache APISIX Comitter from <a href="https://www.apiseven.com/" target="_blank" rel="noopener noreferrer">Shenzhen Zhiliu Technology Co.</a></p><p>Source:</p><ul><li><a href="https://github.com/apache/apisix" target="_blank" rel="noopener noreferrer">https://github.com/apache/apisix</a></li><li><a href="https://github.com/apache/apisix-helm-chart" target="_blank" rel="noopener noreferrer">https://github.com/apache/apisix-helm-chart</a></li><li><a href="https://github.com/apache/apisix-ingress-controller" target="_blank" rel="noopener noreferrer">https://github.com/apache/apisix-ingress-controller</a></li></ul></blockquote><p>This post is based on <a href="https://github.com/apache/apisix-ingress-controller/blob/master/docs/deployments/aws.md" target="_blank" rel="noopener noreferrer">Install Ingress APISIX on Amazon EKS</a>.</p><ul><li></li></ul><p>Amazon Elastic Kubernetes Service (<a href="https://amazonaws-china.com/eks/?whats-new-cards.sort-by=item.additionalFields.postDateTime&amp;whats-new-cards.sort-order=desc&amp;eks-blogs.sort-by=item.additionalFields.createdDate&amp;eks-blogs.sort-order=desc" target="_blank" rel="noopener noreferrer">Amazon EKS</a>) gives you the flexibility to start, run, and scale Kubernetes applications in the AWS cloud or on-premises. This article explains how to run Ingress APISIX on it.</p><p>Ingress APISIX brings good features (traffic splitting, multiple protocols, authentication and etc) of Apache APISIX to Kubernetes, with a well-designed Controller componment to drive it, which helps users to achieve complex demands for the north-south traffic.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h2><p>Before you go ahead, make sure you have an available EKS cluster on Amazon AWS. If you don&#x27;t have one, please create it according to the guide.</p><p>You shall have kubectl tool in your own environment, set the context to your EKS cluster by running:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">aws eks update-kubeconfig --name </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">your eks cluster name</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> --region </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">your region</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>After the Kubernetes cluster is ready, creating the namespace ingress-apisix, all subsequent resources will be created at this namespace.</p><p>kubectl create namespace ingress-apisix</p><p>We use <a href="https://helm.sh/" target="_blank" rel="noopener noreferrer">Helm</a> to deploy all components in Ingress APISIX (<a href="https://github.com/apache/apisix" target="_blank" rel="noopener noreferrer">Apache APISIX</a> and <a href="https://github.com/apache/apisix-ingress-controller" target="_blank" rel="noopener noreferrer">apisix-ingress-controller</a>), so please also install Helm according to its installation guide. The helm charts for Apache APISIX and apisix-ingress-controller are in apache/apisix-helm-chart and apache/apisix-ingress-controller, clone them to get the charts.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install-apache-apisix"></a>Install Apache APISIX<a class="hash-link" href="#install-apache-apisix" title="Direct link to heading">#</a></h2><p>Apache APISIX as the proxy plane of apisix-ingress-controller, should be deployed in advance.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /path/to/apisix-helm-chart</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm repo </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> bitnami https://charts.bitnami.com/bitnami</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm dependency update ./chart/apisix</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> apisix ./chart/apisix </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set gateway.type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">LoadBalancer </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set allow.ipList</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;{0.0.0.0/0}&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --namespace ingress-apisix</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get </span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> --namespace ingress-apisix</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The above commands created two Kubernetes Service resources, one is <code>apisix-gateway</code>, which processes the real traffic; another is <code>apisix-admin</code>, which acts as the control plane to process all the configuration changes. Here we created the <code>apisix-gateway</code> as a <code>LoadBalancer</code> type Service, which resorts the <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/network/introduction.html" target="_blank" rel="noopener noreferrer">AWS Network Balancer</a> to expose it to the Internet. You can find the load balancer hostname by the following command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get </span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> apisix-gateway </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--namespace ingress-apisix </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{.status.loadBalancer.ingress[].hostname}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p> Another thing should be concerned that the <code>allow.ipList</code> field should be customized according to the <a href="https://amazonaws-china.com/premiumsupport/knowledge-center/eks-multiple-cidr-ranges/" target="_blank" rel="noopener noreferrer">EKS CIDR Ranges</a> in your EKS cluster, so that the apisix-ingress-controller can be authorized by Apache APISIX (for the resources pushing).</p><p>See value.yaml](<a href="https://github.com/apache/apisix-helm-chart/blob/master/chart/apisix/values.yaml" target="_blank" rel="noopener noreferrer">https://github.com/apache/apisix-helm-chart/blob/master/chart/apisix/values.yaml</a>) to learn all the configuration items if you have other requirements.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install-apisix-ingress-controller"></a>Install apisix-ingress-controller<a class="hash-link" href="#install-apisix-ingress-controller" title="Direct link to heading">#</a></h2><p>After Apache APISIX is deployed successfully, now it&#x27;s time to install the controller component.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /path/to/apisix-ingress-controller</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># install base resources, e.g. ServiceAccount.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> ingress-apisix-base -n ingress-apisix ./charts/base</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># install apisix-ingress-controller</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> ingress-apisix ./charts/ingress-apisix </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set ingressController.image.tag</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">dev </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set ingressController.config.apisix.baseURL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http://apisix-admin:9180/apisix/admin </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set ingressController.config.apisix.adminKey</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">YOUR ADMIN KEY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --namespace ingress-apisix</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The ingress-apisix-base chart installed some basic dependencies for apisix-ingress-controller, such as ServiceAccount, its exclusive CRDs and etc.</p><p>The ingress-apisix chart guides us how to install the controller itself, you can change the image tag to the desired release version, also the value of <code>ingressController.config.apisix.adminKey</code> in abovementioned commands should be filled according to your pratical usage (and be sure the admin key is same as the on in Apache APISIX deployment). See <a href="https://github.com/apache/apisix-ingress-controller/blob/master/charts/ingress-apisix/values.yaml" target="_blank" rel="noopener noreferrer">value.yaml</a> to learn all the configuration items if you have other requirements.</p><p>Now try to open your EKS console, choosing your cluster and clicking the Workloads tag, you shall see all pods of Apache APISIX, etcd and apisix-ingress-controller are ready.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="test"></a>Test<a class="hash-link" href="#test" title="Direct link to heading">#</a></h2><p>Now we have deployed all components in Ingress APISIX, it&#x27;s important to check whether it runs well. We will deploy a httpbin service and ask Apache APISIX to route all requests with Host <code>&quot;local.httpbin.org&quot;</code> to it.</p><p>The first step we should do is created the httpbin workload and expose it.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl run httpbin --image kennethreitz/httpbin --port </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl expose pod httpbin --port </span><span class="token number" style="color:rgb(247, 140, 108)">80</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In order to let Apache APISIX routes requests correctly, we need create an ApisixRoute resource to drive it.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ar-httpbin.yaml</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: apisix.apache.org/v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kind: ApisixRoute</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name: httpserver-route</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rules:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - host: local.httpbin.org</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    http:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      paths:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - backend:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          serviceName: httpbin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          servicePort: </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        path: /*</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The above ApisixRoute resource asks Apache APISIX to route requests which Host header is <code>&quot;local.httpbin.org&quot;</code> to the httpbin backend (the one we just created).</p><p>Now try to apply it, note the service and the ApisixRoute resource should be put in the same namespace., crossing namespaces is not allowed in apisix-ingress-controller.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f ar-httpbin.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Test it by a simple curl call from a place where the Apache APISIX service is reachable.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> http://</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">apisix-gateway-ip</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">apisix-gateway-port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">/headers -s -H </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Host: local.httpbin.org&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;headers&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Accept&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;*/*&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Host&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;httpbin.org&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;User-Agent&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;curl/7.64.1&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;X-Amzn-Trace-Id&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Root=1-5ffc3273-2928e0844e19c9810d1bbd8a&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>If the Serivce type is <code>ClusterIP,</code> you have to login to a pod in the EKS cluster, then accessing Apache APISIX with its <code>ClusterIP</code> or Service FQDN. If it was exposed (no matter <code>NodePort</code> or <code>LoadBalancer</code>), just accessing its outside reachable endpoint.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="see-also"></a>See Also<a class="hash-link" href="#see-also" title="Direct link to heading">#</a></h2><ul><li><a href="https://www.apiseven.com/zh/blog/a-first-look-at-kubernetes-service-api" target="_blank" rel="noopener noreferrer">https://www.apiseven.com/zh/blog/a-first-look-at-kubernetes-service-api</a></li><li><a href="https://www.apiseven.com/zh/blog/another-way-to-implement-envoy-filter" target="_blank" rel="noopener noreferrer">https://www.apiseven.com/zh/blog/another-way-to-implement-envoy-filter</a></li></ul></section></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2020/12/18/a-first-look-at-kubernetes-service-api">åˆæ¢ Kubernetes Service APIs</a></h2><div class="margin-vert--md"><time datetime="2020-12-18T00:00:00.000Z" class="blogPostDate_Ta7i">December 18, 2020  Â· 3 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/gxthrj" target="_blank" rel="noreferrer noopener"><img src="https://avatars2.githubusercontent.com/u/4413028?s=400&amp;u=e140a6d2bf19c426da6498b8888edc96509be649&amp;v=4" alt="Wei Jin"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/gxthrj" target="_blank" rel="noreferrer noopener">Wei Jin</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><blockquote><p><a href="https://github.com/gxthrj" target="_blank" rel="noopener noreferrer">@gxthrj</a>, Apache APISIX PMC &amp; Apache apisix-ingress-controller Founder from <a href="https://www.apiseven.com/" target="_blank" rel="noopener noreferrer">Shenzhen Zhiliu Technology Co.</a></p><p>Source:</p><ul><li><a href="https://github.com/apache/apisix" target="_blank" rel="noopener noreferrer">https://github.com/apache/apisix</a></li><li><a href="https://github.com/apache/apisix-ingress-controller" target="_blank" rel="noopener noreferrer">https://github.com/apache/apisix-ingress-controller</a></li></ul></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="å‰è¨€"></a>å‰è¨€<a class="hash-link" href="#å‰è¨€" title="Direct link to heading">#</a></h2><p>ç¬”è€…æ˜¯ Apache APISIX PMCï¼Œä¹Ÿæ˜¯ Apache APISIX Ingress Controller Founderï¼Œé€šè¿‡è°ƒç ”å’Œç¤¾åŒºäº¤æµï¼Œæ‰“ç®—åœ¨ Apache APISIX Ingress Controller çš„åæœŸç‰ˆæœ¬ä¸­é€æ­¥æ”¯æŒ Kubernetes Service APIs.</p><p>æˆ‘ä»¬çŸ¥é“ Kubernetes ä¸ºäº†å°†é›†ç¾¤å†…éƒ¨æœåŠ¡æš´éœ²å‡ºå»ï¼Œæœ‰å¤šç§æ–¹æ¡ˆå®ç°ï¼Œå…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒå—å¤§ä¼—æ¨å´‡çš„å°±æ˜¯ Ingressã€‚Ingress ä½œä¸ºä¸€ç§å¯¹å¤–æš´éœ²æœåŠ¡çš„æ ‡å‡†ï¼Œæœ‰ç›¸å½“å¤šçš„ç¬¬ä¸‰æ–¹å®ç°ï¼Œæ¯ç§å®ç°éƒ½æœ‰å„è‡ªçš„æŠ€æœ¯æ ˆ å’Œ æ‰€ä¾èµ–çš„ç½‘å…³çš„å½±å­ï¼Œç›¸äº’ä¹‹é—´å¹¶ä¸å…¼å®¹ã€‚</p><p>ä¸ºäº†ç»Ÿä¸€å„ç§ Ingress çš„å®ç°ï¼Œä¾¿äº Kubernetes ä¸Šç»Ÿä¸€ç®¡ç†ï¼Œ<a href="https://github.com/kubernetes/community/tree/master/sig-network" target="_blank" rel="noopener noreferrer">SIG-NETWORK</a> ç¤¾åŒºæ¨å‡ºäº†<a href="https://kubernetes-sigs.github.io/service-apis/" target="_blank" rel="noopener noreferrer">Kubernetes Service APIs</a> ä¸€å¥—æ ‡å‡†å®ç°ï¼Œç§°ä¸ºç¬¬äºŒä»£ Ingress ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ä¸»é¢˜æè¿°"></a>ä¸»é¢˜æè¿°<a class="hash-link" href="#ä¸»é¢˜æè¿°" title="Direct link to heading">#</a></h2><p>æœ¬æ–‡ä»å‡ ä¸ªé—®é¢˜å…¥æ‰‹ï¼Œå¯¹ Kubernetes Service APIs çš„åŸºæœ¬æ¦‚å¿µè¿›è¡Œä»‹ç»ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ä»‹ç»"></a>ä»‹ç»<a class="hash-link" href="#ä»‹ç»" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="kubernetes-service-apis-å·ç§°ç¬¬äºŒä»£-ingress-æŠ€æœ¯ï¼Œåˆ°åº•åœ¨å“ªäº›æ–¹é¢ä¼˜äºç¬¬ä¸€ä»£ï¼Ÿ"></a>Kubernetes Service APIs å·ç§°ç¬¬äºŒä»£ Ingress æŠ€æœ¯ï¼Œåˆ°åº•åœ¨å“ªäº›æ–¹é¢ä¼˜äºç¬¬ä¸€ä»£ï¼Ÿ<a class="hash-link" href="#kubernetes-service-apis-å·ç§°ç¬¬äºŒä»£-ingress-æŠ€æœ¯ï¼Œåˆ°åº•åœ¨å“ªäº›æ–¹é¢ä¼˜äºç¬¬ä¸€ä»£ï¼Ÿ" title="Direct link to heading">#</a></h3><p>Kubernetes Service APIs è®¾è®¡ä¹‹åˆï¼Œç›®æ ‡å¹¶æ²¡æœ‰å±€é™åœ¨ Ingressï¼Œ è€Œæ˜¯ä¸ºäº†å¢å¼º service networkingï¼Œç€é‡é€šè¿‡ä»¥ä¸‹å‡ ç‚¹æ¥å¢å¼ºï¼šè¡¨è¾¾æ€§ã€æ‰©å±•æ€§ã€RBACã€‚</p><ol><li>æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›ï¼Œä¾‹å¦‚ å¯ä»¥æ ¹æ® header ã€weighting æ¥ç®¡ç†æµé‡</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kind: HTTPRoute</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: networking.x-k8s.io/v1alpha1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">matches:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - path:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      value: &quot;/foo&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      values:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        version: &quot;2&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - path:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      value: &quot;/v2/foo&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="2"><li>å¢å¼ºäº†æ‰©å±•èƒ½åŠ›ï¼ŒService APIs æå‡ºå¤šå±‚ API çš„æ¦‚å¿µï¼Œå„å±‚ç‹¬ç«‹æš´éœ²æ¥å£ï¼Œæ–¹ä¾¿å…¶ä»–è‡ªå®šä¹‰èµ„æºä¸ API å¯¹æ¥ï¼Œåšåˆ°æ›´ç»†ç²’åº¦ï¼ˆAPI ç²’åº¦ï¼‰çš„æ§åˆ¶ã€‚</li></ol><p><img src="https://kubernetes-sigs.github.io/service-apis/images/api-model.png" alt="api-model"></p><ol start="3"><li>é¢å‘è§’è‰² RBACï¼šå¤šå±‚ API çš„å®ç°ï¼Œå…¶ä¸­ä¸€ä¸ªæ€æƒ³å°±æ˜¯ä»ä½¿ç”¨è€…çš„è§’åº¦å»è®¾è®¡èµ„æºå¯¹è±¡ã€‚è¿™äº›èµ„æºæœ€ç»ˆä¼šä¸ Kubernetes ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºçš„å¸¸è§è§’è‰²è¿›è¡Œæ˜ å°„ã€‚</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="kubernetes-service-apis-æŠ½è±¡å‡ºäº†å“ªäº›èµ„æºå¯¹è±¡ï¼Ÿ"></a>Kubernetes Service APIs æŠ½è±¡å‡ºäº†å“ªäº›èµ„æºå¯¹è±¡ï¼Ÿ<a class="hash-link" href="#kubernetes-service-apis-æŠ½è±¡å‡ºäº†å“ªäº›èµ„æºå¯¹è±¡ï¼Ÿ" title="Direct link to heading">#</a></h2><p>Kubernetes Service APIs åŸºäºä½¿ç”¨è€…è§’è‰²ï¼Œå°†å®šä¹‰äº†ä»¥ä¸‹å‡ ç§èµ„æºï¼š</p><p>GatewayClass, Gateway, Route</p><ol><li>GatewayClass å®šä¹‰äº†ä¸€ç»„å…·æœ‰é€šç”¨é…ç½®å’Œè¡Œä¸ºçš„ç½‘å…³ç±»å‹</li></ol><ul><li><p>ä¸ Gateway çš„å…³ç³»ï¼Œç±»ä¼¼ ingress ä¸­çš„ ingress.class annotationï¼›</p></li><li><p>GatewayClass å®šä¹‰äº†ä¸€ç»„å…±äº«ç›¸åŒé…ç½®å’Œè¡Œä¸ºçš„ç½‘å…³ã€‚æ¯ä¸ª GatewayClass å°†ç”±å•ä¸ª controller å¤„ç†ï¼Œcontroller ä¸ GatewayClass æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼›</p></li><li><p>GatewayClass æ˜¯ cluster èµ„æºã€‚å¿…é¡»è‡³å°‘å®šä¹‰ä¸€ä¸ª GatewayClass æ‰èƒ½å…·æœ‰åŠŸèƒ½ç½‘å…³ã€‚</p></li></ul><ol start="2"><li>Gateway è¯·æ±‚ä¸€ä¸ªå¯ä»¥å°†æµé‡è½¬æ¢ä¸ºç¾¤é›†å†…æœåŠ¡çš„ç‚¹ã€‚</li></ol><ul><li><p>ä½œç”¨ï¼šæŠŠé›†ç¾¤å¤–çš„æµé‡å¼•å…¥é›†ç¾¤å†…éƒ¨ã€‚è¿™ä¸ªæ‰æ˜¯çœŸæ­£çš„ ingress å®ä½“ï¼›</p></li><li><p>å®ƒå®šä¹‰äº†å¯¹ç‰¹å®š LB é…ç½®çš„è¯·æ±‚ï¼Œè¯¥é…ç½®ä¹Ÿæ˜¯ GatewayClass çš„é…ç½®å’Œè¡Œä¸ºçš„å®ç°ï¼›</p></li><li><p>Gateway èµ„æºå¯ä»¥ç”±æ“ä½œå‘˜ç›´æ¥åˆ›å»ºï¼Œä¹Ÿå¯ä»¥ç”±å¤„ç† GatewayClass çš„ controller åˆ›å»ºï¼›</p></li><li><p>Gateway ä¸ Route æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ï¼›</p></li></ul><ol start="3"><li>Route æè¿°äº†é€šè¿‡ç½‘å…³çš„æµé‡å¦‚ä½•æ˜ å°„åˆ°æœåŠ¡ã€‚</li></ol><p><img src="https://kubernetes-sigs.github.io/service-apis/images/schema-uml.svg" alt="schema-uml"></p><p>å¦å¤–ï¼ŒKubernetes Service APIs ä¸ºäº†èƒ½å¤Ÿçµæ´»çš„é…ç½®åç«¯æœåŠ¡ï¼Œç‰¹åœ°å®šä¹‰äº†ä¸€ä¸ª BackendPolicy èµ„æºå¯¹è±¡ã€‚</p><p>é€šè¿‡ BackendPolicy å¯¹è±¡ï¼Œå¯ä»¥é…ç½® TLSã€å¥åº·æ£€æŸ¥ ä»¥åŠæŒ‡å®šåç«¯æœåŠ¡ç±»å‹ï¼Œæ¯”å¦‚ service è¿˜æ˜¯ podã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="kubernetes-service-apis-çš„æ¨è¡Œä¼šå¸¦æ¥å“ªäº›æ”¹å˜ï¼Ÿ"></a>Kubernetes Service APIs çš„æ¨è¡Œä¼šå¸¦æ¥å“ªäº›æ”¹å˜ï¼Ÿ<a class="hash-link" href="#kubernetes-service-apis-çš„æ¨è¡Œä¼šå¸¦æ¥å“ªäº›æ”¹å˜ï¼Ÿ" title="Direct link to heading">#</a></h2><p>Kubernetes Service APIs ä½œä¸ºä¸€ç§å®ç°æ ‡å‡†ï¼Œå¸¦æ¥äº†ä»¥ä¸‹æ”¹å˜ï¼š</p><ol><li><p>é€šç”¨æ€§ï¼š å¯ä»¥æœ‰å¤šç§å®ç°ï¼Œå°±åƒ ingress æœ‰å¤šç§å®ç°ä¸€æ ·ï¼Œå¯ä»¥æ ¹æ®ç½‘å…³çš„ç‰¹ç‚¹å»è‡ªå®šä¹‰ ingress controllerï¼Œä½†æ˜¯ä»–ä»¬éƒ½æœ‰ä¸€è‡´çš„é…ç½®ç»“æ„ã€‚ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯ä»¥é…ç½®å¤šç§ ingress controllerã€‚</p></li><li><p>Class æ¦‚å¿µï¼šGatewayClasses å¯ä»¥é…ç½®ä¸åŒè´Ÿè½½å‡è¡¡å®ç°çš„ç±»å‹ã€‚è¿™äº›ç±» class ä½¿ç”¨æˆ·å¯ä»¥è½»æ¾è€Œæ˜ç¡®åœ°äº†è§£å“ªäº›åŠŸèƒ½å¯ä»¥ç”¨ä½œèµ„æºæ¨¡å‹æœ¬èº«ã€‚</p></li><li><p>å…±äº«ç½‘å…³ï¼šé€šè¿‡å…è®¸ç‹¬ç«‹çš„è·¯ç”±èµ„æº HTTPRoute ç»‘å®šåˆ°åŒä¸€ä¸ª GatewayClassï¼Œå®ƒä»¬å¯ä»¥å…±äº«è´Ÿè½½å¹³è¡¡å™¨å’Œ VIPã€‚æŒ‰ç…§ä½¿ç”¨è€…åˆ†å±‚ï¼Œè¿™ä½¿å¾—å›¢é˜Ÿå¯ä»¥å®‰å…¨åœ°å…±äº«åŸºç¡€ç»“æ„ï¼Œè€Œæ— éœ€å…³å¿ƒä¸‹å±‚ Gateway çš„å…·ä½“å®ç°ã€‚</p></li><li><p>å¸¦ç±»å‹çš„åç«¯å¼•ç”¨: ä½¿ç”¨å¸¦ç±»å‹çš„åç«¯å¼•ç”¨ï¼Œè·¯ç”±å¯ä»¥å¼•ç”¨ Kubernetes Servicesï¼Œä¹Ÿå¯ä»¥å¼•ç”¨ä»»ä½•ç±»å‹çš„è®¾è®¡ä¸ºç½‘å…³åç«¯çš„ Kubernetes èµ„æºï¼Œæ¯”å¦‚ podï¼Œåˆæˆ–è€…æ˜¯ statefulset æ¯”å¦‚ DBï¼Œ ç”šè‡³æ˜¯å¯è®¿é—®çš„é›†ç¾¤å¤–éƒ¨èµ„æºã€‚</p></li><li><p>è·¨å‘½åç©ºé—´å¼•ç”¨ï¼šè·¨ä¸åŒå‘½åç©ºé—´çš„è·¯ç”±å¯ä»¥ç»‘å®šåˆ° Gatewayã€‚å…è®¸è·¨å‘½åç©ºé—´çš„äº’ç›¸è®¿é—®ã€‚åŒæ—¶ä¹Ÿå¯ä»¥é™åˆ¶æŸä¸ª Gateway ä¸‹çš„ Route å¯ä»¥è®¿é—®çš„å‘½åç©ºé—´èŒƒå›´ã€‚</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ç›®å‰æœ‰å“ªäº›-ingress-å®ç°äº†-kubernetes-service-apis-ï¼Ÿ"></a>ç›®å‰æœ‰å“ªäº› ingress å®ç°äº† Kubernetes Service APIs ï¼Ÿ<a class="hash-link" href="#ç›®å‰æœ‰å“ªäº›-ingress-å®ç°äº†-kubernetes-service-apis-ï¼Ÿ" title="Direct link to heading">#</a></h2><p>ç›®å‰å·²çŸ¥çš„ä»ä»£ç å±‚é¢èƒ½çœ‹åˆ°å¯¹ Kubernetes Service APIs èµ„æºå¯¹è±¡æ”¯æŒçš„ Ingress æœ‰ Contour, ingress-gceã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="kubernetes-service-apis-å¦‚ä½•ç®¡ç†èµ„æºè¯»å†™æƒé™ï¼Ÿ"></a>Kubernetes Service APIs å¦‚ä½•ç®¡ç†èµ„æºè¯»å†™æƒé™ï¼Ÿ<a class="hash-link" href="#kubernetes-service-apis-å¦‚ä½•ç®¡ç†èµ„æºè¯»å†™æƒé™ï¼Ÿ" title="Direct link to heading">#</a></h2><p>Kubernetes Service APIs æŒ‰ç…§ä½¿ç”¨è€…çš„ç»´åº¦åˆ†ä¸º 3 ä¸ªè§’è‰²</p><ol><li><p>åŸºç¡€è®¾æ–½æä¾›æ–¹ GatewayClass</p></li><li><p>é›†ç¾¤æ“ä½œäººå‘˜ Gateway</p></li><li><p>åº”ç”¨å¼€å‘è€… Route</p></li></ol><p>RBACï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰æ˜¯ç”¨äº Kubernetes æˆæƒçš„æ ‡å‡†ã€‚å…è®¸ç”¨æˆ·é…ç½®è°å¯ä»¥å¯¹ç‰¹å®šèŒƒå›´å†…çš„èµ„æºæ‰§è¡Œæ“ä½œã€‚ RBAC å¯ç”¨äºå¯ç”¨ä¸Šé¢å®šä¹‰çš„æ¯ä¸ªè§’è‰²ã€‚</p><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¸Œæœ›æ‰€æœ‰è§’è‰²éƒ½å¯ä»¥è¯»å–æ‰€æœ‰èµ„æº</p><p>ä¸‰å±‚æ¨¡å‹çš„å†™æƒé™å¦‚ä¸‹ã€‚</p><table><thead><tr><th></th><th>GatewayClass</th><th>Gateway</th><th>Route</th></tr></thead><tbody><tr><td>Infrastructure Provider</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Cluster Operators</td><td>No</td><td>Yes</td><td>Yes</td></tr><tr><td>Application Developers</td><td>No</td><td>No</td><td>Yes</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="kubernetes-service-apis-æœ‰å“ªäº›æ‰©å±•ç‚¹ï¼Ÿ"></a>Kubernetes Service APIs æœ‰å“ªäº›æ‰©å±•ç‚¹ï¼Ÿ<a class="hash-link" href="#kubernetes-service-apis-æœ‰å“ªäº›æ‰©å±•ç‚¹ï¼Ÿ" title="Direct link to heading">#</a></h2><p>ç½‘å…³çš„éœ€æ±‚éå¸¸ä¸°å¯Œï¼ŒåŒä¸€ä¸ªåœºæ™¯å®ç°çš„æ–¹å¼å¤šç§å¤šæ ·ï¼Œå„æœ‰åˆ©å¼Šã€‚Kubernetes Service APIs æç‚¼å‡º å¤šå±‚ èµ„æºå¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿé¢„ç•™äº†ä¸€äº›æ‰©å±•ç‚¹ã€‚</p><p>ç›®å‰ Kubernetes Service APIs çš„æ‰©å±•ç‚¹åŸºæœ¬é›†ä¸­åœ¨ Route ä¸Šï¼š</p><ul><li><p>RouteMatch å¯ä»¥æ‰©å±• Route åŒ¹é…è§„åˆ™ã€‚</p></li><li><p>specify Backend å¯ä»¥æ‰©å±•ç‰¹å®šç±»å‹çš„ åç«¯æœåŠ¡ï¼Œ é™¤äº†ä¸Šé¢æåˆ°çš„ Kubernetes èµ„æºå¤–ï¼Œè¿˜å¯ä»¥æ‰©å±•æ¯”å¦‚ æ–‡ä»¶ç³»ç»Ÿï¼Œå‡½æ•°è¡¨è¾¾å¼ç­‰ã€‚</p></li><li><p>Route filter å¯ä»¥åœ¨ Route çš„ç”Ÿå‘½å‘¨æœŸä¸­å¢åŠ æ‰©å±•ç‚¹ï¼Œå¤„ç† request/response ã€‚</p></li><li><p>Custom Route ä»¥ä¸Šæ‰©å±•ç‚¹éƒ½ä¸èƒ½æ»¡è¶³æ—¶ï¼Œå¯ä»¥å®Œå…¨è‡ªå®šä¹‰ä¸€ä¸ª Routeã€‚</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h2><p>æœ¬æ–‡é€šè¿‡æé—®çš„æ–¹å¼ï¼Œå¯¹ Kubernetes Service APIs åšäº†ä¸€äº›åŸºæœ¬ä»‹ç»ï¼Œä»æ•´ä½“æ¥çœ‹ï¼ŒKubernetes Service APIs æç‚¼äº†å¾ˆå¤š ingress çš„æœ€ä½³å®è·µï¼Œæ¯”å¦‚è¡¨è¾¾èƒ½åŠ›çš„å¢å¼ºï¼Œå…¶å®å°±æ˜¯æ‰©å±•äº† Route çš„èƒ½åŠ›ï¼Œå†æ¯”å¦‚ BackendPolicy å¯¹è±¡ï¼Œå¯ä»¥ä¸º upstream æŒ‡å®šå‡ ä¹æ‰€æœ‰çš„ Kubernetes åç«¯èµ„æºã€‚å½“ç„¶ï¼Œé¡¹ç›®åˆæœŸä¹Ÿæœ‰ä¸è¶³çš„åœ°æ–¹ï¼Œç›®å‰ Kubernetes Service APIs è™½ç„¶å·²ç»ä»å¤§çš„å±‚é¢ä¸Šè§„å®šäº†èµ„æºå¯¹è±¡ï¼Œä½†èµ„æºå¯¹è±¡å†…éƒ¨è¿˜æœ‰ä¸å°‘ç»†èŠ‚éœ€è¦è®¨è®ºä¹‹åå†ç¡®å®šï¼Œä»¥é˜²æ­¢å¯èƒ½å‡ºç°çš„å†²çªåœºæ™¯ï¼Œç»“æ„ä¸Šå­˜åœ¨ä¸€å®šå˜æ•°ã€‚</p><hr><p>å‚è€ƒ:</p><ul><li><a href="https://kubernetes-sigs.github.io/service-apis/" target="_blank" rel="noopener noreferrer">https://kubernetes-sigs.github.io/service-apis/</a></li><li><a href="https://www.apiseven.com/zh/blog/a-first-look-at-kubernetes-service-api" target="_blank" rel="noopener noreferrer">https://www.apiseven.com/zh/blog/a-first-look-at-kubernetes-service-api</a></li></ul></section></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2020/12/16/another-way-to-implement-envoy-filter">Envoy and Apache APISIX: Another way to implement the Envoy filter</a></h2><div class="margin-vert--md"><time datetime="2020-12-16T00:00:00.000Z" class="blogPostDate_Ta7i">December 16, 2020  Â· 5 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/nic-chen" target="_blank" rel="noreferrer noopener"><img src="https://avatars0.githubusercontent.com/u/33000667" alt="nic-chen"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/nic-chen" target="_blank" rel="noreferrer noopener">nic-chen</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><blockquote><p><a href="https://github.com/nic-chen" target="_blank" rel="noopener noreferrer">@nic-chen</a>, Apache APISIX PMC from <a href="http://www.apiseven.com/" target="_blank" rel="noopener noreferrer">Shenzhen Zhiliu Technology Co.</a></p><p>Source: <a href="https://www.apiseven.com/en/blog/another-way-to-implement-envoy-filter" target="_blank" rel="noopener noreferrer">https://www.apiseven.com/en/blog/another-way-to-implement-envoy-filter</a></p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ways-to-implement-envoy-filter"></a>Ways to implement Envoy filter<a class="hash-link" href="#ways-to-implement-envoy-filter" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="envoy-filter"></a>Envoy filter<a class="hash-link" href="#envoy-filter" title="Direct link to heading">#</a></h3><p>Envoy is an L7 proxy and communication bus designed for large modern service oriented architectures.
A pluggable filter chain mechanism allows filters to be written to perform different tasks and inserted into the main server.</p><p><img src="https://static.apiseven.com/filters.png" alt="Envoy filter"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="expansion-method"></a>Expansion method<a class="hash-link" href="#expansion-method" title="Direct link to heading">#</a></h3><p>The existing filters may not meet the user&#x27;s custom requirements. In this case, Envoy needs to be extended. Customize new filters according to the existing filter chain to achieve customization requirements.</p><p>Developers can extend Envoy in three ways:</p><table><thead><tr><th align="center"></th><th align="center">Getting Started difficulty</th><th align="center">stability</th><th align="center">development efficiency</th><th align="center">Deploy and compile</th></tr></thead><tbody><tr><td align="center">C++</td><td align="center">high</td><td align="center">stable</td><td align="center">low</td><td align="center">long time to compile</td></tr><tr><td align="center">Lua</td><td align="center">low</td><td align="center">stable</td><td align="center">High</td><td align="center">no need to compile, deploy directly</td></tr><tr><td align="center">WASM</td><td align="center">high-medium</td><td align="center">on the fence</td><td align="center">depends on language</td><td align="center">compilation time depends on language</td></tr></tbody></table><ol><li>Using C++ to extend</li></ol><p>In this way, C++ code is written directly on the basis of Envoy for functional enhancement. After implementing a custom filter, the new binary file is recompiled to complete the upgrade. There are two problems with this way:</p><ul><li><p>Limited by the C++ language, difficulty of getting started, scarcity of developers.</p></li><li><p>Increasing the complexity of deployment, operation and maintenance, and upgrades. Envoy will become heavier and heavier, and every change requires recompiling the binary file, which is not conducive to iteration and management.</p></li></ul><ol start="2"><li>Using Lua to extend</li></ol><p>Lua is born to be embedded in the application, so as to provide flexible extension and customization features for application, and is widely used.</p><p>Lua Filter allows Lua scripts to be run in the request and response process. The main features currently supported include: inspection of headers, body, and trailers while streaming in either the request flow, response flow;modification of headers and trailers;blocking and buffering the full request/response body for inspection;performing an outbound async HTTP call to an upstream host;performing a direct response and skipping further filter iteration, etc.</p><p>At present, many people directly distribute Lua code in configuration, which is not conducive to code organization and management, and it is difficult to share with others to form an ecosystem.</p><ol start="3"><li>Using WASM extension</li></ol><p>Developers can write filters in their own programming language, compile them into WASM format using tools, and embed them into Envoy to run.</p><p>It currently supports few languages, and using these languages â€‹â€‹to extend is still not that simple. On the other hand, many people still have reservations about WASM and may not directly use it.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="apache-apisix-solution"></a>Apache APISIX solution<a class="hash-link" href="#apache-apisix-solution" title="Direct link to heading">#</a></h2><p>Based on the above analysis, we could see that Lua is very suitable for extending Envoy, and it is easy to learn, and the development efficiency is extremely high. Because it is embedded in Envoy, there is no additional network overhead, and the performance is good.</p><p><a href="https://github.com/apache/apisix" target="_blank" rel="noopener noreferrer">Apache APISIX</a> community proposes its own solution based on Lua, which is to provide a powerful and flexible basic library to implement all plugins of Apache APISIX and plugins that will be developed in the future to run on Envoy. Developers could also develop their own customized plugins based on this basic library.</p><p>Apache APISIX is a dynamic, real-time, high-performance API gateway, based on the Nginx library and Lua. Apache APISIX provides rich traffic management features such as load balancing, dynamic upstream, canary release, circuit breaking, authentication, observability, and more.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example"></a>Example<a class="hash-link" href="#example" title="Direct link to heading">#</a></h3><p>Please check the repo for specific code and how to run: <a href="https://github.com/api7/envoy-apisix" target="_blank" rel="noopener noreferrer">https://github.com/api7/envoy-apisix</a></p><p>The relevant configuration of Envoy is as follows:</p><p>Define a Filter:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">http_filters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> entry.lua</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">typed_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">&quot;@type&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> type.googleapis.com/envoy.extensions.filters.http.lua.v3.Lua</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">source_codes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">entry.lua</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">filename</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /apisix/entry.lua</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Enable the Filter for a route and configure it with metadata:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">routes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">match</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">prefix</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/foo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">route</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">cluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> web_service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">typed_per_filter_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">envoy.filters.http.lua</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">&quot;@type&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> type.googleapis.com/envoy.extensions.filters.http.lua.v3.LuaPerRoute</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> entry.lua</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">filter_metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">envoy.filters.http.lua</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">plugins</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> uri</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">blocker</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token key atrule">conf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">rejected_code</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">403</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">block_rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> root.exe</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> root.m+</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="how-does-it-work"></a>How does it work<a class="hash-link" href="#how-does-it-work" title="Direct link to heading">#</a></h3><p>We don&#x27;t need to make major changes to Envoy, only some optimizations that are suitable for public needs.</p><p>We shield platform differences for the plugin layer. All interfaces that need to be used are abstracted in the underlying framework, which we call apisix.core, so that all plugins can run on Envoy and Apache APISIX at the same time.</p><p><img src="https://static.apiseven.com/main.png" alt="Architecture diagram"></p><p>We use the previous example to show how the plugin runs:</p><p><img src="https://static.apiseven.com/workflow.png" alt="Plugin workflow"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="first-step-read-configuration"></a>First step, read configuration<a class="hash-link" href="#first-step-read-configuration" title="Direct link to heading">#</a></h4><p>We configure through metadata to determine what plugins need to run on each route and what configuration is for each plugin.
In the example, we configured plugin <code>uri-blocker</code> for the route whose prefix is â€‹â€‹<code>/foo</code>, as well as the block rule of the plugin and the response status when a block is required.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="second-step-parse-request"></a>Second step, parse request<a class="hash-link" href="#second-step-parse-request" title="Direct link to heading">#</a></h4><p>We encapsulated the client request data into <code>ctx</code> so that it can be used directly in the entire process.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="third-step-run-the-plugin"></a>Third step, run the plugin<a class="hash-link" href="#third-step-run-the-plugin" title="Direct link to heading">#</a></h4><p>We determine whether we need to block this request by matching the configured rules and the obtained uri. If a block is needed, we call <code>respond</code> to directly respond, otherwise we let it go.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="future-outlook"></a>Future outlook<a class="hash-link" href="#future-outlook" title="Direct link to heading">#</a></h2><p>More and more APISIX plugins are available to run on Envoy, and finally all APISIX plugins (Even that will be developed in the future) will be available to run on Envoy.</p><p>At the same time, we hope that we could work with the Envoy community in the direction of Lua Filter, optimize and improve Lua Filter, enhance the expansion capabilities of Envoy, and reduce the difficulty of Envoy expansion.</p></section></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2020/08/22/new-website">New website for Apache APISIX</a></h2><div class="margin-vert--md"><time datetime="2020-08-22T00:00:00.000Z" class="blogPostDate_Ta7i">August 22, 2020  Â· 1 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/juzhiyuan" target="_blank" rel="noreferrer noopener"><img src="https://avatars3.githubusercontent.com/u/2106987?s=460&amp;u=f92e880ce95fe1fee18becd0a803f5401eb4ee7f&amp;v=4" alt="juzhiyuan"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/juzhiyuan" target="_blank" rel="noreferrer noopener">juzhiyuan</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>We are just refactored out website for Apache APISIX by using <a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer">docusaurus</a>.</p></section><footer class="row margin-vert--lg"><div class="col text--right"><a aria-label="Read more about New website for Apache APISIX" href="/blog/2020/08/22/new-website"><strong>Read More</strong></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">ASF</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation</a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License</a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events</a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issue Tracker</a></li><li class="footer__item"><a href="https://apisix.slack.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://apisix.apache.org/users/" target="_blank" rel="noopener noreferrer" class="footer__link-item">User Showcase</a></li><li class="footer__item"><a href="https://apisix.apache.org/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_31Aa"><img class="footer__logo" alt="Apache Software Foundation" src="/img/asf_logo_wide_small.png"></a></div><div class="footer__copyright">Copyright Â© 2019-2021 The Apache Software Foundation. Apache APISIX, APISIXâ„¢, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></div></footer></div>
<script src="/styles.992e9cec.js"></script>
<script src="/runtime~main.a7fa1084.js"></script>
<script src="/main.3e136775.js"></script>
<script src="/common.2d967526.js"></script>
<script src="/2.54f5630c.js"></script>
<script src="/30.163c5ee4.js"></script>
<script src="/2d8fe9ee.30394a0b.js"></script>
<script src="/514de2af.539501a7.js"></script>
<script src="/5bb67ffc.2fa3b45c.js"></script>
<script src="/e02da2c5.0f2eca6c.js"></script>
<script src="/37e3b3ea.f669081a.js"></script>
<script src="/b2b675dd.42a652db.js"></script>
</body>
</html>