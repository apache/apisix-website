<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="ahrefs-site-verification" content="c2f7370ecf46173f4fb25f114e74c97e0a2976d4f02f61c9b00a9d7d34e34698">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache APISIX® -- Cloud-Native API Gateway and AI Gateway RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache APISIX® -- Cloud-Native API Gateway and AI Gateway Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIX® -- Cloud-Native API Gateway and AI Gateway" href="/opensearch.xml">
<script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Apache APISIX","url":"https://apisix.apache.org"}</script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="24b59d9a-682e-4c3d-9e83-bf2ee85cdc19" data-project-name="APISIX" data-project-color="#E8442E" data-project-logo="https://static.apiseven.com/202202/apache-apisix.png" data-modal-disclaimer="This is a custom LLM for APISIX with access to all developer documentation, GitHub issues and discussions." data-modal-example-questions="How to set up canary release in APISIX?,How to develop a custom APISIX plugin?,How to use custom NGINX configuration in APISIX?,How to configure mTLS between clients and APISIX?,How to only allow a specific APISIX consumer to access special services or routes?" async></script><title data-react-helmet="true">Using APISIX Ingress to access custom monitoring in KubeSphere | Apache APISIX® -- Cloud-Native API Gateway and AI Gateway</title><meta data-react-helmet="true" property="og:image" content="https://static.apiseven.com/202202/apache-apisix.png"><meta data-react-helmet="true" name="twitter:image" content="https://static.apiseven.com/202202/apache-apisix.png"><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org/blog/2021/11/30/use-apisix-ingress-in-kubesphere/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" name="robots" content="index,follow"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" property="og:title" content="Using APISIX Ingress to access custom monitoring in KubeSphere | Apache APISIX® -- Cloud-Native API Gateway and AI Gateway"><meta data-react-helmet="true" name="description" content="This article uses Apache APISIX Ingress Controller as an example to introduce how to quickly use different gateways for Kubernetes clusters and monitor status through KubeSphere."><meta data-react-helmet="true" property="og:description" content="This article uses Apache APISIX Ingress Controller as an example to introduce how to quickly use different gateways for Kubernetes clusters and monitor status through KubeSphere."><meta data-react-helmet="true" name="keywords" content="KubeSphere,Apache APISIX,API Gateway,Kubenetes,Ingress Controller,Monitor"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-11-30T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/webup"><meta data-react-helmet="true" property="article:tag" content="Ecosystem"><link data-react-helmet="true" rel="shortcut icon" href="https://static.apiseven.com/202202/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org/blog/2021/11/30/use-apisix-ingress-in-kubesphere/"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2021/11/30/use-apisix-ingress-in-kubesphere/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2021/11/30/use-apisix-ingress-in-kubesphere/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://38VC84A2WJ-dsn.algolia.net" crossorigin="anonymous"><link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Bold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Light.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Demi.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-ExtraBold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/runtime~main.57eaa0fa.js" as="script">
<link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/main.84c0a2cc.js" as="script">
<link rel="stylesheet" href="https://apisix-website-static.apiseven.com/assets/css/styles.9943cb19.css">
<!-- Matomo from the ASF -->
<script>var _paq=window._paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://analytics.apache.org/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","17"]);var e=document,p=e.createElement("script"),t=e.getElementsByTagName("script")[0];p.async=!0,p.src=a+"matomo.js",t.parentNode.insertBefore(p,t)}()</script>
<!-- End Matomo Code -->
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#e8433e;color:white" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">🤔 Introducing APISIX AI Gateway – Built for LLMs and AI workloads. <a target="_blank" rel="noopener noreferrer" href="/ai-gateway/"> Learn More</a></div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a target="_parent" class="navbar__brand" href="/"><img src="/img/logo2.svg" alt="Apache APISIX®" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo2.svg" alt="Apache APISIX®" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Apache APISIX®</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" target="_parent" href="/docs/">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/docs/apisix/getting-started/">Apache APISIX®️</a></li><li><a class="dropdown__link" target="_parent" href="/docs/apisix/next/dashboard/">Apache APISIX®️ Dashboard</a></li><li><a class="dropdown__link" target="_parent" href="/docs/ingress-controller/overview/">Apache APISIX®️ Ingress Controller</a></li><li><a class="dropdown__link" target="_parent" href="/docs/helm-chart/apisix/">Apache APISIX®️ Helm Charts</a></li><li><a class="dropdown__link" target="_parent" href="/docs/docker/build/">Apache APISIX®️ Docker</a></li><li><a class="dropdown__link" target="_parent" href="/docs/java-plugin-runner/development/">Apache APISIX®️ Java Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/go-plugin-runner/getting-started/">Apache APISIX®️ Go Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/python-plugin-runner/getting-started/">Apache APISIX®️ Python Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/join/">General</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" target="_parent" href="/blog/">Blog</a><a class="navbar__item navbar__link" target="_parent" href="/blog/tags/case-studies/">Case Studies</a><a class="navbar__item navbar__link" target="_parent" href="/downloads/">Downloads</a><a class="navbar__item navbar__link" target="_parent" href="/help/">Help</a><a class="navbar__item navbar__link" target="_parent" href="/team/">Team</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/showcase/">Showcase</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/code-samples/">Code Samples</a></li><li><a class="dropdown__link" target="_parent" href="/plugins/">PluginHub</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/join/">Community</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/events/">Events</a></li><li><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer" class="dropdown__link">Roadmap</a></li></ul></div><a href="/zh/blog" target="_parent" rel="noopener noreferrer" class="localizedBlogLink_W2zh">中文博客</a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_SGhp"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="sticky-outer-wrapper placeholder_iq-X"><div class="sticky-inner-wrapper" style="position:relative;top:0px;z-index:199"><div class="tagsHeader_HGHP"><a target="_parent" href="/blog/tags/case-studies/">Case Studies</a><a target="_parent" href="/blog/tags/ecosystem/">Ecosystem</a><a target="_parent" href="/blog/tags/authentication/">Authentication</a><a target="_parent" href="/blog/tags/plugins/">Plugins</a><a target="_parent" href="/blog/tags/community/">Community</a><a target="_parent" href="/blog/tags/vulnerabilities/">Vulnerabilities</a></div></div></div><div class="container margin-vert--lg"><div class="row" style="justify-content:center"><div class="col col--9"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Using APISIX Ingress to access custom monitoring in KubeSphere</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-11-30T00:00:00.000Z" itemprop="datePublished">November 30, 2021</time> · <!-- -->13 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_dGI0"><div class="avatar margin-bottom--sm"><a href="https://github.com/webup" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_KCbV" src="https://avatars.githubusercontent.com/u/2936504?v=4" alt="Haili Zhang"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/webup" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Haili Zhang</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><section class="shareSection_OUzq"><div><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button aria-label="reddit" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button></div></section><blockquote><p>This article will take Apache APISIX Ingress Controller as an example to show you in detail how to quickly use different types of gateways and status monitoring for Kubernetes clusters through KubeSphere.</p></blockquote><p>In early November, KubeSphere released version 3.2.0, which added a full set of monitoring and management pages for project gateways, and introduced cluster gateways to provide global Ingress gateway capabilities at the cluster level.</p><p>To help users better understand how to deploy and use third-party Ingress Controllers in the new version of KubeSphere, this article will use the <a href="https://apisix.apache.org/docs/ingress-controller/getting-started/" target="_blank" rel="noopener noreferrer">Apache APISIX Ingress Controller</a> as an example to show you how to quickly use different types of gateways for Kubernetes clusters with KubeSphere and perform status monitoring.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="preparation">Preparation<a aria-hidden="true" class="hash-link" href="#preparation" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="installing-kubesphere">Installing KubeSphere<a aria-hidden="true" class="hash-link" href="#installing-kubesphere" title="Direct link to heading">​</a></h3><p>There are two ways to install KubeSphere.</p><ol><li>Install directly on <a href="https://kubesphere.com.cn/docs/quick-start/all-in-one-on-linux/" target="_blank" rel="noopener noreferrer">Linux</a></li><li>Install on <a href="https://kubesphere.com.cn/docs/quick-start/minimal-kubesphere-on-k8s/" target="_blank" rel="noopener noreferrer">existing Kubernetes</a></li></ol><p>The monitoring module is already included in the minimal installation of KubeSphere, so there is no need to enable it additionally, and you can confirm the installation status via the Monitoring tab on the System Components page.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638255471644-e1327ffc-dbed-4890-a15c-819f28731fc9.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638255471644-e1327ffc-dbed-4890-a15c-819f28731fc9.webp, https://static.apiseven.com/202108/1638255471644-e1327ffc-dbed-4890-a15c-819f28731fc9.png" alt="Confirm installation status" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638255471644-e1327ffc-dbed-4890-a15c-819f28731fc9.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638255471644-e1327ffc-dbed-4890-a15c-819f28731fc9.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638255471644-e1327ffc-dbed-4890-a15c-819f28731fc9.png" alt="Confirm installation status" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638255471644-e1327ffc-dbed-4890-a15c-819f28731fc9.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="deploying-the-httpbin-demo-application">Deploying the httpbin demo application<a aria-hidden="true" class="hash-link" href="#deploying-the-httpbin-demo-application" title="Direct link to heading">​</a></h3><p>Since we need to demonstrate the access control capabilities of the gateway, we must first have an accessible application as a backend service for the gateway. Here we use the <a href="https://hub.docker.com/r/kennethreitz/httpbin/" target="_blank" rel="noopener noreferrer">kennethreitz/httpbin</a> container application provided by <a href="/blog/2021/11/30/use-apisix-ingress-in-kubesphere/httpbin.org/">httpbin.org</a> as our demo application.</p><p>In KubeSphere, we can either create a new project or use an existing one. After entering the project page, select &quot;Services&quot; under &quot;Application Loads&quot; to directly create a stateless workload and generate a companion service.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638255616585-b0f5a674-f06a-4b18-baf9-8d6006abeead.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638255616585-b0f5a674-f06a-4b18-baf9-8d6006abeead.webp, https://static.apiseven.com/202108/1638255616585-b0f5a674-f06a-4b18-baf9-8d6006abeead.png" alt="Create a Service" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638255616585-b0f5a674-f06a-4b18-baf9-8d6006abeead.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638255616585-b0f5a674-f06a-4b18-baf9-8d6006abeead.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638255616585-b0f5a674-f06a-4b18-baf9-8d6006abeead.png" alt="Create a Service" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638255616585-b0f5a674-f06a-4b18-baf9-8d6006abeead.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>Use the default port <code>80</code> of the <a href="https://hub.docker.com/r/kennethreitz/httpbin/" target="_blank" rel="noopener noreferrer">kennethreitz/httpbin</a> container as the service port, and make sure you can see the corresponding entry for <code>httpbin</code> under both the Workloads and Services pages after creation, as shown in the following image.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638255786442-924bf704-9b9d-413f-9fc0-be6650a6ff4a.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638255786442-924bf704-9b9d-413f-9fc0-be6650a6ff4a.webp, https://static.apiseven.com/202108/1638255786442-924bf704-9b9d-413f-9fc0-be6650a6ff4a.png" alt="Service" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638255786442-924bf704-9b9d-413f-9fc0-be6650a6ff4a.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638255786442-924bf704-9b9d-413f-9fc0-be6650a6ff4a.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638255786442-924bf704-9b9d-413f-9fc0-be6650a6ff4a.png" alt="Service" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638255786442-924bf704-9b9d-413f-9fc0-be6650a6ff4a.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638255792974-7f354950-e34a-427a-9ff7-aa3af0a56dd6.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638255792974-7f354950-e34a-427a-9ff7-aa3af0a56dd6.webp, https://static.apiseven.com/202108/1638255792974-7f354950-e34a-427a-9ff7-aa3af0a56dd6.png" alt="Workload" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638255792974-7f354950-e34a-427a-9ff7-aa3af0a56dd6.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638255792974-7f354950-e34a-427a-9ff7-aa3af0a56dd6.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638255792974-7f354950-e34a-427a-9ff7-aa3af0a56dd6.png" alt="Workload" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638255792974-7f354950-e34a-427a-9ff7-aa3af0a56dd6.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="additional-project-gateway-details">Additional Project Gateway Details<a aria-hidden="true" class="hash-link" href="#additional-project-gateway-details" title="Direct link to heading">​</a></h3><p>The <strong>Project Gateway</strong> is a feature that has been live since KubeSphere 3.0. The Gateway in the KubeSphere Project is an NGINX Ingress controller. The mechanism built into KubeSphere for HTTP load balancing is called <strong>Application Routing</strong>, which defines the rules for connecting from the outside to the clustered service. To allow access to services from the outside, users can create routing resources to define URI paths, back-end service names, and other information.</p><p>Following the <code>httpbin</code> service project deployed above, open the Gateway Settings page in Project Settings and perform the &quot;Enable Gateway&quot; operation. For convenience, just select <code>NodePort</code> as the &quot;Access Method&quot;.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638256005754-d1e8bf9a-0ecc-4c6e-8ceb-0c25b04fef20.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638256005754-d1e8bf9a-0ecc-4c6e-8ceb-0c25b04fef20.webp, https://static.apiseven.com/202108/1638256005754-d1e8bf9a-0ecc-4c6e-8ceb-0c25b04fef20.png" alt="Project setting" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638256005754-d1e8bf9a-0ecc-4c6e-8ceb-0c25b04fef20.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638256005754-d1e8bf9a-0ecc-4c6e-8ceb-0c25b04fef20.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638256005754-d1e8bf9a-0ecc-4c6e-8ceb-0c25b04fef20.png" alt="Project setting" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638256005754-d1e8bf9a-0ecc-4c6e-8ceb-0c25b04fef20.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>After complete the above operation, go back to the Gateway page, wait for a moment and refresh the page, you can get the deployment completion status as shown below, where you can see that NodePort is given two node ports by default. Next, we use the &quot;Manage&quot; button in the upper right corner to &quot;View Details&quot;.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638256011357-960f6852-31b3-4702-8911-17d07ec19d7b.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638256011357-960f6852-31b3-4702-8911-17d07ec19d7b.webp, https://static.apiseven.com/202108/1638256011357-960f6852-31b3-4702-8911-17d07ec19d7b.png" alt="Deployment complete" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638256011357-960f6852-31b3-4702-8911-17d07ec19d7b.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638256011357-960f6852-31b3-4702-8911-17d07ec19d7b.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638256011357-960f6852-31b3-4702-8911-17d07ec19d7b.png" alt="Deployment complete" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638256011357-960f6852-31b3-4702-8911-17d07ec19d7b.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>At this point we are looking at the new monitoring page for the project/cluster gateway in version 3.2.0. Next we need to create an application route for the httpbin service.</p><p>Go to the Application Routing page from Application Load and start &quot;creating&quot; the route. After naming the route <code>httpbin</code>, we specify a domain name for testing purposes and set the &quot;path&quot; to <code>/</code>, select &quot;service&quot; <code>httpbin</code> and &quot;port&quot; <code>80</code>.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241684770-ce94fe24-58a6-4b9b-9507-d802713b4c38.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241684770-ce94fe24-58a6-4b9b-9507-d802713b4c38.webp, https://static.apiseven.com/202108/1638241684770-ce94fe24-58a6-4b9b-9507-d802713b4c38.png" alt="Apply routin" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241684770-ce94fe24-58a6-4b9b-9507-d802713b4c38.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241684770-ce94fe24-58a6-4b9b-9507-d802713b4c38.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241684770-ce94fe24-58a6-4b9b-9507-d802713b4c38.png" alt="Apply routin" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241684770-ce94fe24-58a6-4b9b-9507-d802713b4c38.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241689985-149fc2f7-456b-423c-8cfc-00800dc24917.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241689985-149fc2f7-456b-423c-8cfc-00800dc24917.webp, https://static.apiseven.com/202108/1638241689985-149fc2f7-456b-423c-8cfc-00800dc24917.png" alt="Create route" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241689985-149fc2f7-456b-423c-8cfc-00800dc24917.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241689985-149fc2f7-456b-423c-8cfc-00800dc24917.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241689985-149fc2f7-456b-423c-8cfc-00800dc24917.png" alt="Create route" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241689985-149fc2f7-456b-423c-8cfc-00800dc24917.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>After skipping the advanced settings in the next step, the route creation is completed and you can get the <code>httpbin</code> application route entry as shown in the figure below.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638256382273-109728eb-4d19-4c2b-ab92-9a2909c3eff8.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638256382273-109728eb-4d19-4c2b-ab92-9a2909c3eff8.webp, https://static.apiseven.com/202108/1638256382273-109728eb-4d19-4c2b-ab92-9a2909c3eff8.png" alt="Route creation" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638256382273-109728eb-4d19-4c2b-ab92-9a2909c3eff8.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638256382273-109728eb-4d19-4c2b-ab92-9a2909c3eff8.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638256382273-109728eb-4d19-4c2b-ab92-9a2909c3eff8.png" alt="Route creation" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638256382273-109728eb-4d19-4c2b-ab92-9a2909c3eff8.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>Next, we can access the httpbin application service through the NodePort address of the project gateway and the specified domain name (e.g., <a href="http://httpbin.ui:32516" target="_blank" rel="noopener noreferrer">http://httpbin.ui:32516</a> here), refresh or manipulate the request generation function of the page at will, and then enter the details page of the gateway, you can see that the &quot;Monitoring&quot; panel has appeared some built-in monitoring indicators.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638256419345-48476f01-b293-401b-9e4f-8bf64a9fab90.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638256419345-48476f01-b293-401b-9e4f-8bf64a9fab90.webp, https://static.apiseven.com/202108/1638256419345-48476f01-b293-401b-9e4f-8bf64a9fab90.png" alt="Generation function" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638256419345-48476f01-b293-401b-9e4f-8bf64a9fab90.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638256419345-48476f01-b293-401b-9e4f-8bf64a9fab90.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638256419345-48476f01-b293-401b-9e4f-8bf64a9fab90.png" alt="Generation function" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638256419345-48476f01-b293-401b-9e4f-8bf64a9fab90.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h4 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="specifying-the-nodeport-node-port">Specifying the NodePort Node Port<a aria-hidden="true" class="hash-link" href="#specifying-the-nodeport-node-port" title="Direct link to heading">​</a></h4><p>For public cloud environments that use NodePort to expose access to the outside world, the open ports are usually limited and controlled, so we need to modify the NodePort used by the gateway.</p><p>Since the gateway is managed by KubeSphere, to modify the NodePort of the gateway service, you need to have access to the <code>kubesphere-controls-system</code> project. Once inside the project, you can find the gateway service named <code>kubesphere-router-&lt;project-namespace&gt;</code> on the &quot;Services&quot; page under &quot;Application Load&quot;, and the NodePort is open for external access.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638256523468-408ee36f-aac7-4bb4-9cd3-2473a95a52f4.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638256523468-408ee36f-aac7-4bb4-9cd3-2473a95a52f4.webp, https://static.apiseven.com/202108/1638256523468-408ee36f-aac7-4bb4-9cd3-2473a95a52f4.png" alt="Application Load" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638256523468-408ee36f-aac7-4bb4-9cd3-2473a95a52f4.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638256523468-408ee36f-aac7-4bb4-9cd3-2473a95a52f4.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638256523468-408ee36f-aac7-4bb4-9cd3-2473a95a52f4.png" alt="Application Load" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638256523468-408ee36f-aac7-4bb4-9cd3-2473a95a52f4.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="getting-started-with-clustered-gateways">Getting Started with Clustered Gateways<a aria-hidden="true" class="hash-link" href="#getting-started-with-clustered-gateways" title="Direct link to heading">​</a></h2><blockquote><p>KubeSphere 3.2.0 supports global gateways at the cluster level, so all projects can share the same gateway, and previously created project gateways are not affected by the cluster gateway. Gateways for all projects can be managed and configured centrally, eliminating the need to switch to a different enterprise space to configure gateways.</p></blockquote><p>If you are using KubeSphere version 3.2.0, we recommend using the cluster gateway feature to unify the application routing across the cluster. To enable the cluster gateway, it&#x27;s very simple: use an account with cluster management privileges to access one of the clusters you can manage (e.g. default cluster here), and under &quot;Gateway Settings&quot; in &quot;Cluster Settings&quot;, you can &quot;Enable Gateway&quot; and view the &quot;Project Gateway&quot;.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638256574546-920473f3-e8ac-4cf9-932b-4202888e7a54.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638256574546-920473f3-e8ac-4cf9-932b-4202888e7a54.webp, https://static.apiseven.com/202108/1638256574546-920473f3-e8ac-4cf9-932b-4202888e7a54.png" alt="Project gateway" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638256574546-920473f3-e8ac-4cf9-932b-4202888e7a54.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638256574546-920473f3-e8ac-4cf9-932b-4202888e7a54.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638256574546-920473f3-e8ac-4cf9-932b-4202888e7a54.png" alt="Project gateway" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638256574546-920473f3-e8ac-4cf9-932b-4202888e7a54.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>The way the cluster gateway is opened and the modification of the aligned NodePort access port are basically the same as the previous project gateway, so we won&#x27;t go into details here.</p><p>However, there is one point that needs special attention: after the cluster gateway is opened, the gateway of the project that has been opened will remain; however, the project that has not yet created a gateway cannot create a separate gateway, and will use the cluster gateway directly.</p><p>The following figure shows the overview of all gateways in the &quot;Gateway Settings&quot; page for projects that have already created gateways, after having both project and cluster gateways.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638256658706-ac5107fe-2fd7-4521-b830-9ae1fdf762e1.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638256658706-ac5107fe-2fd7-4521-b830-9ae1fdf762e1.webp, https://static.apiseven.com/202108/1638256658706-ac5107fe-2fd7-4521-b830-9ae1fdf762e1.png" alt="Gateway setting" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638256658706-ac5107fe-2fd7-4521-b830-9ae1fdf762e1.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638256658706-ac5107fe-2fd7-4521-b830-9ae1fdf762e1.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638256658706-ac5107fe-2fd7-4521-b830-9ae1fdf762e1.png" alt="Gateway setting" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638256658706-ac5107fe-2fd7-4521-b830-9ae1fdf762e1.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="a-quick-look-at-apache-apisix-ingress-controller">A Quick Look at Apache APISIX Ingress Controller<a aria-hidden="true" class="hash-link" href="#a-quick-look-at-apache-apisix-ingress-controller" title="Direct link to heading">​</a></h2><p>Apache APISIX is an open source, high-performance, dynamic cloud-native gateway donated to the Apache Foundation by Shenzhen Tributary Technology Co. in 2019, and is now the top open source project of the Apache Foundation and the most active gateway project on GitHub.Apache APISIX currently covers API gateways, LB Kubernetes Ingress, Service Mesh, and many other scenarios.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="how-to-deploy">How to deploy<a aria-hidden="true" class="hash-link" href="#how-to-deploy" title="Direct link to heading">​</a></h3><p>First add the Apache APISIX Helm Chart repository. After that, select an enterprise space and add the following <a href="https://charts.apiseven.com" target="_blank" rel="noopener noreferrer">Apache APISIX repository</a> via &quot;Application Repository&quot; under &quot;Application Management&quot;.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638256788584-dca2d21b-3ffc-4bb4-bd73-56dedb6d005a.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638256788584-dca2d21b-3ffc-4bb4-bd73-56dedb6d005a.webp, https://static.apiseven.com/202108/1638256788584-dca2d21b-3ffc-4bb4-bd73-56dedb6d005a.png" alt="Application repository" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638256788584-dca2d21b-3ffc-4bb4-bd73-56dedb6d005a.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638256788584-dca2d21b-3ffc-4bb4-bd73-56dedb6d005a.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638256788584-dca2d21b-3ffc-4bb4-bd73-56dedb6d005a.png" alt="Application repository" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638256788584-dca2d21b-3ffc-4bb4-bd73-56dedb6d005a.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>Next, create a project named <code>apisix-system</code>. Once you are on the project page, select the Create an Application in Application Load method to deploy Apache APISIX, and select the <code>apisix</code> application template to start the deployment.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241691528-80090ab6-85de-401f-96d7-58118b3cbd88.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241691528-80090ab6-85de-401f-96d7-58118b3cbd88.webp, https://static.apiseven.com/202108/1638241691528-80090ab6-85de-401f-96d7-58118b3cbd88.png" alt="start the deployment" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241691528-80090ab6-85de-401f-96d7-58118b3cbd88.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241691528-80090ab6-85de-401f-96d7-58118b3cbd88.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241691528-80090ab6-85de-401f-96d7-58118b3cbd88.png" alt="start the deployment" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241691528-80090ab6-85de-401f-96d7-58118b3cbd88.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><blockquote><p>Why deploy the Apache APISIX application Helm Chart directly instead of deploying the Apache APISIX Ingress Controller directly?</p></blockquote><p>This is because the Apache APISIX Ingress Controller is currently strongly associated with the Apache APISIX Gateway (as shown in the figure below), and it is currently most convenient to deploy Apache APISIX Gateway + Dashboard + Ingress Controller through Apache APISIX Helm Charts at the same time. Ingress Controller is the most convenient, so this article recommends using Apache APISIX Helm Charts directly for the deployment of the whole set of components.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241693072-9b3146f5-bcc6-4441-b002-f1a07603a8c4.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241693072-9b3146f5-bcc6-4441-b002-f1a07603a8c4.webp, https://static.apiseven.com/202108/1638241693072-9b3146f5-bcc6-4441-b002-f1a07603a8c4.png" alt="Why use APISIX gateway" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241693072-9b3146f5-bcc6-4441-b002-f1a07603a8c4.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241693072-9b3146f5-bcc6-4441-b002-f1a07603a8c4.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241693072-9b3146f5-bcc6-4441-b002-f1a07603a8c4.png" alt="Why use APISIX gateway" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241693072-9b3146f5-bcc6-4441-b002-f1a07603a8c4.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>Name the application apisix to avoid mismatches between workloads and service names of multiple components (Gateway, Dashboard, Ingress Controller); in the &quot;Application Settings&quot; section edited in the installation steps, please fill in the following configuration (please pay special attention to the notes marked with <!-- -->[Note]<!-- -->, the rest (The rest can be edited and modified by yourself as needed).</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">global</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">imagePullSecrets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apisix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">customLuaSharedDicts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">repository</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apache/apisix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">pullPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> IfNotPresent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">tag</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 2.10.1</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicaCount</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">podAnnotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">podSecurityContext</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">securityContext</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">nodeSelector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tolerations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">affinity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">podAntiAffinity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">nameOverride</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">fullnameOverride</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">gateway</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">externalTrafficPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">servicePort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tls</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">servicePort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">existingCASecret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">certCAFilename</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">http2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stream</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">only</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">tcp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">udp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ingress</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">hosts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apisix.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">paths</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">tls</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">admin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">externalIPs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9180</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">servicePort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9180</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cors</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">credentials</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">admin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> edd1c9f034335f136f87ad84b625c8f1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">viewer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 4054f7cf07e344346cd3f287985e76a2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">allow</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ipList</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 0.0.0.0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">plugins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> api</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">breaker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> authz</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">keycloak</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> basic</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> batch</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">restriction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> cors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> echo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> fault</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">injection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> grpc</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">transcode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> hmac</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">logger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ip</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">restriction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ua</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">restriction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> jwt</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> kafka</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">logger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> limit</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">conn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> limit</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> limit</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">req</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> openid</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> authz</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">casbin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> proxy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> proxy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">mirror</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> proxy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rewrite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> redirect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> referer</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">restriction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">validation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rewrite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> serverless</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> serverless</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pre</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> sls</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">logger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> syslog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> tcp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">logger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> udp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">logger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> uri</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">blocker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> wolf</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rbac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> zipkin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> traffic</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">split</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> gzip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> real</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># [note] add this plug-in to cooperate with Dashboard to display service information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">stream_plugins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> mqtt</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ip</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">restriction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> limit</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">conn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">customPlugins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">luaPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opts/custom_plugins/</span><span class="token punctuation" style="color:#393A34">?</span><span class="token plain">.lua</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># [note] the following configuration ensures that the Prometheus plug-in can expose indicators to the outside world.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">plugins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">attrs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">export_addr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token key atrule" style="color:#00a4db">ip</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9091</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">configMap</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">mounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">dns</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resolvers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 172.20.0.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 114.114.114.114</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 223.5.5.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 1.1.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 8.8.8.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">validity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">timeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">autoscaling</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minReplicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">maxReplicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">targetCPUUtilizationPercentage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">targetMemoryUtilizationPercentage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">configurationSnippet</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">main</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">httpStart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">httpEnd</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">httpSrv</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">httpAdmin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stream</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">etcd</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://etcd.host:2379&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /apisix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">timeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">auth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">rbac</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">tls</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">existingSecret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">certFilename</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">certKeyFilename</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">verify</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2379</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicaCount</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">dashboard</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># [note] Enable NodePort for Dashboard to facilitate subsequent use</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ingress-controller</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">apisix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic"># [note] Be sure to set the namespace where gateway is located</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">serviceNamespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apisix</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">serviceMonitor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;apisix-system&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">interval</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 15s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>After successful deployment, click the application name to enter the details page, and you can see the following service deployment and working status operation status display under the &quot;Resource Status&quot; tab.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241694605-7d88f095-fef5-43f4-9752-8dc5a2f9abc4.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241694605-7d88f095-fef5-43f4-9752-8dc5a2f9abc4.webp, https://static.apiseven.com/202108/1638241694605-7d88f095-fef5-43f4-9752-8dc5a2f9abc4.png" alt="Resource status" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241694605-7d88f095-fef5-43f4-9752-8dc5a2f9abc4.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241694605-7d88f095-fef5-43f4-9752-8dc5a2f9abc4.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241694605-7d88f095-fef5-43f4-9752-8dc5a2f9abc4.png" alt="Resource status" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241694605-7d88f095-fef5-43f4-9752-8dc5a2f9abc4.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The default configuration parameters for the other two Helm Charts of the Apache APISIX project can be found in <a href="https://github.com/apache/apisix-helm-chart/blob/master/charts/apisix-dashboard/values.yaml" target="_blank" rel="noopener noreferrer">Dashboard</a> and <a href="https://github.com/apache/apisix-helm-chart/blob/master/charts/apisix-ingress-controller/values.yaml" target="_blank" rel="noopener noreferrer">Ingress Controller</a> <code>values.yaml</code>.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="dashboard-usage">Dashboard Usage<a aria-hidden="true" class="hash-link" href="#dashboard-usage" title="Direct link to heading">​</a></h3><p>After the Apache APISIX application is deployed, you can check the current status of the Apache APISIX gateway through the Apache APISIX Dashboard.</p><p>You can find the <code>apisix-dashboard</code> service from the application load-services page. Since we have enabled NodePort for Dashboard in the application configuration, you can access Dashboard directly through the NodePort port here.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241699353-8d54dfe9-8439-4085-8e7d-02583a1d0d9e.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241699353-8d54dfe9-8439-4085-8e7d-02583a1d0d9e.webp, https://static.apiseven.com/202108/1638241699353-8d54dfe9-8439-4085-8e7d-02583a1d0d9e.png" alt="Dahboard view" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241699353-8d54dfe9-8439-4085-8e7d-02583a1d0d9e.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241699353-8d54dfe9-8439-4085-8e7d-02583a1d0d9e.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241699353-8d54dfe9-8439-4085-8e7d-02583a1d0d9e.png" alt="Dahboard view" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241699353-8d54dfe9-8439-4085-8e7d-02583a1d0d9e.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>Log in to the Apache APISIX Dashboard with the default user name and password <code>admin</code>, and you can enter the System Information page to view the information of Apache APISIX nodes currently connected to management.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241703083-0915a427-9aab-41e6-8c76-be60d70fc135.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241703083-0915a427-9aab-41e6-8c76-be60d70fc135.webp, https://static.apiseven.com/202108/1638241703083-0915a427-9aab-41e6-8c76-be60d70fc135.png" alt="Enter name and password" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241703083-0915a427-9aab-41e6-8c76-be60d70fc135.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241703083-0915a427-9aab-41e6-8c76-be60d70fc135.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241703083-0915a427-9aab-41e6-8c76-be60d70fc135.png" alt="Enter name and password" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241703083-0915a427-9aab-41e6-8c76-be60d70fc135.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="how-to-use">How to use<a aria-hidden="true" class="hash-link" href="#how-to-use" title="Direct link to heading">​</a></h3><p>Next, let&#x27;s go back to the &quot;Apply Routes&quot; page, create another route (e.g. <code>apisix-httpbin</code>), set the path to <code>/*</code> <code>httpbin</code> <code>80</code> and add the key <code>kubernetes.io/ingress.class</code>: <code>apisix</code> to it.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241705123-6fe3ba11-bc08-4fb2-a8b1-73066ce73679.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241705123-6fe3ba11-bc08-4fb2-a8b1-73066ce73679.webp, https://static.apiseven.com/202108/1638241705123-6fe3ba11-bc08-4fb2-a8b1-73066ce73679.png" alt="Create route" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241705123-6fe3ba11-bc08-4fb2-a8b1-73066ce73679.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241705123-6fe3ba11-bc08-4fb2-a8b1-73066ce73679.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241705123-6fe3ba11-bc08-4fb2-a8b1-73066ce73679.png" alt="Create route" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241705123-6fe3ba11-bc08-4fb2-a8b1-73066ce73679.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241706790-3989c06d-c803-4c16-869a-6fa000b5744b.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241706790-3989c06d-c803-4c16-869a-6fa000b5744b.webp, https://static.apiseven.com/202108/1638241706790-3989c06d-c803-4c16-869a-6fa000b5744b.png" alt="Setting details" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241706790-3989c06d-c803-4c16-869a-6fa000b5744b.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241706790-3989c06d-c803-4c16-869a-6fa000b5744b.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241706790-3989c06d-c803-4c16-869a-6fa000b5744b.png" alt="Setting details" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241706790-3989c06d-c803-4c16-869a-6fa000b5744b.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h4 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="verify-that-the-application-route-is-effective">Verify that the application route is effective<a aria-hidden="true" class="hash-link" href="#verify-that-the-application-route-is-effective" title="Direct link to heading">​</a></h4><p>Go back to the Apache APISIX Dashboard and enter the &quot;Routes&quot; page. You can see that the newly created application route has been recognized by the Apache APISIX Ingress Controller and automatically added to the Apache APISIX gateway, and you can also see an automatically created upstream entry in the &quot;Upstream&quot; page.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241712811-db1f93dd-2963-4034-b461-26733d173bae.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241712811-db1f93dd-2963-4034-b461-26733d173bae.webp, https://static.apiseven.com/202108/1638241712811-db1f93dd-2963-4034-b461-26733d173bae.png" alt="Verify route is effective" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241712811-db1f93dd-2963-4034-b461-26733d173bae.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241712811-db1f93dd-2963-4034-b461-26733d173bae.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241712811-db1f93dd-2963-4034-b461-26733d173bae.png" alt="Verify route is effective" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241712811-db1f93dd-2963-4034-b461-26733d173bae.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>Next, go back to the <code>apisix-system</code> project &quot;Services&quot; page, find the port corresponding to the <code>apisix-gateway</code> service, and access <code>&lt;apisix-httpbin application routing domain name&gt;:&lt;apisix-gateway external access port&gt;</code> (for example, <code>httpbin.ui:30408</code> here) to access the backend service associated with the <code>apisix-httpbin</code> application route.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241716159-134e6bd8-9e08-46de-8d46-39142c439b8f.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241716159-134e6bd8-9e08-46de-8d46-39142c439b8f.webp, https://static.apiseven.com/202108/1638241716159-134e6bd8-9e08-46de-8d46-39142c439b8f.png" alt="Service page" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241716159-134e6bd8-9e08-46de-8d46-39142c439b8f.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241716159-134e6bd8-9e08-46de-8d46-39142c439b8f.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241716159-134e6bd8-9e08-46de-8d46-39142c439b8f.png" alt="Service page" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241716159-134e6bd8-9e08-46de-8d46-39142c439b8f.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="custom-monitoring-of-apache-apisix-gateways">Custom Monitoring of Apache APISIX Gateways<a aria-hidden="true" class="hash-link" href="#custom-monitoring-of-apache-apisix-gateways" title="Direct link to heading">​</a></h2><p>Monitoring capabilities can be augmented when using the Apache APISIX gateway through the Prometheus plug-in and the custom monitoring capabilities that come with KubeSphere.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="exposing-relevant-prometheus-monitoring-metrics">Exposing relevant Prometheus monitoring metrics<a aria-hidden="true" class="hash-link" href="#exposing-relevant-prometheus-monitoring-metrics" title="Direct link to heading">​</a></h3><p>Since we have already enabled the <a href="https://apisix.apache.org/docs/apisix/plugins/prometheus" target="_blank" rel="noopener noreferrer">Prometheus plugin</a> when deploying the Apache APISIX application, we only need to expose the interface to the Prometheus monitoring metrics.</p><p>Go to the <code>apisix-system</code> project, find apisix on the &quot;Workloads&quot; page and go to the deployment details page, then select &quot;Edit Settings&quot; from &quot;More Actions&quot; in the left action panel.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241718162-86d110b6-2c40-461c-9cf4-a13b73cf5768.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241718162-86d110b6-2c40-461c-9cf4-a13b73cf5768.webp, https://static.apiseven.com/202108/1638241718162-86d110b6-2c40-461c-9cf4-a13b73cf5768.png" alt="APISIX workloads page" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241718162-86d110b6-2c40-461c-9cf4-a13b73cf5768.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241718162-86d110b6-2c40-461c-9cf4-a13b73cf5768.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241718162-86d110b6-2c40-461c-9cf4-a13b73cf5768.png" alt="APISIX workloads page" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241718162-86d110b6-2c40-461c-9cf4-a13b73cf5768.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>In the pop-up panel, go to the <code>apisix</code> container editing interface, find &quot;Port Settings&quot;, add a new port named <code>prom</code> to map to port <code>9091</code> of the container, save it and the <code>apisix</code> workload will restart.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241721050-c3e9409c-4ec8-4ff1-bcf8-045ea57ec179.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241721050-c3e9409c-4ec8-4ff1-bcf8-045ea57ec179.webp, https://static.apiseven.com/202108/1638241721050-c3e9409c-4ec8-4ff1-bcf8-045ea57ec179.png" alt="APISIX container" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241721050-c3e9409c-4ec8-4ff1-bcf8-045ea57ec179.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241721050-c3e9409c-4ec8-4ff1-bcf8-045ea57ec179.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241721050-c3e9409c-4ec8-4ff1-bcf8-045ea57ec179.png" alt="APISIX container" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241721050-c3e9409c-4ec8-4ff1-bcf8-045ea57ec179.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="creating-a-servicemonitor-for-monitoring-metrics">Creating a ServiceMonitor for monitoring metrics<a aria-hidden="true" class="hash-link" href="#creating-a-servicemonitor-for-monitoring-metrics" title="Direct link to heading">​</a></h3><p>Next, we need to connect the exposed metrics interface to KubeSphere&#x27;s own Prometheus to make it accessible (to grab the metrics data).</p><p>Since KubeSphere maintains the internal Prometheus system through the <a href="https://github.com/prometheus-operator/prometheus-operator" target="_blank" rel="noopener noreferrer">Prometheus Operator</a>, the quickest way to access the metrics is to create a ServiceMonitor resource directly.</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> monitoring.coreos.com/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ServiceMonitor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apisix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apisix</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">endpoints</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">scheme</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic"># [note] use the container port name exposed by the workload in the previous step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">targetPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic"># [note] you need to bind the metric interface path corresponding to apisix correctly.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /apisix/prometheus/metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">interval</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 15s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespaceSelector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchNames</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> apisix</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app.kubernetes.io/name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apisix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app.kubernetes.io/version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 2.10.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">helm.sh/chart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apisix</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0.7.2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>Create the ServiceMonitor resource using <code>kubectl apply -f your_service_monitor.yaml</code>. Once created, you can also search for the ServiceMonitor resource in the cluster&#x27;s CRD management page and find a custom resource named <code>apisix</code>, if you have cluster management privileges, and make subsequent YAML changes here.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241723331-64cb363e-b6af-4af4-93f3-29a79c9a5e77.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241723331-64cb363e-b6af-4af4-93f3-29a79c9a5e77.webp, https://static.apiseven.com/202108/1638241723331-64cb363e-b6af-4af4-93f3-29a79c9a5e77.png" alt="Create ServiceMonitor" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241723331-64cb363e-b6af-4af4-93f3-29a79c9a5e77.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241723331-64cb363e-b6af-4af4-93f3-29a79c9a5e77.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241723331-64cb363e-b6af-4af4-93f3-29a79c9a5e77.png" alt="Create ServiceMonitor" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241723331-64cb363e-b6af-4af4-93f3-29a79c9a5e77.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="indicator-access-to-custom-monitoring-panel">Indicator access to custom monitoring panel<a aria-hidden="true" class="hash-link" href="#indicator-access-to-custom-monitoring-panel" title="Direct link to heading">​</a></h3><p>Find &quot;Custom Monitoring&quot; under &quot;Monitoring Alarms&quot; in the menu list on the left side of the project, and start to &quot;create&quot; custom monitoring panels.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241724906-d9531809-4682-49b3-b90b-d7f3a03e70e3.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241724906-d9531809-4682-49b3-b90b-d7f3a03e70e3.webp, https://static.apiseven.com/202108/1638241724906-d9531809-4682-49b3-b90b-d7f3a03e70e3.png" alt="Create monitor panels" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241724906-d9531809-4682-49b3-b90b-d7f3a03e70e3.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241724906-d9531809-4682-49b3-b90b-d7f3a03e70e3.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241724906-d9531809-4682-49b3-b90b-d7f3a03e70e3.png" alt="Create monitor panels" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241724906-d9531809-4682-49b3-b90b-d7f3a03e70e3.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>Fill in &quot;Name&quot; in the pop-up window, select &quot;Custom&quot; monitoring template, and go to &quot;Next&quot; to create the monitoring panel.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241727938-cd3843f9-0e22-4316-91d2-84b56cd66f21.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241727938-cd3843f9-0e22-4316-91d2-84b56cd66f21.webp, https://static.apiseven.com/202108/1638241727938-cd3843f9-0e22-4316-91d2-84b56cd66f21.png" alt="Setting details" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241727938-cd3843f9-0e22-4316-91d2-84b56cd66f21.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241727938-cd3843f9-0e22-4316-91d2-84b56cd66f21.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241727938-cd3843f9-0e22-4316-91d2-84b56cd66f21.png" alt="Setting details" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241727938-cd3843f9-0e22-4316-91d2-84b56cd66f21.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>After entering the edit page now click on the <code>+</code> area on the left side and configure the Prometheus monitoring metrics in the &quot;Data&quot; area on the right side. For example, here we can use <code>sum(apisix_nginx_http_current_connections)</code> to count the total number of connections to the Apache APISIX gateway in real time.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241729416-3d2024f1-9586-44ac-ad6c-7472c8924fc8.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241729416-3d2024f1-9586-44ac-ad6c-7472c8924fc8.webp, https://static.apiseven.com/202108/1638241729416-3d2024f1-9586-44ac-ad6c-7472c8924fc8.png" alt="Connect to APISIX gateway" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241729416-3d2024f1-9586-44ac-ad6c-7472c8924fc8.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241729416-3d2024f1-9586-44ac-ad6c-7472c8924fc8.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241729416-3d2024f1-9586-44ac-ad6c-7472c8924fc8.png" alt="Connect to APISIX gateway" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241729416-3d2024f1-9586-44ac-ad6c-7472c8924fc8.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>After saving, find &quot;+ Add monitoring item&quot; in the bottom-right corner of the page and select &quot;Line Chart&quot; to create the Nginx connection state metric: use <code>sum(apisix_nginx_http_current_connections) by (state)</code> as the metric, <code>{{state}}</code> as the legend name, and &quot;Legend type&quot; as the stacked graph to get a result similar to the one below. Save the template and get your first custom monitoring panel!</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241730747-298fe17e-fb34-4da6-ac9d-8b1efde4521c.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241730747-298fe17e-fb34-4da6-ac9d-8b1efde4521c.webp, https://static.apiseven.com/202108/1638241730747-298fe17e-fb34-4da6-ac9d-8b1efde4521c.png" alt="Get custom monitoring panel" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241730747-298fe17e-fb34-4da6-ac9d-8b1efde4521c.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241730747-298fe17e-fb34-4da6-ac9d-8b1efde4521c.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241730747-298fe17e-fb34-4da6-ac9d-8b1efde4521c.png" alt="Get custom monitoring panel" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241730747-298fe17e-fb34-4da6-ac9d-8b1efde4521c.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><blockquote><p>The Prometheus metrics currently provided by the Apache APISIX gateway can be found in the <a href="https://apisix.apache.org/zh/docs/apisix/plugins/prometheus/#%25E5%258F%25AF%25E6%259C%2589%25E7%259A%2584%25E6%258C%2587%25E6%25A0%2587" target="_blank" rel="noopener noreferrer">available metrics section</a> of the official documentation.</p></blockquote><p>Since the metrics configuration process is a bit tricky, it is recommended to import the <a href="https://grafana.com/grafana/dashboards/11719" target="_blank" rel="noopener noreferrer">Apache APISIX Grafana template</a> directly from the cluster-level &quot;Custom Monitoring&quot; (download the JSON and import it via &quot;Local Upload&quot;).</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241733535-168ce86b-6654-4278-941d-23fb44003c90.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241733535-168ce86b-6654-4278-941d-23fb44003c90.webp, https://static.apiseven.com/202108/1638241733535-168ce86b-6654-4278-941d-23fb44003c90.png" alt="Import Grafana template" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241733535-168ce86b-6654-4278-941d-23fb44003c90.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241733535-168ce86b-6654-4278-941d-23fb44003c90.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241733535-168ce86b-6654-4278-941d-23fb44003c90.png" alt="Import Grafana template" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241733535-168ce86b-6654-4278-941d-23fb44003c90.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>KubeSphere is also <a href="https://github.com/kubesphere/kubesphere/issues/4433" target="_blank" rel="noopener noreferrer">actively working</a> on introducing the Grafana template import into the project&#x27;s custom monitoring capabilities, so stay tuned!</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1638241735167-4c6d3a9a-8190-41b5-9e89-7f09384c7113.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1638241735167-4c6d3a9a-8190-41b5-9e89-7f09384c7113.webp, https://static.apiseven.com/202108/1638241735167-4c6d3a9a-8190-41b5-9e89-7f09384c7113.png" alt="Finish work" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1638241735167-4c6d3a9a-8190-41b5-9e89-7f09384c7113.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1638241735167-4c6d3a9a-8190-41b5-9e89-7f09384c7113.webp, https://static.apiseven.com/apisix-thumbnail/202108/1638241735167-4c6d3a9a-8190-41b5-9e89-7f09384c7113.png" alt="Finish work" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1638241735167-4c6d3a9a-8190-41b5-9e89-7f09384c7113.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="summary">Summary<a aria-hidden="true" class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>This article is a very detailed step-by-step guide for you to fully understand and follow along with how to &quot;interoperate Apache APISIX Ingress gateway with KubeSphere and perform custom monitoring&quot;. We hope that reading this article will deepen your understanding of Apache APISIX Ingress Controller and Apache APISIX application.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/ecosystem/">Ecosystem</a></li></ul></div></footer></article><section class="shareSection_OUzq"><div><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button aria-label="reddit" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button></div></section><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2021/12/01/release-apache-apisix-2.11/"><div class="pagination-nav__sublabel sublabel_M5Gs">Newer Post</div><div class="pagination-nav__label">Release Apache APISIX 2.11.0</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2021/11/26/apache-apisix-committer-experience/"><div class="pagination-nav__sublabel sublabel_M5Gs">Older Post</div><div class="pagination-nav__label">Contributer to Committer journey @Apache APISIX</div></a></div></nav></div></div></div></div><footer class="container_N-4m"><div class="linksRow_U0oR"><div class="linksCol_R6VE"><div>ASF</div><ul><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span></span><span>Foundation</span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer"><span></span><span>License</span></a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer"><span></span><span>Events</span></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer"><span></span><span>Security</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer"><span></span><span>Sponsorship</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer"><span></span><span>Thanks</span></a></li></ul></div><div class="linksCol_R6VE"><div>Community</div><ul><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer"><span></span><span>GitHub</span></a></li><li class="footer__item"><a href="/docs/general/join/"><span></span><span>Slack</span></a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer"><span></span><span>Twitter</span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCgPD18cMhOg5rmPVnQhAC8g" target="_blank" rel="noopener noreferrer"><span></span><span>YouTube</span></a></li></ul></div><div class="linksCol_R6VE"><div>More</div><ul><li class="footer__item"><a target="_parent" href="/blog/"><span></span><span>Blog</span></a></li><li class="footer__item"><a target="_parent" href="/showcase/"><span></span><span>Showcase</span></a></li><li class="footer__item"><a target="_parent" href="/plugins/"><span></span><span>Plugin Hub</span></a></li><li class="footer__item"><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer"><span></span><span>Roadmap</span></a></li></ul></div></div><div class="copyright_Bdi1"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span style="display:inline-block;width:231.25px;height:40px"></span></a><div>Copyright © 2019-2025 The Apache Software Foundation. Apache APISIX, APISIX®, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></footer></div>
<script src="https://apisix-website-static.apiseven.com/assets/js/runtime~main.57eaa0fa.js"></script>
<script src="https://apisix-website-static.apiseven.com/assets/js/main.84c0a2cc.js"></script>
</body>
</html>