<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WQLBQL6GY3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WQLBQL6GY3",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/releases/rss.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/releases/atom.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/articles/rss.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/articles/atom.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog Atom Feed">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"><title data-react-helmet="true">How to Improve the Observability of Nginx with Apache APISX | Apache APISIX¬Æ -- Cloud-Native API Gateway</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://apisix.apache.org/img/favicon.png"><meta data-react-helmet="true" name="twitter:image" content="https://apisix.apache.org/img/favicon.png"><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org/blog/2021/08/06/using-apache-apisix-to-improve-the-observability-of-nginx"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" name="robots" content="index,follow"><meta data-react-helmet="true" property="og:title" content="How to Improve the Observability of Nginx with Apache APISX | Apache APISIX¬Æ -- Cloud-Native API Gateway"><meta data-react-helmet="true" name="description" content="Best Practices: This article shares solutions and practices for observability in the context of Nginx observability, the relationship between Apache APISIX and Nginx, Apache APISIX observability, and further enhancing observability with Apache SkyWalking."><meta data-react-helmet="true" property="og:description" content="Best Practices: This article shares solutions and practices for observability in the context of Nginx observability, the relationship between Apache APISIX and Nginx, Apache APISIX observability, and further enhancing observability with Apache SkyWalking."><meta data-react-helmet="true" name="keywords" content="API Gateway,APISIX,Apache APISIX,Nginx,observability"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-08-06T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/gxthrj"><meta data-react-helmet="true" property="article:tag" content="Practical Case"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org/blog/2021/08/06/using-apache-apisix-to-improve-the-observability-of-nginx"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2021/08/06/using-apache-apisix-to-improve-the-observability-of-nginx" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/zh/blog/2021/08/06/using-apache-apisix-to-improve-the-observability-of-nginx" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2021/08/06/using-apache-apisix-to-improve-the-observability-of-nginx" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://38VC84A2WJ-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/apache/apisix-website@asf-site/assets/css/styles.4ccf253e.css">
<link rel="preload" href="https://cdn.jsdelivr.net/gh/apache/apisix-website@asf-site/assets/js/runtime~main.6dde7109.js" as="script">
<link rel="preload" href="https://cdn.jsdelivr.net/gh/apache/apisix-website@asf-site/assets/js/main.8cb8262b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" style="background-color:#e8433e;color:white" role="banner"><div class="announcementBarPlaceholder_2m9F"></div><div class="announcementBarContent_3EUC">ü§î Have queries regarding apache APISIX, Join slack channel to discuss them <a target="_blank" rel="noopener noreferrer" href="https://join.slack.com/t/the-asf/shared_invite/zt-vlfbf7ch-HkbNHiU_uDlcH_RvaHv9gQ">join #apisix channel</a>! ‚≠êÔ∏è</div><button type="button" class="clean-btn close announcementBarClose_38nx" aria-label="Close"><svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo2.svg" alt="Apache APISIX¬Æ" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo2.svg" alt="Apache APISIX¬Æ" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Apache APISIX¬Æ</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/apisix/getting-started">Apache APISIX¬ÆÔ∏è</a></li><li><a class="dropdown__link" href="/docs/dashboard/USER_GUIDE">Apache APISIX¬ÆÔ∏è Dashboard</a></li><li><a class="dropdown__link" href="/docs/ingress-controller/getting-started/">Apache APISIX¬ÆÔ∏è Ingress Controller</a></li><li><a class="dropdown__link" href="/docs/helm-chart/apisix/">Apache APISIX¬ÆÔ∏è Helm Charts</a></li><li><a class="dropdown__link" href="/docs/docker/build/">Apache APISIX¬ÆÔ∏è Docker</a></li><li><a class="dropdown__link" href="/docs/java-plugin-runner/development/">Apache APISIX¬ÆÔ∏è Java Plugin Runner</a></li><li><a class="dropdown__link" href="/docs/go-plugin-runner/getting-started/">Apache APISIX¬ÆÔ∏è Go Plugin Runner</a></li><li><a class="dropdown__link" href="/docs/python-plugin-runner/getting-started/">Apache APISIX¬ÆÔ∏è Python Plugin Runner</a></li><li><a class="dropdown__link" href="/docs/general/security">General</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">FAQ</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/apisix/FAQ/">Apache APISIX¬Æ</a></li><li><a class="dropdown__link" href="/docs/dashboard/FAQ/">Apache APISIX¬Æ Dashboard</a></li><li><a class="dropdown__link" href="/docs/ingress-controller/FAQ/">Apache APISIX¬Æ Ingress Controller</a></li><li><a class="dropdown__link" href="/docs/helm-chart/FAQ/">Apache APISIX¬Æ Helm Chart</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/downloads">Downloads</a><a class="navbar__item navbar__link" href="/team">Team</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/general/community">Community</a></li><li><a class="dropdown__link" href="/plugins">Plugin Hub</a></li><li><a class="dropdown__link" href="/releases">Releases</a></li><li><a class="dropdown__link" href="/help">Help</a></li></ul></div><a class="navbar__item navbar__link" href="/showcase">Showcase</a><a class="navbar__item navbar__link" href="/contribute">Contribute</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_3vod"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/blog/2021/08/06/using-apache-apisix-to-improve-the-observability-of-nginx" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/zh/blog/2021/08/06/using-apache-apisix-to-improve-the-observability-of-nginx" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">ÁÆÄ‰Ωì‰∏≠Êñá</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">All posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/23/cve-2021-43557-research-report">Apache APISIX Path traversal in request_uri variable(CVE-2021-43557)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/23/cve-2021-43557">Apache APISIX Path traversal in request_uri variable(CVE-2021-43557)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/22/develop-apisix-ingress-with-nocalhost-in-kubernetes">Developing APISIX Ingress Controller with Nocalhost in Kubernetes</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/19/apisix-supports-wasm">Apache APISIX embraces the WASM ecosystem</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/17/dapr-with-apisix">How to integrate with Dapr to build Apache APISIX Gateway Controller</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/16/weekly-report-1114">Weekly ReportÔΩú11.1-11.14 Feature Highlights Update in Progress</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/12/apisix-datadog">Cloud Monitoring with Datadog in Apache APISIX</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/04/skywalking">The observability of Apache APISIX</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/03/airwallex-usercase">How Apache APISIX protects Airwallex data sovereignty through the gateway layer</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/11/02/weekly-report-1031">Weekly ReportÔΩú10.15-10.31 Feature Highlights Update in Progress</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/29/Extension-guide">Apache APISIX Extensions Guide</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/26/APISIX-Ingress">From 0 to 1, How APISIX Ingress Has Grown and Gained Since Joining The Community</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/22/cert-manager-in-ingress">Tutorial: How to use Cert Manager to manage certificates in Apache APISIX Ingress Controller</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/18/meetup">Webinar | Apache APISIX √ó Apache SkyWalking Online Meetup</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/14/weekly-report-1014">Community WeeklyÔΩú10.1-10.14 Feature Highlight Updates in Progress</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/13/celebrating-300-contributors-of-apisix">New milestone for the Apache APISIX community - over 300 contributors worldwide!</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/09/apisix-ingress-techblog">A thoughtful tutorial to get started with Apache APISIX Ingress from concept to practice</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/01/openEuler">Apache APISIX community members help openEuler release first community innovation version</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/30/weekly-report">Community WeeklyÔΩúNew committer, feature highlight update in progress</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/29/release-apache-apisix-2.10">Release Apache APISIX 2.10.0</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/28/WPS-usercase">WPS has teamed up with Apache APISIX to create a new gateway experience</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/24/youpaicloud-usercase">Why is Apache APISIX Ingress a new option for building container gateways into the UPYUN?</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/18/xiaodian-usercase">Apache APISIX helps DIAN to facilitate cloud native solution</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/16/tencent-cloud">Implementing Apache APISIX in Tencent Cloud TI-ONE Platform</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/15/weekly-report">Community WeeklyÔΩúTwo new committers, feature highlight updates in progress</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/14/youzan">Apache APISIX powers the Youzanyun native PaaS platform for comprehensive micro-service governance</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/13/china-mobile-cloud-usercase">How Apache APISIX is implemented in China Mobile Cloud</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/09/how-to-contribute-to-an-OpenSource-without-coding">How can I contribute to an open source project without writing code?</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/07/how-to-use-apisix-auth">Centralized Authentication with Apache APISIX and Advanced Tricks</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/07/iQIYI-usercase">Based on Apache APISIX, iQIYI API Gateway Update and landing practice</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/09/06/python-helps-you-quickly-with-Apache-APISIX-development">Python helps you develop Apache APISIX plugin</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/31/Apache APISIX √ó KubeSphere-a-better-gateway-and-K8S-Ingress-Controller">Apache APISIX √ó KubeSphere: Providing a better gateway and K8S Ingress Controller</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/30/Ingress-Meeting">WebinarÔΩú See you at the Apache APISIX Ingress Community Meeting on Wednesday at 2pm!</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/30/weekly-report">Apache APISIX Community Weekly Report ÔΩú 2021 8.23-8.29</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/27/release-apache-apisix-2.9">Release Apache APISIX 2.9</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/25/Auth-with-Casbin-in-Apache-APISIX">Authorization with Casbin in Apache APISIX</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/25/Using-the-Apache-APISIX-OpenID-Connect-Plugin-for-Centralized-Authentication">Centralized authentication using the OpenID Connect plug-in for Apache APISIX</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/25/Why-Apache-APISIX-chose-Nginx-and-Lua">Why Apache APISIX chose Nginx and Lua to build API Gateway</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/24/shanghai-meetup-recap">Apache APISIX Meetup in Shanghai</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/23/ApacheCon-Asia-2021">ApacheCon Asia 2021</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/23/weekly-report">Apache APISIX Á§æÂå∫Âë®Êä• ÔΩú 2021 8.16-8.22</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/21/shanghai-meetup">August 21 Apache APISIX Meetup Shanghai, welcome to register!</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/19/go-makes-Apache-APISIX-better">Go gives Apache APISIX a run for its money</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/19/weekly-report">Apache APISIX Á§æÂå∫Âë®Êä• ÔΩú 08-09 ÔΩû 08-15</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/18/Auth-with-Casbin-in-Apache-APISIX">Licensing with Casbin in Apache APISIX</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/17/interview-airwallex">Apache APISIX in Airwallex | Interview with Yang Li, Head of Airwallex Technology Platform</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/16/Using-the-Apache-APISIX-OpenID-Connect-Plugin-for-Centralized-Authentication">Using the Apache APISIX OpenID Connect Plugin for Okta Centralized Authentication</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/14/contributors-the-golden-metric-of-openSource-projects">Contributors ‚Äî The Golden Metric of OpenSource Projects</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/12/Chaos-Mesh-Helps-Apache-APISIX-Improve-System-Stability">Chaos Mesh Helps Apache APISIX Improve System Stability</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/11/interview-TuZhengsong">I issued my first PR in the Apache APISIX community</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/10/apisix-nginx">Apache APISIX Architecture Analysis: How to Dynamically Manage Nginx Clustering?</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/09/Apache-APISIX-in-China-Mobile-Cloud">Apache APISIX Âú®ÁßªÂä®‰∫ëÁöÑÂ∫îÁî®</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/09/Apache-APISIX-in-Quliankeji">Abandoning Kong and Nginx, Hyperchain Technology implements on its BaaS platform</a></li><li class="sidebarItem_2UVv"><a aria-current="page" class="sidebarItemLink_1RT6 sidebarItemLinkActive_12pM" href="/blog/2021/08/06/using-apache-apisix-to-improve-the-observability-of-nginx">How to Improve the Observability of Nginx with Apache APISX</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/08/05/Kong-to-APISIX">Kong-To-APISIX Migration Tool</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/28/release-apache-apisix-2.8">Release Apache APISIX 2.8.0</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/27/use-of-plugin-orchestration-in-Apache-APISIX">Applying Plugin Orchestration in Apache APISIX</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/25/apachecon-asia">ApacheCon Asia 2021: Apache APISIX Technical Topics</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/21/Apache-APISIX-Kubernetes">Apache APISIX x Kubernetes: Just RightÔΩúLive</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/14/the-road-to-customization-of-Sina-Weibo-API-gateway-based-on-Apache-APISIX">The Road to Customized Development of Sina Weibo API Gateway</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/06/celebrate-200-contributors">Apache APISIX has over 200 contributors in GitHub main repo! </a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/30/etcd3-support-HTTP-access-perfectly">Does etcd 3 Support HTTP Access Perfectly?</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/29/release-apache-apisix-2.7">Release Apache APISIX 2.7.0</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/28/why-we-need-Apache-APISIX">Why do you need Apache APISIX when you have NGINX and Kong?</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/23/deploy-great-open-source-gateway-and-ingress-controller-fast">Deploy Apache APISIX and Apache APISIX Ingress Controller on Rancher</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/21/use-Java-to-write-Apache-APISIX-plugins">How to Write an Apache APISIX Plugin in Java</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/18/first-GA-version-v1.0-of-Apache-APISIX-Ingress-Controller-released">The first GA release of Apache APISIX Ingress Controller v1.0 is now available!</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/17/Apache-APISIX-Dashboard-Access-Control-Bypass-Vulnerability-Announcement">Apache APISIX Dashboard Access Control Bypass Vulnerability Advisory (CVE-2021-33190)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/16/Chaos-Mesh-helps-Apache-APISIX-improve-stability">Chaos Mesh Helps Apache APISIX Improve Stability</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/10/Apache-APISIX-and-Envoy-performance-comparison">Apache APISIX v.s Envoy: Which Has the Better Performance?</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/07/Apache-APISIX-not-affected-by-NGINX-CVE-2021-23017">Apache APISIX not affected by NGINX CVE-2021-23017</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/06/apisix-two-years">Apache APISIX Open Source 2 Year Anniversary!</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/03/experience-share-from-Apache-APISIX-committer">Experience sharing from Apache APISIX committer - Interview with Summer of Programming</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/05/25/Apache APISIX 2.6.0-Release">Apache APISIX 2.6.0-Release Officially Released</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/05/24/Tencent-Games">ÊîØÊåÅ 10 ‰∫øÊó•ÊµÅÈáèÁöÑÂü∫Á°ÄËÆæÊñΩÔºöÂΩì Apahce APISIX ÈÅá‰∏äËÖæËÆØ</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/03/02/get-front-end-test-coverage-with-cypress">Get Front-End Test Coverage with Cypress</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/02/26/install-apache-apisix-from-helm-charts">Install Apache APISIX from Helm Charts</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/02/08/stable-product-delivery-with-cypress">Stable Product Delivery with Cypress</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/01/21/run-ingress-apisix-on-amazon-eks">Run Ingress APISIX on Amazon EKS</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/01/11/interview-Apache-APISIX-contributor-Wang-Pengcheng-Senior-Security-Advisor-of-PwC-South-China-Data-Security-and-Privacy-Protection-Team">Apache APISIX Contributor Interview | Pengcheng Wang, Senior Security Consultant, PricewaterhouseCoopers China Data Security &amp; Privacy Team</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2020/12/18/first-look-at-kubernetes-service-api">A First Look at Kubernetes Service APIs</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2020/12/16/another-way-to-implement-envoy-filter">Envoy and Apache APISIX: Another way to implement the Envoy filter</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2020/12/11/beike-how-to-build-gateway-based-on-apache-apisix">Ë¥ùÂ£≥ÊâæÊàøÔºöÂ¶Ç‰ΩïÂü∫‰∫é Apache APISIX Êê≠Âª∫ÁΩëÂÖ≥</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_GeHD" itemprop="headline">How to Improve the Observability of Nginx with Apache APISX</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2021-08-06T00:00:00.000Z" itemprop="datePublished">August 6, 2021</time> ¬∑ 14 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://github.com/gxthrj" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://avatars.githubusercontent.com/u/4413028?v=4" alt="Wei Jin"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/gxthrj" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Jin</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><blockquote><p>This article shares solutions and practices for observability in the context of Nginx observability, the relationship between Apache APISIX and Nginx, Apache APISIX observability, and further enhancing observability in conjunction with Apache SkyWalking.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>&quot;Observability&quot; is a metric that allows you to keep track of how your infrastructure, system platform, or application is performing. Commonly, metrics, logging, and tracing and events data are collected to help developers and operations staff detect, investigate, alert, and correct system problems.</p><p>In this article, we will share solutions and practices for observability in the context of Nginx observability, the relationship between Apache APISIX and Nginx, Apache APISIX observability, and further observability improvements in conjunction with Apache SkyWalking.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="nginx-observability"></a>Nginx Observability<a class="hash-link" href="#nginx-observability" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="common-monitoring-methods-for-nginx"></a>Common monitoring methods for Nginx<a class="hash-link" href="#common-monitoring-methods-for-nginx" title="Direct link to heading">#</a></h3><p>Nginx is observable to some extent, and the following is a list of common monitoring methods for Nginx.</p><ol><li>ngx_http_stub_status_module</li><li>VTS module + exporter + prometheus + grafana (if you have a low version of Nginx, you need to introduce exporter)</li><li>Nginx Amplify SaaS</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_3R7-" id="ngx_http_stub_status_module"></a>ngx_http_stub_status_module<a class="hash-link" href="#ngx_http_stub_status_module" title="Direct link to heading">#</a></h4><p>The ngx_http_stub_status_module mainly collects instance-level statistics.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_3R7-" id="vts-module"></a>VTS module<a class="hash-link" href="#vts-module" title="Direct link to heading">#</a></h4><p>The VTS module has 3 obvious drawbacks.</p><ol><li><p><strong>Complex installation</strong>: Although VTS module is able to collect metrics and collect more types of metrics, it is more complex to install. If you want to use the VTS module, you need to recompile Nginx, add the VTS moudle before compiling Nginx, and reinstall Nginx after completing the compilation before you can use VTS properly. 2.</p></li><li><p><strong>Weak extensibility</strong>: VTS extensibility is divided into two parts: one is to add extensions to VTS before compilation; the other is to add extensions after compilation -- modifying the nginx.conf configuration file. Adding extensions by modifying the nginx.conf file will cause Nginx to reload, and a direct reload of the production environment may have some impact on the business.</p></li><li><p><strong>Slow community updates</strong>: The last update to the VTS module was in 2018, and it has been down for 3 years.</p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_3R7-" id="nginx-amplify-saas"></a>Nginx Amplify SaaS<a class="hash-link" href="#nginx-amplify-saas" title="Direct link to heading">#</a></h4><p>Nginx Amplify is a SaaS service where Nginx Amplify provides services on the remote end and installs agents outside of the Nginx service.
If you install the collection module outside of Nginx, you are limited in the metrics you can collect, and you can only get the information exposed by Nginx, not the internal information that is not exposed.</p><p>In addition, because Nginx Amplify SaaS is a SaaS service, you need to transfer the collected data to the server through the public network, which can pose some security risks and keep some enterprise users out. Perhaps Nginx Amplify is targeted at enterprise users like Nginx plus, not open source users.</p><p>Also, the Nginx Amplify SaaS community is not active and has been down for 2 years.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="nginxs-pitfalls"></a>Nginx&#x27;s pitfalls<a class="hash-link" href="#nginxs-pitfalls" title="Direct link to heading">#</a></h3><p>Nginx has its own flaws in Events collection, two of which are listed here.</p><p>Nginx is configured based on nginx.conf, which is reloaded after changes are made to the nginx.conf file. There are no Events available other than reload events, so we can&#x27;t know what has changed each time we modify the file, e.g., if we start with one route and modify the file to add 10 routes, we won&#x27;t know which 10 routes have been added with only reload events.</p><p>Nginx is a reverse proxy, and the real backend service may be restarted, upgraded, or abnormal, so without active health checks and relying on passive checks, we will only know that something is wrong with the service when the traffic is abnormal, which will throw away many Events and result in incomplete information about upstream Events. .</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="nginx-observability-summary"></a>Nginx Observability Summary<a class="hash-link" href="#nginx-observability-summary" title="Direct link to heading">#</a></h3><p>The open source version of Nginx does not provide very good monitoring. Although Nginx provides some monitoring tools, they are very complex to install and configure and have little scalability. It is possible that these tools are not designed for observability, but simply to be able to see metrics or statistics to easily pinpoint problems. There are various observability setup products available, but they are difficult to integrate into Nginx.</p><p>In addition, the Nginx community is stagnant, resulting in slow iterations of Nginx.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="apache-apisix-overview"></a>Apache APISIX Overview<a class="hash-link" href="#apache-apisix-overview" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="apache-apisix-in-relation-to-nginx"></a>Apache APISIX in relation to Nginx<a class="hash-link" href="#apache-apisix-in-relation-to-nginx" title="Direct link to heading">#</a></h3><p><img src="https://static.apiseven.com/202108/1630651158638-aba4e627-d2d6-4bf5-b431-61eb3913a296.png" alt="Relationship between Apache APISIX and Nginx"></p><p>Apache APISIX is based on the Nginx implementation, but relies only on the Nginx network libraries. On top of Nginx, Apache APISIX implements its own core code, with extension mechanisms reserved.</p><p>The table shows a comparison of Apache APISIX and Nginx features. Apache APISIX can do both reverse proxy and implement some features that Nginx does not support, such as: active health checking, traffic management, horizontal scaling, etc., and these features are open source.</p><ul><li><strong>API Design</strong>: It is simpler to use Apache APISIX for API design.</li><li><strong>Open Source Dashboard</strong>: The reverse proxy can be configured all in the interface.</li><li><strong>Active Health Check</strong>ÔºöApache APISIX supports active health checks, which can be combined with Events to improve observability.</li><li><strong>Traffic Management</strong>: Suitable for monitoring data, or for use when a business release goes live.</li><li><strong>Horizontal Scaling</strong>: Apache APISIX supports horizontal scaling, a feature that is made possible by the Apache APISIX architecture (see below).</li><li><strong>Plug-in extension mechanism</strong>: Apache APISIX&#x27;s plug-in extension mechanism makes it extremely powerful and scalable.</li><li><strong>Plugin orchestration</strong>: Multiple plugins are logically orchestrated and combined for use according to business requirements.</li><li><strong>Certificate Management</strong>: Apache APISIX supports dynamic certificate management.</li></ul><p><img src="https://static.apiseven.com/202108/1630651158643-ecc67e12-2076-41e5-88d8-baa14144f35d.png" alt="Apache APISIX Architecture Diagram"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="apache-apisix-introduction"></a>Apache APISIX Introduction<a class="hash-link" href="#apache-apisix-introduction" title="Direct link to heading">#</a></h3><p>Apache APISIX is a dynamic, real-time, high-performance API gateway that provides load balancing, dynamic upstream, grayscale publishing, service meltdown, authentication, observability, and other rich traffic management features. Apache APISIX is also the world&#x27;s most active open source API gateway project, and is a production-ready, high-performance gateway. Hundreds of enterprises around the world have used Apache APISIX to handle business-critical traffic, covering finance, Internet, manufacturing, retail, carriers, and more, such as NASA, the EU&#x27;s Digital Factory, Air China, China Mobile, Tencent, Huawei, Weibo, NetEase, Shell Finder, 360, Taikang, and more.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="apache-apisix-solution"></a>Apache APISIX Solution<a class="hash-link" href="#apache-apisix-solution" title="Direct link to heading">#</a></h3><p><img src="https://static.apiseven.com/202108/1630651158645-83c22975-ebf1-4861-8b61-38639a28875a.png" alt="Apache APISIX Full Traffic Solution"></p><p>On the left side of the diagram above, the evolution from top to bottom is from monolithic services to SOA (Service Oriented Architecture) to microservices.</p><p>Under SOA, gateways typically use Nginx or HAProxy; under microservices architecture, gateways use Nginx for load balancing. There are two common solutions for microservices architecture: one is based on Java technology stack implementation, such as Spring Cloud series; the other is Service Mesh.</p><p>Where does Apache APISIX fit into this evolutionary process and what can it do?</p><p>Simply put, the parts in red in the diagram on the left (Nginx / HAProxy / Kong / Spring Cloud Zuul / Spring Cloud Gateway / Traefik / Envoy / Ingress Nginx) can all be replaced with an Apache APISIX solution.</p><p><strong>In SOA there is Apache APISIX SLB solution, in microservice architecture there is Apache APISIX Gateway, in Kubernetes deployment there is Apache APISIX Ingress, in Service Mesh deployment there is Apache APISIX mesh</strong>.</p><p><img src="https://static.apiseven.com/202108/1630651158648-dffd59dd-15c2-4f76-832e-5ed3763b18e5.png" alt="Apache APISIX Full Traffic Data Surface"></p><p>In terms of service request traffic, when a client initiates a request, it passes through the LB, passes through the Gateway, and the request is distributed to the back-end business service. The parts in red (LB / Gateway / Spring Cloud Gateway / K8s Ingress / Sidecar) can all choose Apache APISIX as the solution. Apache APISIX supports multi-language development plug-ins and can be written in Java under the Java architecture.</p><p>Apache APISIX is a full-flow data plane, and Apache APISIX has solutions for LB, Gateway, Ingress, and sidecar, and they are unified solutions in terms of observability. When the solution is unified, the management control chain is also easy to implement out.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="apache-apisix-observability"></a>Apache APISIX Observability<a class="hash-link" href="#apache-apisix-observability" title="Direct link to heading">#</a></h2><p>After a brief look at Nginx and Apache APISIX, here are two questions: What can Apache APISIX do in terms of observability, and what are the advantages of Apache APISIX observability?</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="types-of-data-apache-apisix-supports-to-collect"></a>Types of data Apache APISIX supports to collect<a class="hash-link" href="#types-of-data-apache-apisix-supports-to-collect" title="Direct link to heading">#</a></h3><p>Apache APISIX supports the following types of data collection.</p><ol><li>Tracing - integrated with SkyWalking</li><li>Metrics - integrated with SkyWalking / Prometheus</li><li>Logging - integration with SkyWalking / other logging platforms</li></ol><p>Apache APISIX is a gateway-type product that can replace Nginx or other gateways; in terms of observability Apache APISIX can integrate with multiple APM or observable systems, e.g. Tracing part can integrate with SkyWalking, Metrics can integrate with SkyWalking or Prometheus, Logging can integrate with SkyWalking and other logging systems.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="apache-apisix-advantages-in-observability"></a>Apache APISIX advantages in observability<a class="hash-link" href="#apache-apisix-advantages-in-observability" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_3R7-" id="high-scalability"></a>High Scalability<a class="hash-link" href="#high-scalability" title="Direct link to heading">#</a></h4><p>Why does Apache APISIX have great extensibility? Because Apache APISIX supports writing plug-ins in multiple languages and can write plug-ins in programming languages such as Lua, Java, Golang, etc. Apache APISIX can extend its capabilities through plug-ins. The three data types mentioned above are implemented through the plug-in mechanism.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_3R7-" id="flexible-configuration-capabilities"></a>Flexible Configuration Capabilities<a class="hash-link" href="#flexible-configuration-capabilities" title="Direct link to heading">#</a></h4><p>Three examples are given to illustrate the flexible configuration capabilities of Apache APISIX.</p><p>The first example is <strong>Apache APISIX can modify the configuration of logging at runtime</strong>, for example, by adding or modifying logging fields. Modifying logging fields is a relatively common requirement. For example, when a business first goes live, logging fields are configured, and after the system has been running for a while, several logging fields need to be modified or added. If you are using Nginx, you can do this by modifying the nginx.conf file and reloading the configuration to take effect. <strong>Apache APISIX just needs to script the fields to take effect dynamically</strong>.</p><p>A second example of flexible configuration capabilities is the use of Prometheus. In Apache APISIX, if you want to create/delete a metric or extend metrics labels, just add a new metircs or fill in the relevant information in the Prometheus plugin, and Apache APISIX has a hot reload mechanism to take effect directly without restarting.</p><p>The third flexible configuration capability is in the Apache APISIX implementation, which manages all routing objects and has a set of object management mechanisms in memory. In Apache APISIX, you can add a plug-in to an API, and the level of effect can be refined to the API, and each API can be bound to the plug-in or the plug-in can be removed from the API. Apache APISIX can be fine-grained to control the observable data collection for each API in each service. In other words, you can collect only the data you care about most, and these configurations are dynamically in effect and can be adjusted at any time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_3R7-" id="active-community"></a>Active Community<a class="hash-link" href="#active-community" title="Direct link to heading">#</a></h4><p>One of the most important advantages of Apache APISIX is that there is an active community, and an active community allows the product to iterate quickly, get better and better, and get everyone&#x27;s needs met.</p><p><img src="https://static.apiseven.com/202108/1630651158650-2c4a287f-45a3-4c49-94d1-5be3914e5f69.png" alt="Apache APISIX Community Activity Comparison Chart"></p><p>The graph above shows the growth curves of Apache APISIX (green), Kong (light blue), mosn (yellow), and bfe (dark blue) contributors, with Apache APISX showing the fastest growth trend and the steepest curve. Apache APISIX community activity is the most active within its category.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="combining-apache-skywalking-for-further-improvements-in-observability"></a>Combining Apache SkyWalking for further improvements in observability<a class="hash-link" href="#combining-apache-skywalking-for-further-improvements-in-observability" title="Direct link to heading">#</a></h2><p>What enhancements can be made by combining Apache APISIX with Apache SkyWalking? In addition to the SkyWalking tracing plugin, you can also aggregate tracing, metrics, logging, and events into SkyWalking, and use SkyWalking&#x27;s aggregation capabilities to link data.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="skywalking-satellite"></a>SkyWalking Satellite<a class="hash-link" href="#skywalking-satellite" title="Direct link to heading">#</a></h3><p>SkyWalking Satellite is developed by the Apache APISIX community, the Apache SkyWalking community, and Baidu in deep cooperation.</p><p><img src="https://static.apiseven.com/202108/1630651158652-130e62e1-32dd-4705-9f24-ceffd039560a.png" alt="Apache APISIX SkyWalking Satellite"></p><p>SkyWalking Satellite follows the steps in the above diagram to collect data. SkyWalking Satellite can be deployed closer to the front-end where the data is generated, in the form of a sidecar.</p><p>In the diagram from top to bottom business requests go through Apache APISIX proxy to Upstream, Satellite is deployed next to Apache APISIX in the form of sidecar to collect data from Apache APISIX in three data types: tracing, metrics and logging, and send it to SkyWalking via GRPC protocol.</p><p>The most important point is that <strong>in this deployment method, Apache APISIX can integrate the three data types directly into SkyWalking without making any changes</strong>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="als-solution"></a>ALS Solution<a class="hash-link" href="#als-solution" title="Direct link to heading">#</a></h3><p>ALS (Access Log Service) sends out access logs from Apache APISIX, adding special fields to the normal access log, e.g., adding key fields to facilitate topology map generation and aggregating metrics.</p><p>The biggest advantage of ALS solution is that it can directly analyze and aggregate three types of data, such as topology, metrics, and logging, by means of access log.
When using Prometheus, if you configure the statistics of metrics at the URI level, the whole metrics will be inflated dramatically. Because there may be dozens of services at the URI level, each metrics may be followed by many labels, which will slow down the performance of the gateway and make the metrics more difficult to obtain. <strong>Use ALS solution to send the data to SkyWalking by streaming, leaving the calculation to SkyWalking and making it easy to query later</strong>, without pulling very large data every few seconds.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="integrating-events-into-skywalking"></a>Integrating Events into SkyWalking<a class="hash-link" href="#integrating-events-into-skywalking" title="Direct link to heading">#</a></h3><p>Commonly used Events include: configuration distribution, cluster changes, and health checks.</p><p><strong>Configuration Distribution</strong>: When configuring API distribution, routes may be added, routes modified, routes removed, or plugins added.</p><p><strong>Cluster Changes</strong>: When the cluster changes, you need to know the number of services in the cluster. For example, IPs change during expansion, and the changes are reflected when the gateway receives the message. Each process is an event, and these events need to be exposed.</p><p><strong>Health Check</strong>: Proactive detection of health, e.g., business request failure rate suddenly becomes high, and events detect unhealthy business services, at which point the problem can be quickly located.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="extended-reading"></a>Extended Reading<a class="hash-link" href="#extended-reading" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="how-the-extension-mechanism-of-apache-apisix-is-implemented-and-its-impact-on-stability"></a>How the extension mechanism of Apache APISIX is implemented and its impact on stability<a class="hash-link" href="#how-the-extension-mechanism-of-apache-apisix-is-implemented-and-its-impact-on-stability" title="Direct link to heading">#</a></h3><p>Question: How is the extension mechanism of Apache APISIX implemented? Does extending this feature have an impact on the stability of Apache APISIX itself?</p><p>A: The Apache APISIX extension mechanism benefits from its architecture, which allows adding business logic to each phase (rewrite / access / header_filter / body_filter / preread_filter / log).</p><p>As for stability, Apahce APISIX has open sourced nearly 50 plugins, each of which is tested end-to-end and is proven to be stable and available. However, custom plug-ins have to follow certain specifications, which are simple, but we should not be too casual. The stability of the custom plug-ins is guaranteed and needs to be guaranteed by the business side itself.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="how-to-confirm-that-rules-are-in-effect"></a>How to confirm that rules are in effect<a class="hash-link" href="#how-to-confirm-that-rules-are-in-effect" title="Direct link to heading">#</a></h3><p>Q: Nginx may have a lot of rules configured in the nginx.conf file, and the later rules may be blocked by the earlier rules, so it is not clear if the later rules are in effect.</p><p>A: The more configuration you have in the nginx.conf file, and the more complex the configuration service, the more difficult it is to maintain this file. But in Apache APISIX, the configuration file is fixed, and the official Apache APISIX configuration is the optimal configuration for most scenarios, while other routing configurations are configured in the API, and the routing configuration is in memory.</p><p>In terms of management, you can manage your routes in a variety of organizational ways, for example, through the Dashboard.</p><p>For example, if you have a service called ABC, you can have various route definitions under this service, and the route definitions can be viewed in a list. Another way to view routes is to tag the API in the dashboard, which makes the management of routes more user-friendly and makes it easy to query the list of routes by tag filtering.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="about-the-author"></a>About the Author<a class="hash-link" href="#about-the-author" title="Direct link to heading">#</a></h2><p>Wei Jin, Apache APISIX PMC and Apache SkyWalking committer.</p><p><img src="https://static.apiseven.com/202108/1630651158654-2e028970-9e09-4d52-bf72-ab53aa98706b.png" alt="Jin Wei&#x27;s profile"></p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/practical-case">Practical Case</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2021/08/09/Apache-APISIX-in-Quliankeji"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">¬´ Abandoning Kong and Nginx, Hyperchain Technology implements on its BaaS platform</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2021/08/05/Kong-to-APISIX"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Kong-To-APISIX Migration Tool ¬ª</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#nginx-observability" class="table-of-contents__link">Nginx Observability</a><ul><li><a href="#common-monitoring-methods-for-nginx" class="table-of-contents__link">Common monitoring methods for Nginx</a></li><li><a href="#nginxs-pitfalls" class="table-of-contents__link">Nginx&#39;s pitfalls</a></li><li><a href="#nginx-observability-summary" class="table-of-contents__link">Nginx Observability Summary</a></li></ul></li><li><a href="#apache-apisix-overview" class="table-of-contents__link">Apache APISIX Overview</a><ul><li><a href="#apache-apisix-in-relation-to-nginx" class="table-of-contents__link">Apache APISIX in relation to Nginx</a></li><li><a href="#apache-apisix-introduction" class="table-of-contents__link">Apache APISIX Introduction</a></li><li><a href="#apache-apisix-solution" class="table-of-contents__link">Apache APISIX Solution</a></li></ul></li><li><a href="#apache-apisix-observability" class="table-of-contents__link">Apache APISIX Observability</a><ul><li><a href="#types-of-data-apache-apisix-supports-to-collect" class="table-of-contents__link">Types of data Apache APISIX supports to collect</a></li><li><a href="#apache-apisix-advantages-in-observability" class="table-of-contents__link">Apache APISIX advantages in observability</a></li></ul></li><li><a href="#combining-apache-skywalking-for-further-improvements-in-observability" class="table-of-contents__link">Combining Apache SkyWalking for further improvements in observability</a><ul><li><a href="#skywalking-satellite" class="table-of-contents__link">SkyWalking Satellite</a></li><li><a href="#als-solution" class="table-of-contents__link">ALS Solution</a></li><li><a href="#integrating-events-into-skywalking" class="table-of-contents__link">Integrating Events into SkyWalking</a></li></ul></li><li><a href="#extended-reading" class="table-of-contents__link">Extended Reading</a><ul><li><a href="#how-the-extension-mechanism-of-apache-apisix-is-implemented-and-its-impact-on-stability" class="table-of-contents__link">How the extension mechanism of Apache APISIX is implemented and its impact on stability</a></li><li><a href="#how-to-confirm-that-rules-are-in-effect" class="table-of-contents__link">How to confirm that rules are in effect</a></li></ul></li><li><a href="#about-the-author" class="table-of-contents__link">About the Author</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ASF</div><ul class="footer__items"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation</a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License</a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events</a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issue Tracker</a></li><li class="footer__item"><a href="https://join.slack.com/t/the-asf/shared_invite/zt-vlfbf7ch-HkbNHiU_uDlcH_RvaHv9gQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://apisix.apache.org/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/img/asf_logo_wide_small.png" alt="Apache Software Foundation" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/asf_logo_wide_small.png" alt="Apache Software Foundation" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright ¬© 2019-2021 The Apache Software Foundation. Apache APISIX, APISIX¬Æ, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.6dde7109.js"></script>
<script src="/assets/js/main.8cb8262b.js"></script>
</body>
</html>