<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="ahrefs-site-verification" content="c2f7370ecf46173f4fb25f114e74c97e0a2976d4f02f61c9b00a9d7d34e34698">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache APISIX® -- Cloud-Native API Gateway and AI Gateway RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache APISIX® -- Cloud-Native API Gateway and AI Gateway Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIX® -- Cloud-Native API Gateway and AI Gateway" href="/opensearch.xml">
<script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Apache APISIX","url":"https://apisix.apache.org"}</script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="24b59d9a-682e-4c3d-9e83-bf2ee85cdc19" data-project-name="APISIX" data-project-color="#E8442E" data-project-logo="https://static.apiseven.com/202202/apache-apisix.png" data-modal-disclaimer="This is a custom LLM for APISIX with access to all developer documentation, GitHub issues and discussions." data-modal-example-questions="How to set up canary release in APISIX?,How to develop a custom APISIX plugin?,How to use custom NGINX configuration in APISIX?,How to configure mTLS between clients and APISIX?,How to only allow a specific APISIX consumer to access special services or routes?" async></script><title data-react-helmet="true">APISIX Gateway Practices in Tencent Games | Apache APISIX® -- Cloud-Native API Gateway and AI Gateway</title><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org/blog/2025/05/07/apisix-gateway-practice-in-tencent-timi/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" name="robots" content="index,follow"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" property="og:title" content="APISIX Gateway Practices in Tencent Games | Apache APISIX® -- Cloud-Native API Gateway and AI Gateway"><meta data-react-helmet="true" name="description" content="Tencent Timi Studio Group developed TAPISIX based on APISIX, exploring gateway extension, deployment, and operations."><meta data-react-helmet="true" property="og:description" content="Tencent Timi Studio Group developed TAPISIX based on APISIX, exploring gateway extension, deployment, and operations."><meta data-react-helmet="true" name="keywords" content="open source,API gateway,Apache APISIX,Tencent,Timi Studio Group,API gateway use case"><meta data-react-helmet="true" property="og:image" content="https://static.api7.ai/uploads/2025/05/07/Em3otYyD_tencent-timi-uses-apisix.webp"><meta data-react-helmet="true" name="twitter:image" content="https://static.api7.ai/uploads/2025/05/07/Em3otYyD_tencent-timi-uses-apisix.webp"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2025-05-07T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/Yilialinn"><meta data-react-helmet="true" property="article:tag" content="Case Studies"><link data-react-helmet="true" rel="shortcut icon" href="https://static.apiseven.com/202202/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org/blog/2025/05/07/apisix-gateway-practice-in-tencent-timi/"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2025/05/07/apisix-gateway-practice-in-tencent-timi/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2025/05/07/apisix-gateway-practice-in-tencent-timi/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://38VC84A2WJ-dsn.algolia.net" crossorigin="anonymous"><link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Bold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Light.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Demi.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-ExtraBold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/runtime~main.57eaa0fa.js" as="script">
<link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/main.84c0a2cc.js" as="script">
<link rel="stylesheet" href="https://apisix-website-static.apiseven.com/assets/css/styles.9943cb19.css">
<!-- Matomo from the ASF -->
<script>var _paq=window._paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://analytics.apache.org/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","17"]);var e=document,p=e.createElement("script"),t=e.getElementsByTagName("script")[0];p.async=!0,p.src=a+"matomo.js",t.parentNode.insertBefore(p,t)}()</script>
<!-- End Matomo Code -->
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#e8433e;color:white" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">🤔 Introducing APISIX AI Gateway – Built for LLMs and AI workloads. <a target="_blank" rel="noopener noreferrer" href="/ai-gateway/"> Learn More</a></div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a target="_parent" class="navbar__brand" href="/"><img src="/img/logo2.svg" alt="Apache APISIX®" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo2.svg" alt="Apache APISIX®" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Apache APISIX®</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" target="_parent" href="/docs/">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/docs/apisix/getting-started/">Apache APISIX®️</a></li><li><a class="dropdown__link" target="_parent" href="/docs/apisix/next/dashboard/">Apache APISIX®️ Dashboard</a></li><li><a class="dropdown__link" target="_parent" href="/docs/ingress-controller/overview/">Apache APISIX®️ Ingress Controller</a></li><li><a class="dropdown__link" target="_parent" href="/docs/helm-chart/apisix/">Apache APISIX®️ Helm Charts</a></li><li><a class="dropdown__link" target="_parent" href="/docs/docker/build/">Apache APISIX®️ Docker</a></li><li><a class="dropdown__link" target="_parent" href="/docs/java-plugin-runner/development/">Apache APISIX®️ Java Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/go-plugin-runner/getting-started/">Apache APISIX®️ Go Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/python-plugin-runner/getting-started/">Apache APISIX®️ Python Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/join/">General</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" target="_parent" href="/blog/">Blog</a><a class="navbar__item navbar__link" target="_parent" href="/blog/tags/case-studies/">Case Studies</a><a class="navbar__item navbar__link" target="_parent" href="/downloads/">Downloads</a><a class="navbar__item navbar__link" target="_parent" href="/help/">Help</a><a class="navbar__item navbar__link" target="_parent" href="/team/">Team</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/showcase/">Showcase</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/code-samples/">Code Samples</a></li><li><a class="dropdown__link" target="_parent" href="/plugins/">PluginHub</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/join/">Community</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/events/">Events</a></li><li><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer" class="dropdown__link">Roadmap</a></li></ul></div><a href="/zh/blog" target="_parent" rel="noopener noreferrer" class="localizedBlogLink_W2zh">中文博客</a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_SGhp"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="sticky-outer-wrapper placeholder_iq-X"><div class="sticky-inner-wrapper" style="position:relative;top:0px;z-index:199"><div class="tagsHeader_HGHP"><a target="_parent" href="/blog/tags/case-studies/">Case Studies</a><a target="_parent" href="/blog/tags/ecosystem/">Ecosystem</a><a target="_parent" href="/blog/tags/authentication/">Authentication</a><a target="_parent" href="/blog/tags/plugins/">Plugins</a><a target="_parent" href="/blog/tags/community/">Community</a><a target="_parent" href="/blog/tags/vulnerabilities/">Vulnerabilities</a></div></div></div><div class="container margin-vert--lg"><div class="row" style="justify-content:center"><div class="col col--9"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">APISIX Gateway Practices in Tencent Games</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2025-05-07T00:00:00.000Z" itemprop="datePublished">May 7, 2025</time> · <!-- -->19 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_dGI0"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link avatar__photo"><div size="48" color="EDEEFD" class="go3797115068"><p color="05128A" size="48" class="go2045283810">Ze</p></div></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a itemprop="url"><span itemprop="name">Zemiao Yang</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div><div class="col col--6 authorCol_dGI0"><div class="avatar margin-bottom--sm"><a href="https://github.com/Yilialinn" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_KCbV" src="https://github.com/Yilialinn.png" alt="Yilia Lin"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Yilialinn" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Yilia Lin</span></a></div><small class="avatar__subtitle" itemprop="description">Technical Writer</small></div></div></div></div></header><meta itemprop="image" content="https://static.api7.ai/uploads/2025/05/07/Em3otYyD_tencent-timi-uses-apisix.webp"><div class="markdown" itemprop="articleBody"><section class="shareSection_OUzq"><div><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button aria-label="reddit" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button></div></section><blockquote><p>Authors: Zemiao Yang, Backend Development Engineer at Tencent Timi Studio Group. This article is based on his presentation at the APISIX Shenzhen Meetup on April 12, 2025.</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="about-timi-studio-group">About Timi Studio Group<a aria-hidden="true" class="hash-link" href="#about-timi-studio-group" title="Direct link to heading">​</a></h2><p>TiMi is a subsidiary of Tencent Games and the developer of several popular mobile games, including <em>Call of Duty: Mobile</em>, <em>Pokémon Unite</em>, <em>Arena of Valor</em>, and <em>Honor of Kings</em>.</p><p><em>Honor of Kings</em> is one of the world&#x27;s most popular MOBA mobile games. As of December 2023, it has recorded up to 160 million daily active users, 3 million concurrent online users, over 3.8 billion downloads, and over 300 million registered users. In May 2017, it topped the global mobile game revenue chart. (Source: Wikipedia)</p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="tapisix-api-gateway">TAPISIX API Gateway<a aria-hidden="true" class="hash-link" href="#tapisix-api-gateway" title="Direct link to heading">​</a></h2><p>Our team primarily uses the Golang language for development and also takes on some operational responsibilities. Given our limited experience in operations and our desire to control costs, we aim to unify the handling of multiple tasks such as authentication and traffic recording through an API gateway. Additionally, due to the frequent infrastructure migration required for our overseas business, we cannot rely on cloud-based solutions and require all data and components to be migratable.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="introduction-to-tapisix">Introduction to TAPISIX<a aria-hidden="true" class="hash-link" href="#introduction-to-tapisix" title="Direct link to heading">​</a></h3><p>Although Apache APISIX is fully open-source with a rich plugin ecosystem, we need to balance the integration with existing infrastructure, such as internal service discovery, log standards, and trace reporting. These functions are company-specific and cannot be directly merged into the open-source upstream. Therefore, we have developed a customized version, TAPISIX, based on APISIX, adding a series of plugins designed for our internal environment.</p><p>Our services run on Kubernetes (k8s) clusters, with APISIX serving as the traffic entry point and connecting to internal business services. Service discovery utilizes the company&#x27;s internal Polaris system, metric monitoring is achieved through the Prometheus provided by APISIX, and log and trace collection are performed via OpenTelemetry and ClickHouse. For CI tools, we use OCI (similar to GitHub Actions), which supports pipeline definition through YAML; for CD tools, we select Argo CD, which implements continuous deployment based on open-source solutions.</p><p>Due to the stringent compliance requirements of our overseas business, many internal company components cannot be directly implemented.</p><p></p><div class="rc-image"><img loading="lazy" alt="TAPISIX Gateway Architecture" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/jnAmJchc_timi-1.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><p>This presentation will cover the following four aspects:</p><ol><li>Gateway Feature Extension: How to extend gateway features based on business needs.</li><li>Deployment and Operations: Practices for gateway deployment and daily operations.</li><li>Runtime Operations: Maintenance and optimization of the runtime environment.</li><li>Other Experiences: Practical experience accumulated by the team in gateway operations.</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="gateway-feature-extension">Gateway Feature Extension<a aria-hidden="true" class="hash-link" href="#gateway-feature-extension" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="goals-and-challenges">Goals and Challenges<a aria-hidden="true" class="hash-link" href="#goals-and-challenges" title="Direct link to heading">​</a></h3><p>Our goal is to build a business-targeted gateway that leverages APISIX&#x27;s plugins to meet customized requirements. As a business-oriented team, we face the following challenges:</p><ol><li><p>High Development Threshold: Frontline developers are familiar with Golang but lack familiarity with the Lua language and APISIX plugin development, leading to a high learning curve.</p></li><li><p>Plugin Reliability: Ensuring that developed plugins can be safely and stably deployed.</p></li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="core-issues">Core Issues<a aria-hidden="true" class="hash-link" href="#core-issues" title="Direct link to heading">​</a></h4><ol><li>How to reduce the development threshold?</li><li>How to quickly verify plugin functionality?</li><li>How to ensure plugin reliability?</li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="solutions">Solutions<a aria-hidden="true" class="hash-link" href="#solutions" title="Direct link to heading">​</a></h4><p>To address the above issues, we have taken the following four approaches:</p><ol><li>Development Standards (Maintainability)</li><li>Local Quick Running and Testing</li><li>Pipeline Construction (Build Process)</li><li>Reliability Assurance</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="1-development-standards">1. Development Standards<a aria-hidden="true" class="hash-link" href="#1-development-standards" title="Direct link to heading">​</a></h3><p>Development standards are easy to understand. We need to define a library, specify the storage path for plugins, and require plugins to adopt a single-file format, consistent with APISIX&#x27;s single-file plugin mechanism, to facilitate management and maintenance.</p><p>To lower the development threshold, we support local quick running and testing. By utilizing APISIX&#x27;s Docker image, local plugins can be mounted into containers via volume mapping for convenient deployment. Additionally, by leveraging the downstream echo-service (a service developed based on open-source Node.js), upstream behavior can be simulated. This service can return all content of a request, such as request headers. By adding specific parameters in the request (e.g., HTTP status code <code>500</code>), upstream exceptional behavior can be simulated, thereby comprehensively verifying plugin functionality.</p><p align="center"></p><div class="rc-image" style="width:550"><img loading="lazy" alt="Honor Plugin Ecosystem" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/1r4TMUK9_timi-2.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="2-local-quick-running-and-testing">2. Local Quick Running and Testing<a aria-hidden="true" class="hash-link" href="#2-local-quick-running-and-testing" title="Direct link to heading">​</a></h3><p>To reduce the development threshold and accelerate verification, we provide convenient local development environment support:</p><ol><li><p><strong>File Mapping</strong>: By mounting local plugin files into Docker containers, developers can test plugin changes in real-time.</p></li><li><p><strong>Makefile Build</strong>: Construct a Makefile to support quick startup of the plugin testing environment via the <code>make run-dev</code> command, ensuring seamless connection between local files and containers.</p></li><li><p><strong>Direct Browser Access</strong>: Developers can directly verify plugin functionality by accessing relevant interfaces in a browser, without additional deployment or configuration.</p></li></ol><p align="center"></p><div class="rc-image" style="width:550"><img loading="lazy" alt="Honor Plugin Ecosystem" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/bdMFTb0b_timi-3.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><p>By defining development standards and providing local quick development support, we have effectively lowered the development threshold and accelerated the plugin verification process. Developers can focus on feature implementation without worrying about complex deployment and testing procedures, thereby improving overall development efficiency.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="3-pipeline-construction-build-process">3. Pipeline Construction (Build Process)<a aria-hidden="true" class="hash-link" href="#3-pipeline-construction-build-process" title="Direct link to heading">​</a></h3><p>During pipeline construction, it is essential to ensure reliability and stability in plugin development. The development process is as follows:</p><ol><li><p>Branch Management and Pull Request (PR) Process:</p><p>a. Developers create a new branch from the master branch for development.</p><p>b. After completing development, they submit a PR to the master branch.</p></li><li><p>Webhook Triggering: After submitting a PR, the system automatically triggers a Webhook to start the pipeline.</p></li><li><p>Pipeline Inspection:</p><p>a. Lint Check: Primarily checks code formatting standards.</p><p>b. Unit Testing: Runs unit tests to verify whether plugin functionality meets expectations.</p><p>c. Try Build: Constructs an image using the source code to verify its buildability.</p></li></ol><p align="center"></p><div class="rc-image" style="width:550"><img loading="lazy" alt="Pipeline Building" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/VAFUteFJ_timi-4.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="4-reliability-assurance-cr-lint-unit-testing-black-box-testing">4. Reliability Assurance (CR, lint, unit testing, black-box testing)<a aria-hidden="true" class="hash-link" href="#4-reliability-assurance-cr-lint-unit-testing-black-box-testing" title="Direct link to heading">​</a></h3><p>We utilize the k6 testing framework from Grafana to validate core test cases. The k6 framework supports writing test case declaratively and covers various scenarios. We regularly replay these test cases to check interface functionality. For instance, even if only a plugin is modified, we conduct comprehensive replay testing, including parsing and service discovery.</p><h4 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="core-test-cases-and-the-k6-testing-framework">Core Test Cases and the k6 Testing Framework<a aria-hidden="true" class="hash-link" href="#core-test-cases-and-the-k6-testing-framework" title="Direct link to heading">​</a></h4><p>k6 Test Cases: Comprising hundreds of test cases covering core processes to ensure plugin reliability.</p><p align="center"></p><div class="rc-image" style="width:550"><img loading="lazy" alt="K6 Test" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/80NTJpcY_timi-5.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><p>Through the complete process of local development, quick validation, MR submission, pipeline inspection, reliability assurance, and packaging deployment, we ensure that every stage of plugin development and deployment undergoes strict quality control.</p><p></p><div class="rc-image"><img loading="lazy" alt="Gateway Development Workflow" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/0sIEPiql_timi-6.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="deployment-and-operations">Deployment and Operations<a aria-hidden="true" class="hash-link" href="#deployment-and-operations" title="Direct link to heading">​</a></h2><p>Next, we briefly introduce the deployment modes of APISIX, which are divided into the data plane and control plane. The data plane is responsible for proxy, while the control plane manages configurations, including the management interface and other functionalities, writing configurations to etcd. The data plane reads configurations from etcd and loads them into memory to complete routing functions.</p><p>APISIX offers three deployment methods to accommodate the needs of different production environments:</p><ol><li><p><strong>Traditional Mode</strong>: The data plane and control plane are deployed within a single instance.</p></li><li><p><strong>Separated Mode</strong>: The data plane and control plane are deployed independently. Even if the data plane fails, the control plane can still operate and make modifications.</p></li><li><p><strong>Standalone Mode</strong>: Only the data plane is deployed, with configurations loaded from local YAML files, eliminating dependence on etcd.</p></li></ol><p>We utilize the standalone mode that retains only the data plane. All configurations are stored locally, avoiding reliance on etcd. This mode is more suitable for overseas scenarios. Since etcd is a database, some cloud providers do not offer etcd services. Given the stringent overseas data compliance requirements and our k8s-based deployment environment, we have also implemented a configuration management approach that is k8s-friendly.</p><p align="center"></p><div class="rc-image" style="width:650"><img loading="lazy" alt="APISIX Deployment" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/07/99nRuGCG_7-dp-and-cp.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><ul><li>YAML Configuration: All configurations are directly stored in YAML files for easy management and automated deployment.</li><li>ConfigMap Storage: YAML files are directly placed in k8s ConfigMaps to ensure configuration versioning and traceability.</li></ul><p>We define the gateway as immutable infrastructure, with infrequent changes during daily operations. Even route changes are considered as change operations.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="kubernetes-configuration-management-and-deployment-practices">Kubernetes Configuration Management and Deployment Practices<a aria-hidden="true" class="hash-link" href="#kubernetes-configuration-management-and-deployment-practices" title="Direct link to heading">​</a></h3><p><strong>Backgrounds and Challenges</strong></p><p>When managing config.yaml, we found that Kubernetes deployments actually rely on a series of complex configuration files, such as Service.yaml, ConfigMap.yaml, and Workload. These numerous and detailed configuration files can lead to complex management and potential errors.</p><p><strong>Solution</strong></p><p>The Kubernetes community proposes Helm Charts as a solution. Helm Charts template Kubernetes configuration files, significantly simplifying configuration management. The official APISIX Helm Chart enables us to efficiently manage core configurations (e.g., node counts) without manually filling out numerous YAML files. Currently, Helm Charts have effectively addressed the issue of configuration complexity.</p><p><strong>Follow-up Problem</strong></p><p>However, a key follow-up issue arises: how to deploy Helm Charts or YAML files to a Kubernetes cluster.</p><p><strong>Solution</strong></p><p>To address this, we adopted the GitOps model, deploying YAML files to a Kubernetes cluster via pipelines. Under the GitOps model, all configurations are stored in Git as code. By triggering CI/CD processes via Git, we achieve automated deployment. Both <code>config.yaml</code> and other configuration files are stored in Git, ensuring versioned management and traceability of configurations. This approach not only simplifies configuration management but also automates and standardizes the deployment process, enhancing overall efficiency and reliability.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="deployment-process-example">Deployment Process Example<a aria-hidden="true" class="hash-link" href="#deployment-process-example" title="Direct link to heading">​</a></h3><p align="center"></p><div class="rc-image" style="width:550"><img loading="lazy" alt="Deployment Workflow" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/S2R27TnZ_timi-8.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><p>In the deployment process illustrated above, SREs (Site Reliability Engineers) manage configurations on behalf of users. Any modifications, such as route changes or image updates, must be implemented by altering the Helm Chart repository. After the change, Argo CD automatically detects it and triggers the pipeline to pull the latest configuration for deployment. Additionally, a strong synchronization is established between Git and Kubernetes, ensuring configuration consistency and reliability.</p><p>For instance, after deployment, if I have full access to the k8s cluster and modify the <code>service.yaml</code> file, Argo CD continuously monitors the cluster status. If it detects discrepancies between actual resources and the configurations in the Git repository, it automatically triggers synchronization, overriding the cluster configuration with the content from the Git repository.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="advantages-of-gitops">Advantages of GitOps<a aria-hidden="true" class="hash-link" href="#advantages-of-gitops" title="Direct link to heading">​</a></h3><p>This management model offers numerous benefits:</p><ul><li><strong>Configuration Consistency</strong>: All configuration changes are made through Git, ensuring system configuration consistency.</li><li><strong>Security</strong>: Reduces the risk of manual modifications, with all changes traceable.</li><li><strong>Automated Deployment</strong>: Achieves automated deployment and canary releases based on version changes in Argo CD or Git.</li></ul><p>In deployment, we only need to maintain two repositories: the code repository (for application code) and the deployment repository (for all deployment-related configuration files). This simplified model renders many traditional management platforms unnecessary, making the entire process more efficient and streamlined. When deploying applications to other clusters, simply pull the corresponding branch from the deployment repository and apply it to the target cluster. The entire process is simple and efficient.</p><p></p><div class="rc-image"><img loading="lazy" alt="GitOps Advantages" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/20UakpGY_timi-9.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><p>In our deployment practices, key APISIX configuration files (e.g., routing configurations and <code>config.yaml</code> startup configurations) are integrated into a single Helm Chart repository for unified management and deployment. However, this deployment approach may also present an issue: it essentially treats APISIX as a regular service for deployment.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="why-not-use-the-apisix-ingress-controller">Why Not Use the APISIX Ingress Controller?<a aria-hidden="true" class="hash-link" href="#why-not-use-the-apisix-ingress-controller" title="Direct link to heading">​</a></h2><p></p><div class="rc-image"><img loading="lazy" alt="APISIX Ingress Controller Wrkflow" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/07/7WnT5rWl_10-ingress-controller.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><p>The APISIX Ingress Controller, as the official community solution for k8s, follows this core process: By defining custom resources such as APISIXRoute, routing and other configurations are described in YAML files within k8s.</p><p>After deploying these CRDs to the k8s cluster, the Ingress Controller continuously monitors the relevant CRD resources. It parses the configuration information from the CRDs and synchronizes the configurations to APISIX by invoking APISIX&#x27;s Admin API. The Ingress Controller primarily facilitates deployment between CRDs and APISIX, ultimately writing data to etcd.</p><p align="center"></p><div class="rc-image" style="width:550"><img loading="lazy" alt="APISIX Ingress Controller" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/07/XbjN7Bky_11-ingress-controller.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><p>After careful evaluation, we found that the deployment and operational model of the APISIX Ingress Controller does not fully align with our team&#x27;s requirements for the following reasons:</p><ol><li><p><strong>Business-Oriented Gateway Positioning</strong>: As a business-oriented gateway, we focus on reducing development and operational thresholds to enhance usability and development efficiency.</p></li><li><p><strong>Operational Cost</strong>: Introducing the Ingress Controller adds an extra layer of operational complexity. It requires deep integration with k8s, involving additional Golang code and k8s API calls, which increases operational difficulty and cost.</p></li><li><p><strong>Environment Consistency</strong>: Due to reliance on the k8s environment, discrepancies between local development and online deployment environments may lead to inconsistencies such as &quot;works locally but fails online,&quot; complicating fault diagnosis and resolution.</p></li><li><p><strong>Version Coupling</strong>: There is a strong coupling between APISIX and Ingress Controller versions. Since our APISIX is a customized version, we only maintain compatibility with specific versions. This may result in unsupported APIs or compatibility issues, affecting system stability and reliability.</p></li><li><p><strong>Configuration Opacity</strong>: With the Ingress Controller approach, the final configurations still need to be written to etcd, which may cause inconsistent configuration states. For example, Ingress Controller monitoring failures or poor etcd status may trigger issues like excessive connections, making the entire architecture chain more opaque and complex. In contrast, Helm Charts offers a comprehensive and auditable YAML file containing all routing configurations, making routing states clear and visible.</p></li></ol><p>For these reasons, we opted not to use the APISIX Ingress Controller.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="how-to-achieve-hot-reloading-of-configurations">How to Achieve Hot Reloading of Configurations?<a aria-hidden="true" class="hash-link" href="#how-to-achieve-hot-reloading-of-configurations" title="Direct link to heading">​</a></h3><p>When deploying APISIX in a k8s environment, hot configuration updates are crucial for ensuring system stability and availability. APISIX configurations are primarily divided into two categories:</p><ol><li><p><strong>APISIX Routing Configuration</strong> (<code>apisix.yaml</code>): Uses traditional loading methods to define routing configurations, including upstream routing and corresponding forwarding rules.</p></li><li><p><strong>Startup Configuration</strong> (<code>config.yaml</code>): Serves as the startup configuration file, specifying key parameters such as the APISIX runtime port. Changes to certain configuration items require a service restart to take effect.</p></li></ol><p></p><div class="rc-image"><img loading="lazy" alt="Hot Reloading" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/HBe8lFgq_timi-12.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="k8s-resource-deployment-process">k8s Resource Deployment Process<a aria-hidden="true" class="hash-link" href="#k8s-resource-deployment-process" title="Direct link to heading">​</a></h3><ol><li><strong>Modify Git configuration</strong>: Make changes to the aforementioned Git configurations.</li><li><strong>Deliver to Argo CD</strong>: Submit the modified configurations to Argo CD.</li><li><strong>Generate resource files</strong>: Based on the modified configurations, Argo CD generates corresponding resource files such as ConfigMap and Service YAML via the Helm Chart.</li></ol><p>In the k8s environment, resources like <code>apisix.yaml</code> and <code>config.yaml</code> exist in the form of ConfigMaps.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="apisix-configuration-change-handling-mechanism">APISIX Configuration Change Handling Mechanism<a aria-hidden="true" class="hash-link" href="#apisix-configuration-change-handling-mechanism" title="Direct link to heading">​</a></h3><p><strong>Backgrounds and Challenges</strong></p><p>When APISIX-related configurations change, the corresponding ConfigMap is updated. However, the Deployment (i.e., the APISIX deployment instance) itself remains unchanged.</p><p><strong>Solution</strong></p><p>To address this issue, the k8s community proposes a solution that involves splitting configurations and utilizing hash and annotation methods. The content of the ConfigMap that needs to be changed is injected into the Deployment as annotations, thereby achieving dynamic configuration updates.</p><ul><li><p><code>apisix-configmap.yaml</code>: Primarily stores APISIX&#x27;s core configurations, such as routing rules. When this type of ConfigMap is modified, due to the built-in timer mechanism in APISIX, it periodically reads and updates the in-memory configuration information from the local file. Therefore, the APISIX service does not need to be restarted for the configuration to take effect.</p></li><li><p><code>config-configmap.yaml</code>: Mainly includes basic configurations such as the APISIX runtime environment. When this type of ConfigMap is modified, as it involves the basic runtime environment settings of the APISIX service, a restart of the APISIX deployment instance is required to ensure the new configurations are correctly loaded and applied.</p></li></ul><p><strong>Update Trigger Mechanism</strong></p><p>To automatically detect configuration changes and trigger the update process, we annotate the ConfigMap content with a hash and write the hash value into the <code>deployment.yaml</code> file. When configuration changes cause the hash value to update, the <code>deployment.yaml</code> file also changes. The k8s system detects this change and automatically triggers the update process, ensuring that the APISIX deployment instance promptly applies the new configurations.</p><p></p><div class="rc-image"><img loading="lazy" alt="Hot Reloading" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/TQVZcDbl_timi-13.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="runtime-operations">Runtime Operations<a aria-hidden="true" class="hash-link" href="#runtime-operations" title="Direct link to heading">​</a></h2><p>Runtime operations are primarily divided into three parts: metrics collection, trace reporting, and log collection.</p><p></p><div class="rc-image"><img loading="lazy" alt="Runtime Operation" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/bYcxhAf1_timi-14.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="1-metrics-collection">1. Metrics Collection<a aria-hidden="true" class="hash-link" href="#1-metrics-collection" title="Direct link to heading">​</a></h3><p>k8s clusters offer an official metrics collection solution called the Kubernetes Prometheus Operator. By periodically scraping metrics ports and information exposed by services, data is regularly reported to external systems such as Prometheus. Since this part has not been deeply customized, it will not be detailed here. Related k8s configurations are fully described in APISIX&#x27;s Helm Chart.</p><p></p><div class="rc-image"><img loading="lazy" alt="Metrics" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/HWY7oK1j_timi-15.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="2-trace-reporting">2. Trace Reporting<a aria-hidden="true" class="hash-link" href="#2-trace-reporting" title="Direct link to heading">​</a></h3><p>Trace reporting is implemented based on the OpenTelemetry plugin provided by APISIX. This plugin sends data to the OpenTelemetry Collector via the OpenTelemetry protocol, which ultimately writes the data to ClickHouse for trace data collection and storage.</p><p></p><div class="rc-image"><img loading="lazy" alt="Trace" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/aHPC3JJa_timi-16.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="3-log-collection">3. Log Collection<a aria-hidden="true" class="hash-link" href="#3-log-collection" title="Direct link to heading">​</a></h3><p>Log collection also utilizes the OpenTelemetry protocol. However, the OpenTelemetry plugin in the APISIX community edition only supports trace reporting and does not include log reporting. Therefore, we recommend using local log storage. By employing a sidecar mode, APISIX logs are written to a shared folder. In the Deployment, another Pod is mounted, which shares the same log folder as the APISIX Pod, thereby achieving log collection and reporting via the OpenTelemetry protocol.</p><p></p><div class="rc-image"><img loading="lazy" alt="Log" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/fKomicyg_timi-17.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><p>Additionally, the monitoring dashboard provided by APISIX are relatively general-purpose and lack specificity. Therefore, we have custom-developed dedicated monitoring panels based on the collected metric data to meet specific monitoring requirements. The alerting system is built using Grafana&#x27;s open-source solution, leveraging its powerful visualization and alerting capabilities to achieve real-time monitoring and alerting of APISIX&#x27;s operational status.</p><p></p><div class="rc-image"><img loading="lazy" alt="Monitoring and Alerting" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/nMkIzdmq_timi-18.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="other-experiences">Other Experiences<a aria-hidden="true" class="hash-link" href="#other-experiences" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="standalone-route-management">Standalone Route Management<a aria-hidden="true" class="hash-link" href="#standalone-route-management" title="Direct link to heading">​</a></h3><p>In our initial approach to route management, we consolidated all route configurations into a single YAML file. However, as our business expanded and the number of routes increased, this monolithic configuration became unwieldy and challenging to maintain. This scenario is humorously encapsulated in the industry jest that Kubernetes operations engineers are essentially &quot;YAML engineers,&quot; highlighting the overwhelming nature of managing extensive YAML configurations.</p><p>To address these challenges, we implemented a two-pronged strategy to optimize our route management:</p><ul><li><p>Modular Decomposition: Following APISIX&#x27;s routing specifications, we segmented the configurations into collector and consumer configuration modules, achieving functional decoupling and categorized management.</p></li><li><p>Domain-Based Segmentation: We further refined our route files by organizing them based on domain names, making route configurations more refined and organized for easier maintenance and expansion.</p></li></ul><p></p><div class="rc-image"><img loading="lazy" alt="Standalone Route Management" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/eQ80I0SA_timi-19.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="reuse-of-route-configurations">Reuse of Route Configurations<a aria-hidden="true" class="hash-link" href="#reuse-of-route-configurations" title="Direct link to heading">​</a></h3><p>In k8s upstream configurations, there are various types, differed solely by the service name. After introducing a new version and updating the Lua package, we effectively addressed the issue of duplicated configurations by fully utilizing leveraged YAML&#x27;s anchor (&amp;) and alias (*) features. Through the anchor mechanism, we abstracted and reused common configuration parts, reducing duplicated configurations by approximately 70% in practical applications. This significantly improved the efficiency and simplicity of configuration management and reduced the risk of errors introduced by duplicated configurations.</p><p align="center"></p><div class="rc-image" style="width:550"><img loading="lazy" alt="Duplicated Route Configuration" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/07/hbEPdHAf_20-duplicated-route-configuration.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="migration-practices-of-apisix-replacing-ingress">Migration Practices of APISIX Replacing Ingress<a aria-hidden="true" class="hash-link" href="#migration-practices-of-apisix-replacing-ingress" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="initial-architecture-and-background">Initial Architecture and Background<a aria-hidden="true" class="hash-link" href="#initial-architecture-and-background" title="Direct link to heading">​</a></h3><p>Our original traffic architecture was structured as follows:</p><ol><li>EdgeOne served as the Content Delivery Network (CDN), handling initial traffic ingress.</li><li>Traffic was then forwarded by Cloud Load Balancer (CLB) to the Ingress layer, which utilized Istio.</li><li>Finally, requests reached the internal APISIX gateway for processing.</li></ol><p>The inclusion of the Ingress layer, specifically Istio, was primarily due to historical decisions. At the time, Istio was selected as the service mesh solution in our cloud environment.</p><p>However, as our business evolved and technology advanced, we recognized the need for a more efficient and flexible traffic management system. Consequently, we plan to replace the existing Ingress layer with APISIX, leveraging it as the Kubernetes Ingress Controller.</p><p></p><div class="rc-image"><img loading="lazy" alt="APISIX Replaces Ingress" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/68MNH7c5_timi-21.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="migration-solution-evaluation">Migration Solution Evaluation<a aria-hidden="true" class="hash-link" href="#migration-solution-evaluation" title="Direct link to heading">​</a></h3><p>During the migration process, we evaluated two primary migration solutions:</p><ul><li><p><strong>Solution One: CDN Canary and Dual Domains</strong> – Deploy a new APISIX instance alongside the existing architecture to direct new traffic to this instance. However, this solution&#x27;s drawback is the need to modify the front-end domain, which may impact user access and business continuity. After careful consideration, we temporarily set aside this solution.</p></li><li><p><strong>Solution Two: CDN Traffic Steering</strong> – This approach allows configuring multiple CLB routes and achieving traffic push based on percentages. Its advantage lies in the ability to gradually switch traffic to the new APISIX instance without changing the user access entry point. Additionally, the traffic ratio can be flexibly adjusted based on actual conditions, facilitating observation and evaluation of the migration effects.</p></li></ul><p></p><div class="rc-image"><img loading="lazy" alt="Migration Solutions" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/Ae6ayVyJ_timi-22.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="implementation-and-advantages-of-the-final-solution">Implementation and Advantages of the Final Solution<a aria-hidden="true" class="hash-link" href="#implementation-and-advantages-of-the-final-solution" title="Direct link to heading">​</a></h3><p>We ultimately chose Solution Two, successfully establishing a new traffic path: new traffic reaches APISIX directly through canary deployment. This new architecture offers the following significant advantages:</p><ul><li><p><strong>No Front-end Changes</strong>: The domain names and entry points accessed by front-end users remain unchanged, ensuring uninterrupted user experience and avoiding potential user confusion or access interruptions caused by domain changes.</p></li><li><p><strong>Full Backend Autonomy</strong>: The backend gains autonomous control and management over traffic switching, enabling flexible adjustment of traffic distribution based on business needs and system status without reliance on external coordination.</p></li><li><p><strong>Rapid Rollback Capability</strong>: With canary release feature, any issues discovered during migration can be quickly rolled back to the original path, minimizing migration risks and ensuring stable business operations.</p></li><li><p><strong>User-Transparent Migration</strong>: The entire migration process is transparent to users, who remain unaware of backend architectural changes during business access, ensuring a smooth and seamless migration.</p></li></ul><p>Below is the overall migration process.</p><p></p><div class="rc-image"><img loading="lazy" alt="Migration Practices" class="rc-image-img" src="https://static.api7.ai/uploads/2025/05/15/y1FiOjxR_timi-23.webp"><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="conclusion">Conclusion<a aria-hidden="true" class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>Our team has developed the business-oriented API gateway TAPISIX based on APISIX. As the core component of our gateway architecture, APISIX has been instrumental in meeting stringent international compliance requirements, reducing development and operational overhead, and enhancing system flexibility and reliability.</p><p>APISIX&#x27;s robust features—such as high-performance routing, dynamic configuration capabilities, and a rich plugin ecosystem—have enabled us to build a highly efficient, stable, and adaptable gateway platform. Looking ahead, we are excited to continue our collaboration with the APISIX community, exploring innovative application scenarios and unlocking greater value for our business.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/case-studies/">Case Studies</a></li></ul></div></footer></article><section class="shareSection_OUzq"><div><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button aria-label="reddit" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button></div></section><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2025/05/29/apisix-ai-gateway-from-cloud-native-to-ai-native/"><div class="pagination-nav__sublabel sublabel_M5Gs">Newer Post</div><div class="pagination-nav__label">APISIX AI Gateway: From Cloud-Native to AI-Native</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2025/04/30/2025-april-monthly-report/"><div class="pagination-nav__sublabel sublabel_M5Gs">Older Post</div><div class="pagination-nav__label">2025 Monthly Report (April 01 - April 30)</div></a></div></nav></div></div></div></div><footer class="container_N-4m"><div class="linksRow_U0oR"><div class="linksCol_R6VE"><div>ASF</div><ul><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span></span><span>Foundation</span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer"><span></span><span>License</span></a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer"><span></span><span>Events</span></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer"><span></span><span>Security</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer"><span></span><span>Sponsorship</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer"><span></span><span>Thanks</span></a></li></ul></div><div class="linksCol_R6VE"><div>Community</div><ul><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer"><span></span><span>GitHub</span></a></li><li class="footer__item"><a href="/docs/general/join/"><span></span><span>Slack</span></a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer"><span></span><span>Twitter</span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCgPD18cMhOg5rmPVnQhAC8g" target="_blank" rel="noopener noreferrer"><span></span><span>YouTube</span></a></li></ul></div><div class="linksCol_R6VE"><div>More</div><ul><li class="footer__item"><a target="_parent" href="/blog/"><span></span><span>Blog</span></a></li><li class="footer__item"><a target="_parent" href="/showcase/"><span></span><span>Showcase</span></a></li><li class="footer__item"><a target="_parent" href="/plugins/"><span></span><span>Plugin Hub</span></a></li><li class="footer__item"><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer"><span></span><span>Roadmap</span></a></li></ul></div></div><div class="copyright_Bdi1"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span style="display:inline-block;width:231.25px;height:40px"></span></a><div>Copyright © 2019-2025 The Apache Software Foundation. Apache APISIX, APISIX®, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></footer></div>
<script src="https://apisix-website-static.apiseven.com/assets/js/runtime~main.57eaa0fa.js"></script>
<script src="https://apisix-website-static.apiseven.com/assets/js/main.84c0a2cc.js"></script>
</body>
</html>