<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="ahrefs-site-verification" content="c2f7370ecf46173f4fb25f114e74c97e0a2976d4f02f61c9b00a9d7d34e34698">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache APISIX® -- Cloud-Native API Gateway and AI Gateway RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache APISIX® -- Cloud-Native API Gateway and AI Gateway Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIX® -- Cloud-Native API Gateway and AI Gateway" href="/opensearch.xml">
<script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Apache APISIX","url":"https://apisix.apache.org"}</script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="24b59d9a-682e-4c3d-9e83-bf2ee85cdc19" data-project-name="APISIX" data-project-color="#E8442E" data-project-logo="https://static.apiseven.com/202202/apache-apisix.png" data-modal-disclaimer="This is a custom LLM for APISIX with access to all developer documentation, GitHub issues and discussions." data-modal-example-questions="How to set up canary release in APISIX?,How to develop a custom APISIX plugin?,How to use custom NGINX configuration in APISIX?,How to configure mTLS between clients and APISIX?,How to only allow a specific APISIX consumer to access special services or routes?" async></script><title data-react-helmet="true">Getting Started with APISIX Test Cases | Apache APISIX® -- Cloud-Native API Gateway and AI Gateway</title><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org/blog/2022/06/27/getting-start-with-apisix-test-cases/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" name="robots" content="index,follow"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" property="og:title" content="Getting Started with APISIX Test Cases | Apache APISIX® -- Cloud-Native API Gateway and AI Gateway"><meta data-react-helmet="true" name="description" content="This article introduces the test case of APISIX and how to write the test case, and shows the actual operation effect from the local and GitHub."><meta data-react-helmet="true" property="og:description" content="This article introduces the test case of APISIX and how to write the test case, and shows the actual operation effect from the local and GitHub."><meta data-react-helmet="true" name="keywords" content="Apache APISIX,API Gateway,Test cases,GitHub"><meta data-react-helmet="true" property="og:image" content="https://static.apiseven.com/2022/11/13/637053d67a0d4.png"><meta data-react-helmet="true" name="twitter:image" content="https://static.apiseven.com/2022/11/13/637053d67a0d4.png"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-06-27T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/bzp2010,https://github.com/hf400159"><meta data-react-helmet="true" property="article:tag" content="Community,Ecosystem"><link data-react-helmet="true" rel="shortcut icon" href="https://static.apiseven.com/202202/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org/blog/2022/06/27/getting-start-with-apisix-test-cases/"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2022/06/27/getting-start-with-apisix-test-cases/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2022/06/27/getting-start-with-apisix-test-cases/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://38VC84A2WJ-dsn.algolia.net" crossorigin="anonymous"><link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Bold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Light.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Demi.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-ExtraBold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/runtime~main.57eaa0fa.js" as="script">
<link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/main.84c0a2cc.js" as="script">
<link rel="stylesheet" href="https://apisix-website-static.apiseven.com/assets/css/styles.9943cb19.css">
<!-- Matomo from the ASF -->
<script>var _paq=window._paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://analytics.apache.org/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","17"]);var e=document,p=e.createElement("script"),t=e.getElementsByTagName("script")[0];p.async=!0,p.src=a+"matomo.js",t.parentNode.insertBefore(p,t)}()</script>
<!-- End Matomo Code -->
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#e8433e;color:white" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">🤔 Introducing APISIX AI Gateway – Built for LLMs and AI workloads. <a target="_blank" rel="noopener noreferrer" href="/ai-gateway/"> Learn More</a></div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a target="_parent" class="navbar__brand" href="/"><img src="/img/logo2.svg" alt="Apache APISIX®" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo2.svg" alt="Apache APISIX®" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Apache APISIX®</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" target="_parent" href="/docs/">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/docs/apisix/getting-started/">Apache APISIX®️</a></li><li><a class="dropdown__link" target="_parent" href="/docs/apisix/next/dashboard/">Apache APISIX®️ Dashboard</a></li><li><a class="dropdown__link" target="_parent" href="/docs/ingress-controller/overview/">Apache APISIX®️ Ingress Controller</a></li><li><a class="dropdown__link" target="_parent" href="/docs/helm-chart/apisix/">Apache APISIX®️ Helm Charts</a></li><li><a class="dropdown__link" target="_parent" href="/docs/docker/build/">Apache APISIX®️ Docker</a></li><li><a class="dropdown__link" target="_parent" href="/docs/java-plugin-runner/development/">Apache APISIX®️ Java Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/go-plugin-runner/getting-started/">Apache APISIX®️ Go Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/python-plugin-runner/getting-started/">Apache APISIX®️ Python Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/join/">General</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" target="_parent" href="/blog/">Blog</a><a class="navbar__item navbar__link" target="_parent" href="/blog/tags/case-studies/">Case Studies</a><a class="navbar__item navbar__link" target="_parent" href="/downloads/">Downloads</a><a class="navbar__item navbar__link" target="_parent" href="/help/">Help</a><a class="navbar__item navbar__link" target="_parent" href="/team/">Team</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/showcase/">Showcase</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/code-samples/">Code Samples</a></li><li><a class="dropdown__link" target="_parent" href="/plugins/">PluginHub</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/join/">Community</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/events/">Events</a></li><li><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer" class="dropdown__link">Roadmap</a></li></ul></div><a href="/zh/blog" target="_parent" rel="noopener noreferrer" class="localizedBlogLink_W2zh">中文博客</a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_SGhp"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="sticky-outer-wrapper placeholder_iq-X"><div class="sticky-inner-wrapper" style="position:relative;top:0px;z-index:199"><div class="tagsHeader_HGHP"><a target="_parent" href="/blog/tags/case-studies/">Case Studies</a><a target="_parent" href="/blog/tags/ecosystem/">Ecosystem</a><a target="_parent" href="/blog/tags/authentication/">Authentication</a><a target="_parent" href="/blog/tags/plugins/">Plugins</a><a target="_parent" href="/blog/tags/community/">Community</a><a target="_parent" href="/blog/tags/vulnerabilities/">Vulnerabilities</a></div></div></div><div class="container margin-vert--lg"><div class="row" style="justify-content:center"><div class="col col--9"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Getting Started with APISIX Test Cases</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-06-27T00:00:00.000Z" itemprop="datePublished">June 27, 2022</time> · <!-- -->12 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_dGI0"><div class="avatar margin-bottom--sm"><a href="https://github.com/bzp2010" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_KCbV" src="https://github.com/bzp2010.png" alt="Zeping Bai"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/bzp2010" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Zeping Bai</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div><div class="col col--6 authorCol_dGI0"><div class="avatar margin-bottom--sm"><a href="https://github.com/hf400159" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_KCbV" src="https://github.com/hf400159.png" alt="Fei Han"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hf400159" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Fei Han</span></a></div><small class="avatar__subtitle" itemprop="description">Technical Writer</small></div></div></div></div></header><meta itemprop="image" content="https://static.apiseven.com/2022/11/13/637053d67a0d4.png"><div class="markdown" itemprop="articleBody"><section class="shareSection_OUzq"><div><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button aria-label="reddit" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button></div></section><blockquote><p>This article introduces the test case of APISIX and how to write the test case, and shows the actual operation effect from the local and GitHub.</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="background">Background<a aria-hidden="true" class="hash-link" href="#background" title="Direct link to heading">​</a></h2><p>Apache APISIX is a dynamic, real-time, high-performance API Gateway, it provides rich traffic management features such as load balancing, dynamic upstream, canary release, circuit breaking, authentication, observability, and more. You can use APISIX API Gateway to handle traditional north-south traffic, as well as east-west traffic between services.</p><p>Under normal circumstances, to ensure the normal operation of the software, we generally use various techniques and methods to check the functions of the software manually or automatically to ensure that it is running normally before the software goes online. We call this operation QA (testing). Testing is generally divided into unit testing, E2E testing and chaos testing.</p><p>Unit testing is used to check the correctness of a single module (such as checking whether the serialization/deserialization of a certain RPC, data encryption and decryption are normal), but the test lacks a global perspective on the system. The E2E test (ie end-to-end test) can make up for the insufficiency of the unit test. The test runs the entire system and external dependent services, and checks the integration of the system and other systems through real software calls; the chaos test passes the test. Create unexpected situations between various components of the system, such as OOM Kill, network interruption, etc., to test the tolerance and capability of the entire system for errors and errors. The testing of APISIX is more inclined to E2E testing to ensure the correctness of its own functions and integration with other systems.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="apisix-test-case-introduction">APISIX Test Case Introduction<a aria-hidden="true" class="hash-link" href="#apisix-test-case-introduction" title="Direct link to heading">​</a></h2><p>APISIX is the world&#x27;s most active API gateway, and its stability and service robustness need to be guaranteed to a certain extent, so how to avoid potential errors in APISIX? This needs to be achieved through test cases.</p><p>A test script is not just a program file executed by the machine under test. For developers, the test script can be used to test all functions of the software, including the running status of the program under different configurations and different input parameters. For the user, the test provides a specific example of the use of a function module, such as: the configuration and input that the program can accept, and what kind of output results are expected to be obtained. If the user encounters something they do not understand when referring to the documentation, they can refer to the existing test cases to find out whether there are similar usage scenarios.</p><p>In the APISIX project, Github Action is usually used to run CI tests and execute the test scripts shown in the following figure. Many APISIX developers encounter a variety of problems when writing test cases. Hope this article will help you write APISIX test cases.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/1.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/2022/blog/0627/1.webp, https://static.apiseven.com/2022/blog/0627/1.png" alt="network error/apisix test case" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/2022/blog/0627/1.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/1.webp, https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/1.png" alt="network error/apisix test case" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/1.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="write-test-cases">Write test cases<a aria-hidden="true" class="hash-link" href="#write-test-cases" title="Direct link to heading">​</a></h2><p>The test cases of APISIX are written based on the <code>Test::NGINX</code> test framework, which is a test environment implemented on the basis of the Perl language, which can provide script-based automated testing capabilities, and provides a large-scale test and quality assurance work for APISIX. support. Of course, it doesn&#x27;t matter if you don&#x27;t use Perl, because in most scenarios, you don&#x27;t need to write Perl code, you only need to use the ability of <code>TEST::NGINX</code> encapsulation. If you have special needs, you can combine it with Lua code to enhance it.</p><p>The test cases of APISIX are stored in the <code>./apisix/t</code> directory. Next, we will introduce you to how to write test cases by adding the opa plugin as an example.</p><ol><li><p>You need to create a test file ending with <code>.t</code>, eg <code>./t/plugin/opa.t</code>. If you are adding features to existing functions, you can directly add test cases to the corresponding test file, and add the fixed-format <code>ASF 2.0</code> protocol to the file.</p></li><li><p>The main function of this part is to automatically add <code>no_error_log</code> to all test cases in the <code>opa.t</code> file, so that you don&#x27;t need to add <code>error_log</code> related code under each code, you can copy and use this code directly. segment code. In this way, some duplication of code can be reduced.</p></li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK perl"><pre tabindex="0" class="prism-code language-perl codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">add_block_preprocessor(sub {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my ($block) = @_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ((!defined $block-&gt;error_log) &amp;&amp; (!defined $block-&gt;no_error_log)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $block-&gt;set_value(&quot;no_error_log&quot;, &quot;[error]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!defined $block-&gt;request) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $block-&gt;set_value(&quot;request&quot;, &quot;GET /t&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run_tests();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DATA</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><ol start="3"><li>Each test case has a fixed beginning, and the general format is as follows.</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK perl"><pre tabindex="0" class="prism-code language-perl codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">=== TEST 1: sanity</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p><code>===</code> is a fixed syntax structure at the beginning of a test case, and <code>TEST 1</code> represents the first test case in this file. <code>sanity</code> is the name of the test. Usually named after the specific purpose of the test case.</p><ol start="4"><li>Next is the body of the test case. Almost every plugin in APISIX defines some parameters and properties, and pre-defines JSON schema, so we need to check whether the input parameters of the plugin can be properly verified. In this way, we can check whether the data we input can be properly verified by the rules of JSON schema.</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK perl"><pre tabindex="0" class="prism-code language-perl codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">--- config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location /t {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        content_by_lua_block {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            local test_cases = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {host = &quot;http://127.0.0.1:8181&quot;, policy = &quot;example/allow&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {host = &quot;http://127.0.0.1:8181&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {host = 3233, policy = &quot;example/allow&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            local plugin = require(&quot;apisix.plugins.opa&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            for _, case in ipairs(test_cases) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                local ok, err = plugin.check_schema(case)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ngx.say(ok and &quot;done&quot; or err)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- response_body</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">property &quot;policy&quot; is required</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">property &quot;host&quot; validation failed: wrong type: expected string, got number</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>By reading the <a href="https://github.com/apache/apisix/blob/master/apisix/plugins/opa.lua#L46" target="_blank" rel="noopener noreferrer">source code</a> of the <code>opa</code> plugin, you can see that the <code>opa</code> plugin requires both <code>host</code> and <code>policy</code> to exist, so three rules need to be defined here.</p><ul><li>Enter the correct parameters, including <code>host</code> and <code>policy</code>. So the return result will be <code>done</code>;</li><li>Enter only the <code>host</code> parameter. Does not meet the requirements of <code>host</code> and <code>policy</code> at the same time, so the expected return result of this test will be <code>property &quot;policy&quot; is required</code>;</li><li>A <code>host</code> value of the wrong type (integer) was entered. Because the <code>host</code> parameter must be a string type set in the source code, the return result will be <code>property &quot;host&quot; validation failed: wrong type: expected string, got number</code>.</li></ul><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK perl"><pre tabindex="0" class="prism-code language-perl codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">--- config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location /t {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        content_by_lua_block {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ngx.say(ok and &quot;done&quot; or err)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- response_body</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>In general, each test case needs to use the <code>/t</code> function, for example, you need to call Lua code, define <code>location</code>. You can use the <code>content_by_lua_block</code> method to call some code-assisted tests, and finally print the response information in the <code>ngx.say</code> method, and then use the <code>--- response_body</code> method to check whether the above program runs correctly. There is no need to enter <code>request</code> and <code>error</code> manually, because you have already added them automatically through the script.</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK perl"><pre tabindex="0" class="prism-code language-perl codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">    local plugin = require(&quot;apisix.plugins.opa&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for _, case in ipairs(test_cases) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        local ok, err = plugin.check_schema(case)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ngx.say(ok and &quot;done&quot; or err)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>The above code represents a module that imports the APISIX Plugin <code>opa</code> plugin and calls the <code>plugin.check_schema</code> function. Then pass the <code>for</code> loop to call the parameters and return the corresponding results according to the test situation.</p><ol start="5"><li>Next, we need to set up an environment for testing. For plugins, it is to create a route, and then associate the plugin to this route. After the setup is complete, we can verify whether the internal logic of the plugin is implemented correctly by sending a request.</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK perl"><pre tabindex="0" class="prism-code language-perl codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">=== TEST 2: setup route with plugin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location /t {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        content_by_lua_block {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            local t = require(&quot;lib.test_admin&quot;).test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            local code, body = t(&#x27;/apisix/admin/routes/1&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 ngx.HTTP_PUT,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 [[{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;opa&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;host&quot;: &quot;http://127.0.0.1:8181&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;policy&quot;: &quot;example&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;upstream&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;nodes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;127.0.0.1:1980&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;type&quot;: &quot;roundrobin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;uris&quot;: [&quot;/hello&quot;, &quot;/test&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if code &gt;= 300 then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ngx.status = code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ngx.say(body)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- response_body</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">passed</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>In the above example, <code>lib_test_admin</code> is used to import into the <code>t</code> function, create a route with <code>id</code> of <code>1</code>, and then use the <code>PUT</code> method to pass in the data. In this test, we did not check the data format, because the test case only needs to ensure that the route can be created normally using the Admin API. Of course, we also need to judge the exception. If the status code is greater than or equal to <code>300</code>, then The specific information will be printed.</p><p>In APISIX&#x27;s test cases, you will find that many of the tests include the following code:</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK perl"><pre tabindex="0" class="prism-code language-perl codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">local t = require(&quot;lib.test_admin&quot;).test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local code, body = t(&#x27;/apisix/admin/routes/1&#x27;, ngx.HTTP_PUT)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>The above code means importing the <code>lib.test_admin</code> module and encapsulating it with the test function to send the request. It reduces the repetitive code when we call HTTP interfaces such as APISIX Admin API, and only needs to simply call and check the returned result.</p><ol start="6"><li>In the third test, we don&#x27;t need to repeat the creation of the route since it was already created in the second test.</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK perl"><pre tabindex="0" class="prism-code language-perl codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">=== TEST 3: hit route (with correct request)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /hello?test=1234&amp;user=none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- more_headers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-header: only-for-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- response_body</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello world</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>The above example defines <code>request</code>. Since we defined <code>/hello</code> and <code>/test</code> paths in the previous test, we can send a <code>GET</code> request to <code>/hello</code> and it will then send a <code>test=1234</code> and <code>user=none</code> for the <code>query</code> parameter. You can also add response headers via <code>more_headers</code>, such as adding a <code>test-header</code> response header to a request sent to <code>hello</code>.</p><p>The above test is to test whether adding the correct request header can be successful. You can also add error headers in subsequent test examples and verify the results. If you need to use <code>POST</code> request, you can also change <code>GET /hello</code> in the above code to <code>POST /hello</code>.</p><p>In some tests, you may need to create multiple upstreams or routes. In this case, you can define an array, then define these corresponding values in the array, and use the <code>for</code> method to call the <code>t</code> function in a loop, and then Let it call the Admin API interface of APISIX through <code>put</code> to create a route or upstream normally. This method is also a more common method of testing, called: Table driving test, which is a method of driving tests through tables, which reduces some repetitive codes. For details, please refer to the <a href="https://www.bilibili.com/video/BV1qF411G78j?spm_id_from=333.1007.top_right_bar_window_history.content.click&amp;vd_source=d427acb1117c07aeea8968e15736e375" target="_blank" rel="noopener noreferrer">APISIX test case quick start video</a> and the <code>opa2.t</code> <a href="https://github.com/apache/apisix/blob/master/t/plugin/opa2.t#L39" target="_blank" rel="noopener noreferrer">test case</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="run-the-test-case">Run the test case<a aria-hidden="true" class="hash-link" href="#run-the-test-case" title="Direct link to heading">​</a></h2><p>The test case requires the source code to install APISIX. For the specific installation method, please refer to <a href="https://apisix.apache.org/docs/apisix/next/building-apisix" target="_blank" rel="noopener noreferrer">Building APISIX from source</a>. Next, we will focus on how to run test cases and error checking.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="running-locally">Running locally<a aria-hidden="true" class="hash-link" href="#running-locally" title="Direct link to heading">​</a></h3><p>Typically, you can run a test case locally using the following command:</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK shell"><pre tabindex="0" class="prism-code language-shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token assign-left variable environment constant" style="color:#36acaa">PATH</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/local/openresty/nginx/sbin:/usr/bin </span><span class="token assign-left variable" style="color:#36acaa">PERL5LIB</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">.:</span><span class="token variable" style="color:#36acaa">$PERL5LIB</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">FLUSH_ETCD</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> prove -Itest-nginx/lib -r t/admin</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>The above commands are interpreted as follows:</p><ul><li><code>PATH</code> specifies the directory where <code>openresty/nginx</code> is located, which can avoid conflicts caused by incorrect configuration of some environments. If OpenResty in the environment is installed in other locations, it can also be specified through this command.</li><li><code>PERL5LIB</code> specifies importing locally using <code>Perl</code>. Import the PERL library that exists in this path and some of the PERL libraries attached via environment variables.</li><li><code>FLUSH_ETCD</code> specifies that after each test file is executed, all data is cleared. It needs to call the <code>etcdctl</code> function, and it needs to ensure that the <code>etcdctl</code> executable file can be found in the <code>PATH</code>.</li><li><code>prove</code> invokes the test program to start the test execution.</li><li><code>-Itest-nginx/lib</code> means import the <code>Itest-nginx/lib</code> library.</li><li><code>-r</code> means to automatically find test files. If a path is specified, all test files under this path will be searched.</li><li><code>t/admin</code> means to specify the test case search path, and it can also be specified to a unique <code>.t</code> file for qualification.</li></ul><p>The following is the normal return result.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/5.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/2022/blog/0627/5.webp, https://static.apiseven.com/2022/blog/0627/5.png" alt="network error/normal return result" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/2022/blog/0627/5.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/5.webp, https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/5.png" alt="network error/normal return result" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/5.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>If the test fails, the following message appears:</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/2.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/2022/blog/0627/2.webp, https://static.apiseven.com/2022/blog/0627/2.png" alt="network error/fail return result" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/2022/blog/0627/2.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/2.webp, https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/2.png" alt="network error/fail return result" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/2.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>The above information will tell you which test case in which test file failed.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="running-github">Running Github<a aria-hidden="true" class="hash-link" href="#running-github" title="Direct link to heading">​</a></h3><p>In general, when submitting code in Github, the output results are similar to those of local testing.</p><p>First select the wrong execution workflow, the main test cases are in the build series CI.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/3.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/2022/blog/0627/3.webp, https://static.apiseven.com/2022/blog/0627/3.png" alt="network error/Github CI example" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/2022/blog/0627/3.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/3.webp, https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/3.png" alt="network error/Github CI example" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/3.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>We can see that, in this example, line <code>416</code> is reporting an error. Through the error information, we can get that there is an error in a test case in a certain test file, and the developer can look for the correction in direction. It should be noted that there may be some strange errors in CI, which may be caused by temporary abnormalities in the CI environment. If the code in the corresponding module has not been modified, these errors can be ignored.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/4.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/2022/blog/0627/4.webp, https://static.apiseven.com/2022/blog/0627/4.png" alt="network error/Github CI error example" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/2022/blog/0627/4.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/4.webp, https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/4.png" alt="network error/Github CI error example" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/2022/blog/0627/4.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="summary">Summary<a aria-hidden="true" class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>This article mainly introduces the relevant process of testing, as well as the composition of APISIX test cases and how to write test cases. I hope you can have a general understanding of APISIX test cases through this article.</p><p>However, the text only mentions some core content in the APISIX test framework, and fails to cover all the content in the TEST::NGINX framework. In fact, there are many powerful capabilities in <code>TEST::NGINX</code>. We can use <a href="https://metacpan.org/pod/Test::Nginx::Socket" target="_blank" rel="noopener noreferrer">Test::Nginx::Socket</a> documentation for more usage. If you want to learn more about writing test cases, you can also watch the <a href="https://www.bilibili.com/video/BV1qF411G78j?spm_id_from=333.1007.top_right_bar_window_history.content.click&amp;vd_source=d427acb1117c07aeea8968e15736e375" target="_blank" rel="noopener noreferrer">APISIX Test Cases Quick Start video</a>.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/community/">Community</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/ecosystem/">Ecosystem</a></li></ul></div></footer></article><section class="shareSection_OUzq"><div><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button aria-label="reddit" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button></div></section><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022/07/04/apisix-integrates-with-hydra/"><div class="pagination-nav__sublabel sublabel_M5Gs">Newer Post</div><div class="pagination-nav__label">APISIX integrates with Ory Hydra</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022/06/21/weekly-report-0621/"><div class="pagination-nav__sublabel sublabel_M5Gs">Older Post</div><div class="pagination-nav__label">Biweekly Report (Jun 1 - Jun 15)</div></a></div></nav></div></div></div></div><footer class="container_N-4m"><div class="linksRow_U0oR"><div class="linksCol_R6VE"><div>ASF</div><ul><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span></span><span>Foundation</span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer"><span></span><span>License</span></a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer"><span></span><span>Events</span></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer"><span></span><span>Security</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer"><span></span><span>Sponsorship</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer"><span></span><span>Thanks</span></a></li></ul></div><div class="linksCol_R6VE"><div>Community</div><ul><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer"><span></span><span>GitHub</span></a></li><li class="footer__item"><a href="/docs/general/join/"><span></span><span>Slack</span></a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer"><span></span><span>Twitter</span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCgPD18cMhOg5rmPVnQhAC8g" target="_blank" rel="noopener noreferrer"><span></span><span>YouTube</span></a></li></ul></div><div class="linksCol_R6VE"><div>More</div><ul><li class="footer__item"><a target="_parent" href="/blog/"><span></span><span>Blog</span></a></li><li class="footer__item"><a target="_parent" href="/showcase/"><span></span><span>Showcase</span></a></li><li class="footer__item"><a target="_parent" href="/plugins/"><span></span><span>Plugin Hub</span></a></li><li class="footer__item"><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer"><span></span><span>Roadmap</span></a></li></ul></div></div><div class="copyright_Bdi1"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span style="display:inline-block;width:231.25px;height:40px"></span></a><div>Copyright © 2019-2025 The Apache Software Foundation. Apache APISIX, APISIX®, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></footer></div>
<script src="https://apisix-website-static.apiseven.com/assets/js/runtime~main.57eaa0fa.js"></script>
<script src="https://apisix-website-static.apiseven.com/assets/js/main.84c0a2cc.js"></script>
</body>
</html>