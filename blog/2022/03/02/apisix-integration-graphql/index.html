<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="ahrefs-site-verification" content="c2f7370ecf46173f4fb25f114e74c97e0a2976d4f02f61c9b00a9d7d34e34698">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway and AI Gateway RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway and AI Gateway Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway and AI Gateway" href="/opensearch.xml">
<script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Apache APISIX","url":"https://apisix.apache.org"}</script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="24b59d9a-682e-4c3d-9e83-bf2ee85cdc19" data-project-name="APISIX" data-project-color="#E8442E" data-project-logo="https://static.apiseven.com/202202/apache-apisix.png" data-modal-disclaimer="This is a custom LLM for APISIX with access to all developer documentation, GitHub issues and discussions." data-modal-example-questions="How to set up canary release in APISIX?,How to develop a custom APISIX plugin?,How to use custom NGINX configuration in APISIX?,How to configure mTLS between clients and APISIX?,How to only allow a specific APISIX consumer to access special services or routes?" async></script><title data-react-helmet="true">Use GraphQL with API Gateway Apache APISIX | Apache APISIX¬Æ -- Cloud-Native API Gateway and AI Gateway</title><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org/blog/2022/03/02/apisix-integration-graphql/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" name="robots" content="index,follow"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" property="og:title" content="Use GraphQL with API Gateway Apache APISIX | Apache APISIX¬Æ -- Cloud-Native API Gateway and AI Gateway"><meta data-react-helmet="true" name="description" content="This article describes the features of the cloud-native API gateway Apache APISIX and GraphQL, and how to use Apache APISIX to proxy GraphQL requests."><meta data-react-helmet="true" property="og:description" content="This article describes the features of the cloud-native API gateway Apache APISIX and GraphQL, and how to use Apache APISIX to proxy GraphQL requests."><meta data-react-helmet="true" name="keywords" content="Apache APISIX,API Gateway,GraphQL,Ecosystem"><meta data-react-helmet="true" property="og:image" content="https://static.apiseven.com/2022/blog/0818/ecosystem/GraphQL.png"><meta data-react-helmet="true" name="twitter:image" content="https://static.apiseven.com/2022/blog/0818/ecosystem/GraphQL.png"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-03-02T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/Chever-John,https://github.com/hf400159"><meta data-react-helmet="true" property="article:tag" content="Ecosystem"><link data-react-helmet="true" rel="shortcut icon" href="https://static.apiseven.com/202202/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org/blog/2022/03/02/apisix-integration-graphql/"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2022/03/02/apisix-integration-graphql/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2022/03/02/apisix-integration-graphql/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://38VC84A2WJ-dsn.algolia.net" crossorigin="anonymous"><link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Bold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Light.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Demi.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-ExtraBold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/runtime~main.4bbc9839.js" as="script">
<link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/main.a516b59b.js" as="script">
<link rel="stylesheet" href="https://apisix-website-static.apiseven.com/assets/css/styles.9943cb19.css">
<!-- Matomo from the ASF -->
<script>var _paq=window._paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://analytics.apache.org/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","17"]);var e=document,p=e.createElement("script"),t=e.getElementsByTagName("script")[0];p.async=!0,p.src=a+"matomo.js",t.parentNode.insertBefore(p,t)}()</script>
<!-- End Matomo Code -->
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#e8433e;color:white" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">ü§î Introducing APISIX AI Gateway ‚Äì Built for LLMs and AI workloads. <a target="_blank" rel="noopener noreferrer" href="/ai-gateway/"> Learn More</a></div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a target="_parent" class="navbar__brand" href="/"><img src="/img/logo2.svg" alt="Apache APISIX¬Æ" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo2.svg" alt="Apache APISIX¬Æ" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Apache APISIX¬Æ</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" target="_parent" href="/docs/">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/docs/apisix/getting-started/">Apache APISIX¬ÆÔ∏è</a></li><li><a class="dropdown__link" target="_parent" href="/docs/apisix/next/dashboard/">Apache APISIX¬ÆÔ∏è Dashboard</a></li><li><a class="dropdown__link" target="_parent" href="/docs/ingress-controller/overview/">Apache APISIX¬ÆÔ∏è Ingress Controller</a></li><li><a class="dropdown__link" target="_parent" href="/docs/helm-chart/apisix/">Apache APISIX¬ÆÔ∏è Helm Charts</a></li><li><a class="dropdown__link" target="_parent" href="/docs/docker/build/">Apache APISIX¬ÆÔ∏è Docker</a></li><li><a class="dropdown__link" target="_parent" href="/docs/java-plugin-runner/development/">Apache APISIX¬ÆÔ∏è Java Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/go-plugin-runner/getting-started/">Apache APISIX¬ÆÔ∏è Go Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/python-plugin-runner/getting-started/">Apache APISIX¬ÆÔ∏è Python Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/join/">General</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" target="_parent" href="/blog/">Blog</a><a class="navbar__item navbar__link" target="_parent" href="/blog/tags/case-studies/">Case Studies</a><a class="navbar__item navbar__link" target="_parent" href="/downloads/">Downloads</a><a class="navbar__item navbar__link" target="_parent" href="/help/">Help</a><a class="navbar__item navbar__link" target="_parent" href="/team/">Team</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/showcase/">Showcase</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/code-samples/">Code Samples</a></li><li><a class="dropdown__link" target="_parent" href="/plugins/">PluginHub</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/join/">Community</a></li><li><a class="dropdown__link" target="_parent" href="/docs/general/events/">Events</a></li><li><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer" class="dropdown__link">Roadmap</a></li></ul></div><a href="/zh/blog" target="_parent" rel="noopener noreferrer" class="localizedBlogLink_W2zh">‰∏≠ÊñáÂçöÂÆ¢</a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">üåú</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">üåû</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_SGhp"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="sticky-outer-wrapper placeholder_iq-X"><div class="sticky-inner-wrapper" style="position:relative;top:0px;z-index:199"><div class="tagsHeader_HGHP"><a target="_parent" href="/blog/tags/case-studies/">Case Studies</a><a target="_parent" href="/blog/tags/ecosystem/">Ecosystem</a><a target="_parent" href="/blog/tags/authentication/">Authentication</a><a target="_parent" href="/blog/tags/plugins/">Plugins</a><a target="_parent" href="/blog/tags/community/">Community</a><a target="_parent" href="/blog/tags/vulnerabilities/">Vulnerabilities</a></div></div></div><div class="container margin-vert--lg"><div class="row" style="justify-content:center"><div class="col col--9"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Use GraphQL with API Gateway Apache APISIX</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-03-02T00:00:00.000Z" itemprop="datePublished">March 2, 2022</time> ¬∑ <!-- -->9 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_dGI0"><div class="avatar margin-bottom--sm"><a href="https://github.com/Chever-John" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_KCbV" src="https://avatars.githubusercontent.com/u/43690894?v=4" alt="JohnChever"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Chever-John" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">JohnChever</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div><div class="col col--6 authorCol_dGI0"><div class="avatar margin-bottom--sm"><a href="https://github.com/hf400159" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_KCbV" src="https://avatars.githubusercontent.com/u/97138894?v=4" alt="Fei Han"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hf400159" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Fei Han</span></a></div><small class="avatar__subtitle" itemprop="description">Technical Writer</small></div></div></div></div></header><meta itemprop="image" content="https://static.apiseven.com/2022/blog/0818/ecosystem/GraphQL.png"><div class="markdown" itemprop="articleBody"><section class="shareSection_OUzq"><div><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button aria-label="reddit" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button></div></section><blockquote><p>This article introduces the features of Apache APISIX and GraphQL, and how to use the API gateway Apache APISIX to proxy GraphQL requests, and proposes solutions to solve the pain points of practical scenarios.</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="background-information">Background Information<a aria-hidden="true" class="hash-link" href="#background-information" title="Direct link to heading">‚Äã</a></h2><p>GraphQL is an open source, API oriented data query operation language and corresponding running environment. Originally developed internally by Facebook in 2012 and publicly released in 2015. On November 7, 2018, Facebook transferred the GraphQL project to the newly established GraphQL foundation.</p><p>You can understand GraphQL by analogy with SQL query statements. Compared with SQL query statements, GraphQL provides an easy to understand and complete description of the data in the API, so that the client can accurately obtain the data it needs through the customized description. This also allows the API to calmly face the development of increasingly complex interfaces and avoid eventually becoming a daunting complex interface.</p><p>Apache APISIX is a dynamic, real-time, high-performance API gateway that provides rich traffic management features such as load balancing, dynamic upstream, canary release, circuit breaking, authentication, observability, and more.</p><p>As a cloud native API gateway, Apache APISIX already has the matching ability to recognize GraphQL syntax at the beginning of its design. By efficiently matching GraphQL statements carried in requests, it can filter out abnormal traffic to further ensure security and improve system performance.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="scene-analysis">Scene Analysis<a aria-hidden="true" class="hash-link" href="#scene-analysis" title="Direct link to heading">‚Äã</a></h3><p>We are in the era of big data and large traffic, Apache APISIX and GraphQL can be combined to form a win-win situation. The following is a detailed description of a scenario.</p><p>This article will discuss the practical application of Apache APISIX and GraphQL in the context of microservice architecture.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="problems-encountered-in-the-actual-scene">Problems Encountered In the Actual Scene<a aria-hidden="true" class="hash-link" href="#problems-encountered-in-the-actual-scene" title="Direct link to heading">‚Äã</a></h3><p>In the late stage of the project, business complexity and team mobility are often the problems. Micro service architecture has become a common solution to such problems. In microservice architecture, GraphQL exposes two kinds of interfaces: decentralized and centralized. However, only centralized interface design can maximize GraphQL&#x27;s advantages. However, in centralized interface design, all microservices are exposed to the same interface. <strong>So processing flow routing cannot simply forwarded according to the URL, but should be based on the request contained in different fields are forwarded.</strong></p><p>Because NGINX only processes URLs and some parameters when processing requests, but only by parsing the query information in the request parameters can the resources accessed by the client be known, so as to perform routing forwarding, so this routing forwarding method cannot be completed through traditional NGINX. . In practical application scenarios, it is very dangerous to directly expose the GraphQL interface to the outside world, so a professional high-performance API gateway is required to protect the GraphQL interface.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="solution">Solution<a aria-hidden="true" class="hash-link" href="#solution" title="Direct link to heading">‚Äã</a></h3><p>Based on the security, stability, and high performance of Apache APISIX, adding flexible routing matching rules to GraphQL is the best solution to GraphQL&#x27;s centralized interface design.</p><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1646200966179-1d649ab0-8d49-49f5-a8fa-a1a30af0519d.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1646200966179-1d649ab0-8d49-49f5-a8fa-a1a30af0519d.webp, https://static.apiseven.com/202108/1646200966179-1d649ab0-8d49-49f5-a8fa-a1a30af0519d.png" alt="error/graphql architecture.png" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1646200966179-1d649ab0-8d49-49f5-a8fa-a1a30af0519d.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1646200966179-1d649ab0-8d49-49f5-a8fa-a1a30af0519d.webp, https://static.apiseven.com/apisix-thumbnail/202108/1646200966179-1d649ab0-8d49-49f5-a8fa-a1a30af0519d.png" alt="error/graphql architecture.png" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1646200966179-1d649ab0-8d49-49f5-a8fa-a1a30af0519d.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>In this scheme, Apache APISIX is deployed before GraphQL Server as an API gateway, providing security for the whole backend system. In addition, Apache APISIX has GraphQL matching functions according to its own. Some of the requests are filtered and processed by the GraphQL Server, making the whole request resource process more efficient.</p><p>Thanks to the dynamic features of Apache APISIX, you can enable plug-ins such as current limiting, authentication, and observability without restarting services, which further improves the operating efficiency of this solution and facilitates operation and maintenance.</p><p>In addition, Apache APISIX can also perform different permission checks for different <code>graphql_operations</code>, and forward to different Upstream for different graphql_names. The details will be described below.</p><p><strong>To sum up, the solution of Apache APISIX + GraphQL can fully utilize the advantages of GraphQL search and also have the security and stability of Apache APISIX as API gateway.</strong></p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="application-of-graphql-in-api-gateway">Application of GraphQL In API Gateway<a aria-hidden="true" class="hash-link" href="#application-of-graphql-in-api-gateway" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="basic-logic">Basic Logic<a aria-hidden="true" class="hash-link" href="#basic-logic" title="Direct link to heading">‚Äã</a></h3><p></p><div type="image/webp" placeholdersrc="https://static.apiseven.com/apisix-thumbnail/202108/1646201215532-f5965158-7456-443a-84a7-cadadb95fc1f.webp" class="rc-image"><img loading="lazy" srcset="https://static.apiseven.com/apisix-webp/202108/1646201215532-f5965158-7456-443a-84a7-cadadb95fc1f.webp, https://static.apiseven.com/202108/1646201215532-f5965158-7456-443a-84a7-cadadb95fc1f.png" alt="error/GraphQL principle.png" class="rc-image-img" src="https://static.apiseven.com/apisix-webp/202108/1646201215532-f5965158-7456-443a-84a7-cadadb95fc1f.webp"><div aria-hidden="true" class="rc-image-placeholder"><div class="rc-image"><img srcset="https://static.apiseven.com/apisix-thumbnail/202108/1646201215532-f5965158-7456-443a-84a7-cadadb95fc1f.webp, https://static.apiseven.com/apisix-thumbnail/202108/1646201215532-f5965158-7456-443a-84a7-cadadb95fc1f.png" alt="error/GraphQL principle.png" class="rc-image-img" src="https://static.apiseven.com/apisix-thumbnail/202108/1646201215532-f5965158-7456-443a-84a7-cadadb95fc1f.webp"></div></div><div class="rc-image-mask">Click to Preview</div></div><p></p><p>The execution logic of GraphQL in Apache APISIX is as follows:</p><ol><li>Clients to  Apache APISIX initiated with GraphQL statements request;</li><li>Apache APISIX matching routing and extract the preset GraphQL data;</li><li>Apache APISIX matches the request data with the preset GraphQL data;</li></ol><ul><li>If the match is successful,  Apache APISIX will continue to forward the request;</li><li>If the match fails, Apache APISIX will immediately terminate the request.</li></ul><ol start="4"><li>Whether plugins exist;</li></ol><ul><li>if the plug-in exists, the request will continue to be processed by the plug-in, and after the processing is completed, it will continue to be forwarded to the GraphQL Server;</li><li>If no plug-in exists, the request will be forwarded directly to GraphQL Server.</li></ul><p>In the internal matching of APISIX core, Apache APISIX implements GraphQL support through the <a href="https://github.com/bjornbytes/graphql-lua" target="_blank" rel="noopener noreferrer"><code>graphql-lua</code></a> library. The Apache APISIX GraphQL parsing library will first parse the request carrying the GraphQL syntax, and then match the parsed request with the configuration data preset in the Apache APISIX database. If the match is successful, Apache APISIX will pass and forward the request, otherwise it will terminate the request.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="specific-configuration">Specific Configuration<a aria-hidden="true" class="hash-link" href="#specific-configuration" title="Direct link to heading">‚Äã</a></h3><p>Apache APISIX currently supports filtering routes by some properties of GraphQL:</p><ul><li>graphql_operation</li><li>graphql_name</li><li>graphql_root_fields</li></ul><p>The GraphQL properties correspond to the GraphQL query statement shown below:</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Nginx"><pre tabindex="0" class="prism-code language-Nginx codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">query getRepo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    owner {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><ul><li><code>graphql_operation</code> corresponds to <code>query</code></li><li><code>graphql_name</code> corresponds to <code>getRepo</code></li><li><code>graphql_root_fields</code> corresponds to <code>[&quot;owner&quot;, &quot;repo&quot;]</code></li></ul><p>You can set up a route for Apache APISIX to verify GraphQL matching capabilities with the following example:</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">curl http://127.0.0.1:9080/apisix/admin/routes/1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27; -X PUT -i -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;methods&quot;: [&quot;POST&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;uri&quot;: &quot;/graphql&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;vars&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_operation&quot;, &quot;==&quot;, &quot;query&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_name&quot;, &quot;==&quot;, &quot;getRepo&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_root_fields&quot;, &quot;has&quot;, &quot;owner&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;upstream&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;type&quot;: &quot;roundrobin&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;nodes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;192.168.1.200:4000&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>Then use GraphQL statements request to visit:</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">curl -H &#x27;content-type: application/graphql&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-X POST http://127.0.0.1:9080/graphql -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">query getRepo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    owner {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>If the match is successful, Apache APISIX proceeds to forward the request.</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 200 OK</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>Otherwise, terminate the request.</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 404 Not Found</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="advanced-operation">Advanced Operation<a aria-hidden="true" class="hash-link" href="#advanced-operation" title="Direct link to heading">‚Äã</a></h2><p>Apache APISIX can forward to different Upstreams according to different <code>graphql_names</code>, and perform different permission checks according to different <code>graphql_operation</code>. The following will show you the code configuration for this feature.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="match-upstream-with-graphql_name">Match Upstream with <code>graphql_name</code><a aria-hidden="true" class="hash-link" href="#match-upstream-with-graphql_name" title="Direct link to heading">‚Äã</a></h3><ol><li>Create the first Upstream:</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  curl http://192.168.1.200:9080/apisix/admin/upstreams/1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27; -X PUT -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;chash&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;key&quot;: &quot;remote_addr&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;nodes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;192.168.1.200:1980&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><ol start="2"><li>Create GraphQL route bound to the first Upstream service with <code>graphql_name</code> set to <code>getRepo111</code>:</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  curl http://192.168.1.200:9080/apisix/admin/routes/1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27; -X PUT -i -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;methods&quot;: [&quot;POST&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;uri&quot;: &quot;/graphql&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;vars&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_operation&quot;, &quot;==&quot;, &quot;query&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_name&quot;, &quot;==&quot;, &quot;getRepo111&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_root_fields&quot;, &quot;has&quot;, &quot;owner&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;upstream_id&quot;: &quot;1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><ol start="3"><li>Create the second Upstream:</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  curl http://192.168.1.200:9080/apisix/admin/upstreams/2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27; -X PUT -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;chash&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;key&quot;: &quot;remote_addr&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;nodes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;192.168.1.200:1981&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><ol start="4"><li>Create a GraphQL route bound to the second upstream service with <code>graphql_name</code> set to <code>getRepo222</code>:</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  curl http://192.168.1.200:9080/apisix/admin/routes/2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27; -X PUT -i -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;methods&quot;: [&quot;POST&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;uri&quot;: &quot;/graphql&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;vars&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_operation&quot;, &quot;==&quot;, &quot;query&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_name&quot;, &quot;==&quot;, &quot;getRepo222&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_root_fields&quot;, &quot;has&quot;, &quot;owner&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;upstream_id&quot;: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><ol start="5"><li>Test with the two <code>graphql_name</code> services created earlier, you can find that Apache APISIX can automatically select the forwarded Upstream based on the different <code>graphql_names</code> in the request.</li></ol><ul><li>If the request is this example:</li></ul><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  curl -i -H &#x27;content-type: application/graphql&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -X POST http://192.168.1.200:9080/graphql -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  query getRepo111 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      owner {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      repo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>Returns a response from upstream <code>192.168.1.200:1980</code>:</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  HTTP/1.1 200 OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ---URI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /graphql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ---Service Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Centos-port: 1980</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><ul><li>If the request is this example:</li></ul><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  curl -i -H &#x27;content-type: application/graphql&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -X POST http://192.168.1.200:9080/graphql -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  query getRepo222 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      owner {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      repo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>Returns a response from upstream <code>192.168.1.200:1981</code>:</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  HTTP/1.1 200 OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ---URI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /graphql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ---Service Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Centos-port: 1981</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="use-graphql_operation-for-different-permission-checks">Use <code>graphql_operation</code> for different permission checks<a aria-hidden="true" class="hash-link" href="#use-graphql_operation-for-different-permission-checks" title="Direct link to heading">‚Äã</a></h3><p>The above example provides a matching rule with <code>graphql_operation</code> as query, and now uses GraphQL requests in the form of <code>mutation</code>.</p><ol><li>Configure Apache APISIX:</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  curl http://192.168.1.200:9080/apisix/admin/routes/11 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27; -X PUT -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;methods&quot;: [&quot;POST&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;uri&quot;: &quot;/hello&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;vars&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_operation&quot;, &quot;==&quot;, &quot;mutation&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [&quot;graphql_name&quot;, &quot;==&quot;, &quot;repo&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;upstream&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;nodes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;192.168.1.200:1982&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;type&quot;: &quot;roundrobin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><ol start="2"><li>Use <code>mutation</code> request to verify Apache APISIX configuration:</li></ol><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  curl -i -H &#x27;content-type: application/graphql&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -X POST http://192.168.1.200:9080/hello -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mutation repo($ep: Episode!, $review: ReviewInput!) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    createReview(episode: $ep, review: $review) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stars</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      commentary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><p>The returned result is as follows:</p><div class="codeBlockContainer_5tM7"><div class="codeBlockContent_VFOK Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_sqlf thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Aq39"><span class="token-line" style="color:#393A34"><span class="token plain">  HTTP/1.1 200 OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ---URI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ---Service Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Centos-port: 1982</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_gLFX clean-btn">Copy</button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="collocation-plugins">Collocation Plugins<a aria-hidden="true" class="hash-link" href="#collocation-plugins" title="Direct link to heading">‚Äã</a></h2><p>Apache APISIX has a rich plugin ecosystem to apply different usage scenarios. If you add suitable plug-ins when using Apache APISIX + GraphQL, you can make more scenarios for the solution application.</p><p>This article only selects the following two types of plugins as examples.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="limit-count-plugin"><code>limit-count</code> Plugin<a aria-hidden="true" class="hash-link" href="#limit-count-plugin" title="Direct link to heading">‚Äã</a></h3><p>With the use of the <code>limit-count</code> plugin, the traffic is further limited after being forwarded by GraphQL matching rules. Thanks to the characteristics of Apache APISIX, dynamic, refined and distributed current and speed limiting can be achieved. For details, please refer to the <a href="https://apisix.apache.org/docs/apisix/plugins/limit-count" target="_blank" rel="noopener noreferrer">Apache APISIX official documentation</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="observability-plugin">Observability Plugin<a aria-hidden="true" class="hash-link" href="#observability-plugin" title="Direct link to heading">‚Äã</a></h3><p>Apache APISIX provides observability plug-ins including but not limited to  <a href="https://apisix.apache.org/docs/apisix/plugins/prometheus" target="_blank" rel="noopener noreferrer"><code>prometheus</code></a>„ÄÅ<a href="https://apisix.apache.org/docs/apisix/plugins/skywalking" target="_blank" rel="noopener noreferrer"><code>skywalking</code></a>, etc.,which can provide more monitoring indicator data for the system and facilitate the implementation of subsequent operation and maintenance of the system.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="summary">Summary<a aria-hidden="true" class="hash-link" href="#summary" title="Direct link to heading">‚Äã</a></h2><p>This article briefly introduces the application of GraphQL in Apache APISIX, and uses the actual code to show you the combination of Apache APISIX and GraphQL. Users can use GraphQL in Apache APISIX according to their own business needs and actual scenarios.</p><p>For more instructions and complete configuration information about GraphQL, please refer to the <a href="https://apisix.apache.org/docs/apisix/router-radixtree/#how-to-filter-route-by-graphql-attributes" target="_blank" rel="noopener noreferrer">Apache APISIX official documentation</a>.</p><p>Apache APISIX is also currently working on additional plugins to support the integration of additional services, so if you are interested, feel free to start a discussion in <a href="https://github.com/apache/apisix/discussions" target="_blank" rel="noopener noreferrer">GitHub Discussions</a>, or via the <a href="https://apisix.apache.org/docs/general/join" target="_blank" rel="noopener noreferrer">mailing list</a> to communicate.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/ecosystem/">Ecosystem</a></li></ul></div></footer></article><section class="shareSection_OUzq"><div><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button aria-label="reddit" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button></div></section><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022/03/03/weekly-report-0228/"><div class="pagination-nav__sublabel sublabel_M5Gs">Newer Post</div><div class="pagination-nav__label">Biweekly Report (Feb 15 - Feb 28)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022/03/02/zhongan-usercase-with-apache-apisix/"><div class="pagination-nav__sublabel sublabel_M5Gs">Older Post</div><div class="pagination-nav__label">Implement Traffic Governance in Internet Insurance with APISIX</div></a></div></nav></div></div></div></div><footer class="container_N-4m"><div class="linksRow_U0oR"><div class="linksCol_R6VE"><div>ASF</div><ul><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span></span><span>Foundation</span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer"><span></span><span>License</span></a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer"><span></span><span>Events</span></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer"><span></span><span>Security</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer"><span></span><span>Sponsorship</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer"><span></span><span>Thanks</span></a></li></ul></div><div class="linksCol_R6VE"><div>Community</div><ul><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer"><span></span><span>GitHub</span></a></li><li class="footer__item"><a href="/docs/general/join/"><span></span><span>Slack</span></a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer"><span></span><span>Twitter</span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCgPD18cMhOg5rmPVnQhAC8g" target="_blank" rel="noopener noreferrer"><span></span><span>YouTube</span></a></li></ul></div><div class="linksCol_R6VE"><div>More</div><ul><li class="footer__item"><a target="_parent" href="/blog/"><span></span><span>Blog</span></a></li><li class="footer__item"><a target="_parent" href="/showcase/"><span></span><span>Showcase</span></a></li><li class="footer__item"><a target="_parent" href="/plugins/"><span></span><span>Plugin Hub</span></a></li><li class="footer__item"><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer"><span></span><span>Roadmap</span></a></li></ul></div></div><div class="copyright_Bdi1"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span style="display:inline-block;width:231.25px;height:40px"></span></a><div>Copyright ¬© 2019-2026 The Apache Software Foundation. Apache APISIX, APISIX¬Æ, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></footer></div>
<script src="https://apisix-website-static.apiseven.com/assets/js/runtime~main.4bbc9839.js"></script>
<script src="https://apisix-website-static.apiseven.com/assets/js/main.a516b59b.js"></script>
</body>
</html>