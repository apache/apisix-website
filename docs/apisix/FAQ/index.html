<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.fd17476c3">
<meta name="robots" content="noindex, nofollow">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache APISIX™ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache APISIX™ Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WQLBQL6GY3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WQLBQL6GY3",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIX™" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/events/rss.xml" title="Apache APISIX™ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/events/atom.xml" title="Apache APISIX™ Blog Atom Feed">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"><title data-react-helmet="true">FAQ | Apache APISIX™</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-docs-apisix-current"><meta data-react-helmet="true" property="og:title" content="FAQ | Apache APISIX™"><meta data-react-helmet="true" name="description" content="&lt;!--"><meta data-react-helmet="true" property="og:description" content="&lt;!--"><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org//docs/apisix/FAQ"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org//docs/apisix/FAQ" hreflang="x-default"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org//zh/docs/apisix/FAQ" hreflang="zh"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org//docs/apisix/FAQ"><link rel="stylesheet" href="/assets/css/styles.6a71f002.css">
<link rel="preload" href="/assets/js/styles.5448b07f.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.b6b31c9b.js" as="script">
<link rel="preload" href="/assets/js/main.5785e5c6.js" as="script">
<link rel="preload" href="/assets/js/1.6d70a9ae.js" as="script">
<link rel="preload" href="/assets/js/2.2c09db00.js" as="script">
<link rel="preload" href="/assets/js/1be78505.592eb130.js" as="script">
<link rel="preload" href="/assets/js/d73fca9b.43fd6467.js" as="script">
<link rel="preload" href="/assets/js/17896441.c7f6dc3d.js" as="script">
<link rel="preload" href="/assets/js/162a65a3.aac528f9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_1oUP">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo2.svg" alt="Apache APISIX™" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo2.svg" alt="Apache APISIX™" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Apache APISIX™</strong></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/general/security">General</a></li><li><a class="dropdown__link" href="/docs/apisix/architecture-design">APISIX™️</a></li><li><a class="dropdown__link" href="/docs/dashboard/USER_GUIDE">APISIX™️ Dashboard</a></li><li><a href="https://apisix.apache.org/docs/ingress-controller/design/" target="_blank" rel="noopener noreferrer" class="dropdown__link">APISIX™️ Ingress Controller</a></li></ul></div><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/events">Events</a><a class="navbar__item navbar__link" href="/downloads">Downloads</a><a class="navbar__item navbar__link" href="/team">Team</a><a class="navbar__item navbar__link" href="/help">Help</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/docs/apisix/FAQ" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh/docs/apisix/FAQ" target="_self" rel="noopener noreferrer" class="dropdown__link">简体中文</a></li></ul></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><div class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></div></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo2.svg" alt="Apache APISIX™" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo2.svg" alt="Apache APISIX™" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Apache APISIX™</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a aria-current="page" class="menu__link menu__link--sublist navbar__link--active" role="button" href="/docs">Docs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/general/security">General</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/architecture-design">APISIX™️</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/dashboard/USER_GUIDE">APISIX™️ Dashboard</a></li><li class="menu__list-item"><a href="https://apisix.apache.org/docs/ingress-controller/design/" target="_blank" rel="noopener noreferrer" class="menu__link">APISIX™️ Ingress Controller</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/events">Events</a></li><li class="menu__list-item"><a class="menu__link" href="/downloads">Downloads</a></li><li class="menu__list-item"><a class="menu__link" href="/team">Team</a></li><li class="menu__list-item"><a class="menu__link" href="/help">Help</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Languages</span></span></a><ul class="menu__list"><li class="menu__list-item"><a href="/docs/apisix/FAQ" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active">English</a></li><li class="menu__list-item"><a href="/zh/docs/apisix/FAQ" target="_self" rel="noopener noreferrer" class="menu__link">简体中文</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_3AUJ"><div class="docSidebarContainer_2LAn" role="complementary"><div class="sidebar_3jCp"><div class="sidebarVersionSwitch_m-Df">Version: <a class="navbar__item navbar__link" href="/docs/apisix/architecture-design">Next</a></div><div class="menu menu--responsive thin-scrollbar menu_1DcY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_wchL" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/architecture-design">Architecture Design</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/how-to-build">How to build Apache APISIX</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">General</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/batch-requests">batch-requests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/serverless">serverless</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/redirect">redirect</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Transformation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/response-rewrite">response-rewrite</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/proxy-rewrite">proxy-rewrite</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/grpc-transcode">grpc-transcode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/fault-injection">fault-injection</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Authentication</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/key-auth">key-auth</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/jwt-auth">jwt-auth</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/basic-auth">basic-auth</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/authz-keycloak">authz-keycloak</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/wolf-rbac">wolf-rbac</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/openid-connect">openid-connect</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Security</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/cors">cors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/uri-blocker">uri-blocker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/ip-restriction">ip-restriction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/referer-restriction">referer-restriction</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Traffic</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/limit-req">limit-req</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/limit-conn">limit-conn</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/limit-count">limit-connt</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/proxy-cache">proxy-cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/request-validation">request-validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/proxy-mirror">proxy-mirror</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/api-breaker">api-breaker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/traffic-split">traffic-split</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Monitoring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/prometheus">prometheus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/zipkin">Zipkin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/skywalking">skywalking</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Loggers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/http-logger">http-logger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/tcp-logger">tcp-logger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/kafka-logger">kafka-logger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/udp-logger">udp-logger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/syslog">syslog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/apisix/plugins/log-rotate">log-rotate</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/admin-api">Admin API</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/control-api">Control API</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/health-check">Health Check</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/router-radixtree">Router radixtree</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/stand-alone">Stand-alone mode</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/stream-proxy">Stream Proxy</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/grpc-proxy">gRPC Proxy</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/customize-nginx-configuration">Customize Nginx configuration</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/https">HTTPS</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/benchmark">Benchmark</a></li><li class="menu__list-item"><a href="https://github.com/apache/apisix/blob/master/CODE_STYLE.md" target="_blank" rel="noreferrer noopener" class="menu__link">CODE_STYLE</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apisix/debug-function">Debug Function</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs/apisix/FAQ">FAQ</a></li><li class="menu__list-item"><a href="https://github.com/apache/apisix/blob/master/CHANGELOG.md" target="_blank" rel="noreferrer noopener" class="menu__link">CHANGELOG</a></li></ul></div></div></div><main class="docMainContainer_2AUC"><div class="container padding-vert--lg docItemWrapper_1WZa"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">FAQ</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="why-a-new-api-gateway"></a>Why a new API gateway?<a class="hash-link" href="#why-a-new-api-gateway" title="Direct link to heading">#</a></h2><p>There are new requirements for API gateways in the field of microservices: higher flexibility, higher performance requirements, and cloud native.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="what-are-the-differences-between-apisix-and-other-api-gateways"></a>What are the differences between APISIX and other API gateways?<a class="hash-link" href="#what-are-the-differences-between-apisix-and-other-api-gateways" title="Direct link to heading">#</a></h2><p>APISIX is based on etcd to save and synchronize configuration, not relational databases such as Postgres or MySQL.</p><p>This not only eliminates polling, makes the code more concise, but also makes configuration synchronization more real-time. At the same time, there will be no single point in the system, which is more usable.</p><p>In addition, APISIX has dynamic routing and hot loading of plug-ins, which is especially suitable for API management under micro-service system.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="whats-the-performance-of-apisix"></a>What&#x27;s the performance of APISIX?<a class="hash-link" href="#whats-the-performance-of-apisix" title="Direct link to heading">#</a></h2><p>One of the goals of APISIX design and development is the highest performance in the industry. Specific test data can be found here：<a href="https://github.com/apache/apisix/blob/master/benchmark.md" target="_blank" rel="noopener noreferrer">benchmark</a></p><p>APISIX is the highest performance API gateway with a single-core QPS of 23,000, with an average delay of only 0.6 milliseconds.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="does-apisix-have-a-console-interface"></a>Does APISIX have a console interface?<a class="hash-link" href="#does-apisix-have-a-console-interface" title="Direct link to heading">#</a></h2><p>Yes, in version 0.6 we have dashboard built in, you can operate APISIX through the web interface.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="can-i-write-my-own-plugin"></a>Can I write my own plugin?<a class="hash-link" href="#can-i-write-my-own-plugin" title="Direct link to heading">#</a></h2><p>Of course, APISIX provides flexible custom plugins for developers and businesses to write their own logic.</p><p><a href="/docs/apisix/plugin-develop">How to write plugin</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="why-we-choose-etcd-as-the-configuration-center"></a>Why we choose etcd as the configuration center?<a class="hash-link" href="#why-we-choose-etcd-as-the-configuration-center" title="Direct link to heading">#</a></h2><p>For the configuration center, configuration storage is only the most basic function, and APISIX also needs the following features:</p><ol><li>Cluster</li><li>Transactions</li><li>Multi-version Concurrency Control</li><li>Change Notification</li><li>High Performance</li></ol><p>See more <a href="https://github.com/etcd-io/etcd/blob/master/Documentation/learning/why.md#comparison-chart" target="_blank" rel="noopener noreferrer">etcd why</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="why-is-it-that-installing-apisix-dependencies-with-luarocks-causes-timeout-slow-or-unsuccessful-installation"></a>Why is it that installing APISIX dependencies with Luarocks causes timeout, slow or unsuccessful installation?<a class="hash-link" href="#why-is-it-that-installing-apisix-dependencies-with-luarocks-causes-timeout-slow-or-unsuccessful-installation" title="Direct link to heading">#</a></h2><p>There are two possibilities when encountering slow luarocks:</p><ol><li>Server used for luarocks installation is blocked</li><li>There is a place between your network and github server to block the &#x27;git&#x27; protocol</li></ol><p>For the first problem, you can use https_proxy or use the <code>--server</code> option to specify a luarocks server that you can access or access faster.
Run the <code>luarocks config rocks_servers</code> command(this command is supported after luarocks 3.0) to see which server are available.</p><p>If using a proxy doesn&#x27;t solve this problem, you can add <code>--verbose</code> option during installation to see exactly how slow it is. Excluding the first case, only the second that the <code>git</code> protocol is blocked. Then we can run <code>git config --global url.&quot;https://&quot;.insteadOf git://</code> to using the &#x27;HTTPS&#x27; protocol instead of <code>git</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-support-gray-release-via-apisix"></a>How to support gray release via APISIX?<a class="hash-link" href="#how-to-support-gray-release-via-apisix" title="Direct link to heading">#</a></h2><p>An example, <code>foo.com/product/index.html?id=204&amp;page=2</code>, gray release based on <code>id</code> in the query string in URL as a condition：</p><ol><li>Group A：id &lt;= 1000</li><li>Group B：id &gt; 1000</li></ol><p>There are two different ways to do this：</p><ol><li>Use the <code>vars</code> field of route to do it.</li></ol><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -i http://127.0.0.1:9080/apisix/admin/routes/1 -H </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;uri&quot;: &quot;/index.html&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;vars&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        [&quot;arg_id&quot;, &quot;&lt;=&quot;, &quot;1000&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;plugins&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;redirect&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;uri&quot;: &quot;/test?group_id=1&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">}&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -i http://127.0.0.1:9080/apisix/admin/routes/2 -H </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;uri&quot;: &quot;/index.html&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;vars&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        [&quot;arg_id&quot;, &quot;&gt;&quot;, &quot;1000&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;plugins&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;redirect&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;uri&quot;: &quot;/test?group_id=2&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Here is the operator list of current <code>lua-resty-radixtree</code>：
<a href="https://github.com/iresty/lua-resty-radixtree#operator-list" target="_blank" rel="noopener noreferrer">https://github.com/iresty/lua-resty-radixtree#operator-list</a></p><ol start="2"><li>Use <code>traffic-split</code> plugin to do it.</li></ol><p>Please refer to the <a href="/docs/apisix/plugins/traffic-split">traffic-split.md</a> plugin documentation for usage examples.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-redirect-http-to-https-via-apisix"></a>How to redirect http to https via APISIX?<a class="hash-link" href="#how-to-redirect-http-to-https-via-apisix" title="Direct link to heading">#</a></h2><p>An example, redirect <code>http://foo.com</code> to <code>https://foo.com</code></p><p>There are several different ways to do this.</p><ol><li>Directly use the <code>http_to_https</code> in <code>redirect</code> plugin：</li></ol><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> http://127.0.0.1:9080/apisix/admin/routes/1  -H </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;uri&quot;: &quot;/hello&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;host&quot;: &quot;foo.com&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;plugins&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;redirect&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;http_to_https&quot;: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="2"><li>Use with advanced routing rule <code>vars</code> with <code>redirect</code> plugin:</li></ol><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -i http://127.0.0.1:9080/apisix/admin/routes/1  -H </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;uri&quot;: &quot;/hello&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;host&quot;: &quot;foo.com&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;vars&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;scheme&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;==&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;http&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;plugins&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;redirect&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;uri&quot;: &quot;https://</span><span class="token string variable" style="color:rgb(191, 199, 213)">$host</span><span class="token string variable" style="color:rgb(191, 199, 213)">$request_uri</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;ret_code&quot;: 301</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="3"><li><code>serverless</code> plugin：</li></ol><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -i http://127.0.0.1:9080/apisix/admin/routes/1  -H </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;uri&quot;: &quot;/hello&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;plugins&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;serverless-pre-function&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;phase&quot;: &quot;rewrite&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;functions&quot;: [&quot;return function() if ngx.var.scheme == </span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string" style="color:rgb(195, 232, 141)">http</span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string" style="color:rgb(195, 232, 141)"> and ngx.var.host == </span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string" style="color:rgb(195, 232, 141)">foo.com</span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string" style="color:rgb(195, 232, 141)"> then ngx.header[</span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string" style="color:rgb(195, 232, 141)">Location</span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string" style="color:rgb(195, 232, 141)">] = </span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string" style="color:rgb(195, 232, 141)">https://foo.com</span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string" style="color:rgb(195, 232, 141)"> .. ngx.var.request_uri; ngx.exit(ngx.HTTP_MOVED_PERMANENTLY); end; end&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Then test it to see if it works：</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -i -H </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Host: foo.com&#x27;</span><span class="token plain"> http://127.0.0.1:9080/hello</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The response body should be:</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">HTTP/1.1 301 Moved Permanently</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Date: Mon, 18 May 2020 02:56:04 GMT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: text/html</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Length: 166</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Connection: keep-alive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Location: https://foo.com/hello</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Server: APISIX web server</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;html&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;head&gt;&lt;title&gt;301 Moved Permanently&lt;/title&gt;&lt;/head&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;body&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;center&gt;&lt;h1&gt;301 Moved Permanently&lt;/h1&gt;&lt;/center&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;hr&gt;&lt;center&gt;openresty&lt;/center&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/body&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/html&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-fix-openresty-installation-failure-on-macos-1015"></a>How to fix OpenResty Installation Failure on MacOS 10.15<a class="hash-link" href="#how-to-fix-openresty-installation-failure-on-macos-1015" title="Direct link to heading">#</a></h2><p>When you install the OpenResty on MacOs 10.15, you may face this error</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> brew </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> openresty</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Updating Homebrew</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> Auto-updated Homebrew</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Updated </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> tap </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">homebrew/cask</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">No changes to formulae.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> Installing openresty from openresty/brew</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Warning: A newer Command Line Tools release is available.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Update them from Software Update </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> System Preferences or</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">https://developer.apple.com/download/more/.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> Downloading https://openresty.org/download/openresty-1.15.8.2.tar.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Already downloaded: /Users/wusheng/Library/Caches/Homebrew/downloads/4395089f0fd423261d4f1124b7beb0f69e1121e59d399e89eaa6e25b641333bc--openresty-1.15.8.2.tar.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> ./configure -j8 --prefix</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/usr/local/Cellar/openresty/1.15.8.2 --pid-path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/usr/local/var/run/openresty.pid --lock-path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/usr/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Last </span><span class="token number" style="color:rgb(247, 140, 108)">15</span><span class="token plain"> lines from /Users/wusheng/Library/Logs/Homebrew/openresty/01.configure:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DYNASM    host/buildvm_arch.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HOSTCC    host/buildvm.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HOSTLINK  host/buildvm</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BUILDVM   lj_vm.S</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BUILDVM   lj_ffdef.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BUILDVM   lj_bcdef.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BUILDVM   lj_folddef.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BUILDVM   lj_recdef.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BUILDVM   lj_libdef.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BUILDVM   jit/vmdef.lua</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">make</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">: *** </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">lj_folddef.h</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Segmentation fault: </span><span class="token number" style="color:rgb(247, 140, 108)">11</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">make</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">: *** Deleting </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"> `lj_folddef.h</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">make[1]: *** Waiting for unfinished jobs....</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">make: *** [default] Error 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ERROR: failed to run command: gmake -j8 TARGET_STRIP=@: CCDEBUG=-g XCFLAGS=&#x27;</span><span class="token plain">-msse4.2 -DLUAJIT_NUMMODE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> -DLUAJIT_ENABLE_LUA52COMPAT</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27; CC=cc PREFIX=/usr/local/Cellar/openresty/1.15.8.2/luajit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="display:inline-block;color:rgb(195, 232, 141)">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">If reporting this issue please do so at (not Homebrew/brew or Homebrew/core):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  https://github.com/openresty/homebrew-brew/issues</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="display:inline-block;color:rgb(195, 232, 141)">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">These open issues may also help:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">Can&#x27;</span><span class="token plain">t </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> openresty on macOS </span><span class="token number" style="color:rgb(247, 140, 108)">10.15</span><span class="token plain"> https://github.com/openresty/homebrew-brew/issues/10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">The openresty-debug package should use openresty-openssl-debug instead https://github.com/openresty/homebrew-brew/issues/3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Fails to </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> OpenResty https://github.com/openresty/homebrew-brew/issues/5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Error: A newer Command Line Tools release is available.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Update them from Software Update </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> System Preferences or</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">https://developer.apple.com/download/more/.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This is an OS incompatible issue, you could fix by these two steps</p><ol><li><code>brew edit openresty/brew/openresty</code></li><li>add <code>\ -fno-stack-check</code> in with-luajit-xcflags line.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-change-the-log-level"></a>How to change the log level?<a class="hash-link" href="#how-to-change-the-log-level" title="Direct link to heading">#</a></h2><p>The default log level for APISIX is <code>warn</code>. However You can change the log level to <code>info</code> if you want to trace the messages print by <code>core.log.info</code>.</p><p>Steps:</p><ol><li><p>Modify the parameter <code>error_log_level: &quot;warn&quot;</code> to <code>error_log_level: &quot;info&quot;</code> in conf/config.yaml</p></li><li><p>Reload or restart APISIX</p></li></ol><p>Now you can trace the info level log in logs/error.log.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-reload-your-own-plugin"></a>How to reload your own plugin?<a class="hash-link" href="#how-to-reload-your-own-plugin" title="Direct link to heading">#</a></h2><p>The Apache APISIX plugin supports hot reloading.
See the <code>Hot reload</code> section in <a href="/docs/apisix/plugins">plugins</a> for how to do that.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-make-apisix-listen-on-multiple-ports-when-handling-http-or-https-requests"></a>How to make APISIX listen on multiple ports when handling HTTP or HTTPS requests?<a class="hash-link" href="#how-to-make-apisix-listen-on-multiple-ports-when-handling-http-or-https-requests" title="Direct link to heading">#</a></h2><p>By default, APISIX only listens on port 9080 when handling HTTP requests. If you want APISIX to listen on multiple ports, you need to modify the relevant parameters in the configuration file as follows:</p><ol><li><p>Modify the parameter of HTTP port listen <code>node_listen</code> in <code>conf/config.yaml</code>, for example:</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> apisix:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   node_listen:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     - 9080</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     - 9081</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     - 9082</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Handling HTTPS requests is similar, modify the parameter of HTTPS port listen <code>ssl.listen_port</code> in <code>conf/config.yaml</code>, for example:</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">apisix:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ssl:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    listen_port:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - 9443</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - 9444</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - 9445</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Reload or restart APISIX</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-does-apisix-use-etcd-to-achieve-millisecond-level-configuration-synchronization"></a>How does APISIX use etcd to achieve millisecond-level configuration synchronization<a class="hash-link" href="#how-does-apisix-use-etcd-to-achieve-millisecond-level-configuration-synchronization" title="Direct link to heading">#</a></h2><p>etcd provides subscription functions to monitor whether the specified keyword or directory is changed (for example: <a href="https://github.com/api7/lua-resty-etcd/blob/master/api_v3.md#watch" target="_blank" rel="noopener noreferrer">watch</a>, <a href="https://github.com/api7/lua-resty-etcd/blob/master/api_v3.md#watchdir" target="_blank" rel="noopener noreferrer">watchdir</a>).</p><p>APISIX uses <a href="https://github.com/api7/lua-resty-etcd/blob/master/api_v3.md#watchdir" target="_blank" rel="noopener noreferrer">etcd.watchdir</a> to monitor directory content changes:</p><ul><li>If there is no data update in the monitoring directory: the process will be blocked until timeout or other errors occurred.</li><li>If the monitoring directory has data updates: etcd will return the new subscribed data immediately (in milliseconds), and APISIX will update it to the memory cache.</li></ul><p>With the help of etcd which incremental notification feature is millisecond-level, APISIX achieve millisecond-level of configuration synchronization.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-customize-the-apisix-instance-id"></a>How to customize the APISIX instance id?<a class="hash-link" href="#how-to-customize-the-apisix-instance-id" title="Direct link to heading">#</a></h2><p>By default, APISIX will read the instance id from <code>conf/apisix.uid</code>. If it is not found, and no id is configured, APISIX will generate a <code>uuid</code> as the instance id.</p><p>If you want to specify a meaningful id to bind APISIX instance to your internal system, you can configure it in <code>conf/config.yaml</code>, for example:</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">apisix:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  id: &quot;your-meaningful-id&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="why-there-are-a-lot-of-failed-to-fetch-data-from-etcd-failed-to-read-etcd-dir-etcd-key-xxxxxx-errors-in-errorlog"></a>Why there are a lot of &quot;failed to fetch data from etcd, failed to read etcd dir, etcd key: xxxxxx&quot; errors in error.log?<a class="hash-link" href="#why-there-are-a-lot-of-failed-to-fetch-data-from-etcd-failed-to-read-etcd-dir-etcd-key-xxxxxx-errors-in-errorlog" title="Direct link to heading">#</a></h2><p>First please make sure the network between APISIX and etcd cluster is not partitioned.</p><p>If the network is healthy, please check whether your etcd cluster enables the <a href="https://etcd.io/docs/v3.4.0/dev-guide/api_grpc_gateway/" target="_blank" rel="noopener noreferrer">gRPC gateway</a>.  However, The default case for this feature is different when use command line options or configuration file to start etcd server.</p><ol><li>When command line options is in use, this feature is enabled by default, the related option is <code>--enable-grpc-gateway</code>.</li></ol><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">etcd --enable-grpc-gateway --data-dir=/path/to/data</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Note this option is not shown in the output of <code>etcd --help</code>.</p><ol start="2"><li>When configuration file is used, this feature is disabled by default, please enable <code>enable-grpc-gateway</code> explicitly.</li></ol><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># etcd.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;enable-grpc-gateway&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;data-dir&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/path/to/data&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Indeed this distinction was eliminated by etcd in their master branch, but not backport to announced versions, so be care when deploy your etcd cluster.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-set-up-high-available-apache-apisix-clusters"></a>How to set up high available Apache APISIX clusters?<a class="hash-link" href="#how-to-set-up-high-available-apache-apisix-clusters" title="Direct link to heading">#</a></h2><p>The high availability of APISIX can be divided into two parts:</p><ol><li><p>The data plane of Apache APISIX is stateless and can be elastically scaled at will. Just add a layer of LB in front.</p></li><li><p>The control plane of Apache APISIX relies on the highly available implementation of <code>etcd cluster</code> and does not require any relational database dependency.</p></li></ol></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/apisix/debug-function"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Debug Function</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-a-new-api-gateway" class="table-of-contents__link">Why a new API gateway?</a></li><li><a href="#what-are-the-differences-between-apisix-and-other-api-gateways" class="table-of-contents__link">What are the differences between APISIX and other API gateways?</a></li><li><a href="#whats-the-performance-of-apisix" class="table-of-contents__link">What&#39;s the performance of APISIX?</a></li><li><a href="#does-apisix-have-a-console-interface" class="table-of-contents__link">Does APISIX have a console interface?</a></li><li><a href="#can-i-write-my-own-plugin" class="table-of-contents__link">Can I write my own plugin?</a></li><li><a href="#why-we-choose-etcd-as-the-configuration-center" class="table-of-contents__link">Why we choose etcd as the configuration center?</a></li><li><a href="#why-is-it-that-installing-apisix-dependencies-with-luarocks-causes-timeout-slow-or-unsuccessful-installation" class="table-of-contents__link">Why is it that installing APISIX dependencies with Luarocks causes timeout, slow or unsuccessful installation?</a></li><li><a href="#how-to-support-gray-release-via-apisix" class="table-of-contents__link">How to support gray release via APISIX?</a></li><li><a href="#how-to-redirect-http-to-https-via-apisix" class="table-of-contents__link">How to redirect http to https via APISIX?</a></li><li><a href="#how-to-fix-openresty-installation-failure-on-macos-1015" class="table-of-contents__link">How to fix OpenResty Installation Failure on MacOS 10.15</a></li><li><a href="#how-to-change-the-log-level" class="table-of-contents__link">How to change the log level?</a></li><li><a href="#how-to-reload-your-own-plugin" class="table-of-contents__link">How to reload your own plugin?</a></li><li><a href="#how-to-make-apisix-listen-on-multiple-ports-when-handling-http-or-https-requests" class="table-of-contents__link">How to make APISIX listen on multiple ports when handling HTTP or HTTPS requests?</a></li><li><a href="#how-does-apisix-use-etcd-to-achieve-millisecond-level-configuration-synchronization" class="table-of-contents__link">How does APISIX use etcd to achieve millisecond-level configuration synchronization</a></li><li><a href="#how-to-customize-the-apisix-instance-id" class="table-of-contents__link">How to customize the APISIX instance id?</a></li><li><a href="#why-there-are-a-lot-of-failed-to-fetch-data-from-etcd-failed-to-read-etcd-dir-etcd-key-xxxxxx-errors-in-errorlog" class="table-of-contents__link">Why there are a lot of &quot;failed to fetch data from etcd, failed to read etcd dir, etcd key: xxxxxx&quot; errors in error.log?</a></li><li><a href="#how-to-set-up-high-available-apache-apisix-clusters" class="table-of-contents__link">How to set up high available Apache APISIX clusters?</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">ASF</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation</a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License</a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events</a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issue Tracker</a></li><li class="footer__item"><a href="https://apisix.slack.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://apisix.apache.org/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/img/asf_logo_wide_small.png" alt="Apache Software Foundation" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/asf_logo_wide_small.png" alt="Apache Software Foundation" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright © 2019-2021 The Apache Software Foundation. Apache APISIX, APISIX™, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/styles.5448b07f.js"></script>
<script src="/assets/js/runtime~main.b6b31c9b.js"></script>
<script src="/assets/js/main.5785e5c6.js"></script>
<script src="/assets/js/1.6d70a9ae.js"></script>
<script src="/assets/js/2.2c09db00.js"></script>
<script src="/assets/js/1be78505.592eb130.js"></script>
<script src="/assets/js/d73fca9b.43fd6467.js"></script>
<script src="/assets/js/17896441.c7f6dc3d.js"></script>
<script src="/assets/js/162a65a3.aac528f9.js"></script>
</body>
</html>