<!doctype html>
<html lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<meta name="robots" content="noindex, nofollow">
<link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="Apache APISIXâ„¢ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="Apache APISIXâ„¢ Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WQLBQL6GY3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WQLBQL6GY3",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIXâ„¢" href="/zh/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/zh/events/rss.xml" title="Apache APISIXâ„¢ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/events/atom.xml" title="Apache APISIXâ„¢ Blog Atom Feed">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"><title data-react-helmet="true">æ’ä»¶å¼€å‘ | Apache APISIXâ„¢</title><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org//zh/docs/apisix/next/plugin-develop"><meta data-react-helmet="true" name="docsearch:language" content="zh"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-docs-apisix-current"><meta data-react-helmet="true" property="og:title" content="æ’ä»¶å¼€å‘ | Apache APISIXâ„¢"><meta data-react-helmet="true" name="description" content="&lt;!--"><meta data-react-helmet="true" property="og:description" content="&lt;!--"><meta data-react-helmet="true" property="og:image" content="https://apisix.apache.org//zh/img/favicon.png"><meta data-react-helmet="true" name="twitter:image" content="https://apisix.apache.org//zh/img/favicon.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/zh/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org//zh/docs/apisix/next/plugin-develop"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org//docs/apisix/next/plugin-develop" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org//zh/docs/apisix/next/plugin-develop" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org//docs/apisix/next/plugin-develop" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh/assets/css/styles.f0718333.css">
<link rel="preload" href="/zh/assets/js/runtime~main.087525af.js" as="script">
<link rel="preload" href="/zh/assets/js/main.f87d8e84.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><img src="/zh/img/logo2.svg" alt="Apache APISIXâ„¢" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh/img/logo2.svg" alt="Apache APISIXâ„¢" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Apache APISIXâ„¢</strong></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh/docs">æ–‡æ¡£</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/apisix/getting-started">APISIXâ„¢ï¸</a></li><li><a class="dropdown__link" href="/zh/docs/dashboard/USER_GUIDE">APISIXâ„¢ï¸ Dashboard</a></li><li><a class="dropdown__link" href="/zh/docs/ingress-controller/getting-started/">APISIXâ„¢ï¸ Ingress Controller</a></li><li><a class="dropdown__link" href="/zh/docs/helm-chart/apisix/">Apacheâ„¢ï¸ APISIX Helm Charts</a></li><li><a class="dropdown__link" href="/zh/docs/docker/build/">Apacheâ„¢ï¸ APISIX Docker</a></li><li><a class="dropdown__link" href="/zh/docs/apisix-java-plugin-runner/development/">Apacheâ„¢ï¸ APISIX Java Plugin Runner</a></li><li><a class="dropdown__link" href="/zh/docs/general/security">General</a></li></ul></div><a class="navbar__item navbar__link" href="/zh/blog">åšå®¢</a><a class="navbar__item navbar__link" href="/zh/events">Events</a><a class="navbar__item navbar__link" href="/zh/downloads">ä¸‹è½½</a><a class="navbar__item navbar__link" href="/zh/team">å›¢é˜Ÿ</a><a class="navbar__item navbar__link" href="/zh/help">Help</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>ç®€ä½“ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/docs/apisix/next/plugin-develop" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh/docs/apisix/next/plugin-develop" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></div><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/zh/"><img src="/zh/img/logo2.svg" alt="Apache APISIXâ„¢" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh/img/logo2.svg" alt="Apache APISIXâ„¢" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Apache APISIXâ„¢</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a aria-current="page" class="menu__link menu__link--sublist navbar__link--active" role="button" href="/zh/docs">æ–‡æ¡£</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/zh/docs/apisix/getting-started">APISIXâ„¢ï¸</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/dashboard/USER_GUIDE">APISIXâ„¢ï¸ Dashboard</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/ingress-controller/getting-started/">APISIXâ„¢ï¸ Ingress Controller</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/helm-chart/apisix/">Apacheâ„¢ï¸ APISIX Helm Charts</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/docker/build/">Apacheâ„¢ï¸ APISIX Docker</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/apisix-java-plugin-runner/development/">Apacheâ„¢ï¸ APISIX Java Plugin Runner</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/general/security">General</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/zh/blog">åšå®¢</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/events">Events</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/downloads">ä¸‹è½½</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/team">å›¢é˜Ÿ</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/help">Help</a></li><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Languages</span></span></a><ul class="menu__list"><li class="menu__list-item"><a href="/docs/apisix/next/plugin-develop" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">English</a></li><li class="menu__list-item"><a href="/zh/docs/apisix/next/plugin-develop" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_3AUJ"><div class="docSidebarContainer_2LAn" role="complementary"><div class="sidebar_3jCp sidebarWithHideableNavbar_Uxjr"><a tabindex="-1" class="sidebarLogo_8bKs" href="/zh/"><img src="/zh/img/logo2.svg" alt="Apache APISIXâ„¢" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/zh/img/logo2.svg" alt="Apache APISIXâ„¢" class="themedImage_1VuW themedImage--dark_hz6m"><strong>Apache APISIXâ„¢</strong></a><div class="sidebarVersionSwitch_m-Df">Version:<div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__item navbar__link" href="/zh/docs/apisix/next/architecture-design/apisix">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh/docs/apisix/next/plugin-develop">Next</a></li><li><a class="dropdown__link" href="/zh/docs/apisix/plugin-develop">2.7</a></li><li><a class="dropdown__link" href="/zh/docs/apisix/2.6/plugin-develop">2.6</a></li><li><a class="dropdown__link" href="/zh/docs/apisix/2.5/plugin-develop">2.5</a></li><li><a class="dropdown__link" href="/zh/docs/apisix/2.4/plugin-develop">2.4</a></li></ul></div></div><div class="menu menu--responsive thin-scrollbar menu_1DcY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_wchL" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Architecture Design</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/apisix">APISIX</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/route">Route</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/plugin">Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/script">Script</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/service">Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/consumer">Consumer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/upstream">Upstream</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/global-rule">Global rule</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/plugin-config">Plugin Config</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/router">Router</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/architecture-design/debug-mode">Debug Mode</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/apisix/next/getting-started">å¿«é€Ÿå…¥é—¨æŒ‡å—</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/apisix/next/how-to-build">å¦‚ä½•æ„å»º Apache APISIX</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">General</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/batch-requests">batch-requests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/serverless">serverless</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/redirect">redirect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/echo">echo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/server-info">server-info</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/ext-plugin-pre-req">ext-plugin-pre-req</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/ext-plugin-post-req">ext-plugin-post-req</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Transformation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/response-rewrite">response-rewrite</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/proxy-rewrite">proxy-rewrite</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/grpc-transcode">grpc-transcode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/fault-injection">fault-injection</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Authentication</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/key-auth">key-auth</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/jwt-auth">jwt-auth</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/basic-auth">basic-auth</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/authz-keycloak">authz-keycloak</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/wolf-rbac">wolf-rbac</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/openid-connect">openid-connect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/hmac-auth">hmac-auth</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Security</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/cors">cors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/uri-blocker">uri-blocker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/ip-restriction">ip-restriction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/referer-restriction">referer-restriction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/consumer-restriction">consumer-restriction</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Traffic</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/limit-req">limit-req</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/limit-conn">limit-conn</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/limit-count">limit-count</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/proxy-cache">proxy-cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/request-validation">request-validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/proxy-mirror">proxy-mirror</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/api-breaker">api-breaker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/traffic-split">traffic-split</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/request-id">request-id</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/client-control">client-control</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Monitoring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/prometheus">prometheus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/zipkin">zipkin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/skywalking">skywalking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/node-status">node-status</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Loggers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/http-logger">http-logger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/tcp-logger">tcp-logger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/kafka-logger">kafka-logger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/udp-logger">udp-logger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/syslog">syslog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/log-rotate">log-rotate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/error-log-logger">error-log-logger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/sls-logger">sls-logger</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Other Protocols</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/dubbo-proxy">dubbo-proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/plugins/mqtt-proxy">mqtt-proxy</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/admin-api">Admin API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/control-api">Control API</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/apisix/next/FAQ">å¸¸è§é—®é¢˜</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Others</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Discovery</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/discovery">é›†æˆæœåŠ¡å‘ç°æ³¨å†Œä¸­å¿ƒ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/discovery/dns">DNS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/discovery/consul_kv">consul_kv</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/discovery/nacos">nacos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh/docs/apisix/next/discovery/eureka">eureka</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/health-check">å¥åº·æ£€æŸ¥</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/router-radixtree">Router radixtree</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/stand-alone">Stand-alone mode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/stream-proxy">TCP/UDP åŠ¨æ€ä»£ç†</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/grpc-proxy">gRPC ä»£ç†</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/customize-nginx-configuration">è‡ªå®šä¹‰ Nginx é…ç½®</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/certificate">è¯ä¹¦</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/batch-processor">æ‰¹å¤„ç†æœº</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/benchmark">å‹åŠ›æµ‹è¯•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/install-dependencies">å®‰è£…ä¾èµ–</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/zh/docs/apisix/next/plugin-develop">æ’ä»¶å¼€å‘</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/external-plugin">External Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/plugin-interceptors">æ’ä»¶æ‹¦æˆªå™¨</a></li><li class="menu__list-item"><a href="https://github.com/apache/apisix/blob/master/CODE_STYLE.md" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="0">CODE_STYLE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/aws">Running APISIX in AWS with AWS CDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/mtls">TLS åŒå‘è®¤è¯</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/debug-function">è°ƒè¯•åŠŸèƒ½</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/next/profile">åŸºäºç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®æ–‡ä»¶åˆ‡æ¢</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/apache/apisix/blob/master/CHANGELOG.md" target="_blank" rel="noreferrer noopener" class="menu__link">CHANGELOG</a></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_3okl"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_1LB5" aria-label="Collapse sidebar"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_2AUC"><div class="container padding-vert--lg docItemWrapper_1WZa"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for Apache APISIXâ„¢ <strong>Next</strong> version.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/zh/docs/apisix/plugin-develop">latest version</a></strong> (2.7).</div></div><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_3a4h">æ’ä»¶å¼€å‘</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="ç›®å½•"></a>ç›®å½•<a class="hash-link" href="#ç›®å½•" title="Direct link to heading">#</a></h2><ul><li><a href="#%E7%9B%AE%E5%BD%95">ç›®å½•</a></li><li><a href="#%E6%A3%80%E6%9F%A5%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96">æ£€æŸ¥å¤–éƒ¨ä¾èµ–</a></li><li><a href="#%E6%8F%92%E4%BB%B6%E5%91%BD%E5%90%8D%E4%B8%8E%E9%85%8D%E7%BD%AE">æ’ä»¶å‘½åä¸é…ç½®</a></li><li><a href="#%E9%85%8D%E7%BD%AE%E6%8F%8F%E8%BF%B0%E4%B8%8E%E6%A0%A1%E9%AA%8C">é…ç½®æè¿°ä¸æ ¡éªŒ</a></li><li><a href="#%E7%A1%AE%E5%AE%9A%E6%89%A7%E8%A1%8C%E9%98%B6%E6%AE%B5">ç¡®å®šæ‰§è¡Œé˜¶æ®µ</a></li><li><a href="#%E7%BC%96%E5%86%99%E6%89%A7%E8%A1%8C%E9%80%BB%E8%BE%91">ç¼–å†™æ‰§è¡Œé€»è¾‘</a><ul><li><a href="#conf-%E5%8F%82%E6%95%B0">conf å‚æ•°</a></li><li><a href="#ctx-%E5%8F%82%E6%95%B0">ctx å‚æ•°</a></li></ul></li><li><a href="#%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B">ç¼–å†™æµ‹è¯•ç”¨ä¾‹</a><ul><li><a href="#%E9%99%84%E4%B8%8A-test-nginx-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B">é™„ä¸Š test-nginx æ‰§è¡Œæµç¨‹</a></li><li><a href="#%E6%B3%A8%E5%86%8C%E5%85%AC%E5%85%B1%E6%8E%A5%E5%8F%A3">æ³¨å†Œå…¬å…±æ¥å£</a></li><li><a href="#%E6%B3%A8%E5%86%8C%E6%8E%A7%E5%88%B6%E6%8E%A5%E5%8F%A3">æ³¨å†Œæ§åˆ¶æ¥å£</a></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="æ£€æŸ¥å¤–éƒ¨ä¾èµ–"></a>æ£€æŸ¥å¤–éƒ¨ä¾èµ–<a class="hash-link" href="#æ£€æŸ¥å¤–éƒ¨ä¾èµ–" title="Direct link to heading">#</a></h2><p>å¦‚æœä½ çš„æ’ä»¶ï¼Œæ¶‰åŠåˆ°ä¸€äº›å¤–éƒ¨çš„ä¾èµ–å’Œä¸‰æ–¹åº“ï¼Œè¯·é¦–å…ˆæ£€æŸ¥ä¸€ä¸‹ä¾èµ–é¡¹çš„å†…å®¹ã€‚ å¦‚æœæ’ä»¶éœ€è¦ç”¨åˆ°å…±äº«å†…å­˜ï¼Œéœ€è¦åœ¨<a href="/zh/docs/apisix/next/customize-nginx-configuration">è‡ªå®šä¹‰ Nginx é…ç½®</a>ï¼Œä¾‹å¦‚ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># put this in config.yaml:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">nginx_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">http_configuration_snippet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">|</span><span class="token scalar string" style="color:rgb(195, 232, 141)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token scalar string" style="color:rgb(195, 232, 141)">        # for openid-connect plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token scalar string" style="color:rgb(195, 232, 141)">        lua_shared_dict discovery             1m; # cache for discovery metadata documents</span></div><div class="token-line" style="color:#bfc7d5"><span class="token scalar string" style="color:rgb(195, 232, 141)">        lua_shared_dict jwks                  1m; # cache for JWKs</span></div><div class="token-line" style="color:#bfc7d5"><span class="token scalar string" style="color:rgb(195, 232, 141)">        lua_shared_dict introspection        10m; # cache for JWT verification results</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ’ä»¶æœ¬èº«æä¾›äº† init æ–¹æ³•ã€‚æ–¹ä¾¿æ’ä»¶åŠ è½½ååšåˆå§‹åŒ–åŠ¨ä½œã€‚</p><p>æ³¨ï¼šå¦‚æœéƒ¨åˆ†æ’ä»¶çš„åŠŸèƒ½å®ç°ï¼Œéœ€è¦åœ¨ Nginx åˆå§‹åŒ–å¯åŠ¨ï¼Œåˆ™å¯èƒ½éœ€è¦åœ¨ <strong>apisix/init.lua</strong> æ–‡ä»¶çš„åˆå§‹åŒ–æ–¹æ³• http_init ä¸­æ·»åŠ é€»è¾‘ï¼Œå¹¶ä¸”
å¯èƒ½éœ€è¦åœ¨ <strong>apisix/cli/ngx_tpl.lua</strong> æ–‡ä»¶ä¸­ï¼Œå¯¹ Nginx é…ç½®æ–‡ä»¶ç”Ÿæˆçš„éƒ¨åˆ†ï¼Œæ·»åŠ ä¸€äº›ä½ éœ€è¦çš„å¤„ç†ã€‚ä½†æ˜¯è¿™æ ·å®¹æ˜“å¯¹å…¨å±€äº§ç”Ÿå½±å“ï¼Œæ ¹æ®ç°æœ‰çš„
æ’ä»¶æœºåˆ¶ï¼Œ<strong>æˆ‘ä»¬ä¸å»ºè®®è¿™æ ·åšï¼Œé™¤éä½ å·²ç»å¯¹ä»£ç å®Œå…¨æŒæ¡</strong>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="æ’ä»¶å‘½åä¸é…ç½®"></a>æ’ä»¶å‘½åä¸é…ç½®<a class="hash-link" href="#æ’ä»¶å‘½åä¸é…ç½®" title="Direct link to heading">#</a></h2><p>ç»™æ’ä»¶å–ä¸€ä¸ªå¾ˆæ£’çš„åå­—ï¼Œç¡®å®šæ’ä»¶çš„åŠ è½½ä¼˜å…ˆçº§ï¼Œç„¶ååœ¨ <strong>conf/config-default.yaml</strong> æ–‡ä»¶ä¸­æ·»åŠ ä¸Šä½ çš„æ’ä»¶åã€‚ä¾‹å¦‚ example-plugin è¿™ä¸ªæ’ä»¶ï¼Œ
éœ€è¦åœ¨ä»£ç é‡ŒæŒ‡å®šæ’ä»¶åç§°ï¼ˆåç§°æ˜¯æ’ä»¶çš„å”¯ä¸€æ ‡è¯†ï¼Œä¸å¯é‡åï¼‰ï¼Œåœ¨ <strong>apisix/plugins/example-plugin.lua</strong> æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">local plugin_name = &quot;example-plugin&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local _M = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    version = 0.1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    priority = 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name = plugin_name,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    schema = schema,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    metadata_schema = metadata_schema,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ³¨ï¼šæ–°æ’ä»¶çš„ä¼˜å…ˆçº§ï¼ˆ priority å±æ€§ ï¼‰ä¸èƒ½ä¸ç°æœ‰æ’ä»¶çš„ä¼˜å…ˆçº§ç›¸åŒï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <a href="/zh/docs/en/latest/control-api.md#get-v1schema">control API</a> çš„ <code>/v1/schema</code> æ–¹æ³•æŸ¥çœ‹æ‰€æœ‰æ’ä»¶çš„ä¼˜å…ˆçº§ã€‚å¦å¤–ï¼ŒåŒä¸€ä¸ªé˜¶æ®µé‡Œé¢ï¼Œä¼˜å…ˆçº§( priority )å€¼å¤§çš„æ’ä»¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œï¼Œæ¯”å¦‚ <code>example-plugin</code> çš„ä¼˜å…ˆçº§æ˜¯ 0 ï¼Œ<code>ip-restriction</code> çš„ä¼˜å…ˆçº§æ˜¯ 3000 ï¼Œæ‰€ä»¥åœ¨æ¯ä¸ªé˜¶æ®µï¼Œä¼šå…ˆæ‰§è¡Œ <code>ip-restriction</code> æ’ä»¶ï¼Œå†å»æ‰§è¡Œ <code>example-plugin</code> æ’ä»¶ã€‚è¿™é‡Œçš„â€œé˜¶æ®µâ€çš„å®šä¹‰ï¼Œå‚è§åç»­çš„<a href="#%E7%A1%AE%E5%AE%9A%E6%89%A7%E8%A1%8C%E9%98%B6%E6%AE%B5">ç¡®å®šæ‰§è¡Œé˜¶æ®µ</a>è¿™ä¸€èŠ‚ã€‚å¯¹äºä½ çš„æ’ä»¶ï¼Œå»ºè®®é‡‡ç”¨ 1 åˆ° 99 ä¹‹é—´çš„ä¼˜å…ˆçº§ã€‚</p><p>åœ¨ <strong>conf/config-default.yaml</strong> é…ç½®æ–‡ä»¶ä¸­ï¼Œåˆ—å‡ºäº†å¯ç”¨çš„æ’ä»¶ï¼ˆéƒ½æ˜¯ä»¥æ’ä»¶åæŒ‡å®šçš„ï¼‰ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">plugins</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">                          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># plugin list</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">req</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">conn</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">auth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> prometheus</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">status</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> jwt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">auth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> zipkin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ip</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">restriction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> grpc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">transcode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> serverless</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">pre</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">function</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> serverless</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">post</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">function</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> openid</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">connect</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> proxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rewrite</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> redirect</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ³¨ï¼šå…ˆåé¡ºåºä¸æ‰§è¡Œé¡ºåºæ— å…³ã€‚</p><p>ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ çš„æ’ä»¶æœ‰æ–°å»ºè‡ªå·±çš„ä»£ç ç›®å½•ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¿®æ”¹ Makefile æ–‡ä»¶ï¼Œæ–°å¢åˆ›å»ºæ–‡ä»¶å¤¹çš„æ“ä½œï¼Œæ¯”å¦‚ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$(INSTALL) -d $(INST_LUADIR)/apisix/plugins/skywalking</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$(INSTALL) apisix/plugins/skywalking/*.lua $(INST_LUADIR)/apisix/plugins/skywalking/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="é…ç½®æè¿°ä¸æ ¡éªŒ"></a>é…ç½®æè¿°ä¸æ ¡éªŒ<a class="hash-link" href="#é…ç½®æè¿°ä¸æ ¡éªŒ" title="Direct link to heading">#</a></h2><p>å®šä¹‰æ’ä»¶çš„é…ç½®é¡¹ï¼Œä»¥åŠå¯¹åº”çš„ <a href="https://json-schema.org" target="_blank" rel="noopener noreferrer">Json Schema</a> æè¿°ï¼Œå¹¶å®Œæˆå¯¹ json çš„æ ¡éªŒï¼Œè¿™æ ·æ–¹ä¾¿å¯¹é…ç½®çš„æ•°æ®è§„
æ ¼è¿›è¡ŒéªŒè¯ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ä»¥åŠç¨‹åºçš„å¥å£®æ€§ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä»¥ example-plugin æ’ä»¶ä¸ºä¾‹ï¼Œçœ‹çœ‹ä»–çš„é…ç½®æ•°æ®ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;example-plugin&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;i&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;s&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;s&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;t&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬çœ‹ä¸‹ä»–çš„ Schema æè¿°ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">local schema = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type = &quot;object&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    properties = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        i = {type = &quot;number&quot;, minimum = 0},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        s = {type = &quot;string&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        t = {type = &quot;array&quot;, minItems = 1},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ip = {type = &quot;string&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        port = {type = &quot;integer&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    required = {&quot;i&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ä¸ª schema å®šä¹‰äº†ä¸€ä¸ªéè´Ÿæ•° <code>i</code>ï¼Œå­—ç¬¦ä¸² <code>s</code>ï¼Œéç©ºæ•°ç»„ <code>t</code>ï¼Œå’Œ <code>ip</code> è·Ÿ <code>port</code>ã€‚åªæœ‰ <code>i</code> æ˜¯å¿…éœ€çš„ã€‚</p><p>åŒæ—¶ï¼Œéœ€è¦å®ç° <strong>check_schema(conf)</strong> æ–¹æ³•ï¼Œå®Œæˆé…ç½®å‚æ•°çš„åˆæ³•æ€§æ ¡éªŒã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _M.check_schema(conf)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return core.schema.check(schema, conf)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ³¨ï¼šé¡¹ç›®å·²ç»æä¾›äº† <strong>core.schema.check</strong> å…¬å…±æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨å³å¯å®Œæˆé…ç½®å‚æ•°æ ¡éªŒã€‚</p><p>å¦å¤–ï¼Œå¦‚æœæ’ä»¶éœ€è¦ä½¿ç”¨ä¸€äº›å…ƒæ•°æ®ï¼Œå¯ä»¥å®šä¹‰æ’ä»¶çš„ <code>metadata_schema</code> ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡ <code>admin api</code> åŠ¨æ€çš„ç®¡ç†è¿™äº›å…ƒæ•°æ®äº†ã€‚å¦‚ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">local metadata_schema = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type = &quot;object&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    properties = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ikey = {type = &quot;number&quot;, minimum = 0},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        skey = {type = &quot;string&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    required = {&quot;ikey&quot;, &quot;skey&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    additionalProperties = false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local plugin_name = &quot;example-plugin&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local _M = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    version = 0.1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    priority = 0,        -- TODO: add a type field, may be a good idea</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name = plugin_name,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    schema = schema,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    metadata_schema = metadata_schema,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä½ å¯èƒ½ä¹‹å‰è§è¿‡ key-auth è¿™ä¸ªæ’ä»¶åœ¨å®ƒçš„æ¨¡å—å®šä¹‰æ—¶è®¾ç½®äº† <code>type = &#x27;auth&#x27;</code>ã€‚
å½“ä¸€ä¸ªæ’ä»¶è®¾ç½® <code>type = &#x27;auth&#x27;</code>ï¼Œè¯´æ˜å®ƒæ˜¯ä¸ªè®¤è¯æ’ä»¶ã€‚</p><p>è®¤è¯æ’ä»¶éœ€è¦åœ¨æ‰§è¡Œåé€‰æ‹©å¯¹åº”çš„ consumerã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ key-auth æ’ä»¶ä¸­ï¼Œå®ƒé€šè¿‡ <code>apikey</code> è¯·æ±‚å¤´è·å–å¯¹åº”çš„ consumerï¼Œç„¶åé€šè¿‡ <code>consumer.attach_consumer</code> è®¾ç½®å®ƒã€‚</p><p>ä¸ºäº†è·Ÿ <code>consumer</code> èµ„æºä¸€èµ·ä½¿ç”¨ï¼Œè®¤è¯æ’ä»¶éœ€è¦æä¾›ä¸€ä¸ª <code>consumer_schema</code> æ¥æ£€éªŒ <code>consumer</code> èµ„æºçš„ <code>plugins</code> å±æ€§é‡Œé¢çš„é…ç½®ã€‚</p><p>ä¸‹é¢æ˜¯ key-auth æ’ä»¶çš„ consumer é…ç½®ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;username&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Joe&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;plugins&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;key-auth&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;key&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Joe&#x27;s key&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä½ åœ¨åˆ›å»º <a href="https://github.com/apache/apisix/blob/master/docs/zh/latest/admin-api.md#consumer" target="_blank" rel="noopener noreferrer">Consumer</a> æ—¶ä¼šç”¨åˆ°å®ƒã€‚</p><p>ä¸ºäº†æ£€éªŒè¿™ä¸ªé…ç½®ï¼Œè¿™ä¸ªæ’ä»¶ä½¿ç”¨äº†å¦‚ä¸‹çš„ schema:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">local consumer_schema = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type = &quot;object&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    additionalProperties = false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    properties = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        key = {type = &quot;string&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    required = {&quot;key&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ³¨æ„ key-auth çš„ <strong>check_schema(conf)</strong> æ–¹æ³•å’Œ example-plugin çš„åŒåæ–¹æ³•çš„åŒºåˆ«ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- key-auth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _M.check_schema(conf, schema_type)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if schema_type == core.schema.TYPE_CONSUMER then</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return core.schema.check(consumer_schema, conf)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return core.schema.check(schema, conf)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- example-plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _M.check_schema(conf, schema_type)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return core.schema.check(schema, conf)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="ç¡®å®šæ‰§è¡Œé˜¶æ®µ"></a>ç¡®å®šæ‰§è¡Œé˜¶æ®µ<a class="hash-link" href="#ç¡®å®šæ‰§è¡Œé˜¶æ®µ" title="Direct link to heading">#</a></h2><p>æ ¹æ®ä¸šåŠ¡åŠŸèƒ½ï¼Œç¡®å®šä½ çš„æ’ä»¶éœ€è¦åœ¨å“ªä¸ªé˜¶æ®µæ‰§è¡Œã€‚ key-auth æ˜¯ä¸€ä¸ªè®¤è¯æ’ä»¶ï¼Œæ‰€ä»¥éœ€è¦åœ¨ rewrite é˜¶æ®µæ‰§è¡Œã€‚åœ¨ APISIXï¼Œåªæœ‰è®¤è¯é€»è¾‘å¯ä»¥åœ¨ rewrite é˜¶æ®µé‡Œé¢å®Œæˆï¼Œå…¶ä»–éœ€è¦åœ¨ä»£ç†åˆ°ä¸Šæ¸¸ä¹‹å‰æ‰§è¡Œçš„é€»è¾‘éƒ½æ˜¯åœ¨ access é˜¶æ®µå®Œæˆçš„ã€‚</p><p><strong>æ³¨æ„ï¼šæˆ‘ä»¬ä¸èƒ½åœ¨ rewrite å’Œ access é˜¶æ®µè°ƒç”¨ <code>ngx.exit</code> æˆ–è€… <code>core.respond.exit</code>ã€‚å¦‚æœç¡®å®éœ€è¦é€€å‡ºï¼Œåªéœ€è¦ return çŠ¶æ€ç å’Œæ­£æ–‡ï¼Œæ’ä»¶å¼•æ“å°†ä½¿ç”¨è¿”å›çš„çŠ¶æ€ç å’Œæ­£æ–‡è¿›è¡Œé€€å‡ºã€‚<a href="https://github.com/apache/apisix/blob/35269581e21473e1a27b11cceca6f773cad0192a/apisix/plugins/limit-count.lua#L177" target="_blank" rel="noopener noreferrer">ä¾‹å­</a></strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="ç¼–å†™æ‰§è¡Œé€»è¾‘"></a>ç¼–å†™æ‰§è¡Œé€»è¾‘<a class="hash-link" href="#ç¼–å†™æ‰§è¡Œé€»è¾‘" title="Direct link to heading">#</a></h2><p>åœ¨å¯¹åº”çš„é˜¶æ®µæ–¹æ³•é‡Œç¼–å†™åŠŸèƒ½çš„é€»è¾‘ä»£ç ï¼Œåœ¨é˜¶æ®µæ–¹æ³•ä¸­å…·æœ‰ <code>conf</code> å’Œ <code>ctx</code> ä¸¤ä¸ªå‚æ•°ï¼Œä»¥ <code>limit-conn</code> æ’ä»¶é…ç½®ä¸ºä¾‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> http://127.0.0.1:9080/apisix/admin/routes/1 -H </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;methods&quot;: [&quot;GET&quot;],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;uri&quot;: &quot;/index.html&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;id&quot;: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;plugins&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;limit-conn&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;conn&quot;: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;burst&quot;: 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;default_conn_delay&quot;: 0.1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;rejected_code&quot;: 503,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;key&quot;: &quot;remote_addr&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;upstream&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;type&quot;: &quot;roundrobin&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;nodes&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            &quot;39.97.63.215:80&quot;: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="conf-å‚æ•°"></a>conf å‚æ•°<a class="hash-link" href="#conf-å‚æ•°" title="Direct link to heading">#</a></h3><p><code>conf</code> å‚æ•°æ˜¯æ’ä»¶çš„ç›¸å…³é…ç½®ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥é€šè¿‡ <code>core.log.warn(core.json.encode(conf))</code> å°†å…¶è¾“å‡ºåˆ° <code>error.log</code> ä¸­è¿›è¡ŒæŸ¥çœ‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _M.access(conf, ctx)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    core.log.warn(core.json.encode(conf))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ......</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>conf:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;rejected_code&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">503</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;burst&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;default_conn_delay&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;conn&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;key&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;remote_addr&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="ctx-å‚æ•°"></a>ctx å‚æ•°<a class="hash-link" href="#ctx-å‚æ•°" title="Direct link to heading">#</a></h3><p><code>ctx</code> å‚æ•°ç¼“å­˜äº†è¯·æ±‚ç›¸å…³çš„æ•°æ®ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥é€šè¿‡ <code>core.log.warn(core.json.encode(ctx, true))</code> å°†å…¶è¾“å‡ºåˆ° <code>error.log</code> ä¸­è¿›è¡ŒæŸ¥çœ‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _M.access(conf, ctx)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    core.log.warn(core.json.encode(ctx, true))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ......</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="ç¼–å†™æµ‹è¯•ç”¨ä¾‹"></a>ç¼–å†™æµ‹è¯•ç”¨ä¾‹<a class="hash-link" href="#ç¼–å†™æµ‹è¯•ç”¨ä¾‹" title="Direct link to heading">#</a></h2><p>é’ˆå¯¹åŠŸèƒ½ï¼Œå®Œå–„å„ç§ç»´åº¦çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¯¹æ’ä»¶åšä¸ªå…¨æ–¹ä½çš„æµ‹è¯•å§ï¼æ’ä»¶çš„æµ‹è¯•ç”¨ä¾‹ï¼Œéƒ½åœ¨ <strong>t/plugin</strong> ç›®å½•ä¸‹ï¼Œå¯ä»¥å‰å»äº†è§£ã€‚
é¡¹ç›®æµ‹è¯•æ¡†æ¶é‡‡ç”¨çš„ <a href="https://github.com/openresty/test-nginx" target="_blank" rel="noopener noreferrer">*<strong>*test-nginx**</strong></a> ã€‚
ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ <strong>.t</strong> æ–‡ä»¶ï¼Œé€šå¸¸ç”¨ __DATA__ åˆ†å‰²æˆ åºè¨€éƒ¨åˆ† å’Œ æ•°æ®éƒ¨åˆ†ã€‚è¿™é‡Œæˆ‘ä»¬ç®€å•ä»‹ç»ä¸‹æ•°æ®éƒ¨åˆ†ï¼Œ
ä¹Ÿå°±æ˜¯çœŸæ­£æµ‹è¯•ç”¨ä¾‹çš„éƒ¨åˆ†ï¼Œä»ç„¶ä»¥ key-auth æ’ä»¶ä¸ºä¾‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly perl"><div tabindex="0" class="prism-code language-perl codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">=== TEST 1: sanity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--- config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    location /t {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        content_by_lua_block {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            local plugin = require(&quot;apisix.plugins.key-auth&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            local ok, err = plugin.check_schema({key = &#x27;test-key&#x27;}, core.schema.TYPE_CONSUMER)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if not ok then</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ngx.say(err)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ngx.say(&quot;done&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--- request</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GET /t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--- response_body</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--- no_error_log</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸»è¦æœ‰ä¸‰éƒ¨åˆ†å†…å®¹ï¼š</p><ul><li>ç¨‹åºä»£ç ï¼š Nginx location çš„é…ç½®å†…å®¹</li><li>è¾“å…¥ï¼š http çš„ request ä¿¡æ¯</li><li>è¾“å‡ºæ£€æŸ¥ï¼š status ï¼Œheader ï¼Œbody ï¼Œerror_log æ£€æŸ¥</li></ul><p>è¿™é‡Œè¯·æ±‚ <strong>/t</strong> ï¼Œç»è¿‡é…ç½®æ–‡ä»¶ <strong>location</strong> ï¼Œè°ƒç”¨ <strong>content_by_lua_block</strong> æŒ‡ä»¤å®Œæˆ lua çš„è„šæœ¬ï¼Œæœ€ç»ˆè¿”å›ã€‚
ç”¨ä¾‹çš„æ–­è¨€æ˜¯ response_body è¿”å› &quot;done&quot;ï¼Œ<strong>no_error_log</strong> è¡¨ç¤ºä¼šå¯¹ Nginx çš„ error.log æ£€æŸ¥ï¼Œ
å¿…é¡»æ²¡æœ‰ ERROR çº§åˆ«çš„è®°å½•ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="é™„ä¸Š-test-nginx-æ‰§è¡Œæµç¨‹"></a>é™„ä¸Š test-nginx æ‰§è¡Œæµç¨‹<a class="hash-link" href="#é™„ä¸Š-test-nginx-æ‰§è¡Œæµç¨‹" title="Direct link to heading">#</a></h3><p>æ ¹æ®æˆ‘ä»¬åœ¨ Makefile é‡Œé…ç½®çš„ PATHï¼Œå’Œæ¯ä¸€ä¸ª <strong>.t</strong> æ–‡ä»¶æœ€å‰é¢çš„ä¸€äº›é…ç½®é¡¹ï¼Œæ¡†æ¶ä¼šç»„è£…æˆä¸€ä¸ªå®Œæ•´çš„ nginx.conf æ–‡ä»¶ï¼Œ
<strong>t/servroot</strong> ä¼šè¢«å½“æˆ Nginx çš„å·¥ä½œç›®å½•ï¼Œå¯åŠ¨ Nginx å®ä¾‹ã€‚æ ¹æ®æµ‹è¯•ç”¨ä¾‹æä¾›çš„ä¿¡æ¯ï¼Œå‘èµ· http è¯·æ±‚å¹¶æ£€æŸ¥ http çš„è¿”å›é¡¹ï¼Œ
åŒ…æ‹¬ http statusï¼Œhttp response headerï¼Œ http response body ç­‰ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="æ³¨å†Œå…¬å…±æ¥å£"></a>æ³¨å†Œå…¬å…±æ¥å£<a class="hash-link" href="#æ³¨å†Œå…¬å…±æ¥å£" title="Direct link to heading">#</a></h3><p>æ’ä»¶å¯ä»¥æ³¨å†Œæš´éœ²ç»™å…¬ç½‘çš„æ¥å£ã€‚ä»¥ jwt-auth æ’ä»¶ä¸ºä¾‹ï¼Œè¿™ä¸ªæ’ä»¶ä¸ºäº†è®©å®¢æˆ·ç«¯èƒ½å¤Ÿç­¾åï¼Œæ³¨å†Œäº† <code>GET /apisix/plugin/jwt/sign</code> è¿™ä¸ªæ¥å£:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">local function gen_token()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -- ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _M.api()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            methods = {&quot;GET&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            uri = &quot;/apisix/plugin/jwt/sign&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            handler = gen_token,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ³¨æ„æ³¨å†Œçš„æ¥å£ä¼šæš´éœ²åˆ°å¤–ç½‘ã€‚
ä½ å¯èƒ½éœ€è¦ä½¿ç”¨ <a href="/zh/docs/apisix/next/plugin-interceptors">interceptors</a> æ¥ä¿æŠ¤å®ƒã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="æ³¨å†Œæ§åˆ¶æ¥å£"></a>æ³¨å†Œæ§åˆ¶æ¥å£<a class="hash-link" href="#æ³¨å†Œæ§åˆ¶æ¥å£" title="Direct link to heading">#</a></h3><p>å¦‚æœä½ åªæƒ³æš´éœ² API åˆ° localhost æˆ–å†…ç½‘ï¼Œä½ å¯ä»¥é€šè¿‡ <a href="https://apisix.apache.org/docs/apisix/control-api" target="_blank" rel="noopener noreferrer">Control API</a> æ¥æš´éœ²å®ƒã€‚</p><p>Take a look at example-plugin plugin:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><div tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">local function hello()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    local args = ngx.req.get_uri_args()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if args[&quot;json&quot;] then</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return 200, {msg = &quot;world&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return 200, &quot;world\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _M.control_api()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            methods = {&quot;GET&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            uris = {&quot;/v1/plugin/example-plugin/hello&quot;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            handler = hello,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¦‚æœä½ æ²¡æœ‰æ”¹è¿‡é»˜è®¤çš„ control API é…ç½®ï¼Œè¿™ä¸ªæ’ä»¶æš´éœ²çš„ <code>GET /v1/plugin/example-plugin/hello</code> API åªæœ‰é€šè¿‡ <code>127.0.0.1</code> æ‰èƒ½è®¿é—®å®ƒã€‚</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/apache/apisix/edit/master/docs/zh/latest/plugin-develop.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh/docs/apisix/next/install-dependencies"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« å®‰è£…ä¾èµ–</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh/docs/apisix/next/external-plugin"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">External Plugin Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç›®å½•" class="table-of-contents__link">ç›®å½•</a></li><li><a href="#æ£€æŸ¥å¤–éƒ¨ä¾èµ–" class="table-of-contents__link">æ£€æŸ¥å¤–éƒ¨ä¾èµ–</a></li><li><a href="#æ’ä»¶å‘½åä¸é…ç½®" class="table-of-contents__link">æ’ä»¶å‘½åä¸é…ç½®</a></li><li><a href="#é…ç½®æè¿°ä¸æ ¡éªŒ" class="table-of-contents__link">é…ç½®æè¿°ä¸æ ¡éªŒ</a></li><li><a href="#ç¡®å®šæ‰§è¡Œé˜¶æ®µ" class="table-of-contents__link">ç¡®å®šæ‰§è¡Œé˜¶æ®µ</a></li><li><a href="#ç¼–å†™æ‰§è¡Œé€»è¾‘" class="table-of-contents__link">ç¼–å†™æ‰§è¡Œé€»è¾‘</a><ul><li><a href="#conf-å‚æ•°" class="table-of-contents__link">conf å‚æ•°</a></li><li><a href="#ctx-å‚æ•°" class="table-of-contents__link">ctx å‚æ•°</a></li></ul></li><li><a href="#ç¼–å†™æµ‹è¯•ç”¨ä¾‹" class="table-of-contents__link">ç¼–å†™æµ‹è¯•ç”¨ä¾‹</a><ul><li><a href="#é™„ä¸Š-test-nginx-æ‰§è¡Œæµç¨‹" class="table-of-contents__link">é™„ä¸Š test-nginx æ‰§è¡Œæµç¨‹</a></li><li><a href="#æ³¨å†Œå…¬å…±æ¥å£" class="table-of-contents__link">æ³¨å†Œå…¬å…±æ¥å£</a></li><li><a href="#æ³¨å†Œæ§åˆ¶æ¥å£" class="table-of-contents__link">æ³¨å†Œæ§åˆ¶æ¥å£</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">ASF</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation</a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License</a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events</a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issue Tracker</a></li><li class="footer__item"><a href="https://join.slack.com/t/the-asf/shared_invite/zt-nggtva4i-hDCsW1S35MuZ2g_2DgVDGg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://apisix.apache.org/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/zh/img/asf_logo_wide_small.png" alt="Apache Software Foundation" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/zh/img/asf_logo_wide_small.png" alt="Apache Software Foundation" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2019-2021 The Apache Software Foundation. Apache APISIX, APISIXâ„¢, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.087525af.js"></script>
<script src="/zh/assets/js/main.f87d8e84.js"></script>
</body>
</html>