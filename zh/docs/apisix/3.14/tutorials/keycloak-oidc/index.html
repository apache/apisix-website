<!doctype html>
<html class="docs-version-3.14" lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="ahrefs-site-verification" content="c2f7370ecf46173f4fb25f114e74c97e0a2976d4f02f61c9b00a9d7d34e34698">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIXÂ® -- Cloud-Native API Gateway and AI Gateway" href="/zh/opensearch.xml">
<script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Apache APISIX","url":"https://apisix.apache.org"}</script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="24b59d9a-682e-4c3d-9e83-bf2ee85cdc19" data-project-name="APISIX" data-project-color="#E8442E" data-project-logo="https://static.apiseven.com/202202/apache-apisix.png" data-modal-disclaimer="This is a custom LLM for APISIX with access to all developer documentation, GitHub issues and discussions." data-modal-example-questions="How to set up canary release in APISIX?,How to develop a custom APISIX plugin?,How to use custom NGINX configuration in APISIX?,How to configure mTLS between clients and APISIX?,How to only allow a specific APISIX consumer to access special services or routes?" async></script><title data-react-helmet="true">Set Up SSO with Keycloak (OIDC) | Apache APISIXÂ® -- Cloud-Native API Gateway and AI Gateway</title><meta data-react-helmet="true" property="og:image" content="https://static.apiseven.com/202202/apache-apisix.png"><meta data-react-helmet="true" name="twitter:image" content="https://static.apiseven.com/202202/apache-apisix.png"><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org/zh/docs/apisix/3.14/tutorials/keycloak-oidc/"><meta data-react-helmet="true" name="docsearch:language" content="zh"><meta data-react-helmet="true" name="docsearch:version" content="3.14"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-docs-apisix-3.14"><meta data-react-helmet="true" name="robots" content="index,follow"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" property="og:title" content="Set Up SSO with Keycloak (OIDC) | Apache APISIXÂ® -- Cloud-Native API Gateway and AI Gateway"><meta data-react-helmet="true" name="description" content="æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ openid-connect æ’ä»¶ï¼Œé€šè¿‡ authorization code grantã€client credentials grant å’Œ password grant å°† APISIX ä¸ Keycloak é›†æˆã€‚"><meta data-react-helmet="true" property="og:description" content="æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ openid-connect æ’ä»¶ï¼Œé€šè¿‡ authorization code grantã€client credentials grant å’Œ password grant å°† APISIX ä¸ Keycloak é›†æˆã€‚"><meta data-react-helmet="true" name="keywords" content="APISIX,API ç½‘å…³,OIDC,Keycloak"><link data-react-helmet="true" rel="shortcut icon" href="https://static.apiseven.com/202202/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org/zh/docs/apisix/3.14/tutorials/keycloak-oidc/"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/docs/apisix/3.14/tutorials/keycloak-oidc/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/zh/docs/apisix/3.14/tutorials/keycloak-oidc/" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/docs/apisix/3.14/tutorials/keycloak-oidc/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://38VC84A2WJ-dsn.algolia.net" crossorigin="anonymous"><link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Bold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Light.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Demi.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-ExtraBold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://apisix-website-static.apiseven.com/zh/assets/js/runtime~main.f0ea08ab.js" as="script">
<link rel="preload" href="https://apisix-website-static.apiseven.com/zh/assets/js/main.dbcb65bd.js" as="script">
<link rel="stylesheet" href="https://apisix-website-static.apiseven.com/zh/assets/css/styles.8de0825e.css">

<script>var _paq=window._paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://analytics.apache.org/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","17"]);var e=document,p=e.createElement("script"),t=e.getElementsByTagName("script")[0];p.async=!0,p.src=a+"matomo.js",t.parentNode.insertBefore(p,t)}()</script>

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#e8433e;color:white" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">ğŸ¤” Introducing APISIX AI Gateway â€“ Built for LLMs and AI workloads. <a target="_blank" rel="noopener noreferrer" href="/ai-gateway/"> Learn More</a></div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a target="_parent" class="navbar__brand" href="/zh/"><img src="/zh/img/logo2.svg" alt="Apache APISIXÂ®" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/zh/img/logo2.svg" alt="Apache APISIXÂ®" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Apache APISIXÂ®</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" target="_parent" href="/zh/docs/">æ–‡æ¡£</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/zh/docs/apisix/getting-started/">Apache APISIXÂ®ï¸</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/apisix/next/dashboard/">Apache APISIXÂ®ï¸ Dashboard</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/ingress-controller/overview/">Apache APISIXÂ®ï¸ Ingress Controller</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/helm-chart/apisix/">Apache APISIXÂ®ï¸ Helm Charts</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/docker/build/">Apache APISIXÂ®ï¸ Docker</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/java-plugin-runner/development/">Apache APISIXÂ®ï¸ Java Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/go-plugin-runner/getting-started/">Apache APISIXÂ®ï¸ Go Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/python-plugin-runner/getting-started/">Apache APISIXÂ®ï¸ Python Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/general/join/">General</a></li></ul></div><a class="navbar__item navbar__link" target="_parent" href="/zh/blog/">åšå®¢</a><a class="navbar__item navbar__link" target="_parent" href="/zh/blog/tags/case-studies/">ç”¨æˆ·æ¡ˆä¾‹</a><a class="navbar__item navbar__link" target="_parent" href="/zh/downloads/">ä¸‹è½½</a><a class="navbar__item navbar__link" target="_parent" href="/zh/help/">å¸®åŠ©</a><a class="navbar__item navbar__link" target="_parent" href="/zh/team/">å›¢é˜Ÿ</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">ç›¸å…³èµ„æº</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/zh/showcase/">ä½¿ç”¨æ¡ˆä¾‹</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/general/code-samples/">Code Samples</a></li><li><a class="dropdown__link" target="_parent" href="/zh/plugins/">æ’ä»¶å¸‚åœº</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/general/join/">åŠ å…¥ç¤¾åŒº</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/general/events/">ç¤¾åŒºæ´»åŠ¨</a></li><li><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer" class="dropdown__link">Roadmap</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_zID8"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>ç®€ä½“ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/docs/apisix/3.14/tutorials/keycloak-oidc/" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh/docs/apisix/3.14/tutorials/keycloak-oidc/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></div><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_fBfG"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_GMj9"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_k0Pq"><div class="sidebar_LIo8 sidebarWithHideableNavbar_CMI-"><a target="_parent" tabindex="-1" class="sidebarLogo_P87M" href="/zh/"><img src="/zh/img/logo2.svg" alt="Apache APISIXÂ®" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/zh/img/logo2.svg" alt="Apache APISIXÂ®" class="themedImage_TMUO themedImage--dark_uzRr"><b>Apache APISIXÂ®</b></a><div class="sidebarVersionSwitch_0QIZ">Version:<div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/zh/docs/apisix/3.14/getting-started/README/">3.14</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/apisix/next/tutorials/keycloak-oidc/"><div>Next</div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/tutorials/keycloak-oidc/"><div>3.15<div class="badge_6FVu Latest_oyqS">Latest</div></div></a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh/docs/apisix/3.14/tutorials/keycloak-oidc/"><div>3.14</div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/3.13/getting-started/README/"><div>3.13</div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/3.12/getting-started/README/"><div>3.12</div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/3.11/getting-started/README/"><div>3.11</div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/3.10/getting-started/README/"><div>3.10</div></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.9/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.9<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.8/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.8<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.7/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.7<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.6/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.6<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.5/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.5<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.4/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.4<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.3/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.3<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.2/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.2<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.1/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.1<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.0/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.15/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.14/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.13/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.12/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.12<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.11/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.11<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.10/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.10<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.9/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.9<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.8/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.8<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.7/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.7<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.6/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.6<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.5/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.5<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.4/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.4<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><nav class="menu thin-scrollbar menu_oAhv menuWithAnnouncementBar_IVfW"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.14/installation-guide/">APISIX å®‰è£…æŒ‡å—</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.14/architecture-design/apisix/">è½¯ä»¶æ¶æ„</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Tutorials</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/3.14/tutorials/expose-api/">å‘å¸ƒ API</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/3.14/tutorials/protect-api/">ä¿æŠ¤ API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Observability</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/3.14/tutorials/manage-api-consumers/">ç®¡ç† API æ¶ˆè´¹è€…</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/3.14/tutorials/cache-api-responses/">API å“åº”ç¼“å­˜</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/3.14/tutorials/add-multiple-api-versions/">Add multiple API versions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/3.14/tutorials/client-to-apisix-mtls/">é…ç½®å®¢æˆ·ç«¯ä¸ APISIX ä¹‹é—´çš„åŒå‘è®¤è¯ï¼ˆmTLSï¼‰</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/apisix/3.14/tutorials/websocket-authentication/">WebSocket Authentication</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/docs/apisix/3.14/tutorials/keycloak-oidc/">Set Up SSO with Keycloak (OIDC)</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Terminology</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Plugins</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.14/dashboard/">Apache APISIX Dashboard</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.14/deployment-modes/">Deployment modes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.14/FAQ/">å¸¸è§é—®é¢˜</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Others</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a href="https://github.com/apache/apisix/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="menu__link"><span>CHANGELOG<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.14/upgrade-guide-from-2.15.x-to-3.0.0/">å‡çº§æŒ‡å—</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_EBxv"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_AF9Q"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_Q970"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for Apache APISIXÂ® -- Cloud-Native API Gateway and AI Gateway <b>3.14</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/zh/docs/apisix/tutorials/keycloak-oidc/">latest version</a></b> (3.15).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 3.14</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Set Up SSO with Keycloak (OIDC)</h1></header><p><a href="https://openid.net/connect/" target="_blank" rel="noopener noreferrer">OpenID Connect (OIDC)</a> æ˜¯ <a href="https://www.rfc-editor.org/rfc/rfc6749" target="_blank" rel="noopener noreferrer">OAuth 2.0 åè®®</a> ä¹‹ä¸Šçš„ç®€å•èº«ä»½å±‚ã€‚å®ƒå…è®¸å®¢æˆ·ç«¯åŸºäºèº«ä»½æä¾›è€…æ‰§è¡Œçš„èº«ä»½éªŒè¯æ¥éªŒè¯æœ€ç»ˆç”¨æˆ·çš„èº«ä»½ï¼Œä»¥åŠä»¥å¯äº’æ“ä½œå’Œç±»ä¼¼ REST çš„æ–¹å¼è·å–æœ‰å…³æœ€ç»ˆâ€‹â€‹ç”¨æˆ·çš„åŸºæœ¬ä¸ªäººèµ„æ–™ä¿¡æ¯ã€‚å€ŸåŠ© APISIX å’Œ <a href="https://www.keycloak.org/" target="_blank" rel="noopener noreferrer">Keycloak</a>ï¼Œæ‚¨å¯ä»¥å®ç°åŸºäº OIDC çš„èº«ä»½éªŒè¯æµç¨‹æ¥ä¿æŠ¤æ‚¨çš„ API å¹¶å¯ç”¨å•ç‚¹ç™»å½• (SSO)ã€‚</p><p><a href="https://www.keycloak.org/" target="_blank" rel="noopener noreferrer">Keycloak</a> æ˜¯é€‚ç”¨äºç°ä»£åº”ç”¨ç¨‹åºå’ŒæœåŠ¡çš„å¼€æºèº«ä»½å’Œè®¿é—®ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚Keycloak æ”¯æŒå•ç‚¹ç™»å½• (SSO)ï¼Œè¿™ä½¿å¾—æœåŠ¡èƒ½å¤Ÿé€šè¿‡ OIDC å’Œ OAuth 2.0 ç­‰åè®®ä¸ Keycloak è¿›è¡Œäº¤äº’ã€‚æ­¤å¤–ï¼ŒKeycloak è¿˜æ”¯æŒå°†èº«ä»½éªŒè¯å§”æ‰˜ç»™ç¬¬ä¸‰æ–¹èº«ä»½æä¾›å•†ï¼Œä¾‹å¦‚ Facebook å’Œ Googleã€‚</p><p>æœ¬æ•™ç¨‹å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ <a target="_blank" href="/zh/hub/openid-connect/"><code>openid-connect</code></a> æ’ä»¶ï¼Œé€šè¿‡ <a href="#implement-authorization-code-grant">authorization code grant</a>ã€<a href="#implement-client-credentials-grant">client credentials grant</a> å’Œ <a href="#implement-password-grant">password grant</a> å°† APISIX ä¸ Keycloak é›†æˆã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="é…ç½®-keycloak"></a>é…ç½® Keycloak<a class="hash-link" href="#é…ç½®-keycloak" title="Direct link to heading">#</a></h2><p>åœ¨ Docker ä¸­ä»¥ <a href="https://www.keycloak.org/server/configuration#_starting_keycloak_in_development_mode" target="_blank" rel="noopener noreferrer">å¼€å‘æ¨¡å¼</a> å¯åŠ¨ä¸€ä¸ªåä¸º <code>apisix-quickstart-keycloak</code> çš„ Keycloak å®ä¾‹ï¼Œç®¡ç†å‘˜åç§°ä¸º <code>quickstart-admin</code>ï¼Œå¯†ç ä¸º <code>quickstart-admin-pass</code>ï¼Œæš´éœ²çš„ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºä¸Šçš„ <code>8080</code>ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -d --name </span><span class="token string" style="color:#e3116c">&quot;apisix-quickstart-keycloak&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -e </span><span class="token string" style="color:#e3116c">&#x27;KEYCLOAK_ADMIN=quickstart-admin&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -e </span><span class="token string" style="color:#e3116c">&#x27;KEYCLOAK_ADMIN_PASSWORD=quickstart-admin-pass&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">:8080 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  quay.io/keycloak/keycloak:18.0.2 start-dev</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>Keycloak æä¾›äº†ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„ Web UIï¼Œå¸®åŠ©ç®¡ç†å‘˜ç®¡ç†æ‰€æœ‰èµ„æºï¼Œä¾‹å¦‚å®¢æˆ·ç«¯ã€è§’è‰²å’Œç”¨æˆ·ã€‚</p><p>åœ¨æµè§ˆå™¨ä¸­å¯¼èˆªåˆ° <code>http://localhost:8080</code> ä»¥è®¿é—® Keycloak ç½‘é¡µï¼Œç„¶åå•å‡» <strong>ç®¡ç†æ§åˆ¶å°</strong>ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="web-ui" src="https://static.api7.ai/uploads/2023/03/30/ItcwYPIx_web-ui.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>è¾“å…¥ç®¡ç†å‘˜ç”¨æˆ·å <code>quickstart-admin</code> å’Œå¯†ç  <code>quickstart-admin-pass</code> å¹¶ç™»å½•ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="admin-signin" src="https://static.api7.ai/uploads/2023/03/30/6W3pjzE1_admin-signin.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>æ‚¨éœ€è¦åœ¨ä»¥ä¸‹æ­¥éª¤ä¸­ä¿æŒç™»å½•çŠ¶æ€æ¥é…ç½® Keycloakã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="åˆ›å»º-realm"></a>åˆ›å»º Realm<a class="hash-link" href="#åˆ›å»º-realm" title="Direct link to heading">#</a></h3><p>Keycloak ä¸­çš„ realm æ˜¯ç®¡ç†ç”¨æˆ·ã€å‡­è¯å’Œè§’è‰²ç­‰èµ„æºçš„å·¥ä½œåŒºã€‚ä¸åŒé¢†åŸŸä¸­çš„èµ„æºå½¼æ­¤éš”ç¦»ã€‚æ‚¨éœ€è¦ä¸º APISIX åˆ›å»ºä¸€ä¸ªåä¸º<code>quickstart-realm</code> çš„ realmã€‚</p><p>åœ¨å·¦ä¾§èœå•ä¸­ï¼Œå°†é¼ æ ‡æ‚¬åœåœ¨ <strong>Master</strong> ä¸Šï¼Œç„¶ååœ¨ä¸‹æ‹‰èœå•ä¸­é€‰æ‹© <strong>Add realm</strong>ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="create-realm" src="https://static.api7.ai/uploads/2023/03/30/S1Xvqliv_create-realm.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>è¾“å…¥ realm åç§° <code>quickstart-realm</code>ï¼Œç„¶åå•å‡» <code>__Create__</code> è¿›è¡Œåˆ›å»ºï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="add-realm" src="https://static.api7.ai/uploads/2023/03/30/jwb7QU8k_add-realm.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="åˆ›å»º-client"></a>åˆ›å»º Client<a class="hash-link" href="#åˆ›å»º-client" title="Direct link to heading">#</a></h3><p>Keycloak ä¸­çš„ client æ˜¯è¯·æ±‚ Keycloak å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯çš„å®ä½“ã€‚æ›´å¤šæƒ…å†µä¸‹ï¼Œclient æ˜¯å¸Œæœ›ä½¿ç”¨ Keycloak ä¿æŠ¤è‡ªèº«å®‰å…¨å¹¶æä¾›å•ç‚¹ç™»å½•è§£å†³æ–¹æ¡ˆçš„åº”ç”¨ç¨‹åºã€‚APISIX ç›¸å½“äºè´Ÿè´£å‘ Keycloak å‘èµ·èº«ä»½éªŒè¯è¯·æ±‚çš„ clientï¼Œå› æ­¤æ‚¨éœ€è¦åˆ›å»ºå…¶å¯¹åº”çš„å®¢æˆ·ç«¯ï¼Œåä¸º <code>apisix-quickstart-client</code>ã€‚</p><p>å•å‡» <strong>Clients</strong> &gt; <strong>Create</strong>ï¼Œæ‰“å¼€ <strong>Add Client</strong> é¡µé¢ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="create-client" src="https://static.api7.ai/uploads/2023/03/30/qLom0axN_create-client.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>è¾“å…¥ <strong>Client ID</strong> ä¸º <code>apisix-quickstart-client</code>ï¼Œç„¶åé€‰æ‹© <strong>Client Protocol</strong> ä¸º <code>openid-connect</code> å¹¶ <strong>Save</strong>:</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="add-client" src="https://static.api7.ai/uploads/2023/03/30/X5on2r7x_add-client.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>Client <code>apisix-quickstart-client</code> å·²åˆ›å»ºã€‚é‡å®šå‘åˆ°è¯¦ç»†ä¿¡æ¯é¡µé¢åï¼Œé€‰æ‹© <code>confidential</code> ä½œä¸º <strong>Access Type</strong>:</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="config-client" src="https://static.api7.ai/uploads/2023/03/30/v70c8y9F_config-client.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>å½“ç”¨æˆ·åœ¨ SSO æœŸé—´ç™»å½•æˆåŠŸæ—¶ï¼ŒKeycloak ä¼šæºå¸¦çŠ¶æ€å’Œä»£ç å°†å®¢æˆ·ç«¯é‡å®šå‘åˆ° <strong>Valid Redirect URIs</strong> ä¸­çš„åœ°å€ã€‚ä¸ºç®€åŒ–æ“ä½œï¼Œè¾“å…¥é€šé…ç¬¦ <code>*</code> ä»¥å°†ä»»ä½• URI è§†ä¸ºæœ‰æ•ˆï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="client-redirect" src="https://static.api7.ai/uploads/2023/03/30/xLxcyVkn_client-redirect.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>å¦‚æœæ‚¨æ­£åœ¨ <a href="#implement-authorization-code-grant">ä½¿ç”¨ PKCE authorization code grant</a>ï¼Œè¯·åœ¨å®¢æˆ·ç«¯çš„é«˜çº§è®¾ç½®ä¸­é…ç½® PKCE è´¨è¯¢æ–¹æ³•ï¼š</p><div style="text-align:center"><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="PKCE keycloak configuration" src="https://static.api7.ai/uploads/2024/11/04/xvnCNb20_pkce-keycloak-revised.jpeg" style="width:70%"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></div><p>å¦‚æœæ‚¨æ­£åœ¨å®æ–½ <a href="#implement-client-credentials-grant">client credentials grant</a>ï¼Œè¯·ä¸º client å¯ç”¨æœåŠ¡å¸æˆ·ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="enable-service-account" src="https://static.api7.ai/uploads/2023/12/29/h1uNtghd_sa.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>é€‰æ‹© <strong>Save</strong> ä»¥åº”ç”¨è‡ªå®šä¹‰é…ç½®ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="åˆ›å»º-user"></a>åˆ›å»º User<a class="hash-link" href="#åˆ›å»º-user" title="Direct link to heading">#</a></h3><p>Keycloak ä¸­çš„ç”¨æˆ·æ˜¯èƒ½å¤Ÿç™»å½•ç³»ç»Ÿçš„å®ä½“ã€‚ä»–ä»¬å¯ä»¥æ‹¥æœ‰ä¸è‡ªå·±ç›¸å…³çš„å±æ€§ï¼Œä¾‹å¦‚ç”¨æˆ·åã€ç”µå­é‚®ä»¶å’Œåœ°å€ã€‚</p><p>å¦‚æœæ‚¨åªå®æ–½ <a href="#implement-client-credentials-grant">client credentials grant</a>ï¼Œåˆ™å¯ä»¥ <a href="#obtain-the-oidc-configuration">è·³è¿‡æ­¤éƒ¨åˆ†</a>ã€‚</p><p>ç‚¹å‡» <strong>Users</strong> &gt; <strong>Add user</strong> æ‰“å¼€ <strong>Add user</strong> é¡µé¢ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="create-user" src="https://static.api7.ai/uploads/2023/03/30/onQEp23L_create-user.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>ç‚¹å‡» <strong>Users</strong> &gt; <strong>Add user</strong> æ‰“å¼€ <strong>Add user</strong> é¡µé¢ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="add-user" src="https://static.api7.ai/uploads/2023/03/30/EKhuhgML_add-user.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>ç‚¹å‡» <strong>Credentials</strong>ï¼Œç„¶åå°† <strong>Password</strong> è®¾ç½®ä¸º <code>quickstart-user-pass</code>ã€‚å°† <strong>Temporary</strong> åˆ‡æ¢ä¸º <code>OFF</code> ä»¥å…³é—­é™åˆ¶ï¼Œè¿™æ ·æ‚¨ç¬¬ä¸€æ¬¡ç™»å½•æ—¶å°±æ— éœ€æ›´æ”¹å¯†ç ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="user-pass" src="https://static.api7.ai/uploads/2023/03/30/rQKEAEnh_user-pass.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="è·å–-oidc-é…ç½®"></a>è·å– OIDC é…ç½®<a class="hash-link" href="#è·å–-oidc-é…ç½®" title="Direct link to heading">#</a></h2><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæ‚¨å°†ä» Keycloak è·å–å…³é”®çš„ OIDC é…ç½®å¹¶å°†å…¶å®šä¹‰ä¸º shell å˜é‡ã€‚æœ¬èŠ‚ä¹‹åçš„æ­¥éª¤å°†ä½¿ç”¨è¿™äº›å˜é‡é€šè¿‡ shell å‘½ä»¤é…ç½® OIDCã€‚</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>æ‰“å¼€ä¸€ä¸ªå•ç‹¬çš„ç»ˆç«¯æŒ‰ç…§æ­¥éª¤æ“ä½œå¹¶å®šä¹‰ç›¸å…³çš„ shell å˜é‡ã€‚ç„¶åæœ¬èŠ‚ä¹‹åçš„æ­¥éª¤å¯ä»¥ç›´æ¥ä½¿ç”¨å®šä¹‰çš„å˜é‡ã€‚</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="è·å–å‘ç°ç«¯ç‚¹"></a>è·å–å‘ç°ç«¯ç‚¹<a class="hash-link" href="#è·å–å‘ç°ç«¯ç‚¹" title="Direct link to heading">#</a></h3><p>å•å‡» <strong>Realm Settings</strong>ï¼Œç„¶åå³é”®å•å‡» <strong>OpenID Endpoints Configuration</strong> å¹¶å¤åˆ¶é“¾æ¥ã€‚</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="get-discovery" src="https://static.api7.ai/uploads/2023/03/30/526lbJbg_get-discovery.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>è¯¥é“¾æ¥åº”ä¸ä»¥ä¸‹å†…å®¹ç›¸åŒï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 text"><pre tabindex="0" class="prism-code language-text codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">http://localhost:8080/realms/quickstart-realm/.well-known/openid-configuration</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>åœ¨ OIDC èº«ä»½éªŒè¯æœŸé—´éœ€è¦ä½¿ç”¨æ­¤ç«¯ç‚¹å…¬å¼€çš„é…ç½®å€¼ã€‚ä½¿ç”¨æ‚¨çš„ä¸»æœº IP æ›´æ–°åœ°å€å¹¶ä¿å­˜åˆ°ç¯å¢ƒå˜é‡ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">KEYCLOAK_IP</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.42.145    </span><span class="token comment" style="color:#999988;font-style:italic"># replace with your host IP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">OIDC_DISCOVERY</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">http://</span><span class="token variable" style="color:#36acaa">${KEYCLOAK_IP}</span><span class="token plain">:8080/realms/quickstart-realm/.well-known/openid-configuration</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="è·å–å®¢æˆ·ç«¯-id-å’Œå¯†é’¥"></a>è·å–å®¢æˆ·ç«¯ ID å’Œå¯†é’¥<a class="hash-link" href="#è·å–å®¢æˆ·ç«¯-id-å’Œå¯†é’¥" title="Direct link to heading">#</a></h3><p>å•å‡» <strong>Clients</strong> &gt; <code>apisix-quickstart-client</code> &gt; <strong>Credentials</strong>ï¼Œå¹¶ä» <strong>Secret</strong> å¤åˆ¶å®¢æˆ·ç«¯å¯†é’¥ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="client-ID" src="https://static.api7.ai/uploads/2023/03/30/MwYmU20v_client-id.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="client-secret" src="https://static.api7.ai/uploads/2023/03/30/f9iOG8aN_client-secret.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>å°† OIDC å®¢æˆ·ç«¯ ID å’Œå¯†é’¥ä¿å­˜åˆ°ç¯å¢ƒå˜é‡ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">OIDC_CLIENT_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">apisix-quickstart-client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">OIDC_CLIENT_SECRET</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">bSaIN3MV1YynmtXvU8lKkfeY0iwpr9cH  </span><span class="token comment" style="color:#999988;font-style:italic"># replace with your value</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å®ç°-authorization-code-grant"></a>å®ç° Authorization Code Grant<a class="hash-link" href="#å®ç°-authorization-code-grant" title="Direct link to heading">#</a></h2><p>Authorization Code Grant ç”± Web å’Œç§»åŠ¨åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚æµç¨‹ä»æˆæƒæœåŠ¡å™¨åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºç™»å½•é¡µé¢å¼€å§‹ï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­è¾“å…¥å…¶å‡­æ®ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå°†çŸ­æœŸæˆæƒç äº¤æ¢ä¸ºè®¿é—®ä»¤ç‰Œï¼ŒAPISIX å°†å…¶å­˜å‚¨åœ¨æµè§ˆå™¨ä¼šè¯ cookie ä¸­ï¼Œå¹¶å°†éšè®¿é—®ä¸Šæ¸¸èµ„æºæœåŠ¡å™¨çš„æ¯æ¬¡è¯·æ±‚ä¸€èµ·å‘é€ã€‚</p><p>è¦å®ç° Authorization Code Grantï¼Œè¯·ä½¿ç”¨ <code>openid-connect</code> æ’ä»¶åˆ›å»ºä¸€ä¸ªè·¯ç”±ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9180/apisix/admin/routes&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;id&quot;: &quot;auth-with-oidc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;uri&quot;:&quot;/anything/*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;openid-connect&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;bearer_only&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;session&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;secret&quot;: &quot;change_to_whatever_secret_you_want&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;client_id&quot;: &quot;&#x27;</span><span class="token plain">&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_ID</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;client_secret&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_SECRET</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;discovery&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_DISCOVERY</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;scope&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;openid profile&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;redirect_uri&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://localhost:9080/anything/callback&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;upstream&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;roundrobin&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;nodes&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;httpbin.org:80&quot;</span><span class="token plain">:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>æˆ–è€…ï¼Œå¦‚æœæ‚¨æƒ³ä½¿ç”¨ PKCE å®ç° authorization code grantï¼Œè¯·ä½¿ç”¨ <code>openid-connect</code> æ’ä»¶åˆ›å»ºä¸€ä¸ªè·¯ç”±å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9180/apisix/admin/routes&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;id&quot;: &quot;auth-with-oidc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;uri&quot;:&quot;/anything/*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;openid-connect&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;bearer_only&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;session&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;secret&quot;: &quot;change_to_whatever_secret_you_want&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;use_pkce&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;client_id&quot;: &quot;&#x27;</span><span class="token plain">&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_ID</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;client_secret&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_SECRET</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;discovery&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_DISCOVERY</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;scope&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;openid profile&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;redirect_uri&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://localhost:9080/anything/callback&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;upstream&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;roundrobin&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;nodes&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;httpbin.org:80&quot;</span><span class="token plain">:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="ä½¿ç”¨æœ‰æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯"></a>ä½¿ç”¨æœ‰æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯<a class="hash-link" href="#ä½¿ç”¨æœ‰æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯" title="Direct link to heading">#</a></h3><p>åœ¨æµè§ˆå™¨ä¸­å¯¼èˆªè‡³ <code>http://127.0.0.1:9080/anything/test</code>ã€‚è¯·æ±‚å°†é‡å®šå‘åˆ°ç™»å½•é¡µé¢ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="test-sign-on" src="https://static.api7.ai/uploads/2023/03/30/i38u1x9a_validate-sign.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><p>ä½¿ç”¨æ­£ç¡®çš„ç”¨æˆ·å <code>quickstart-user</code> å’Œå¯†ç  <code>quickstart-user-pass</code> ç™»å½•ã€‚å¦‚æœæˆåŠŸï¼Œè¯·æ±‚å°†è¢«è½¬å‘åˆ° <code>httpbin.org</code>ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„å“åº”ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 json"><pre tabindex="0" class="prism-code language-json codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;args&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;data&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;files&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;form&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;headers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Accept&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;text/html...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;json&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;method&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;GET&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;origin&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1, 59.71.244.81&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1/anything/test&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="ä½¿ç”¨æ— æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯"></a>ä½¿ç”¨æ— æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯<a class="hash-link" href="#ä½¿ç”¨æ— æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯" title="Direct link to heading">#</a></h3><p>ä½¿ç”¨é”™è¯¯çš„å‡­è¯ç™»å½•ã€‚æ‚¨åº”è¯¥ä¼šçœ‹åˆ°èº«ä»½éªŒè¯å¤±è´¥ï¼š</p><p><span class="lazy-load-image-background blur" style="color:transparent;display:inline-block"><div><noscript><img alt="test-sign-failed" src="https://static.api7.ai/uploads/2023/03/31/YOuSYX1r_validate-sign-failed.png"></noscript><div style="width:500px;height:300px;border-radius:1rem;background-color:#d2d2d7"></div></div></span></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å®ç°-client-credential-grant"></a>å®ç° Client Credential Grant<a class="hash-link" href="#å®ç°-client-credential-grant" title="Direct link to heading">#</a></h2><p>åœ¨ client credential grant ä¸­ï¼Œå®¢æˆ·ç«¯æ— éœ€ä»»ä½•ç”¨æˆ·å‚ä¸å³å¯è·å¾—è®¿é—®ä»¤ç‰Œã€‚å®ƒé€šå¸¸ç”¨äºæœºå™¨å¯¹æœºå™¨ (M2M) é€šä¿¡ã€‚</p><p>è¦å®ç° client credential grantï¼Œè¯·ä½¿ç”¨ <code>openid-connect</code> æ’ä»¶åˆ›å»ºè·¯ç”±ï¼Œä»¥ä½¿ç”¨èº«ä»½æä¾›è€…çš„ JWKS ç«¯ç‚¹æ¥éªŒè¯ä»¤ç‰Œã€‚ç«¯ç‚¹å°†ä»å‘ç°æ–‡æ¡£ä¸­è·å–ã€‚</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9180/apisix/admin/routes&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;id&quot;: &quot;auth-with-oidc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;uri&quot;:&quot;/anything/*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;openid-connect&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;use_jwks&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;client_id&quot;: &quot;&#x27;</span><span class="token plain">&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_ID</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;client_secret&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_SECRET</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;discovery&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_DISCOVERY</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;scope&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;openid profile&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;redirect_uri&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://localhost:9080/anything/callback&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;upstream&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;roundrobin&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;nodes&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;httpbin.org:80&quot;</span><span class="token plain">:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>æˆ–è€…ï¼Œå¦‚æœæ‚¨æƒ³ä½¿ç”¨è‡ªçœç«¯ç‚¹æ¥éªŒè¯ä»¤ç‰Œï¼Œè¯·æŒ‰å¦‚ä¸‹æ–¹å¼åˆ›å»ºè·¯ç”±ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9180/apisix/admin/routes&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;id&quot;: &quot;auth-with-oidc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;uri&quot;:&quot;/anything/*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;openid-connect&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;bearer_only&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;client_id&quot;: &quot;&#x27;</span><span class="token plain">&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_ID</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;client_secret&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_SECRET</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;discovery&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_DISCOVERY</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;scope&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;openid profile&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;redirect_uri&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://localhost:9080/anything/callback&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;upstream&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;roundrobin&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;nodes&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;httpbin.org:80&quot;</span><span class="token plain">:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>è‡ªçœç«¯ç‚¹å°†ä»å‘ç°æ–‡æ¡£ä¸­è·å–ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯"></a>ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯<a class="hash-link" href="#ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯" title="Direct link to heading">#</a></h3><p>åœ¨ <a href="https://www.keycloak.org/docs/latest/securing_apps/#token-endpoint" target="_blank" rel="noopener noreferrer">ä»¤ç‰Œç«¯ç‚¹</a> è·å– Keycloak æœåŠ¡å™¨çš„è®¿é—®ä»¤ç‰Œï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://</span><span class="token string variable" style="color:#36acaa">$KEYCLOAK_IP</span><span class="token string" style="color:#e3116c">:8080/realms/quickstart-realm/protocol/openid-connect/token&quot;</span><span class="token plain"> -X POST </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;grant_type=client_credentials&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;client_id=&#x27;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_ID</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;client_secret=&#x27;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_SECRET</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>é¢„æœŸå“åº”ç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 text"><pre tabindex="0" class="prism-code language-text codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;access_token&quot;:&quot;eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJoT3ludlBPY2d6Y3VWWnYtTU42bXZKMUczb0dOX2d6MFo3WFl6S2FSa1NBIn0.eyJleHAiOjE3MDM4MjU1NjQsImlhdCI6MTcwMzgyNTI2NCwianRpIjoiMWQ4NWE4N2UtZDFhMC00NThmLThiMTItNGZiYWM2ODA5YmYwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MDgwL3JlYWxtcy9xdWlja3N0YXJ0LXJlYWxtIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjE1OGUzOWFlLTk0YjAtNDI3Zi04ZGU3LTU3MTRhYWYwOGYzOSIsInR5cCI6IkJlYXJlciIsImF6cCI6ImFwaXNpeC1xdWlja3N0YXJ0LWNsaWVudCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1xdWlja3N0YXJ0LXJlYWxtIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiY2xpZW50SG9zdCI6IjE3Mi4xNy4wLjEiLCJjbGllbnRJZCI6ImFwaXNpeC1xdWlja3N0YXJ0LWNsaWVudCIsInByZWZlcnJlZF91c2VybmFtZSI6InNlcnZpY2UtYWNjb3VudC1hcGlzaXgtcXVpY2tzdGFydC1jbGllbnQiLCJjbGllbnRBZGRyZXNzIjoiMTcyLjE3LjAuMSJ9.TltzSXqrJuVID7aGrb35jn-oc07U_-jugSn-3jKz4A44LwtAsME_8b3qkmR4boMOIht_5pF6bnnp70MFAlg6JKu4_yIQDxF_GAHjnZXEO8OCKhtIKwXm2w-hnnJVIhIdGkIVkbPP0HfILuar_m0hpa53VpPBGYR-OS4pyh0KTUs8MB22xAEqyz9zjCm6SX9vXCqgeVkSpRW2E8NaGEbAdY25uY-ZC4dI_pON87Ey5e8GdD6HQLXQlGIOdCDi3N7k0HDoD9TZRv2bMRPfy4zVYm1ZlClIuF79A-ZBwr0c-XYuq7t6EY0gPGEXB-s0SaKlrIU5S9JBeVXRzYvqAih41g&quot;,&quot;expires_in&quot;:300,&quot;refresh_expires_in&quot;:0,&quot;token_type&quot;:&quot;Bearer&quot;,&quot;not-before-policy&quot;:0,&quot;scope&quot;:&quot;email profile&quot;}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>å°†è®¿é—®ä»¤ç‰Œä¿å­˜åˆ°ç¯å¢ƒå˜é‡ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># replace with your access token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ACCESS_TOKEN</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJoT3ludlBPY2d6Y3VWWnYtTU42bXZKMUczb0dOX2d6MFo3WFl6S2FSa1NBIn0.eyJleHAiOjE3MDM4MjU1NjQsImlhdCI6MTcwMzgyNTI2NCwianRpIjoiMWQ4NWE4N2UtZDFhMC00NThmLThiMTItNGZiYWM2ODA5YmYwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MDgwL3JlYWxtcy9xdWlja3N0YXJ0LXJlYWxtIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjE1OGUzOWFlLTk0YjAtNDI3Zi04ZGU3LTU3MTRhYWYwOGYzOSIsInR5cCI6IkJlYXJlciIsImF6cCI6ImFwaXNpeC1xdWlja3N0YXJ0LWNsaWVudCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1xdWlja3N0YXJ0LXJlYWxtIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiY2xpZW50SG9zdCI6IjE3Mi4xNy4wLjEiLCJjbGllbnRJZCI6ImFwaXNpeC1xdWlja3N0YXJ0LWNsaWVudCIsInByZWZlcnJlZF91c2VybmFtZSI6InNlcnZpY2UtYWNjb3VudC1hcGlzaXgtcXVpY2tzdGFydC1jbGllbnQiLCJjbGllbnRBZGRyZXNzIjoiMTcyLjE3LjAuMSJ9.TltzSXqrJuVID7aGrb35jn-oc07U_-jugSn-3jKz4A44LwtAsME_8b3qkmR4boMOIht_5pF6bnnp70MFAlg6JKu4_yIQDxF_GAHjnZXEO8OCKhtIKwXm2w-hnnJVIhIdGkIVkbPP0HfILuar_m0hpa53VpPBGYR-OS4pyh0KTUs8MB22xAEqyz9zjCm6SX9vXCqgeVkSpRW2E8NaGEbAdY25uY-ZC4dI_pON87Ey5e8GdD6HQLXQlGIOdCDi3N7k0HDoD9TZRv2bMRPfy4zVYm1ZlClIuF79A-ZBwr0c-XYuq7t6EY0gPGEXB-s0SaKlrIU5S9JBeVXRzYvqAih41g&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>ä½¿ç”¨æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œå‘è·¯ç”±å‘é€è¯·æ±‚ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9080/anything/test&quot;</span><span class="token plain"> -H </span><span class="token string" style="color:#e3116c">&quot;Authorization: Bearer </span><span class="token string variable" style="color:#36acaa">$ACCESS_TOKEN</span><span class="token string" style="color:#e3116c">&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><code>HTTP/1.1 200 OK</code> å“åº”éªŒè¯å¯¹ä¸Šæ¸¸èµ„æºçš„è¯·æ±‚æ˜¯å¦å·²è·å¾—æˆæƒã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯"></a>ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯<a class="hash-link" href="#ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯" title="Direct link to heading">#</a></h3><p>ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œå‘è·¯ç”±å‘é€è¯·æ±‚ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9080/anything/test&quot;</span><span class="token plain"> -H </span><span class="token string" style="color:#e3116c">&quot;Authorization: Bearer invalid-access-token&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><code>HTTP/1.1 401 Unauthorized</code> å“åº”éªŒè¯ OIDC æ’ä»¶æ˜¯å¦æ‹’ç»äº†å…·æœ‰æ— æ•ˆè®¿é—®ä»¤ç‰Œçš„è¯·æ±‚ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="éªŒè¯æ— è®¿é—®ä»¤ç‰Œ"></a>éªŒè¯æ— è®¿é—®ä»¤ç‰Œ<a class="hash-link" href="#éªŒè¯æ— è®¿é—®ä»¤ç‰Œ" title="Direct link to heading">#</a></h3><p>å‘æ— è®¿é—®ä»¤ç‰Œçš„è·¯ç”±å‘é€è¯·æ±‚ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9080/anything/test&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><code>HTTP/1.1 401 Unauthorized</code> å“åº”éªŒè¯ OIDC æ’ä»¶æ‹’ç»æ²¡æœ‰è®¿é—®ä»¤ç‰Œçš„è¯·æ±‚ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å®æ–½-password-grant"></a>å®æ–½ Password Grant<a class="hash-link" href="#å®æ–½-password-grant" title="Direct link to heading">#</a></h2><p>Password Grant æ˜¯ä¸€ç§å°†ç”¨æˆ·å‡­æ®äº¤æ¢ä¸ºè®¿é—®ä»¤ç‰Œçš„ä¼ ç»Ÿæ–¹æ³•ã€‚</p><p>è¦å®æ–½ Password Grantï¼Œè¯·ä½¿ç”¨ <code>openid-connect</code> æ’ä»¶åˆ›å»ºè·¯ç”±ï¼Œä»¥ä½¿ç”¨èº«ä»½æä¾›è€…çš„ JWKS ç«¯ç‚¹æ¥éªŒè¯ä»¤ç‰Œã€‚ç«¯ç‚¹å°†ä»å‘ç°æ–‡æ¡£ä¸­è·å–ã€‚</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9180/apisix/admin/routes&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;id&quot;: &quot;auth-with-oidc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;uri&quot;:&quot;/anything/*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;openid-connect&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;use_jwks&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;client_id&quot;: &quot;&#x27;</span><span class="token plain">&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_ID</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;client_secret&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_SECRET</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;discovery&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token variable" style="color:#36acaa">$OIDC_DISCOVERY</span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;scope&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;openid profile&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;redirect_uri&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://localhost:9080/anything/callback&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;upstream&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;roundrobin&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;nodes&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;httpbin.org:80&quot;</span><span class="token plain">:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯-1"></a>ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯<a class="hash-link" href="#ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯-1" title="Direct link to heading">#</a></h3><p>åœ¨ <a href="https://www.keycloak.org/docs/latest/securing_apps/#token-endpoint" target="_blank" rel="noopener noreferrer">ä»¤ç‰Œç«¯ç‚¹</a> è·å– Keycloak æœåŠ¡å™¨çš„è®¿é—®ä»¤ç‰Œï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">OIDC_USER</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">quickstart-user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">OIDC_PASSWORD</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">quickstart-user-pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://</span><span class="token string variable" style="color:#36acaa">$KEYCLOAK_IP</span><span class="token string" style="color:#e3116c">:8080/realms/quickstart-realm/protocol/openid-connect/token&quot;</span><span class="token plain"> -X POST </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;grant_type=password&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;client_id=&#x27;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_ID</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;client_secret=&#x27;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_SECRET</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;username=&#x27;</span><span class="token variable" style="color:#36acaa">$OIDC_USER</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;password=&#x27;</span><span class="token variable" style="color:#36acaa">$OIDC_PASSWORD</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>é¢„æœŸå“åº”ç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 text"><pre tabindex="0" class="prism-code language-text codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;access_token&quot;:&quot;eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ6U3FFaXN6VlpuYi1sRWMzZkp0UHNpU1ZZcGs4RGN3dXI1Mkx5V05aQTR3In0.eyJleHAiOjE2ODAxNjA5NjgsImlhdCI6MTY4MDE2MDY2OCwianRpIjoiMzQ5MTc4YjQtYmExZC00ZWZjLWFlYTUtZGY2MzJiMDJhNWY5IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguNDIuMTQ1OjgwODAvcmVhbG1zL3F1aWNrc3RhcnQtcmVhbG0iLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiMTg4MTVjM2EtNmQwNy00YTY2LWJjZjItYWQ5NjdmMmIwMTFmIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYXBpc2l4LXF1aWNrc3RhcnQtY2xpZW50Iiwic2Vzc2lvbl9zdGF0ZSI6ImIxNmIyNjJlLTEwNTYtNDUxNS1hNDU1LWYyNWUwNzdjY2I3NiIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1xdWlja3N0YXJ0LXJlYWxtIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsInNpZCI6ImIxNmIyNjJlLTEwNTYtNDUxNS1hNDU1LWYyNWUwNzdjY2I3NiIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoicXVpY2tzdGFydC11c2VyIn0.uD_7zfZv5182aLXu9-YBzBDK0nr2mE4FWb_4saTog2JTqFTPZZa99Gm8AIDJx2ZUcZ_ElkATqNUZ4OpWmL2Se5NecMw3slJReewjD6xgpZ3-WvQuTGpoHdW5wN9-Rjy8ungilrnAsnDA3tzctsxm2w6i9KISxvZrzn5Rbk-GN6fxH01VC5eekkPUQJcJgwuJiEiu70SjGnm21xDN4VGkNRC6jrURoclv3j6AeOqDDIV95kA_MTfBswDFMCr2PQlj5U0RTndZqgSoxwFklpjGV09Azp_jnU7L32_Sq-8coZd0nj5mSdbkJLJ8ZDQDV_PP3HjCP7EHdy4P6TyZ7oGvjw&quot;,&quot;expires_in&quot;:300,&quot;refresh_expires_in&quot;:1800,&quot;refresh_token&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI0YjFiNTQ3Yi0zZmZjLTQ5YzQtYjE2Ni03YjdhNzIxMjk1ODcifQ.eyJleHAiOjE2ODAxNjI0NjgsImlhdCI6MTY4MDE2MDY2OCwianRpIjoiYzRjNjNlMTEtZTdlZS00ZmEzLWJlNGYtNDMyZWQ4ZmY5OTQwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguNDIuMTQ1OjgwODAvcmVhbG1zL3F1aWNrc3RhcnQtcmVhbG0iLCJhdWQiOiJodHRwOi8vMTkyLjE2OC40Mi4xNDU6ODA4MC9yZWFsbXMvcXVpY2tzdGFydC1yZWFsbSIsInN1YiI6IjE4ODE1YzNhLTZkMDctNGE2Ni1iY2YyLWFkOTY3ZjJiMDExZiIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJhcGlzaXgtcXVpY2tzdGFydC1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiYjE2YjI2MmUtMTA1Ni00NTE1LWE0NTUtZjI1ZTA3N2NjYjc2Iiwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwic2lkIjoiYjE2YjI2MmUtMTA1Ni00NTE1LWE0NTUtZjI1ZTA3N2NjYjc2In0.8xYP4bhDg1U9B5cTaEVD7B4oxNp8wwAYEynUne_Jm78&quot;,&quot;token_type&quot;:&quot;Bearer&quot;,&quot;not-before-policy&quot;:0,&quot;session_state&quot;:&quot;b16b262e-1056-4515-a455-f25e077ccb76&quot;,&quot;scope&quot;:&quot;profile email&quot;}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>å°†è®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œä¿å­˜åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚åˆ·æ–°ä»¤ç‰Œå°†åœ¨åˆ·æ–°ä»¤ç‰Œæ­¥éª¤ä¸­ä½¿ç”¨ã€‚</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># replace with your access token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ACCESS_TOKEN</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ6U3FFaXN6VlpuYi1sRWMzZkp0UHNpU1ZZcGs4RGN3dXI1Mkx5V05aQTR3In0.eyJleHAiOjE2ODAxNjA5NjgsImlhdCI6MTY4MDE2MDY2OCwianRpIjoiMzQ5MTc4YjQtYmExZC00ZWZjLWFlYTUtZGY2MzJiMDJhNWY5IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguNDIuMTQ1OjgwODAvcmVhbG1zL3F1aWNrc3RhcnQtcmVhbG0iLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiMTg4MTVjM2EtNmQwNy00YTY2LWJjZjItYWQ5NjdmMmIwMTFmIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYXBpc2l4LXF1aWNrc3RhcnQtY2xpZW50Iiwic2Vzc2lvbl9zdGF0ZSI6ImIxNmIyNjJlLTEwNTYtNDUxNS1hNDU1LWYyNWUwNzdjY2I3NiIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1xdWlja3N0YXJ0LXJlYWxtIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsInNpZCI6ImIxNmIyNjJlLTEwNTYtNDUxNS1hNDU1LWYyNWUwNzdjY2I3NiIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoicXVpY2tzdGFydC11c2VyIn0.uD_7zfZv5182aLXu9-YBzBDK0nr2mE4FWb_4saTog2JTqFTPZZa99Gm8AIDJx2ZUcZ_ElkATqNUZ4OpWmL2Se5NecMw3slJReewjD6xgpZ3-WvQuTGpoHdW5wN9-Rjy8ungilrnAsnDA3tzctsxm2w6i9KISxvZrzn5Rbk-GN6fxH01VC5eekkPUQJcJgwuJiEiu70SjGnm21xDN4VGkNRC6jrURoclv3j6AeOqDDIV95kA_MTfBswDFMCr2PQlj5U0RTndZqgSoxwFklpjGV09Azp_jnU7L32_Sq-8coZd0nj5mSdbkJLJ8ZDQDV_PP3HjCP7EHdy4P6TyZ7oGvjw&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">REFRESH_TOKEN</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI0YjFiNTQ3Yi0zZmZjLTQ5YzQtYjE2Ni03YjdhNzIxMjk1ODcifQ.eyJleHAiOjE2ODAxNjI0NjgsImlhdCI6MTY4MDE2MDY2OCwianRpIjoiYzRjNjNlMTEtZTdlZS00ZmEzLWJlNGYtNDMyZWQ4ZmY5OTQwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguNDIuMTQ1OjgwODAvcmVhbG1zL3F1aWNrc3RhcnQtcmVhbG0iLCJhdWQiOiJodHRwOi8vMTkyLjE2OC40Mi4xNDU6ODA4MC9yZWFsbXMvcXVpY2tzdGFydC1yZWFsbSIsInN1YiI6IjE4ODE1YzNhLTZkMDctNGE2Ni1iY2YyLWFkOTY3ZjJiMDExZiIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJhcGlzaXgtcXVpY2tzdGFydC1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiYjE2YjI2MmUtMTA1Ni00NTE1LWE0NTUtZjI1ZTA3N2NjYjc2Iiwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwic2lkIjoiYjE2YjI2MmUtMTA1Ni00NTE1LWE0NTUtZjI1ZTA3N2NjYjc2In0.8xYP4bhDg1U9B5cTaEVD7B4oxNp8wwAYEynUne_Jm78&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>ä½¿ç”¨æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œå‘è·¯ç”±å‘é€è¯·æ±‚ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9080/anything/test&quot;</span><span class="token plain"> -H </span><span class="token string" style="color:#e3116c">&quot;Authorization: Bearer </span><span class="token string variable" style="color:#36acaa">$ACCESS_TOKEN</span><span class="token string" style="color:#e3116c">&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><code>HTTP/1.1 200 OK</code> å“åº”éªŒè¯å¯¹ä¸Šæ¸¸èµ„æºçš„è¯·æ±‚æ˜¯å¦å·²è·å¾—æˆæƒã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯-1"></a>ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯<a class="hash-link" href="#ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯-1" title="Direct link to heading">#</a></h3><p>ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œå‘è·¯ç”±å‘é€è¯·æ±‚ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9080/anything/test&quot;</span><span class="token plain"> -H </span><span class="token string" style="color:#e3116c">&quot;Authorization: Bearer invalid-access-token&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><code>HTTP/1.1 401 Unauthorized</code> å“åº”éªŒè¯ OIDC æ’ä»¶æ˜¯å¦æ‹’ç»äº†å…·æœ‰æ— æ•ˆè®¿é—®ä»¤ç‰Œçš„è¯·æ±‚ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="éªŒè¯æ— è®¿é—®ä»¤ç‰Œ-1"></a>éªŒè¯æ— è®¿é—®ä»¤ç‰Œ<a class="hash-link" href="#éªŒè¯æ— è®¿é—®ä»¤ç‰Œ-1" title="Direct link to heading">#</a></h3><p>å‘æ— è®¿é—®ä»¤ç‰Œçš„è·¯ç”±å‘é€è¯·æ±‚ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:9080/anything/test&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><code>HTTP/1.1 401 Unauthorized</code> å“åº”éªŒè¯ OIDC æ’ä»¶æ‹’ç»æ²¡æœ‰è®¿é—®ä»¤ç‰Œçš„è¯·æ±‚ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="åˆ·æ–°ä»¤ç‰Œ"></a>åˆ·æ–°ä»¤ç‰Œ<a class="hash-link" href="#åˆ·æ–°ä»¤ç‰Œ" title="Direct link to heading">#</a></h3><p>è¦åˆ·æ–°è®¿é—®ä»¤ç‰Œï¼Œè¯·å‘ Keycloak ä»¤ç‰Œç«¯ç‚¹å‘é€è¯·æ±‚ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;http://</span><span class="token string variable" style="color:#36acaa">$KEYCLOAK_IP</span><span class="token string" style="color:#e3116c">:8080/realms/quickstart-realm/protocol/openid-connect/token&quot;</span><span class="token plain"> -X POST </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;grant_type=refresh_token&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;client_id=&#x27;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_ID</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;client_secret=&#x27;</span><span class="token variable" style="color:#36acaa">$OIDC_CLIENT_SECRET</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d </span><span class="token string" style="color:#e3116c">&#x27;refresh_token=&#x27;</span><span class="token variable" style="color:#36acaa">$REFRESH_TOKEN</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>æ‚¨åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„å“åº”ï¼Œå…¶ä¸­åŒ…å«æ–°çš„è®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œï¼Œæ‚¨å¯ä»¥å°†å…¶ç”¨äºåç»­è¯·æ±‚å’Œä»¤ç‰Œåˆ·æ–°ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 text"><pre tabindex="0" class="prism-code language-text codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;access_token&quot;:&quot;eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJTdnVwLXlPMHhDdTJBVi1za2pCZ0h6SHZNaG1mcDVDQWc0NHpYb2QxVTlNIn0.eyJleHAiOjE3MzAyNzQ3NDUsImlhdCI6MTczMDI3NDQ0NSwianRpIjoiMjk2Mjk5MWUtM2ExOC00YWFiLWE0NzAtODgxNWEzNjZjZmM4IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMTUyLjU6ODA4MC9yZWFsbXMvcXVpY2tzdGFydC1yZWFsbSIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiI2ZWI0ZTg0Yy00NmJmLTRkYzUtOTNkMC01YWM5YzE5MWU0OTciLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJhcGlzaXgtcXVpY2tzdGFydC1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiNTU2ZTQyYjktMjE2Yi00NTEyLWE5ZjAtNzE3ZTAyYTQ4MjZhIiwiYWNyIjoiMSIsInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJkZWZhdWx0LXJvbGVzLXF1aWNrc3RhcnQtcmVhbG0iLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJlbWFpbCBwcm9maWxlIiwic2lkIjoiNTU2ZTQyYjktMjE2Yi00NTEyLWE5ZjAtNzE3ZTAyYTQ4MjZhIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJxdWlja3N0YXJ0LXVzZXIifQ.KLqn1LQdazoPBqLLR856C35XpqbMO9I7WFt3KrDxZF1N8vwv4AvZYWI_2rsbdjCakh9JmPgyYRgEGufYLiDBsqy9CrMVejAIJPYsJIonIXBCp5Ysu92ODJuqtTKuuJ6K7dam7fisBFfCBbVvGspnZ3p0caedpOaF_kSd-F8ARHKVsmkuX3_ucDrP3UctjEXHezefTY4YHjNMB9wuMDPXX2vXt2BsOasnznsIHHHX-ZH8JY6eEfWPtfx0qAED6lVZICT6Rqj_j5-Cf9ogzFtLyy_XvtG9BbHME2B8AXYpxdzqxOxmVVbZdrB8elfmFjs1R3vUn2r3xA9hO_znZo_IoQ&quot;,&quot;expires_in&quot;:300,&quot;refresh_expires_in&quot;:1800,&quot;refresh_token&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwYWYwZTAwYy0xMThjLTRkNDktYmIwMS1iMDIwNDE3MmFjMzIifQ.eyJleHAiOjE3MzAyNzYyNDUsImlhdCI6MTczMDI3NDQ0NSwianRpIjoiZGQyZTJmYTktN2Y3Zi00MjM5LWEwODAtNWQyZDFiZTdjNzk4IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMTUyLjU6ODA4MC9yZWFsbXMvcXVpY2tzdGFydC1yZWFsbSIsImF1ZCI6Imh0dHA6Ly8xOTIuMTY4LjE1Mi41OjgwODAvcmVhbG1zL3F1aWNrc3RhcnQtcmVhbG0iLCJzdWIiOiI2ZWI0ZTg0Yy00NmJmLTRkYzUtOTNkMC01YWM5YzE5MWU0OTciLCJ0eXAiOiJSZWZyZXNoIiwiYXpwIjoiYXBpc2l4LXF1aWNrc3RhcnQtY2xpZW50Iiwic2Vzc2lvbl9zdGF0ZSI6IjU1NmU0MmI5LTIxNmItNDUxMi1hOWYwLTcxN2UwMmE0ODI2YSIsInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsInNpZCI6IjU1NmU0MmI5LTIxNmItNDUxMi1hOWYwLTcxN2UwMmE0ODI2YSJ9.Uad4BVuojHfyxqedFT5BHliWjIqVDbjM-Xeme0G2AAg&quot;,&quot;token_type&quot;:&quot;Bearer&quot;,&quot;not-before-policy&quot;:0,&quot;session_state&quot;:&quot;556e42b9-216b-4512-a9f0-717e02a4826a&quot;,&quot;scope&quot;:&quot;email profile&quot;}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="/zh/edit#https://github.com/apache/apisix/edit/release/3.14/docs/zh/latest/tutorials/keycloak-oidc.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh/docs/apisix/3.14/tutorials/websocket-authentication/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« WebSocket Authentication</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh/docs/apisix/3.14/terminology/api-gateway/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">API Gateway Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#é…ç½®-keycloak" class="table-of-contents__link">é…ç½® Keycloak</a><ul><li><a href="#åˆ›å»º-realm" class="table-of-contents__link">åˆ›å»º Realm</a></li><li><a href="#åˆ›å»º-client" class="table-of-contents__link">åˆ›å»º Client</a></li><li><a href="#åˆ›å»º-user" class="table-of-contents__link">åˆ›å»º User</a></li></ul></li><li><a href="#è·å–-oidc-é…ç½®" class="table-of-contents__link">è·å– OIDC é…ç½®</a><ul><li><a href="#è·å–å‘ç°ç«¯ç‚¹" class="table-of-contents__link">è·å–å‘ç°ç«¯ç‚¹</a></li><li><a href="#è·å–å®¢æˆ·ç«¯-id-å’Œå¯†é’¥" class="table-of-contents__link">è·å–å®¢æˆ·ç«¯ ID å’Œå¯†é’¥</a></li></ul></li><li><a href="#å®ç°-authorization-code-grant" class="table-of-contents__link">å®ç° Authorization Code Grant</a><ul><li><a href="#ä½¿ç”¨æœ‰æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯" class="table-of-contents__link">ä½¿ç”¨æœ‰æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯</a></li><li><a href="#ä½¿ç”¨æ— æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯" class="table-of-contents__link">ä½¿ç”¨æ— æ•ˆå‡­è¯è¿›è¡ŒéªŒè¯</a></li></ul></li><li><a href="#å®ç°-client-credential-grant" class="table-of-contents__link">å®ç° Client Credential Grant</a><ul><li><a href="#ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯" class="table-of-contents__link">ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯</a></li><li><a href="#ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯" class="table-of-contents__link">ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯</a></li><li><a href="#éªŒè¯æ— è®¿é—®ä»¤ç‰Œ" class="table-of-contents__link">éªŒè¯æ— è®¿é—®ä»¤ç‰Œ</a></li></ul></li><li><a href="#å®æ–½-password-grant" class="table-of-contents__link">å®æ–½ Password Grant</a><ul><li><a href="#ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯-1" class="table-of-contents__link">ä½¿ç”¨æœ‰æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯</a></li><li><a href="#ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯-1" class="table-of-contents__link">ä½¿ç”¨æ— æ•ˆè®¿é—®ä»¤ç‰Œè¿›è¡ŒéªŒè¯</a></li><li><a href="#éªŒè¯æ— è®¿é—®ä»¤ç‰Œ-1" class="table-of-contents__link">éªŒè¯æ— è®¿é—®ä»¤ç‰Œ</a></li><li><a href="#åˆ·æ–°ä»¤ç‰Œ" class="table-of-contents__link">åˆ·æ–°ä»¤ç‰Œ</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="container_MP5Z"><div class="linksRow_iwpv"><div class="linksCol_a1ec"><div>ASF</div><ul><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span></span><span>Foundation</span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer"><span></span><span>License</span></a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer"><span></span><span>Events</span></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer"><span></span><span>Security</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer"><span></span><span>Sponsorship</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer"><span></span><span>Thanks</span></a></li></ul></div><div class="linksCol_a1ec"><div>Community</div><ul><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer"><span></span><span>GitHub</span></a></li><li class="footer__item"><a href="/zh/docs/general/join/"><span></span><span>Slack</span></a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer"><span></span><span>Twitter</span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCgPD18cMhOg5rmPVnQhAC8g" target="_blank" rel="noopener noreferrer"><span></span><span>YouTube</span></a></li></ul></div><div class="linksCol_a1ec"><div>More</div><ul><li class="footer__item"><a target="_parent" href="/zh/blog/"><span></span><span>Blog</span></a></li><li class="footer__item"><a target="_parent" href="/zh/showcase/"><span></span><span>Showcase</span></a></li><li class="footer__item"><a target="_parent" href="/zh/plugins/"><span></span><span>Plugin Hub</span></a></li><li class="footer__item"><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer"><span></span><span>Roadmap</span></a></li></ul></div></div><div class="copyright_ZfFh"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span style="display:inline-block;width:231.25px;height:40px"></span></a><div>Copyright Â© 2019-2026 The Apache Software Foundation. Apache APISIX, APISIXÂ®, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></footer></div>
<script src="https://apisix-website-static.apiseven.com/zh/assets/js/runtime~main.f0ea08ab.js"></script>
<script src="https://apisix-website-static.apiseven.com/zh/assets/js/main.dbcb65bd.js"></script>
</body>
</html>