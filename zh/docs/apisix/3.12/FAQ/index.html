<!doctype html>
<html class="docs-version-3.12" lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="ahrefs-site-verification" content="c2f7370ecf46173f4fb25f114e74c97e0a2976d4f02f61c9b00a9d7d34e34698">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIXÂ® -- Cloud-Native API Gateway and AI Gateway" href="/zh/opensearch.xml">
<script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Apache APISIX","url":"https://apisix.apache.org"}</script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="24b59d9a-682e-4c3d-9e83-bf2ee85cdc19" data-project-name="APISIX" data-project-color="#E8442E" data-project-logo="https://static.apiseven.com/202202/apache-apisix.png" data-modal-disclaimer="This is a custom LLM for APISIX with access to all developer documentation, GitHub issues and discussions." data-modal-example-questions="How to set up canary release in APISIX?,How to develop a custom APISIX plugin?,How to use custom NGINX configuration in APISIX?,How to configure mTLS between clients and APISIX?,How to only allow a specific APISIX consumer to access special services or routes?" async></script><title data-react-helmet="true">å¸¸è§é—®é¢˜ | Apache APISIXÂ® -- Cloud-Native API Gateway and AI Gateway</title><meta data-react-helmet="true" property="og:image" content="https://static.apiseven.com/202202/apache-apisix.png"><meta data-react-helmet="true" name="twitter:image" content="https://static.apiseven.com/202202/apache-apisix.png"><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org/zh/docs/apisix/3.12/FAQ/"><meta data-react-helmet="true" name="docsearch:language" content="zh"><meta data-react-helmet="true" name="docsearch:version" content="3.12"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-docs-apisix-3.12"><meta data-react-helmet="true" name="robots" content="index,follow"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" property="og:title" content="å¸¸è§é—®é¢˜ | Apache APISIXÂ® -- Cloud-Native API Gateway and AI Gateway"><meta data-react-helmet="true" name="description" content="æœ¬æ–‡åˆ—ä¸¾äº†ä½¿ç”¨ Apache APISIX æ—¶å¸¸è§é—®é¢˜è§£å†³æ–¹æ³•ã€‚"><meta data-react-helmet="true" property="og:description" content="æœ¬æ–‡åˆ—ä¸¾äº†ä½¿ç”¨ Apache APISIX æ—¶å¸¸è§é—®é¢˜è§£å†³æ–¹æ³•ã€‚"><meta data-react-helmet="true" name="keywords" content="Apache APISIX,API ç½‘å…³,å¸¸è§é—®é¢˜,FAQ"><link data-react-helmet="true" rel="shortcut icon" href="https://static.apiseven.com/202202/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org/zh/docs/apisix/3.12/FAQ/"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/docs/apisix/3.12/FAQ/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/zh/docs/apisix/3.12/FAQ/" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/docs/apisix/3.12/FAQ/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://38VC84A2WJ-dsn.algolia.net" crossorigin="anonymous"><link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Bold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Light.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-Demi.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://static.apiseven.com/202202/MaisonNeue-ExtraBold.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="https://apisix-website-static.apiseven.com/zh/assets/js/runtime~main.f0ea08ab.js" as="script">
<link rel="preload" href="https://apisix-website-static.apiseven.com/zh/assets/js/main.dbcb65bd.js" as="script">
<link rel="stylesheet" href="https://apisix-website-static.apiseven.com/zh/assets/css/styles.8de0825e.css">

<script>var _paq=window._paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://analytics.apache.org/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","17"]);var e=document,p=e.createElement("script"),t=e.getElementsByTagName("script")[0];p.async=!0,p.src=a+"matomo.js",t.parentNode.insertBefore(p,t)}()</script>

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#e8433e;color:white" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">ğŸ¤” Introducing APISIX AI Gateway â€“ Built for LLMs and AI workloads. <a target="_blank" rel="noopener noreferrer" href="/ai-gateway/"> Learn More</a></div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a target="_parent" class="navbar__brand" href="/zh/"><img src="/zh/img/logo2.svg" alt="Apache APISIXÂ®" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/zh/img/logo2.svg" alt="Apache APISIXÂ®" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Apache APISIXÂ®</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" target="_parent" href="/zh/docs/">æ–‡æ¡£</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/zh/docs/apisix/getting-started/">Apache APISIXÂ®ï¸</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/apisix/next/dashboard/">Apache APISIXÂ®ï¸ Dashboard</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/ingress-controller/overview/">Apache APISIXÂ®ï¸ Ingress Controller</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/helm-chart/apisix/">Apache APISIXÂ®ï¸ Helm Charts</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/docker/build/">Apache APISIXÂ®ï¸ Docker</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/java-plugin-runner/development/">Apache APISIXÂ®ï¸ Java Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/go-plugin-runner/getting-started/">Apache APISIXÂ®ï¸ Go Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/python-plugin-runner/getting-started/">Apache APISIXÂ®ï¸ Python Plugin Runner</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/general/join/">General</a></li></ul></div><a class="navbar__item navbar__link" target="_parent" href="/zh/blog/">åšå®¢</a><a class="navbar__item navbar__link" target="_parent" href="/zh/blog/tags/case-studies/">ç”¨æˆ·æ¡ˆä¾‹</a><a class="navbar__item navbar__link" target="_parent" href="/zh/downloads/">ä¸‹è½½</a><a class="navbar__item navbar__link" target="_parent" href="/zh/help/">å¸®åŠ©</a><a class="navbar__item navbar__link" target="_parent" href="/zh/team/">å›¢é˜Ÿ</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">ç›¸å…³èµ„æº</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/zh/showcase/">ä½¿ç”¨æ¡ˆä¾‹</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/general/code-samples/">Code Samples</a></li><li><a class="dropdown__link" target="_parent" href="/zh/plugins/">æ’ä»¶å¸‚åœº</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/general/join/">åŠ å…¥ç¤¾åŒº</a></li><li><a class="dropdown__link" target="_parent" href="/zh/docs/general/events/">ç¤¾åŒºæ´»åŠ¨</a></li><li><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer" class="dropdown__link">Roadmap</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_zID8"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>ç®€ä½“ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/docs/apisix/3.12/FAQ/" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh/docs/apisix/3.12/FAQ/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></div><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_fBfG"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_GMj9"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_k0Pq"><div class="sidebar_LIo8 sidebarWithHideableNavbar_CMI-"><a target="_parent" tabindex="-1" class="sidebarLogo_P87M" href="/zh/"><img src="/zh/img/logo2.svg" alt="Apache APISIXÂ®" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/zh/img/logo2.svg" alt="Apache APISIXÂ®" class="themedImage_TMUO themedImage--dark_uzRr"><b>Apache APISIXÂ®</b></a><div class="sidebarVersionSwitch_0QIZ">Version:<div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/zh/docs/apisix/3.12/getting-started/README/">3.12</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/apisix/next/FAQ/"><div>Next</div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/FAQ/"><div>3.15<div class="badge_6FVu Latest_oyqS">Latest</div></div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/3.14/FAQ/"><div>3.14</div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/3.13/FAQ/"><div>3.13</div></a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh/docs/apisix/3.12/FAQ/"><div>3.12</div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/3.11/FAQ/"><div>3.11</div></a></li><li><a class="dropdown__link" href="/zh/docs/apisix/3.10/FAQ/"><div>3.10</div></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.9/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.9<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.8/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.8<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.7/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.7<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.6/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.6<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.5/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.5<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.4/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.4<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.3/getting-started/readme/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.3<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.2/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.2<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.1/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.1<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/3.0/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>3.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.15/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.14/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.13/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.12/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.12<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.11/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.11<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.10/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.10<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.9/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.9<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.8/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.8<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.7/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.7<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.6/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.6<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.5/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.5<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://apache-apisix.netlify.app/docs/apisix/2.4/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>2.4<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><nav class="menu thin-scrollbar menu_oAhv menuWithAnnouncementBar_IVfW"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.12/installation-guide/">APISIX å®‰è£…æŒ‡å—</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.12/architecture-design/apisix/">è½¯ä»¶æ¶æ„</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorials</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Terminology</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Plugins</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.12/deployment-modes/">Deployment modes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/zh/docs/apisix/3.12/FAQ/">å¸¸è§é—®é¢˜</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Others</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a href="https://github.com/apache/apisix/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="menu__link"><span>CHANGELOG<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/docs/apisix/3.12/upgrade-guide-from-2.15.x-to-3.0.0/">å‡çº§æŒ‡å—</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_EBxv"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_AF9Q"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_Q970"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for Apache APISIXÂ® -- Cloud-Native API Gateway and AI Gateway <b>3.12</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/zh/docs/apisix/FAQ/">latest version</a></b> (3.15).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 3.12</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>å¸¸è§é—®é¢˜</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªæ–°çš„-api-ç½‘å…³ä¸æ˜¯å·²ç»æœ‰å…¶ä»–çš„å¼€æºç½‘å…³äº†å—"></a>ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªæ–°çš„ API ç½‘å…³ï¼Ÿä¸æ˜¯å·²ç»æœ‰å…¶ä»–çš„å¼€æºç½‘å…³äº†å—ï¼Ÿ<a class="hash-link" href="#ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªæ–°çš„-api-ç½‘å…³ä¸æ˜¯å·²ç»æœ‰å…¶ä»–çš„å¼€æºç½‘å…³äº†å—" title="Direct link to heading">#</a></h2><p>éšç€ä¼ä¸šå‘äº‘æœ¬åœ°å¾®æœåŠ¡çš„å‘å±•ï¼Œä¼ä¸šå¯¹é«˜æ€§èƒ½ã€çµæ´»ã€å®‰å…¨ã€å¯æ‰©å±•çš„ API ç½‘å…³çš„éœ€æ±‚è¶Šæ¥è¶Šå¤§ã€‚</p><p>APISIX åœ¨è¿™äº›æŒ‡æ ‡è¡¨ç°ä¸Šä¼˜äºå…¶å®ƒ API ç½‘å…³ï¼ŒåŒæ—¶å…·æœ‰å¹³å°æ— å…³æ€§å’Œå®Œå…¨åŠ¨æ€çš„ç‰¹æ€§ï¼Œå¦‚æ”¯æŒå¤šç§åè®®ã€ç»†ç²’åº¦è·¯ç”±å’Œå¤šè¯­è¨€æ”¯æŒã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="apisix-å’Œå…¶ä»–çš„-api-ç½‘å…³æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„"></a>APISIX å’Œå…¶ä»–çš„ API ç½‘å…³æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„ï¼Ÿ<a class="hash-link" href="#apisix-å’Œå…¶ä»–çš„-api-ç½‘å…³æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„" title="Direct link to heading">#</a></h2><p>Apache APISIX åœ¨ä»¥ä¸‹æ–¹é¢æœ‰æ‰€ä¸åŒï¼š</p><p>â€” å®ƒä½¿ç”¨ etcd æ¥ä¿å­˜å’ŒåŒæ­¥é…ç½®ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å¦‚ PostgreSQL æˆ– MySQL è¿™ç±»çš„å…³ç³»æ•°æ®åº“ã€‚etcd ä¸­çš„å®æ—¶äº‹ä»¶é€šçŸ¥ç³»ç»Ÿæ¯”è¿™äº›æ›¿ä»£æ–¹æ¡ˆæ›´å®¹æ˜“æ‰©å±•ã€‚è¿™å…è®¸ APISIX å®æ—¶åŒæ­¥é…ç½®ï¼Œä½¿ä»£ç ç®€æ´ï¼Œå¹¶é¿å…å•ç‚¹æ•…éšœã€‚</p><ul><li>å®Œå…¨åŠ¨æ€</li><li>æ”¯æŒ<a href="/zh/docs/apisix/3.12/terminology/plugin/#%E7%83%AD%E5%8A%A0%E8%BD%BD">çƒ­åŠ è½½æ’ä»¶</a>ã€‚</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="apisix-æ‰€å±•ç°å‡ºçš„æ€§èƒ½å¦‚ä½•"></a>APISIX æ‰€å±•ç°å‡ºçš„æ€§èƒ½å¦‚ä½•ï¼Ÿ<a class="hash-link" href="#apisix-æ‰€å±•ç°å‡ºçš„æ€§èƒ½å¦‚ä½•" title="Direct link to heading">#</a></h2><p>ä¸å…¶å®ƒ API ç½‘å…³ç›¸æ¯”ï¼ŒApache APISIX æä¾›äº†æ›´å¥½çš„æ€§èƒ½ï¼Œå…¶å•æ ¸ QPS é«˜è¾¾ 18,000ï¼Œå¹³å‡å»¶è¿Ÿä»…ä¸º 0.2 msã€‚</p><p>å¦‚æœæ‚¨æƒ³è·å–æ€§èƒ½åŸºå‡†æµ‹è¯•çš„å…·ä½“ç»“æœï¼Œè¯·æŸ¥çœ‹ <a href="/zh/docs/apisix/3.12/benchmark/">benchmark</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="apache-apisix-æ”¯æŒå“ªäº›å¹³å°"></a>Apache APISIX æ”¯æŒå“ªäº›å¹³å°ï¼Ÿ<a class="hash-link" href="#apache-apisix-æ”¯æŒå“ªäº›å¹³å°" title="Direct link to heading">#</a></h2><p>Apache APISIX æ˜¯ä¸€ä¸ªå¼€æºçš„äº‘åŸç”Ÿ API ç½‘å…³ï¼Œå®ƒæ”¯æŒåœ¨è£¸é‡‘å±æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œä¹Ÿæ”¯æŒåœ¨ Kubernetes ä¸Šä½¿ç”¨ï¼Œç”šè‡³ä¹Ÿå¯ä»¥è¿è¡Œåœ¨ Apple Silicon ARM èŠ¯ç‰‡ä¸Šã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å¦‚ä½•ç†è§£apache-apisix-æ˜¯å…¨åŠ¨æ€çš„"></a>å¦‚ä½•ç†è§£â€œApache APISIX æ˜¯å…¨åŠ¨æ€çš„â€ï¼Ÿ<a class="hash-link" href="#å¦‚ä½•ç†è§£apache-apisix-æ˜¯å…¨åŠ¨æ€çš„" title="Direct link to heading">#</a></h2><p>Apache APISIX æ˜¯å…¨åŠ¨æ€çš„ API ç½‘å…³ï¼Œæ„å‘³ç€å½“ä½ åœ¨æ›´æ”¹ä¸€ä¸ªé…ç½®åï¼Œåªéœ€è¦é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶å°±å¯ä»¥ä½¿å…¶ç”Ÿæ•ˆã€‚</p><p>APISIX å¯ä»¥åŠ¨æ€å¤„ç†ä»¥ä¸‹è¡Œä¸ºï¼š</p><ul><li>é‡æ–°åŠ è½½æ’ä»¶</li><li>ä»£ç†é‡å†™</li><li>å¯¹è¯·æ±‚è¿›â¾é•œåƒå¤åˆ¶</li><li>å¯¹è¯·æ±‚è¿›â¾ä¿®æ”¹</li><li>å¥åº·çŠ¶æ€çš„æ£€æŸ¥</li><li>åŠ¨æ€æ§åˆ¶æŒ‡å‘ä¸åŒä¸Šæ¸¸æœåŠ¡çš„æµé‡â½</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="apisix-æ˜¯å¦æœ‰æ§åˆ¶å°ç•Œé¢"></a>APISIX æ˜¯å¦æœ‰æ§åˆ¶å°ç•Œé¢ï¼Ÿ<a class="hash-link" href="#apisix-æ˜¯å¦æœ‰æ§åˆ¶å°ç•Œé¢" title="Direct link to heading">#</a></h2><p>APISIX å…·æœ‰åŠŸèƒ½å¼ºå¤§çš„ Dashboardï¼Œå¹¶ä¸” <a href="https://github.com/apache/apisix-dashboard" rel="noopener noreferrer">APISIX Dashboard</a> æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›®ã€‚ä½ å¯ä»¥é€šè¿‡ <a href="https://github.com/apache/apisix-dashboard" rel="noopener noreferrer">APISIX Dashboard</a> ç”¨æˆ·æ“ä½œç•Œé¢æ¥éƒ¨ç½² APISIX Dashboardã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘å¯ä»¥ä¸º-apache-apisix-å¼€å‘é€‚åˆè‡ªèº«ä¸šåŠ¡çš„æ’ä»¶å—"></a>æˆ‘å¯ä»¥ä¸º Apache APISIX å¼€å‘é€‚åˆè‡ªèº«ä¸šåŠ¡çš„æ’ä»¶å—ï¼Ÿ<a class="hash-link" href="#æˆ‘å¯ä»¥ä¸º-apache-apisix-å¼€å‘é€‚åˆè‡ªèº«ä¸šåŠ¡çš„æ’ä»¶å—" title="Direct link to heading">#</a></h2><p>å½“ç„¶å¯ä»¥ï¼ŒAPISIX æä¾›äº†çµæ´»çš„è‡ªå®šä¹‰æ’ä»¶ï¼Œæ–¹ä¾¿å¼€å‘è€…å’Œä¼ä¸šç¼–å†™è‡ªå·±çš„é€»è¾‘ã€‚</p><p>å¦‚æœä½ æƒ³å¼€å‘ç¬¦åˆè‡ªèº«ä¸šåŠ¡é€»è¾‘çš„æ’ä»¶ï¼Œè¯·å‚è€ƒï¼š<a href="/zh/docs/apisix/3.12/plugin-develop/">å¦‚ä½•å¼€å‘æ’ä»¶</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="ä¸ºä»€ä¹ˆ-apache-apisix-é€‰æ‹©-etcd-ä½œä¸ºé…ç½®ä¸­å¿ƒ"></a>ä¸ºä»€ä¹ˆ Apache APISIX é€‰æ‹© etcd ä½œä¸ºé…ç½®ä¸­å¿ƒï¼Ÿ<a class="hash-link" href="#ä¸ºä»€ä¹ˆ-apache-apisix-é€‰æ‹©-etcd-ä½œä¸ºé…ç½®ä¸­å¿ƒ" title="Direct link to heading">#</a></h2><p>å¯¹äºé…ç½®ä¸­å¿ƒï¼Œé…ç½®å­˜å‚¨åªæ˜¯æœ€åŸºæœ¬åŠŸèƒ½ï¼ŒAPISIX è¿˜éœ€è¦ä¸‹é¢å‡ ä¸ªç‰¹æ€§ï¼š</p><ol><li>é›†ç¾¤ä¸­çš„åˆ†å¸ƒå¼éƒ¨ç½²</li><li>é€šè¿‡æ¯”è¾ƒæ¥ç›‘è§†ä¸šåŠ¡</li><li>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</li><li>å˜åŒ–é€šçŸ¥</li><li>é«˜æ€§èƒ½å’Œæœ€å°çš„è¯»/å†™å»¶è¿Ÿ</li></ol><p>etcd æä¾›äº†è¿™äº›ç‰¹æ€§ï¼Œå¹¶ä¸”ä½¿å®ƒæ¯” PostgreSQL å’Œ MySQL ç­‰å…¶ä»–æ•°æ®åº“æ›´ç†æƒ³ã€‚</p><p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº etcd ä¸å…¶ä»–æ›¿ä»£æ–¹æ¡ˆçš„æ¯”è¾ƒï¼Œè¯·å‚è€ƒ<a href="https://etcd.io/docs/latest/learning/why/#comparison-chart" target="_blank" rel="noopener noreferrer">å¯¹æ¯”å›¾è¡¨</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="ä½¿ç”¨-luarocks-å®‰è£…-apache-apisix-ä¾èµ–é¡¹æ—¶ä¸ºä»€ä¹ˆä¼šå¯¼è‡´è¶…æ—¶å®‰è£…ç¼“æ…¢æˆ–å®‰è£…å¤±è´¥"></a>ä½¿ç”¨ LuaRocks å®‰è£… Apache APISIX ä¾èµ–é¡¹æ—¶ï¼Œä¸ºä»€ä¹ˆä¼šå¯¼è‡´è¶…æ—¶ã€å®‰è£…ç¼“æ…¢æˆ–å®‰è£…å¤±è´¥ï¼Ÿ<a class="hash-link" href="#ä½¿ç”¨-luarocks-å®‰è£…-apache-apisix-ä¾èµ–é¡¹æ—¶ä¸ºä»€ä¹ˆä¼šå¯¼è‡´è¶…æ—¶å®‰è£…ç¼“æ…¢æˆ–å®‰è£…å¤±è´¥" title="Direct link to heading">#</a></h2><p>å¯èƒ½æ˜¯å› ä¸ºä½¿ç”¨çš„ LuaRocks æœåŠ¡å™¨å»¶è¿Ÿè¿‡é«˜ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥ä½¿ç”¨ https_proxy æˆ–è€…ä½¿ç”¨ <code>--server</code> å‚æ•°æŒ‡å®šä¸€ä¸ªæ›´å¿«çš„ LuaRocks æœåŠ¡å™¨ã€‚</p><p>ä½ å¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹å¯ç”¨çš„æœåŠ¡å™¨ï¼ˆéœ€è¦ LuaRocks 3.0+ï¼‰ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">luarocks config rocks_servers</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>ä¸­å›½å¤§é™†ç”¨æˆ·å¯ä»¥ä½¿ç”¨ <code>luarocks.cn</code> ä½œä¸º LuaRocks çš„æœåŠ¡å™¨ã€‚</p><p>ä»¥ä¸‹å‘½ä»¤å¯ä»¥å¸®åŠ©ä½ æ›´å¿«é€Ÿçš„å®‰è£…ä¾èµ–ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 bash"><pre tabindex="0" class="prism-code language-bash codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">make</span><span class="token plain"> deps </span><span class="token assign-left variable" style="color:#36acaa">ENV_LUAROCKS_SERVER</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">https://luarocks.cn</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>å¦‚æœé€šè¿‡ä¸Šè¿°æ“ä½œä»ç„¶æ— æ³•è§£å†³é—®é¢˜ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ <code>--verbose</code> æˆ– <code>-v</code> å‚æ•°è·å–è¯¦ç»†çš„æ—¥å¿—æ¥è¯Šæ–­é—®é¢˜ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å¦‚ä½•æ„å»º-apisix-runtime-ç¯å¢ƒ"></a>å¦‚ä½•æ„å»º APISIX-Runtime ç¯å¢ƒï¼Ÿ<a class="hash-link" href="#å¦‚ä½•æ„å»º-apisix-runtime-ç¯å¢ƒ" title="Direct link to heading">#</a></h2><p>æœ‰äº›åŠŸèƒ½éœ€è¦å¼•å…¥é¢å¤–çš„ NGINX æ¨¡å—ï¼Œè¿™å°±è¦æ±‚ APISIX éœ€è¦è¿è¡Œåœ¨ APISIX-Runtime ä¸Šã€‚å¦‚æœä½ éœ€è¦è¿™äº›åŠŸèƒ½ï¼Œä½ å¯ä»¥å‚è€ƒ <a href="https://github.com/api7/apisix-build-tools" rel="noopener noreferrer">api7/apisix-build-tools</a> ä¸­çš„ä»£ç ï¼Œæ„å»ºè‡ªå·±çš„ APISIX-Runtime ç¯å¢ƒã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘è¯¥å¦‚ä½•ä½¿ç”¨-apache-apisix-è¿›è¡Œç°åº¦å‘å¸ƒ"></a>æˆ‘è¯¥å¦‚ä½•ä½¿ç”¨ Apache APISIX è¿›è¡Œç°åº¦å‘å¸ƒï¼Ÿ<a class="hash-link" href="#æˆ‘è¯¥å¦‚ä½•ä½¿ç”¨-apache-apisix-è¿›è¡Œç°åº¦å‘å¸ƒ" title="Direct link to heading">#</a></h2><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼š<code>foo.com/product/index.html?id=204&amp;page=2</code>ï¼Œå¹¶è€ƒè™‘æ‚¨éœ€è¦æ ¹æ®æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­çš„ <code>id</code> åœ¨æ­¤æ¡ä»¶ä¸‹è¿›è¡Œç°åº¦å‘å¸ƒï¼š</p><ol><li>Group A:<code>id &lt;= 1000</code></li><li>Group B:<code>id &gt; 1000</code></li></ol><p>åœ¨ Apache APISIX ä¸­æœ‰ä¸¤ç§ä¸åŒçš„æ–¹æ³•æ¥å®ç°è¿™ä¸€ç‚¹ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ª<a href="/zh/docs/apisix/3.12/terminology/route/">Route</a>å¹¶é…ç½® <code>vars</code> å­—æ®µï¼š</li></ol><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>æ‚¨å¯ä»¥è¿™æ ·ä» <code>config.yaml</code> ä¸­è·å– <code>admin_key</code> å¹¶å­˜å…¥ç¯å¢ƒå˜é‡ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 bash"><pre tabindex="0" class="prism-code language-bash codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">admin_key</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">yq </span><span class="token variable string" style="color:#e3116c">&#x27;.deployment.admin.admin_key[0].key&#x27;</span><span class="token variable" style="color:#36acaa"> conf/config.yaml </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable function" style="color:#d73a49">sed</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable string" style="color:#e3116c">&#x27;s/&quot;//g&#x27;</span><span class="token variable" style="color:#36acaa">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div></div></div><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i http://127.0.0.1:9180/apisix/admin/routes/1 -H </span><span class="token string" style="color:#e3116c">&quot;X-API-KEY: </span><span class="token string variable" style="color:#36acaa">$admin_key</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;: &quot;/index.html&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;vars&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        [&quot;arg_id&quot;, &quot;&lt;=&quot;, &quot;1000&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;redirect&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;uri&quot;: &quot;/test?group_id=1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i http://127.0.0.1:9180/apisix/admin/routes/2 -H </span><span class="token string" style="color:#e3116c">&quot;X-API-KEY: </span><span class="token string variable" style="color:#36acaa">$admin_key</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;: &quot;/index.html&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;vars&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        [&quot;arg_id&quot;, &quot;&gt;&quot;, &quot;1000&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;redirect&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;uri&quot;: &quot;/test?group_id=2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>æ›´å¤š <code>lua-resty-radixtree</code> åŒ¹é…æ“ä½œï¼Œè¯·å‚è€ƒï¼š<a href="https://github.com/api7/lua-resty-radixtree#operator-list" target="_blank" rel="noopener noreferrer">lua-resty-radixtree</a>ã€‚</p><p>2ã€é€šè¿‡ <a href="/zh/docs/apisix/3.12/plugins/traffic-split/">traffic-split</a> æ’ä»¶æ¥å®ç°ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘å¦‚ä½•é€šè¿‡-apache-apisix-å®ç°ä»-http-è‡ªåŠ¨è·³è½¬åˆ°-https"></a>æˆ‘å¦‚ä½•é€šè¿‡ Apache APISIX å®ç°ä» HTTP è‡ªåŠ¨è·³è½¬åˆ° HTTPSï¼Ÿ<a class="hash-link" href="#æˆ‘å¦‚ä½•é€šè¿‡-apache-apisix-å®ç°ä»-http-è‡ªåŠ¨è·³è½¬åˆ°-https" title="Direct link to heading">#</a></h2><p>æ¯”å¦‚ï¼Œå°† <code>http://foo.com</code> é‡å®šå‘åˆ° <code>https://foo.com</code>ã€‚</p><p>Apache APISIX æä¾›äº†å‡ ç§ä¸åŒçš„æ–¹æ³•æ¥å®ç°ï¼š</p><ol><li>åœ¨ <a href="/zh/docs/apisix/3.12/plugins/redirect/">redirect</a> æ’ä»¶ä¸­å°† <code>http_to_https</code> è®¾ç½®ä¸º <code>true</code>ï¼š</li></ol><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9180/apisix/admin/routes/1  -H </span><span class="token string" style="color:#e3116c">&quot;X-API-KEY: </span><span class="token string variable" style="color:#36acaa">$admin_key</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;: &quot;/hello&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;host&quot;: &quot;foo.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;redirect&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;http_to_https&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><ol start="2"><li>ç»“åˆé«˜çº§è·¯ç”±è§„åˆ™ <code>vars</code> å’Œ <code>redirect</code> æ’ä»¶ä¸€èµ·ä½¿ç”¨ï¼š</li></ol><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i http://127.0.0.1:9180/apisix/admin/routes/1  -H </span><span class="token string" style="color:#e3116c">&quot;X-API-KEY: </span><span class="token string variable" style="color:#36acaa">$admin_key</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;: &quot;/hello&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;host&quot;: &quot;foo.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;vars&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        [</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;scheme&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;==&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;http&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;redirect&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;uri&quot;: &quot;https://$host$request_uri&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;ret_code&quot;: 301</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><ol start="3"><li>ä½¿ç”¨ <code>serverless</code> æ’ä»¶ï¼š</li></ol><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i http://127.0.0.1:9180/apisix/admin/routes/1  -H </span><span class="token string" style="color:#e3116c">&quot;X-API-KEY: </span><span class="token string variable" style="color:#36acaa">$admin_key</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;: &quot;/hello&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;serverless-pre-function&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;phase&quot;: &quot;rewrite&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;functions&quot;: [&quot;return function() if ngx.var.scheme == \&quot;http\&quot; and ngx.var.host == \&quot;foo.com\&quot; then ngx.header[\&quot;Location\&quot;] = \&quot;https://foo.com\&quot; .. ngx.var.request_uri; ngx.exit(ngx.HTTP_MOVED_PERMANENTLY); end; end&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>ç„¶åæµ‹è¯•ä¸‹æ˜¯å¦ç”Ÿæ•ˆï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i -H </span><span class="token string" style="color:#e3116c">&#x27;Host: foo.com&#x27;</span><span class="token plain"> http://127.0.0.1:9080/hello</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>å“åº”ä¿¡æ¯åº”è¯¥æ˜¯ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 bash"><pre tabindex="0" class="prism-code language-bash codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 </span><span class="token number" style="color:#36acaa">301</span><span class="token plain"> Moved Permanently</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: Mon, </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> May </span><span class="token number" style="color:#36acaa">2020</span><span class="token plain"> 02:56:04 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: </span><span class="token number" style="color:#36acaa">166</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection: keep-alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Location: https://foo.com/hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server: APISIX web server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">html</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">head</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">title</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">301</span><span class="token plain"> Moved Permanently</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/title</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/head</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">body</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">center</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">h</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">301</span><span class="token plain"> Moved Permanently</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/h</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/center</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">hr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">center</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">openresty</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/center</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/body</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/html</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘åº”è¯¥å¦‚ä½•æ›´æ”¹-apache-apisix-çš„æ—¥å¿—ç­‰çº§"></a>æˆ‘åº”è¯¥å¦‚ä½•æ›´æ”¹ Apache APISIX çš„æ—¥å¿—ç­‰çº§ï¼Ÿ<a class="hash-link" href="#æˆ‘åº”è¯¥å¦‚ä½•æ›´æ”¹-apache-apisix-çš„æ—¥å¿—ç­‰çº§" title="Direct link to heading">#</a></h2><p>Apache APISIX é»˜è®¤çš„æ—¥å¿—ç­‰çº§ä¸º <code>warn</code>ï¼Œä½ éœ€è¦å°†æ—¥å¿—ç­‰çº§è°ƒæ•´ä¸º <code>info</code> æ¥æŸ¥çœ‹ <code>core.log.info</code> çš„æ‰“å°ç»“æœã€‚</p><p>ä½ éœ€è¦å°† <code>./conf/config.yaml</code> ä¸­çš„ <code>nginx_config</code> é…ç½®å‚æ•° <code>error_log_level: &quot;warn&quot;</code> ä¿®æ”¹ä¸º <code>error_log_level: &quot;info&quot;</code>ï¼Œç„¶åé‡æ–°åŠ è½½ Apache APISIX ä½¿å…¶ç”Ÿæ•ˆã€‚</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">nginx_config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">error_log_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;info&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘åº”è¯¥å¦‚ä½•é‡æ–°åŠ è½½-apache-apisix-çš„è‡ªå®šä¹‰æ’ä»¶"></a>æˆ‘åº”è¯¥å¦‚ä½•é‡æ–°åŠ è½½ Apache APISIX çš„è‡ªå®šä¹‰æ’ä»¶ï¼Ÿ<a class="hash-link" href="#æˆ‘åº”è¯¥å¦‚ä½•é‡æ–°åŠ è½½-apache-apisix-çš„è‡ªå®šä¹‰æ’ä»¶" title="Direct link to heading">#</a></h2><p>æ‰€æœ‰çš„ Apache APISIX çš„æ’ä»¶éƒ½æ”¯æŒçƒ­åŠ è½½çš„æ–¹å¼ã€‚</p><p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºçƒ­åŠ è½½çš„å†…å®¹ï¼Œè¯·å‚è€ƒ<a href="/zh/docs/apisix/3.12/terminology/plugin/#%E7%83%AD%E5%8A%A0%E8%BD%BD">çƒ­åŠ è½½</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="åœ¨å¤„ç†-http-æˆ–-https-è¯·æ±‚æ—¶æˆ‘è¯¥å¦‚ä½•é…ç½®-apache-apisix-æ¥ç›‘å¬å¤šä¸ªç«¯å£"></a>åœ¨å¤„ç† HTTP æˆ– HTTPS è¯·æ±‚æ—¶ï¼Œæˆ‘è¯¥å¦‚ä½•é…ç½® Apache APISIX æ¥ç›‘å¬å¤šä¸ªç«¯å£ï¼Ÿ<a class="hash-link" href="#åœ¨å¤„ç†-http-æˆ–-https-è¯·æ±‚æ—¶æˆ‘è¯¥å¦‚ä½•é…ç½®-apache-apisix-æ¥ç›‘å¬å¤šä¸ªç«¯å£" title="Direct link to heading">#</a></h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAPISIX åœ¨å¤„ç† HTTP è¯·æ±‚æ—¶åªç›‘å¬ 9080 ç«¯å£ã€‚</p><p>è¦é…ç½® Apache APISIX ç›‘å¬å¤šä¸ªç«¯å£ï¼Œä½ å¯ä»¥ï¼š</p><ol><li><p>ä¿®æ”¹ <code>conf/config.yaml</code> ä¸­ HTTP ç«¯å£ç›‘å¬çš„å‚æ•° <code>node_listen</code>ï¼Œç¤ºä¾‹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 bash"><pre tabindex="0" class="prism-code language-bash codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">apisix:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  node_listen:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - </span><span class="token number" style="color:#36acaa">9080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - </span><span class="token number" style="color:#36acaa">9081</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - </span><span class="token number" style="color:#36acaa">9082</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>å¤„ç† HTTPS è¯·æ±‚ä¹Ÿç±»ä¼¼ï¼Œä¿®æ”¹ <code>conf/config.yaml</code> ä¸­ HTTPS ç«¯å£ç›‘å¬çš„å‚æ•° <code>ssl.listen</code>ï¼Œç¤ºä¾‹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 bash"><pre tabindex="0" class="prism-code language-bash codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">apisix:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ssl:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enable: </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - port: </span><span class="token number" style="color:#36acaa">9443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - port: </span><span class="token number" style="color:#36acaa">9444</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - port: </span><span class="token number" style="color:#36acaa">9445</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div></li><li><p>é‡å¯æˆ–è€…é‡æ–°åŠ è½½ APISIXã€‚</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å¯ç”¨-ssl-è¯ä¹¦åä¸ºä»€ä¹ˆæ— æ³•é€šè¿‡-https--ip-è®¿é—®å¯¹åº”çš„è·¯ç”±"></a>å¯ç”¨ SSL è¯ä¹¦åï¼Œä¸ºä»€ä¹ˆæ— æ³•é€šè¿‡ HTTPS + IP è®¿é—®å¯¹åº”çš„è·¯ç”±ï¼Ÿ<a class="hash-link" href="#å¯ç”¨-ssl-è¯ä¹¦åä¸ºä»€ä¹ˆæ— æ³•é€šè¿‡-https--ip-è®¿é—®å¯¹åº”çš„è·¯ç”±" title="Direct link to heading">#</a></h2><p>å¦‚æœç›´æ¥ä½¿ç”¨ HTTPS + IP åœ°å€è®¿é—®æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†ä¼šä½¿ç”¨ IP åœ°å€ä¸ç»‘å®šçš„ SNI è¿›è¡Œæ¯”å¯¹ï¼Œç”±äº SSL è¯ä¹¦æ˜¯å’ŒåŸŸåè¿›è¡Œç»‘å®šçš„ï¼Œæ— æ³•åœ¨ SNI ä¸­æ‰¾åˆ°å¯¹åº”çš„èµ„æºï¼Œå› æ­¤è¯ä¹¦å°±ä¼šæ ¡éªŒå¤±è´¥ï¼Œè¿›è€Œå¯¼è‡´ç”¨æˆ·æ— æ³•é€šè¿‡ HTTPS + IP è®¿é—®ç½‘å…³ã€‚</p><p>æ­¤æ—¶ä½ å¯ä»¥é€šè¿‡åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® <code>fallback_sni</code> å‚æ•°ï¼Œå¹¶é…ç½®åŸŸåï¼Œå®ç°è¯¥åŠŸèƒ½ã€‚å½“ç”¨æˆ·ä½¿ç”¨ HTTPS + IP è®¿é—®ç½‘å…³æ—¶ï¼ŒSNI ä¸ºç©ºæ—¶ï¼Œåˆ™ fallback åˆ°é»˜è®¤ SNIï¼Œä»è€Œå®ç° HTTPS + IP è®¿é—®ç½‘å…³ã€‚</p><div class="codeBlockContainer_EiTO"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_PQMO">./conf/config.yaml</div><div class="codeBlockContent_X2I6 yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">apisix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sslï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">fallback_sni</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;${your sni}&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="apisix-å¦‚ä½•åˆ©ç”¨-etcd-å¦‚ä½•å®ç°æ¯«ç§’çº§åˆ«çš„é…ç½®åŒæ­¥"></a>APISIX å¦‚ä½•åˆ©ç”¨ etcd å¦‚ä½•å®ç°æ¯«ç§’çº§åˆ«çš„é…ç½®åŒæ­¥ï¼Ÿ<a class="hash-link" href="#apisix-å¦‚ä½•åˆ©ç”¨-etcd-å¦‚ä½•å®ç°æ¯«ç§’çº§åˆ«çš„é…ç½®åŒæ­¥" title="Direct link to heading">#</a></h2><p>Apache APISIX ä½¿ç”¨ etcd ä½œä¸ºå®ƒçš„é…ç½®ä¸­å¿ƒã€‚etcd æä¾›ä»¥ä¸‹è®¢é˜…åŠŸèƒ½ï¼ˆæ¯”å¦‚ï¼š<a href="https://github.com/api7/lua-resty-etcd/blob/master/api_v3.md#watch" target="_blank" rel="noopener noreferrer">watch</a>ã€<a href="https://github.com/api7/lua-resty-etcd/blob/master/api_v3.md#watchdir" target="_blank" rel="noopener noreferrer">watchdir</a>ï¼‰ã€‚å®ƒå¯ä»¥ç›‘è§†å¯¹ç‰¹å®šå…³é”®å­—æˆ–ç›®å½•çš„æ›´æ”¹ã€‚</p><p>APISIX ä¸»è¦ä½¿ç”¨ <a href="https://github.com/api7/lua-resty-etcd/blob/master/api_v3.md#watchdir" target="_blank" rel="noopener noreferrer">etcd.watchdir</a> ç›‘è§†ç›®å½•å†…å®¹å˜æ›´ï¼š</p><ul><li><p>å¦‚æœç›‘å¬ç›®å½•æ²¡æœ‰æ•°æ®æ›´æ–°ï¼šåˆ™è¯¥è°ƒç”¨ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°è¶…æ—¶æˆ–å…¶ä»–é”™è¯¯è¿”å›ã€‚</p></li><li><p>å¦‚æœç›‘å¬ç›®å½•æœ‰æ•°æ®æ›´æ–°ï¼šetcd å°†ç«‹åˆ»è¿”å›è®¢é˜…ï¼ˆæ¯«ç§’çº§ï¼‰åˆ°çš„æ–°æ•°æ®ï¼ŒAPISIX å°†å®ƒæ›´æ–°åˆ°å†…å­˜ç¼“å­˜ã€‚</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘åº”è¯¥å¦‚ä½•è‡ªå®šä¹‰-apisix-å®ä¾‹-id"></a>æˆ‘åº”è¯¥å¦‚ä½•è‡ªå®šä¹‰ APISIX å®ä¾‹ idï¼Ÿ<a class="hash-link" href="#æˆ‘åº”è¯¥å¦‚ä½•è‡ªå®šä¹‰-apisix-å®ä¾‹-id" title="Direct link to heading">#</a></h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAPISIX ä» <code>conf/apisix.uid</code> ä¸­è¯»å–å®ä¾‹ idã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œä¸”æ²¡æœ‰é…ç½® idï¼ŒAPISIX ä¼šç”Ÿæˆä¸€ä¸ª <code>uuid</code> ä½œä¸ºå®ä¾‹ idã€‚</p><p>è¦æŒ‡å®šä¸€ä¸ªæœ‰æ„ä¹‰çš„ id æ¥ç»‘å®š Apache APISIX åˆ°ä½ çš„å†…éƒ¨ç³»ç»Ÿï¼Œè¯·åœ¨ä½ çš„ <code>./conf/config.yaml</code> ä¸­è®¾ç½® idï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apisix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;your-id&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="ä¸ºä»€ä¹ˆ-errorlog-ä¸­ä¼šå‡ºç°-failed-to-fetch-data-from-etcd-failed-to-read-etcd-dir-etcd-key-xxxxxx-çš„é”™è¯¯"></a>ä¸ºä»€ä¹ˆ <code>error.log</code> ä¸­ä¼šå‡ºç° &quot;failed to fetch data from etcd, failed to read etcd dir, etcd key: xxxxxx&quot; çš„é”™è¯¯ï¼Ÿ<a class="hash-link" href="#ä¸ºä»€ä¹ˆ-errorlog-ä¸­ä¼šå‡ºç°-failed-to-fetch-data-from-etcd-failed-to-read-etcd-dir-etcd-key-xxxxxx-çš„é”™è¯¯" title="Direct link to heading">#</a></h2><p>è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ•…éšœæ’é™¤ï¼š</p><ol><li>ç¡®ä¿ Apache APISIX å’Œé›†ç¾¤ä¸­çš„ etcd éƒ¨ç½²ä¹‹é—´æ²¡æœ‰ä»»ä½•ç½‘ç»œé—®é¢˜ã€‚</li><li>å¦‚æœç½‘ç»œæ­£å¸¸ï¼Œè¯·æ£€æŸ¥æ˜¯å¦ä¸º etcd å¯ç”¨äº†<a href="https://etcd.io/docs/v3.4.0/dev-guide/api_grpc_gateway/" target="_blank" rel="noopener noreferrer">gRPC gateway</a>ã€‚é»˜è®¤çŠ¶æ€å–å†³äºä½ æ˜¯ä½¿ç”¨å‘½ä»¤è¡Œè¿˜æ˜¯é…ç½®æ–‡ä»¶æ¥å¯åŠ¨ etcd æœåŠ¡å™¨ã€‚</li></ol><ul><li>å¦‚æœä½¿ç”¨å‘½ä»¤è¡Œé€‰é¡¹ï¼Œé»˜è®¤å¯ç”¨ gRPC ç½‘å…³ã€‚å¯ä»¥æ‰‹åŠ¨å¯ç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</li></ul><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">etcd --enable-grpc-gateway --data-dir</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/path/to/data</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><strong>æ³¨æ„</strong>ï¼šå½“è¿è¡Œ <code>etcd --help</code> æ—¶ï¼Œè¿™ä¸ªå‚æ•°ä¸ä¼šæ˜¾ç¤ºã€‚</p><ul><li><p>å¦‚æœä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤å…³é—­ gRPC ç½‘å…³ã€‚ä½ å¯ä»¥æ‰‹åŠ¨å¯ç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>åœ¨ <code>etcd.json</code> é…ç½®ï¼š</p></li></ul><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 json"><pre tabindex="0" class="prism-code language-json codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;enable-grpc-gateway&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;data-dir&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/path/to/data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>  åœ¨ <code>etcd.conf.yml</code> é…ç½®</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 yml"><pre tabindex="0" class="prism-code language-yml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">enable-grpc-gateway</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><strong>æ³¨æ„</strong>ï¼šäº‹å®ä¸Šè¿™ç§å·®åˆ«å·²ç»åœ¨ etcd çš„ master åˆ†æ”¯ä¸­æ¶ˆé™¤ï¼Œä½†å¹¶æ²¡æœ‰å‘åå…¼å®¹åˆ°å·²ç»å‘å¸ƒçš„ç‰ˆæœ¬ä¸­ï¼Œæ‰€ä»¥åœ¨éƒ¨ç½² etcd é›†ç¾¤æ—¶ï¼Œä¾ç„¶éœ€è¦å°å¿ƒã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘åº”è¯¥å¦‚ä½•åˆ›å»ºé«˜å¯ç”¨çš„-apache-apisix-é›†ç¾¤"></a>æˆ‘åº”è¯¥å¦‚ä½•åˆ›å»ºé«˜å¯ç”¨çš„ Apache APISIX é›†ç¾¤ï¼Ÿ<a class="hash-link" href="#æˆ‘åº”è¯¥å¦‚ä½•åˆ›å»ºé«˜å¯ç”¨çš„-apache-apisix-é›†ç¾¤" title="Direct link to heading">#</a></h2><p>Apache APISIX å¯ä»¥é€šè¿‡åœ¨å…¶å‰é¢æ·»åŠ ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨æ¥å®ç°é«˜å¯ç”¨æ€§ï¼Œå› ä¸º APISIX çš„æ•°æ®é¢æ˜¯æ— çŠ¶æ€çš„ï¼Œå¹¶ä¸”å¯ä»¥åœ¨éœ€è¦æ—¶è¿›è¡Œæ‰©å±•ã€‚</p><p>Apache APISIX çš„æ§åˆ¶å¹³é¢æ˜¯ä¾èµ–äº <code>etcd cluster</code> çš„é«˜å¯ç”¨å®ç°çš„ï¼Œå®ƒåªä¾èµ–äº etcd é›†ç¾¤ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="ä¸ºä»€ä¹ˆä½¿ç”¨æºç å®‰è£…-apache-apisix-æ—¶æ‰§è¡Œ-make-deps-å‘½ä»¤ä¼šå¤±è´¥"></a>ä¸ºä»€ä¹ˆä½¿ç”¨æºç å®‰è£… Apache APISIX æ—¶ï¼Œæ‰§è¡Œ <code>make deps</code> å‘½ä»¤ä¼šå¤±è´¥ï¼Ÿ<a class="hash-link" href="#ä¸ºä»€ä¹ˆä½¿ç”¨æºç å®‰è£…-apache-apisix-æ—¶æ‰§è¡Œ-make-deps-å‘½ä»¤ä¼šå¤±è´¥" title="Direct link to heading">#</a></h2><p>å½“ä½¿ç”¨æºä»£ç å®‰è£… Apache APISIX æ—¶ï¼Œæ‰§è¡Œ <code>make deps</code> å‘½ä»¤å¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> deps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error: Failed installing dependency: https://luarocks.org/luasec-0.9-1.src.rock - Could not </span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> header </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> OPENSSL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  No </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> openssl/ssl.h </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> /usr/local/include</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You may have to </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> OPENSSL </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> your system and/or pass OPENSSL_DIR or OPENSSL_INCDIR to the luarocks command.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Example: luarocks </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> luasec </span><span class="token assign-left variable" style="color:#36acaa">OPENSSL_DIR</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make: *** </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">deps</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Error </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>è¿™æ˜¯ç”±äºç¼ºå°‘ OpenResty openssl å¼€å‘å·¥å…·åŒ…ã€‚è¦å®‰è£…å®ƒï¼Œè¯·å‚è€ƒ<a href="/zh/docs/apisix/3.12/install-dependencies/">installation dependencies</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘å¦‚ä½•é€šè¿‡-apisix-ä»£ç†è®¿é—®-apisix-dashboard"></a>æˆ‘å¦‚ä½•é€šè¿‡ APISIX ä»£ç†è®¿é—® APISIX Dashboardï¼Ÿ<a class="hash-link" href="#æˆ‘å¦‚ä½•é€šè¿‡-apisix-ä»£ç†è®¿é—®-apisix-dashboard" title="Direct link to heading">#</a></h2><p>ä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œé…ç½®ï¼š</p><ol><li>ä¸º Apache APISIX ä»£ç†å’Œ Admin API é…ç½®ä¸åŒçš„ç«¯å£ï¼Œæˆ–è€…ç¦ç”¨ Admin APIã€‚</li></ol><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">admin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">admin_listen</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># use a separate port</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">ip</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9180</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>2ã€æ·»åŠ  APISIX Dashboard çš„ä»£ç†è·¯ç”±ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i http://127.0.0.1:9180/apisix/admin/routes/1  -H </span><span class="token string" style="color:#e3116c">&quot;X-API-KEY: </span><span class="token string variable" style="color:#36acaa">$admin_key</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uris&quot;:[ &quot;/*&quot; ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;name&quot;:&quot;apisix_proxy_dashboard&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;upstream&quot;:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;nodes&quot;:[</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                &quot;host&quot;:&quot;127.0.0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                &quot;port&quot;:9000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                &quot;weight&quot;:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;type&quot;:&quot;roundrobin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><strong>æ³¨æ„</strong>: Apache APISIX Dashboard æ­£åœ¨ç›‘å¬ <code>127.0.0.1:9000</code>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å¦‚ä½•ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼-regex-åŒ¹é…-route-ä¸­çš„-uri"></a>å¦‚ä½•ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ (regex) åŒ¹é… Route ä¸­çš„ <code>uri</code>ï¼Ÿ<a class="hash-link" href="#å¦‚ä½•ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼-regex-åŒ¹é…-route-ä¸­çš„-uri" title="Direct link to heading">#</a></h2><p>ä½ å¯ä»¥åœ¨ Route ä¸­ä½¿ç”¨ <code>vars</code> å­—æ®µæ¥åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i http://127.0.0.1:9180/apisix/admin/routes/1 -H </span><span class="token string" style="color:#e3116c">&quot;X-API-KEY: </span><span class="token string variable" style="color:#36acaa">$admin_key</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;: &quot;/*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;vars&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        [&quot;uri&quot;, &quot;~~&quot;, &quot;^/[a-z]+$&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;upstream&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;type&quot;: &quot;roundrobin&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;nodes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                &quot;127.0.0.1:1980&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>æµ‹è¯•è¯·æ±‚ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># uri åŒ¹é…æˆåŠŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/hello -i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># uri åŒ¹é…å¤±è´¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/12ab -i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 </span><span class="token number" style="color:#36acaa">404</span><span class="token plain"> Not Found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>å¦‚æœä½ æƒ³äº†è§£ <code>vars</code> å­—æ®µçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒ <a href="https://github.com/api7/lua-resty-expr" target="_blank" rel="noopener noreferrer">lua-resty-expr</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="upstream-èŠ‚ç‚¹æ˜¯å¦æ”¯æŒé…ç½®-fqdn-åœ°å€"></a>Upstream èŠ‚ç‚¹æ˜¯å¦æ”¯æŒé…ç½® <a href="https://en.wikipedia.org/wiki/Fully_qualified_domain_name" target="_blank" rel="noopener noreferrer">FQDN</a> åœ°å€ï¼Ÿ<a class="hash-link" href="#upstream-èŠ‚ç‚¹æ˜¯å¦æ”¯æŒé…ç½®-fqdn-åœ°å€" title="Direct link to heading">#</a></h2><p>è¿™æ˜¯æ”¯æŒçš„ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ª <code>FQDN</code> ä¸º <code>httpbin.default.svc.cluster.local</code>ï¼ˆä¸€ä¸ª Kubernetes Serviceï¼‰çš„ç¤ºä¾‹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9180/apisix/admin/routes/1  -H </span><span class="token string" style="color:#e3116c">&quot;X-API-KEY: </span><span class="token string variable" style="color:#36acaa">$admin_key</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;: &quot;/ip&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;upstream&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;type&quot;: &quot;roundrobin&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;nodes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;httpbin.default.svc.cluster.local&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æµ‹è¯•è·¯ç”±ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/ip -i</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="admin-api-çš„-x-api-key-æŒ‡çš„æ˜¯ä»€ä¹ˆæ˜¯å¦å¯ä»¥ä¿®æ”¹"></a>Admin API çš„ <code>X-API-KEY</code> æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å¦å¯ä»¥ä¿®æ”¹ï¼Ÿ<a class="hash-link" href="#admin-api-çš„-x-api-key-æŒ‡çš„æ˜¯ä»€ä¹ˆæ˜¯å¦å¯ä»¥ä¿®æ”¹" title="Direct link to heading">#</a></h2><p>Admin API çš„ <code>X-API-KEY</code> æŒ‡çš„æ˜¯ <code>./conf/config.yaml</code> æ–‡ä»¶ä¸­çš„ <code>deployment.admin.admin_key.key</code>ï¼Œé»˜è®¤å€¼æ˜¯ <code>edd1c9f034335f136f87ad84b625c8f1</code>ã€‚å®ƒæ˜¯ Admin API çš„è®¿é—® tokenã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒè¢«è®¾ç½®ä¸º <code>edd1c9f034335f136f87ad84b625c8f1</code>ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ <code>./conf/conf/config</code> ä¸­çš„å‚æ•°æ¥ä¿®æ”¹ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">admin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    admin_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;admin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> newkey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">role</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> admin</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>ç„¶åè®¿é—® Admin APIï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i http://127.0.0.1:9180/apisix/admin/routes/1  -H </span><span class="token string" style="color:#e3116c">&#x27;X-API-KEY: newkey&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uris&quot;:[ &quot;/*&quot; ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;name&quot;:&quot;admin-token-test&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;upstream&quot;:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;nodes&quot;:[</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                &quot;host&quot;:&quot;127.0.0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                &quot;port&quot;:1980,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                &quot;weight&quot;:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;type&quot;:&quot;roundrobin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><strong>æ³¨æ„</strong>ï¼šé€šè¿‡ä½¿ç”¨é»˜è®¤ä»¤ç‰Œï¼Œå¯èƒ½ä¼šé¢ä¸´å®‰å…¨é£é™©ã€‚åœ¨å°†å…¶éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œæ›´æ–°ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å¦‚ä½•å…è®¸æ‰€æœ‰-ip-è®¿é—®-apache-apisix-çš„-admin-api"></a>å¦‚ä½•å…è®¸æ‰€æœ‰ IP è®¿é—® Apache APISIX çš„ Admin APIï¼Ÿ<a class="hash-link" href="#å¦‚ä½•å…è®¸æ‰€æœ‰-ip-è®¿é—®-apache-apisix-çš„-admin-api" title="Direct link to heading">#</a></h2><p>Apache APISIX é»˜è®¤åªå…è®¸ <code>127.0.0.0/24</code> çš„ IP æ®µèŒƒå›´è®¿é—® <code>Admin API</code>ï¼Œ</p><p>å¦‚æœä½ æƒ³å…è®¸æ‰€æœ‰çš„ IP è®¿é—®ï¼Œåªéœ€åœ¨ <code>./conf/config.yaml</code> é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹çš„é…ç½®ï¼Œç„¶åé‡å¯æˆ–é‡æ–°åŠ è½½ APISIX å°±å¯ä»¥è®©æ‰€æœ‰ IP è®¿é—® <code>Admin API</code>ã€‚</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">admin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">allow_admin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 0.0.0.0/0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><strong>æ³¨æ„</strong>ï¼šä½ å¯ä»¥åœ¨éç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æ­¤æ–¹æ³•ï¼Œä»¥å…è®¸æ‰€æœ‰å®¢æˆ·ç«¯ä»ä»»ä½•åœ°æ–¹è®¿é—® Apache APISIX å®ä¾‹ï¼Œä½†æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¯¥è®¾ç½®å¹¶ä¸å®‰å…¨ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·ä»…æˆæƒç‰¹å®šçš„ IP åœ°å€æˆ–åœ°å€èŒƒå›´è®¿é—® Apache APISIX å®ä¾‹ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å¦‚ä½•åŸºäº-acmesh-è‡ªåŠ¨æ›´æ–°-apisix-ssl-è¯ä¹¦"></a>å¦‚ä½•åŸºäº acme.sh è‡ªåŠ¨æ›´æ–° APISIX SSL è¯ä¹¦ï¼Ÿ<a class="hash-link" href="#å¦‚ä½•åŸºäº-acmesh-è‡ªåŠ¨æ›´æ–°-apisix-ssl-è¯ä¹¦" title="Direct link to heading">#</a></h2><p>ä½ å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®ç°è¿™ä¸€ç‚¹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 bash"><pre tabindex="0" class="prism-code language-bash codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --output /root/.acme.sh/renew-hook-update-apisix.sh --silent https://gist.githubusercontent.com/anjia0532/9ebf8011322f43e3f5037bc2af3aeaa6/raw/65b359a4eed0ae990f9188c2afa22bacd8471652/renew-hook-update-apisix.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 bash"><pre tabindex="0" class="prism-code language-bash codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x /root/.acme.sh/renew-hook-update-apisix.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 bash"><pre tabindex="0" class="prism-code language-bash codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">acme.sh  --issue  --staging  -d demo.domain --renew-hook </span><span class="token string" style="color:#e3116c">&quot;/root/.acme.sh/renew-hook-update-apisix.sh  -h http://apisix-admin:port -p /root/.acme.sh/demo.domain/demo.domain.cer -k /root/.acme.sh/demo.domain/demo.domain.key -a xxxxxxxxxxxxx&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 bash"><pre tabindex="0" class="prism-code language-bash codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">acme.sh --renew --domain demo.domain</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>è¯¦ç»†æ­¥éª¤ï¼Œè¯·å‚è€ƒ <a href="https://juejin.cn/post/6965778290619449351" target="_blank" rel="noopener noreferrer">APISIX åŸºäº acme.sh è‡ªåŠ¨æ›´æ–° HTTPS è¯ä¹¦</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="åœ¨-apache-apisix-ä¸­æˆ‘å¦‚ä½•åœ¨è½¬å‘åˆ°ä¸Šæ¸¸ä¹‹å‰ä»è·¯å¾„ä¸­åˆ é™¤ä¸€ä¸ªå‰ç¼€"></a>åœ¨ Apache APISIX ä¸­ï¼Œæˆ‘å¦‚ä½•åœ¨è½¬å‘åˆ°ä¸Šæ¸¸ä¹‹å‰ä»è·¯å¾„ä¸­åˆ é™¤ä¸€ä¸ªå‰ç¼€ï¼Ÿ<a class="hash-link" href="#åœ¨-apache-apisix-ä¸­æˆ‘å¦‚ä½•åœ¨è½¬å‘åˆ°ä¸Šæ¸¸ä¹‹å‰ä»è·¯å¾„ä¸­åˆ é™¤ä¸€ä¸ªå‰ç¼€" title="Direct link to heading">#</a></h2><p>åœ¨è½¬å‘è‡³ä¸Šæ¸¸ä¹‹å‰ç§»é™¤è¯·æ±‚è·¯å¾„ä¸­çš„å‰ç¼€ï¼Œæ¯”å¦‚è¯´ä» <code>/foo/get</code> æ”¹æˆ <code>/get</code>ï¼Œå¯ä»¥é€šè¿‡ <code>[proxy-rewrite](/zh/docs/apisix/3.12/plugins/proxy-rewrite)</code> æ’ä»¶æ¥å®ç°ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -i http://127.0.0.1:9180/apisix/admin/routes/1 -H </span><span class="token string" style="color:#e3116c">&quot;X-API-KEY: </span><span class="token string variable" style="color:#36acaa">$admin_key</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;: &quot;/foo/*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;proxy-rewrite&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;regex_uri&quot;: [&quot;^/foo/(.*)&quot;,&quot;/$1&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;upstream&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;type&quot;: &quot;roundrobin&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;nodes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;httpbin.org:80&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>æµ‹è¯•è¿™ä¸ªé…ç½®ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/foo/get -i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;url&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1/get&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘åº”è¯¥å¦‚ä½•è§£å†³-unable-to-get-local-issuer-certificate-è¿™ä¸ªé”™è¯¯"></a>æˆ‘åº”è¯¥å¦‚ä½•è§£å†³ <code>unable to get local issuer certificate</code> è¿™ä¸ªé”™è¯¯ï¼Ÿ<a class="hash-link" href="#æˆ‘åº”è¯¥å¦‚ä½•è§£å†³-unable-to-get-local-issuer-certificate-è¿™ä¸ªé”™è¯¯" title="Direct link to heading">#</a></h2><p>ä½ å¯ä»¥æ‰‹åŠ¨è®¾ç½®è¯ä¹¦çš„è·¯å¾„ï¼Œå°†å…¶æ·»åŠ åˆ° <code>./conf/config.yaml</code> æ–‡ä»¶ä¸­ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apisix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ssl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ssl_trusted_certificate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /path/to/certs/ca</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">certificates.crt</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p><strong>æ³¨æ„ï¼š</strong>å½“ä½ å°è¯•ä½¿ç”¨ cosocket è¿æ¥ä»»ä½• TLS æœåŠ¡æ—¶ï¼Œå¦‚æœ APISIX ä¸ä¿¡ä»»å¯¹ç«¯ TLS æœåŠ¡è¯ä¹¦ï¼Œéƒ½éœ€è¦é…ç½® <code>apisix.ssl.ssl_trusted_certificate</code>ã€‚</p><p>ä¾‹å¦‚ï¼šå¦‚æœåœ¨ APISIX ä¸­ä½¿ç”¨ Nacos ä½œä¸ºæœåŠ¡å‘ç°æ—¶ï¼ŒNacos å¼€å¯äº† TLS åè®®ï¼Œå³ Nacos é…ç½®çš„ <code>host</code> æ˜¯ <code>https://</code> å¼€å¤´ï¼Œå°±éœ€è¦é…ç½® <code>apisix.ssl.ssl_trusted_certificate</code>ï¼Œå¹¶ä¸”ä½¿ç”¨å’Œ Nacos ç›¸åŒçš„ CA è¯ä¹¦ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="æˆ‘åº”è¯¥å¦‚ä½•è§£å†³-module-restyworkerevents-not-found-è¿™ä¸ªé”™è¯¯"></a>æˆ‘åº”è¯¥å¦‚ä½•è§£å†³ <code>module &#x27;resty.worker.events&#x27; not found</code> è¿™ä¸ªé”™è¯¯ï¼Ÿ<a class="hash-link" href="#æˆ‘åº”è¯¥å¦‚ä½•è§£å†³-module-restyworkerevents-not-found-è¿™ä¸ªé”™è¯¯" title="Direct link to heading">#</a></h2><p>å¼•èµ·è¿™ä¸ªé”™è¯¯çš„åŸå› æ˜¯åœ¨ <code>/root</code> ç›®å½•ä¸‹å®‰è£…äº† APISIXã€‚å› ä¸º worker è¿›ç¨‹çš„ç”¨æˆ·æ˜¯ nobodyï¼Œæ— æƒè®¿é—® <code>/root</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</p><p>è§£å†³åŠæ³•æ˜¯æ”¹å˜ APISIX çš„å®‰è£…ç›®å½•ï¼Œæ¨èå®‰è£…åœ¨ <code>/usr/local</code> ç›®å½•ä¸‹ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="åœ¨-apache-apisix-ä¸­plugin-metadata-å’Œ-plugin-configs-æœ‰ä»€ä¹ˆåŒºåˆ«"></a>åœ¨ Apache APISIX ä¸­ï¼Œ<code>plugin-metadata</code> å’Œ <code>plugin-configs</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<a class="hash-link" href="#åœ¨-apache-apisix-ä¸­plugin-metadata-å’Œ-plugin-configs-æœ‰ä»€ä¹ˆåŒºåˆ«" title="Direct link to heading">#</a></h2><p>ä¸¤è€…ä¹‹é—´çš„å·®å¼‚å¦‚ä¸‹ï¼š</p><table><thead><tr><th><code>plugin-metadata</code></th><th><code>plugin-config</code></th></tr></thead><tbody><tr><td>å½“æ›´æ”¹è¯¥ Plugin å±æ€§åï¼Œéœ€è¦åº”ç”¨åˆ°é…ç½®è¯¥æ’ä»¶çš„æ‰€æœ‰è·¯ç”±ä¸Šæ—¶ä½¿ç”¨ã€‚</td><td>å½“ä½ éœ€è¦å¤ç”¨ä¸€ç»„é€šç”¨çš„æ’ä»¶é…ç½®æ—¶ä½¿ç”¨ï¼Œå¯ä»¥æŠŠ Plugin é…ç½®æå–åˆ°ä¸€ä¸ª <code>plugin-config</code> å¹¶ç»‘å®šåˆ°ä¸åŒçš„è·¯ç”±ã€‚</td></tr><tr><td>å¯¹ç»‘å®šåˆ° Plugin çš„é…ç½®å®ä¾‹çš„æ‰€æœ‰å®ä½“ç”Ÿæ•ˆã€‚</td><td>å¯¹ç»‘å®šåˆ° <code>plugin-config</code> çš„è·¯ç”±ç”Ÿæ•ˆã€‚</td></tr><tr><td>å¯¹ç»‘å®šåˆ° Plugin çš„é…ç½®å®ä¾‹çš„æ‰€æœ‰å®ä½“ç”Ÿæ•ˆã€‚</td><td>å¯¹ç»‘å®šåˆ° <code>plugin-config</code> çš„è·¯ç”±ç”Ÿæ•ˆã€‚</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="éƒ¨ç½²äº†-apache-apisix-ä¹‹åå¦‚ä½•æ£€æµ‹-apisix-æ•°æ®å¹³é¢çš„å­˜æ´»æƒ…å†µå¦‚ä½•æ¢æ´»"></a>éƒ¨ç½²äº† Apache APISIX ä¹‹åï¼Œå¦‚ä½•æ£€æµ‹ APISIX æ•°æ®å¹³é¢çš„å­˜æ´»æƒ…å†µï¼ˆå¦‚ä½•æ¢æ´»ï¼‰?<a class="hash-link" href="#éƒ¨ç½²äº†-apache-apisix-ä¹‹åå¦‚ä½•æ£€æµ‹-apisix-æ•°æ®å¹³é¢çš„å­˜æ´»æƒ…å†µå¦‚ä½•æ¢æ´»" title="Direct link to heading">#</a></h2><p>å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º <code>health-info</code> çš„è·¯ç”±ï¼Œå¹¶å¼€å¯ <a href="https://apisix.apache.org/zh/docs/apisix/plugins/fault-injection/" rel="noopener noreferrer">fault-injection</a> æ’ä»¶ï¼ˆå…¶ä¸­ YOUR-TOKEN æ˜¯ç”¨æˆ·è‡ªå·±çš„ tokenï¼›127.0.0.1 æ˜¯æ§åˆ¶å¹³é¢çš„ IP åœ°å€ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹ï¼‰:</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9180/apisix/admin/routes/health-info </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H </span><span class="token string" style="color:#e3116c">&#x27;X-API-KEY: YOUR-TOKEN&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;plugins&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;fault-injection&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;abort&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">       &quot;http_status&quot;: 200,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">       &quot;body&quot;: &quot;fine&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;uri&quot;: &quot;/status&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>éªŒè¯æ–¹å¼ï¼š</p><p>è®¿é—® Apache APISIX æ•°æ®å¹³é¢çš„ <code>/status</code> æ¥æ¢æµ‹ APISIXï¼Œå¦‚æœ response code æ˜¯ 200 å°±ä»£è¡¨ APISIX å­˜æ´»ã€‚</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>è¿™ä¸ªæ–¹å¼åªæ˜¯æ¢æµ‹ APISIX æ•°æ®å¹³é¢æ˜¯å¦å­˜æ´»ï¼Œå¹¶ä¸ä»£è¡¨ APISIX çš„è·¯ç”±å’Œå…¶ä»–åŠŸèƒ½æ˜¯æ­£å¸¸çš„ï¼Œè¿™äº›éœ€è¦æ›´å¤šè·¯ç”±çº§åˆ«çš„æ¢æµ‹ã€‚</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="apisix-ä¸-etcd-ç›¸å…³çš„å»¶è¿Ÿè¾ƒé«˜çš„é—®é¢˜æœ‰å“ªäº›å¦‚ä½•ä¿®å¤"></a>APISIX ä¸ <a href="https://etcd.io/" target="_blank" rel="noopener noreferrer">etcd</a> ç›¸å…³çš„å»¶è¿Ÿè¾ƒé«˜çš„é—®é¢˜æœ‰å“ªäº›ï¼Œå¦‚ä½•ä¿®å¤ï¼Ÿ<a class="hash-link" href="#apisix-ä¸-etcd-ç›¸å…³çš„å»¶è¿Ÿè¾ƒé«˜çš„é—®é¢˜æœ‰å“ªäº›å¦‚ä½•ä¿®å¤" title="Direct link to heading">#</a></h2><p>etcd ä½œä¸º APISIX çš„æ•°æ®å­˜å‚¨ç»„ä»¶ï¼Œå®ƒçš„ç¨³å®šæ€§å…³ä¹ APISIX çš„ç¨³å®šæ€§ã€‚åœ¨å®é™…åœºæ™¯ä¸­ï¼Œå¦‚æœ APISIX ä½¿ç”¨è¯ä¹¦é€šè¿‡ HTTPS çš„æ–¹å¼è¿æ¥ etcdï¼Œå¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹ 2 ç§æ•°æ®æŸ¥è¯¢æˆ–å†™å…¥å»¶è¿Ÿè¾ƒé«˜çš„é—®é¢˜ï¼š</p><ol><li>é€šè¿‡æ¥å£æ“ä½œ APISIX Admin API è¿›è¡Œæ•°æ®çš„æŸ¥è¯¢æˆ–å†™å…¥ï¼Œå»¶è¿Ÿè¾ƒé«˜ã€‚</li><li>åœ¨ç›‘æ§ç³»ç»Ÿä¸­ï¼ŒPrometheus æŠ“å– APISIX æ•°æ®é¢ Metrics æ¥å£è¶…æ—¶ã€‚</li></ol><p>è¿™äº›å»¶è¿Ÿé—®é¢˜ï¼Œä¸¥é‡å½±å“äº† APISIX çš„æœåŠ¡ç¨³å®šæ€§ï¼Œè€Œä¹‹æ‰€ä»¥ä¼šå‡ºç°è¿™ç±»é—®é¢˜ï¼Œä¸»è¦æ˜¯å› ä¸º etcd å¯¹å¤–æä¾›äº† 2 ç§æ“ä½œæ–¹å¼ï¼šHTTPï¼ˆHTTPSï¼‰ã€gRPCã€‚è€Œ APISIX é»˜è®¤æ˜¯åŸºäº HTTPï¼ˆHTTPSï¼‰åè®®æ¥æ“ä½œ etcd çš„ã€‚</p><p>åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œetcd å­˜åœ¨ä¸€ä¸ªå…³äº HTTP/2 çš„ BUGï¼šå¦‚æœé€šè¿‡ HTTPS æ“ä½œ etcdï¼ˆHTTP ä¸å—å½±å“ï¼‰ï¼ŒHTTP/2 çš„è¿æ¥æ•°ä¸Šé™ä¸º Golang é»˜è®¤çš„ <code>250</code> ä¸ªã€‚</p><p>æ‰€ä»¥ï¼Œå½“ APISIX æ•°æ®é¢èŠ‚ç‚¹æ•°è¾ƒå¤šæ—¶ï¼Œä¸€æ—¦æ‰€æœ‰ APISIX èŠ‚ç‚¹ä¸ etcd è¿æ¥æ•°è¶…è¿‡è¿™ä¸ªä¸Šé™ï¼Œåˆ™ APISIX çš„æ¥å£å“åº”ä¼šéå¸¸çš„æ…¢ã€‚</p><p>Golang ä¸­ï¼Œé»˜è®¤çš„ HTTP/2 ä¸Šé™ä¸º <code>250</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 go"><pre tabindex="0" class="prism-code language-go codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> http2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prefaceTimeout         </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Second</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    firstSettingsTimeout   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Second </span><span class="token comment" style="color:#999988;font-style:italic">// should be in-flight with preface anyway</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    handlerChunkWriteSize  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultMaxStreams      </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">250</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// TODO: make this 100 as the GFE seems to?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    maxQueuedControlFrames </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>ç›®å‰ï¼Œetcd å®˜æ–¹ä¸»è¦ç»´æŠ¤äº† <code>3.4</code> å’Œ <code>3.5</code> è¿™ä¸¤ä¸ªä¸»è¦ç‰ˆæœ¬ã€‚åœ¨ <code>3.4</code> ç³»åˆ—ä¸­ï¼Œè¿‘æœŸå‘å¸ƒçš„ <code>3.4.20</code> ç‰ˆæœ¬å·²ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ã€‚è‡³äº <code>3.5</code> ç‰ˆæœ¬ï¼Œå…¶å®ï¼Œå®˜æ–¹å¾ˆæ—©ä¹‹å‰å°±åœ¨ç­¹å¤‡å‘å¸ƒ <code>3.5.5</code> ç‰ˆæœ¬äº†ï¼Œä½†æˆªæ­¢ç›®å‰ï¼ˆ2022.09.13ï¼‰ä»å°šæœªå‘å¸ƒã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ etcd çš„ç‰ˆæœ¬å°äº <code>3.5.5</code>ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹å‡ ç§æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><ol><li>å°† APISIX ä¸ etcd çš„é€šè®¯æ–¹å¼ç”± HTTPS æ”¹ä¸º HTTPã€‚</li><li>å°† etcd ç‰ˆæœ¬å›é€€åˆ° <code>3.4.20</code>ã€‚</li><li>å°† etcd æºç å…‹éš†ä¸‹æ¥ï¼Œç›´æ¥ç¼–è¯‘ <code>release-3.5</code> åˆ†æ”¯ï¼ˆæ­¤åˆ†æ”¯å·²ä¿®å¤ï¼Œåªæ˜¯å°šæœªå‘å¸ƒæ–°ç‰ˆæœ¬è€Œå·²ï¼‰ã€‚</li></ol><p>é‡æ–°ç¼–è¯‘ etcd çš„æ–¹å¼å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout release-3.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">GOOS</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">linux </span><span class="token assign-left variable" style="color:#36acaa">GOARCH</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">amd64</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>ç¼–è¯‘çš„äºŒè¿›åˆ¶åœ¨ <code>bin</code> ç›®å½•ä¸‹ï¼Œå°†å…¶æ›¿æ¢æ‰ä½ æœåŠ¡å™¨ç¯å¢ƒçš„ etcd äºŒè¿›åˆ¶åï¼Œç„¶åé‡å¯ etcd å³å¯ã€‚</p><p>æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒï¼š</p><ul><li><a href="https://github.com/etcd-io/etcd/issues/14185" target="_blank" rel="noopener noreferrer">when etcd node have many http long polling connections, it may cause etcd to respond slowly to http requests.</a></li><li><a href="https://github.com/apache/apisix/issues/7078" rel="noopener noreferrer">bug: when apisix starts for a while, its communication with etcd starts to time out</a></li><li><a href="https://github.com/apache/apisix/issues/7353" rel="noopener noreferrer">the prometheus metrics API is tool slow</a></li><li><a href="https://github.com/etcd-io/etcd/pull/14169" target="_blank" rel="noopener noreferrer">Support configuring <code>MaxConcurrentStreams</code> for http2</a></li></ul><p>å¦å¤–ä¸€ç§è§£å†³åŠæ³•æ˜¯æ”¹ç”¨å®éªŒæ€§çš„åŸºäº gRPC çš„é…ç½®åŒæ­¥ã€‚éœ€è¦åœ¨é…ç½®æ–‡ä»¶ <code>conf/config.yaml</code> ä¸­è®¾ç½® <code>use_grpc: true</code>ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">etcd</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">use_grpc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:2379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/apisix&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="ä¸ºä»€ä¹ˆ-file-logger-è®°å½•æ—¥å¿—ä¼šå‡ºç°ä¹±ç "></a>ä¸ºä»€ä¹ˆ file-logger è®°å½•æ—¥å¿—ä¼šå‡ºç°ä¹±ç ï¼Ÿ<a class="hash-link" href="#ä¸ºä»€ä¹ˆ-file-logger-è®°å½•æ—¥å¿—ä¼šå‡ºç°ä¹±ç " title="Direct link to heading">#</a></h2><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ <code>file-logger</code> æ’ä»¶ï¼Œä½†æ˜¯åœ¨æ—¥å¿—æ–‡ä»¶ä¸­å‡ºç°äº†ä¹±ç ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯å› ä¸ºä¸Šæ¸¸æœåŠ¡çš„å“åº”ä½“è¢«è¿›è¡Œäº†å‹ç¼©ã€‚ä½ å¯ä»¥å°†è¯·æ±‚å¤´å¸¦ä¸Šä¸æ¥æ”¶å‹ç¼©å“åº”å‚æ•°ï¼ˆ<code>gzip;q=0,deflate,sdch</code>ï¼‰ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥ä½¿ç”¨ <a href="https://apisix.apache.org/docs/apisix/plugins/proxy-rewrite/" rel="noopener noreferrer">proxy-rewirte</a> æ’ä»¶å°†è¯·æ±‚å¤´ä¸­çš„ <code>accept-encoding</code> è®¾ç½®ä¸ºä¸æ¥æ”¶å‹ç¼©å“åº”ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9180/apisix/admin/routes/1 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H </span><span class="token string" style="color:#e3116c">&#x27;X-API-KEY: YOUR-TOKEN&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;methods&quot;:[</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;GET&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;:&quot;/test/index.html&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;proxy-rewrite&quot;:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;headers&quot;:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                &quot;set&quot;:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    &quot;accept-encoding&quot;:&quot;gzip;q=0,deflate,sdch&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;upstream&quot;:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;type&quot;:&quot;roundrobin&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;nodes&quot;:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;127.0.0.1:80&quot;:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="apisix-å¦‚ä½•é…ç½®å¸¦è®¤è¯çš„-etcd"></a>APISIX å¦‚ä½•é…ç½®å¸¦è®¤è¯çš„ ETCDï¼Ÿ<a class="hash-link" href="#apisix-å¦‚ä½•é…ç½®å¸¦è®¤è¯çš„-etcd" title="Direct link to heading">#</a></h2><p>å‡è®¾æ‚¨æœ‰ä¸€ä¸ªå¯ç”¨èº«ä»½éªŒè¯çš„ ETCD é›†ç¾¤ã€‚è¦è®¿é—®è¯¥é›†ç¾¤ï¼Œéœ€è¦åœ¨ <code>conf/config.yaml</code> ä¸­ä¸º Apache APISIX é…ç½®æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼š</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_UxnK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">etcd</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:2379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> etcd_user             </span><span class="token comment" style="color:#999988;font-style:italic"># username for etcd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> etcd_password     </span><span class="token comment" style="color:#999988;font-style:italic"># password for etcd</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn">Copy</button></div></div><p>å…³äº ETCD çš„å…¶ä»–é…ç½®ï¼Œæ¯”å¦‚è¿‡æœŸæ—¶é—´ã€é‡è¯•æ¬¡æ•°ç­‰ç­‰ï¼Œä½ å¯ä»¥å‚è€ƒ <code>conf/config.yaml.example</code> æ–‡ä»¶ä¸­çš„ <code>etcd</code> éƒ¨åˆ†ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="ssls-å¯¹è±¡ä¸-upstream-å¯¹è±¡ä¸­çš„-tlsclient_cert-ä»¥åŠ-configyaml-ä¸­çš„-ssl_trusted_certificate-åŒºåˆ«æ˜¯ä»€ä¹ˆ"></a>SSLs å¯¹è±¡ä¸ <code>upstream</code> å¯¹è±¡ä¸­çš„ <code>tls.client_cert</code> ä»¥åŠ <code>config.yaml</code> ä¸­çš„ <code>ssl_trusted_certificate</code> åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ<a class="hash-link" href="#ssls-å¯¹è±¡ä¸-upstream-å¯¹è±¡ä¸­çš„-tlsclient_cert-ä»¥åŠ-configyaml-ä¸­çš„-ssl_trusted_certificate-åŒºåˆ«æ˜¯ä»€ä¹ˆ" title="Direct link to heading">#</a></h2><p>Admin API ä¸­ <code>/apisix/admin/ssls</code> ç”¨äºç®¡ç† SSL å¯¹è±¡ï¼Œå¦‚æœ APISIX éœ€è¦æ¥æ”¶æ¥è‡ªå¤–ç½‘çš„ HTTPS è¯·æ±‚ï¼Œé‚£å°±éœ€è¦ç”¨åˆ°å­˜æ”¾åœ¨è¿™é‡Œçš„è¯ä¹¦å®Œæˆæ¡æ‰‹ã€‚SSL å¯¹è±¡ä¸­æ”¯æŒé…ç½®å¤šä¸ªè¯ä¹¦ï¼Œä¸åŒåŸŸåçš„è¯ä¹¦ APISIX å°†ä½¿ç”¨ Server Name Indication (SNI) è¿›è¡ŒåŒºåˆ†ã€‚</p><p>Upstream å¯¹è±¡ä¸­çš„ <code>tls.client_cert</code>ã€<code>tls.client_key</code> ä¸ <code>tls.client_cert_id</code> ç”¨äºå­˜æ”¾å®¢æˆ·ç«¯çš„è¯ä¹¦ï¼Œé€‚ç”¨äºéœ€è¦ä¸ä¸Šæ¸¸è¿›è¡Œ <a href="https://apisix.apache.org/zh/docs/apisix/tutorials/client-to-apisix-mtls/" rel="noopener noreferrer">mTLS é€šä¿¡</a>çš„æƒ…å†µã€‚</p><p><code>config.yaml</code> ä¸­çš„ <code>ssl_trusted_certificate</code> ç”¨äºé…ç½®ä¸€ä¸ªå—ä¿¡ä»»çš„æ ¹è¯ä¹¦ã€‚å®ƒä»…ç”¨äºåœ¨ APISIX å†…éƒ¨è®¿é—®æŸäº›å…·æœ‰è‡ªç­¾åè¯ä¹¦çš„æœåŠ¡æ—¶ï¼Œé¿å…æç¤ºæ‹’ç»å¯¹æ–¹çš„ SSL è¯ä¹¦ã€‚æ³¨æ„ï¼šå®ƒä¸ç”¨äºä¿¡ä»» APISIX ä¸Šæ¸¸çš„è¯ä¹¦ï¼Œå› ä¸º APISIX ä¸ä¼šéªŒè¯ä¸Šæ¸¸è¯ä¹¦çš„åˆæ³•æ€§ã€‚å› æ­¤ï¼Œå³ä½¿ä¸Šæ¸¸ä½¿ç”¨äº†æ— æ•ˆçš„ TLS è¯ä¹¦ï¼ŒAPISIX ä»ç„¶å¯ä»¥ä¸å…¶é€šä¿¡ï¼Œè€Œæ— éœ€é…ç½®æ ¹è¯ä¹¦ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="å¦‚æœåœ¨ä½¿ç”¨-apisix-è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜æˆ‘å¯ä»¥åœ¨å“ªé‡Œå¯»æ±‚æ›´å¤šå¸®åŠ©"></a>å¦‚æœåœ¨ä½¿ç”¨ APISIX è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œæˆ‘å¯ä»¥åœ¨å“ªé‡Œå¯»æ±‚æ›´å¤šå¸®åŠ©ï¼Ÿ<a class="hash-link" href="#å¦‚æœåœ¨ä½¿ç”¨-apisix-è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜æˆ‘å¯ä»¥åœ¨å“ªé‡Œå¯»æ±‚æ›´å¤šå¸®åŠ©" title="Direct link to heading">#</a></h2><ul><li><a target="_blank" href="/zh/docs/general/join/#%E5%8A%A0%E5%85%A5-slack-%E9%A2%91%E9%81%93">Apache APISIX Slack Channel</a>ï¼šåŠ å…¥åè¯·é€‰æ‹© channel-apisix é¢‘é“ï¼Œå³å¯é€šè¿‡æ­¤é¢‘é“è¿›è¡Œ APISIX ç›¸å…³é—®é¢˜çš„æé—®ã€‚</li><li><a target="_blank" href="/zh/docs/general/join/#%E8%AE%A2%E9%98%85%E9%82%AE%E4%BB%B6%E5%88%97%E8%A1%A8">é‚®ä»¶åˆ—è¡¨</a>ï¼šä»»ä½•é—®é¢˜æˆ–å¯¹é¡¹ç›®æè®®éƒ½å¯ä»¥é€šè¿‡ç¤¾åŒºé‚®ä»¶è¿›è¡Œè®¨è®ºã€‚</li><li><a href="https://github.com/apache/apisix/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc" rel="noopener noreferrer">GitHub Issues</a> ä¸ <a href="https://github.com/apache/apisix/discussions" rel="noopener noreferrer">GitHub Discussions</a>ï¼šä¹Ÿå¯ç›´æ¥åœ¨ GitHub ä¸­è¿›è¡Œç›¸å…³ issue åˆ›å»ºè¿›è¡Œé—®é¢˜çš„è¡¨è¿°ã€‚</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="/zh/edit#https://github.com/apache/apisix/edit/release/3.12/docs/zh/latest/FAQ.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh/docs/apisix/3.12/deployment-modes/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Deployment modes</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh/docs/apisix/3.12/discovery/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">é›†æˆæœåŠ¡å‘ç°æ³¨å†Œä¸­å¿ƒ Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªæ–°çš„-api-ç½‘å…³ä¸æ˜¯å·²ç»æœ‰å…¶ä»–çš„å¼€æºç½‘å…³äº†å—" class="table-of-contents__link">ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªæ–°çš„ API ç½‘å…³ï¼Ÿä¸æ˜¯å·²ç»æœ‰å…¶ä»–çš„å¼€æºç½‘å…³äº†å—ï¼Ÿ</a></li><li><a href="#apisix-å’Œå…¶ä»–çš„-api-ç½‘å…³æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„" class="table-of-contents__link">APISIX å’Œå…¶ä»–çš„ API ç½‘å…³æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„ï¼Ÿ</a></li><li><a href="#apisix-æ‰€å±•ç°å‡ºçš„æ€§èƒ½å¦‚ä½•" class="table-of-contents__link">APISIX æ‰€å±•ç°å‡ºçš„æ€§èƒ½å¦‚ä½•ï¼Ÿ</a></li><li><a href="#apache-apisix-æ”¯æŒå“ªäº›å¹³å°" class="table-of-contents__link">Apache APISIX æ”¯æŒå“ªäº›å¹³å°ï¼Ÿ</a></li><li><a href="#å¦‚ä½•ç†è§£apache-apisix-æ˜¯å…¨åŠ¨æ€çš„" class="table-of-contents__link">å¦‚ä½•ç†è§£â€œApache APISIX æ˜¯å…¨åŠ¨æ€çš„â€ï¼Ÿ</a></li><li><a href="#apisix-æ˜¯å¦æœ‰æ§åˆ¶å°ç•Œé¢" class="table-of-contents__link">APISIX æ˜¯å¦æœ‰æ§åˆ¶å°ç•Œé¢ï¼Ÿ</a></li><li><a href="#æˆ‘å¯ä»¥ä¸º-apache-apisix-å¼€å‘é€‚åˆè‡ªèº«ä¸šåŠ¡çš„æ’ä»¶å—" class="table-of-contents__link">æˆ‘å¯ä»¥ä¸º Apache APISIX å¼€å‘é€‚åˆè‡ªèº«ä¸šåŠ¡çš„æ’ä»¶å—ï¼Ÿ</a></li><li><a href="#ä¸ºä»€ä¹ˆ-apache-apisix-é€‰æ‹©-etcd-ä½œä¸ºé…ç½®ä¸­å¿ƒ" class="table-of-contents__link">ä¸ºä»€ä¹ˆ Apache APISIX é€‰æ‹© etcd ä½œä¸ºé…ç½®ä¸­å¿ƒï¼Ÿ</a></li><li><a href="#ä½¿ç”¨-luarocks-å®‰è£…-apache-apisix-ä¾èµ–é¡¹æ—¶ä¸ºä»€ä¹ˆä¼šå¯¼è‡´è¶…æ—¶å®‰è£…ç¼“æ…¢æˆ–å®‰è£…å¤±è´¥" class="table-of-contents__link">ä½¿ç”¨ LuaRocks å®‰è£… Apache APISIX ä¾èµ–é¡¹æ—¶ï¼Œä¸ºä»€ä¹ˆä¼šå¯¼è‡´è¶…æ—¶ã€å®‰è£…ç¼“æ…¢æˆ–å®‰è£…å¤±è´¥ï¼Ÿ</a></li><li><a href="#å¦‚ä½•æ„å»º-apisix-runtime-ç¯å¢ƒ" class="table-of-contents__link">å¦‚ä½•æ„å»º APISIX-Runtime ç¯å¢ƒï¼Ÿ</a></li><li><a href="#æˆ‘è¯¥å¦‚ä½•ä½¿ç”¨-apache-apisix-è¿›è¡Œç°åº¦å‘å¸ƒ" class="table-of-contents__link">æˆ‘è¯¥å¦‚ä½•ä½¿ç”¨ Apache APISIX è¿›è¡Œç°åº¦å‘å¸ƒï¼Ÿ</a></li><li><a href="#æˆ‘å¦‚ä½•é€šè¿‡-apache-apisix-å®ç°ä»-http-è‡ªåŠ¨è·³è½¬åˆ°-https" class="table-of-contents__link">æˆ‘å¦‚ä½•é€šè¿‡ Apache APISIX å®ç°ä» HTTP è‡ªåŠ¨è·³è½¬åˆ° HTTPSï¼Ÿ</a></li><li><a href="#æˆ‘åº”è¯¥å¦‚ä½•æ›´æ”¹-apache-apisix-çš„æ—¥å¿—ç­‰çº§" class="table-of-contents__link">æˆ‘åº”è¯¥å¦‚ä½•æ›´æ”¹ Apache APISIX çš„æ—¥å¿—ç­‰çº§ï¼Ÿ</a></li><li><a href="#æˆ‘åº”è¯¥å¦‚ä½•é‡æ–°åŠ è½½-apache-apisix-çš„è‡ªå®šä¹‰æ’ä»¶" class="table-of-contents__link">æˆ‘åº”è¯¥å¦‚ä½•é‡æ–°åŠ è½½ Apache APISIX çš„è‡ªå®šä¹‰æ’ä»¶ï¼Ÿ</a></li><li><a href="#åœ¨å¤„ç†-http-æˆ–-https-è¯·æ±‚æ—¶æˆ‘è¯¥å¦‚ä½•é…ç½®-apache-apisix-æ¥ç›‘å¬å¤šä¸ªç«¯å£" class="table-of-contents__link">åœ¨å¤„ç† HTTP æˆ– HTTPS è¯·æ±‚æ—¶ï¼Œæˆ‘è¯¥å¦‚ä½•é…ç½® Apache APISIX æ¥ç›‘å¬å¤šä¸ªç«¯å£ï¼Ÿ</a></li><li><a href="#å¯ç”¨-ssl-è¯ä¹¦åä¸ºä»€ä¹ˆæ— æ³•é€šè¿‡-https--ip-è®¿é—®å¯¹åº”çš„è·¯ç”±" class="table-of-contents__link">å¯ç”¨ SSL è¯ä¹¦åï¼Œä¸ºä»€ä¹ˆæ— æ³•é€šè¿‡ HTTPS + IP è®¿é—®å¯¹åº”çš„è·¯ç”±ï¼Ÿ</a></li><li><a href="#apisix-å¦‚ä½•åˆ©ç”¨-etcd-å¦‚ä½•å®ç°æ¯«ç§’çº§åˆ«çš„é…ç½®åŒæ­¥" class="table-of-contents__link">APISIX å¦‚ä½•åˆ©ç”¨ etcd å¦‚ä½•å®ç°æ¯«ç§’çº§åˆ«çš„é…ç½®åŒæ­¥ï¼Ÿ</a></li><li><a href="#æˆ‘åº”è¯¥å¦‚ä½•è‡ªå®šä¹‰-apisix-å®ä¾‹-id" class="table-of-contents__link">æˆ‘åº”è¯¥å¦‚ä½•è‡ªå®šä¹‰ APISIX å®ä¾‹ idï¼Ÿ</a></li><li><a href="#ä¸ºä»€ä¹ˆ-errorlog-ä¸­ä¼šå‡ºç°-failed-to-fetch-data-from-etcd-failed-to-read-etcd-dir-etcd-key-xxxxxx-çš„é”™è¯¯" class="table-of-contents__link">ä¸ºä»€ä¹ˆ <code>error.log</code> ä¸­ä¼šå‡ºç° &quot;failed to fetch data from etcd, failed to read etcd dir, etcd key: xxxxxx&quot; çš„é”™è¯¯ï¼Ÿ</a></li><li><a href="#æˆ‘åº”è¯¥å¦‚ä½•åˆ›å»ºé«˜å¯ç”¨çš„-apache-apisix-é›†ç¾¤" class="table-of-contents__link">æˆ‘åº”è¯¥å¦‚ä½•åˆ›å»ºé«˜å¯ç”¨çš„ Apache APISIX é›†ç¾¤ï¼Ÿ</a></li><li><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨æºç å®‰è£…-apache-apisix-æ—¶æ‰§è¡Œ-make-deps-å‘½ä»¤ä¼šå¤±è´¥" class="table-of-contents__link">ä¸ºä»€ä¹ˆä½¿ç”¨æºç å®‰è£… Apache APISIX æ—¶ï¼Œæ‰§è¡Œ <code>make deps</code> å‘½ä»¤ä¼šå¤±è´¥ï¼Ÿ</a></li><li><a href="#æˆ‘å¦‚ä½•é€šè¿‡-apisix-ä»£ç†è®¿é—®-apisix-dashboard" class="table-of-contents__link">æˆ‘å¦‚ä½•é€šè¿‡ APISIX ä»£ç†è®¿é—® APISIX Dashboardï¼Ÿ</a></li><li><a href="#å¦‚ä½•ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼-regex-åŒ¹é…-route-ä¸­çš„-uri" class="table-of-contents__link">å¦‚ä½•ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ (regex) åŒ¹é… Route ä¸­çš„ <code>uri</code>ï¼Ÿ</a></li><li><a href="#upstream-èŠ‚ç‚¹æ˜¯å¦æ”¯æŒé…ç½®-fqdn-åœ°å€" class="table-of-contents__link">Upstream èŠ‚ç‚¹æ˜¯å¦æ”¯æŒé…ç½® FQDN åœ°å€ï¼Ÿ</a></li><li><a href="#admin-api-çš„-x-api-key-æŒ‡çš„æ˜¯ä»€ä¹ˆæ˜¯å¦å¯ä»¥ä¿®æ”¹" class="table-of-contents__link">Admin API çš„ <code>X-API-KEY</code> æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å¦å¯ä»¥ä¿®æ”¹ï¼Ÿ</a></li><li><a href="#å¦‚ä½•å…è®¸æ‰€æœ‰-ip-è®¿é—®-apache-apisix-çš„-admin-api" class="table-of-contents__link">å¦‚ä½•å…è®¸æ‰€æœ‰ IP è®¿é—® Apache APISIX çš„ Admin APIï¼Ÿ</a></li><li><a href="#å¦‚ä½•åŸºäº-acmesh-è‡ªåŠ¨æ›´æ–°-apisix-ssl-è¯ä¹¦" class="table-of-contents__link">å¦‚ä½•åŸºäº acme.sh è‡ªåŠ¨æ›´æ–° APISIX SSL è¯ä¹¦ï¼Ÿ</a></li><li><a href="#åœ¨-apache-apisix-ä¸­æˆ‘å¦‚ä½•åœ¨è½¬å‘åˆ°ä¸Šæ¸¸ä¹‹å‰ä»è·¯å¾„ä¸­åˆ é™¤ä¸€ä¸ªå‰ç¼€" class="table-of-contents__link">åœ¨ Apache APISIX ä¸­ï¼Œæˆ‘å¦‚ä½•åœ¨è½¬å‘åˆ°ä¸Šæ¸¸ä¹‹å‰ä»è·¯å¾„ä¸­åˆ é™¤ä¸€ä¸ªå‰ç¼€ï¼Ÿ</a></li><li><a href="#æˆ‘åº”è¯¥å¦‚ä½•è§£å†³-unable-to-get-local-issuer-certificate-è¿™ä¸ªé”™è¯¯" class="table-of-contents__link">æˆ‘åº”è¯¥å¦‚ä½•è§£å†³ <code>unable to get local issuer certificate</code> è¿™ä¸ªé”™è¯¯ï¼Ÿ</a></li><li><a href="#æˆ‘åº”è¯¥å¦‚ä½•è§£å†³-module-restyworkerevents-not-found-è¿™ä¸ªé”™è¯¯" class="table-of-contents__link">æˆ‘åº”è¯¥å¦‚ä½•è§£å†³ <code>module &#39;resty.worker.events&#39; not found</code> è¿™ä¸ªé”™è¯¯ï¼Ÿ</a></li><li><a href="#åœ¨-apache-apisix-ä¸­plugin-metadata-å’Œ-plugin-configs-æœ‰ä»€ä¹ˆåŒºåˆ«" class="table-of-contents__link">åœ¨ Apache APISIX ä¸­ï¼Œ<code>plugin-metadata</code> å’Œ <code>plugin-configs</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li><li><a href="#éƒ¨ç½²äº†-apache-apisix-ä¹‹åå¦‚ä½•æ£€æµ‹-apisix-æ•°æ®å¹³é¢çš„å­˜æ´»æƒ…å†µå¦‚ä½•æ¢æ´»" class="table-of-contents__link">éƒ¨ç½²äº† Apache APISIX ä¹‹åï¼Œå¦‚ä½•æ£€æµ‹ APISIX æ•°æ®å¹³é¢çš„å­˜æ´»æƒ…å†µï¼ˆå¦‚ä½•æ¢æ´»ï¼‰?</a></li><li><a href="#apisix-ä¸-etcd-ç›¸å…³çš„å»¶è¿Ÿè¾ƒé«˜çš„é—®é¢˜æœ‰å“ªäº›å¦‚ä½•ä¿®å¤" class="table-of-contents__link">APISIX ä¸ etcd ç›¸å…³çš„å»¶è¿Ÿè¾ƒé«˜çš„é—®é¢˜æœ‰å“ªäº›ï¼Œå¦‚ä½•ä¿®å¤ï¼Ÿ</a></li><li><a href="#ä¸ºä»€ä¹ˆ-file-logger-è®°å½•æ—¥å¿—ä¼šå‡ºç°ä¹±ç " class="table-of-contents__link">ä¸ºä»€ä¹ˆ file-logger è®°å½•æ—¥å¿—ä¼šå‡ºç°ä¹±ç ï¼Ÿ</a></li><li><a href="#apisix-å¦‚ä½•é…ç½®å¸¦è®¤è¯çš„-etcd" class="table-of-contents__link">APISIX å¦‚ä½•é…ç½®å¸¦è®¤è¯çš„ ETCDï¼Ÿ</a></li><li><a href="#ssls-å¯¹è±¡ä¸-upstream-å¯¹è±¡ä¸­çš„-tlsclient_cert-ä»¥åŠ-configyaml-ä¸­çš„-ssl_trusted_certificate-åŒºåˆ«æ˜¯ä»€ä¹ˆ" class="table-of-contents__link">SSLs å¯¹è±¡ä¸ <code>upstream</code> å¯¹è±¡ä¸­çš„ <code>tls.client_cert</code> ä»¥åŠ <code>config.yaml</code> ä¸­çš„ <code>ssl_trusted_certificate</code> åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li><a href="#å¦‚æœåœ¨ä½¿ç”¨-apisix-è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜æˆ‘å¯ä»¥åœ¨å“ªé‡Œå¯»æ±‚æ›´å¤šå¸®åŠ©" class="table-of-contents__link">å¦‚æœåœ¨ä½¿ç”¨ APISIX è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œæˆ‘å¯ä»¥åœ¨å“ªé‡Œå¯»æ±‚æ›´å¤šå¸®åŠ©ï¼Ÿ</a></li></ul></div></div></div></div></main></div></div><footer class="container_MP5Z"><div class="linksRow_iwpv"><div class="linksCol_a1ec"><div>ASF</div><ul><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span></span><span>Foundation</span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer"><span></span><span>License</span></a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer"><span></span><span>Events</span></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer"><span></span><span>Security</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer"><span></span><span>Sponsorship</span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer"><span></span><span>Thanks</span></a></li></ul></div><div class="linksCol_a1ec"><div>Community</div><ul><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer"><span></span><span>GitHub</span></a></li><li class="footer__item"><a href="/zh/docs/general/join/"><span></span><span>Slack</span></a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer"><span></span><span>Twitter</span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCgPD18cMhOg5rmPVnQhAC8g" target="_blank" rel="noopener noreferrer"><span></span><span>YouTube</span></a></li></ul></div><div class="linksCol_a1ec"><div>More</div><ul><li class="footer__item"><a target="_parent" href="/zh/blog/"><span></span><span>Blog</span></a></li><li class="footer__item"><a target="_parent" href="/zh/showcase/"><span></span><span>Showcase</span></a></li><li class="footer__item"><a target="_parent" href="/zh/plugins/"><span></span><span>Plugin Hub</span></a></li><li class="footer__item"><a href="https://github.com/apache/apisix/milestones" target="_parent" rel="noopener noreferrer"><span></span><span>Roadmap</span></a></li></ul></div></div><div class="copyright_ZfFh"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer"><span style="display:inline-block;width:231.25px;height:40px"></span></a><div>Copyright Â© 2019-2026 The Apache Software Foundation. Apache APISIX, APISIXÂ®, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></footer></div>
<script src="https://apisix-website-static.apiseven.com/zh/assets/js/runtime~main.f0ea08ab.js"></script>
<script src="https://apisix-website-static.apiseven.com/zh/assets/js/main.dbcb65bd.js"></script>
</body>
</html>