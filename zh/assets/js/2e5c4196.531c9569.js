"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[62652],{3905:(t,e,a)=>{a.d(e,{Zo:()=>k,kt:()=>o});var n=a(67294);function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){l(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function p(t,e){if(null==t)return{};var a,n,l=function(t,e){if(null==t)return{};var a,n,l={},r=Object.keys(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||(l[a]=t[a]);return l}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(l[a]=t[a])}return l}var d=n.createContext({}),m=function(t){var e=n.useContext(d),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},k=function(t){var e=m(t.components);return n.createElement(d.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},N=n.forwardRef((function(t,e){var a=t.components,l=t.mdxType,r=t.originalType,d=t.parentName,k=p(t,["components","mdxType","originalType","parentName"]),N=m(a),o=l,s=N["".concat(d,".").concat(o)]||N[o]||u[o]||r;return a?n.createElement(s,i(i({ref:e},k),{},{components:a})):n.createElement(s,i({ref:e},k))}));function o(t,e){var a=arguments,l=e&&e.mdxType;if("string"==typeof t||l){var r=a.length,i=new Array(r);i[0]=N;var p={};for(var d in e)hasOwnProperty.call(e,d)&&(p[d]=e[d]);p.originalType=t,p.mdxType="string"==typeof t?t:l,i[1]=p;for(var m=2;m<r;m++)i[m]=a[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}N.displayName="MDXCreateElement"},20182:(t,e,a)=>{a.r(e),a.d(e,{contentTitle:()=>i,default:()=>k,frontMatter:()=>r,metadata:()=>p,toc:()=>d});var n=a(87462),l=(a(67294),a(3905));const r={title:"Admin API",keywords:["APISIX","API \u7f51\u5173","Admin API","\u8def\u7531","\u63d2\u4ef6","\u4e0a\u6e38"],description:"\u672c\u6587\u4ecb\u7ecd\u4e86 Apache APISIX Admin API \u652f\u6301\u7684\u529f\u80fd\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 Admin API \u6765\u83b7\u53d6\u3001\u521b\u5efa\u3001\u66f4\u65b0\u4ee5\u53ca\u5220\u9664\u8d44\u6e90\u3002"},i=void 0,p={unversionedId:"admin-api",id:"version-3.10/admin-api",isDocsHomePage:!1,title:"Admin API",description:"\u672c\u6587\u4ecb\u7ecd\u4e86 Apache APISIX Admin API \u652f\u6301\u7684\u529f\u80fd\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 Admin API \u6765\u83b7\u53d6\u3001\u521b\u5efa\u3001\u66f4\u65b0\u4ee5\u53ca\u5220\u9664\u8d44\u6e90\u3002",source:"@site/i18n/zh/docusaurus-plugin-content-docs-docs-apisix/version-3.10/admin-api.md",sourceDirName:".",slug:"/admin-api",permalink:"/zh/docs/apisix/3.10/admin-api",editUrl:"/zh/edit#https://github.com/apache/apisix/edit/release/3.10/docs/zh/latest/admin-api.md",tags:[],version:"3.10",frontMatter:{title:"Admin API",keywords:["APISIX","API \u7f51\u5173","Admin API","\u8def\u7531","\u63d2\u4ef6","\u4e0a\u6e38"],description:"\u672c\u6587\u4ecb\u7ecd\u4e86 Apache APISIX Admin API \u652f\u6301\u7684\u529f\u80fd\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 Admin API \u6765\u83b7\u53d6\u3001\u521b\u5efa\u3001\u66f4\u65b0\u4ee5\u53ca\u5220\u9664\u8d44\u6e90\u3002"},sidebar:"version-3.10/docs",previous:{title:"http-dubbo",permalink:"/zh/docs/apisix/3.10/plugins/http-dubbo"},next:{title:"Control API",permalink:"/zh/docs/apisix/3.10/control-api"}},d=[{value:"\u63cf\u8ff0",id:"description",children:[]},{value:"\u76f8\u5173\u914d\u7f6e",id:"basic-configuration",children:[{value:"\u4f7f\u7528\u73af\u5883\u53d8\u91cf",id:"using-environment-variables",children:[]},{value:"\u5f3a\u5236\u5220\u9664",id:"force-delete",children:[]}]},{value:"v3 \u7248\u672c\u65b0\u529f\u80fd",id:"v3-new-function",children:[{value:"\u652f\u6301\u65b0\u7684\u54cd\u5e94\u4f53\u683c\u5f0f",id:"support-new-response-body-format",children:[]},{value:"\u652f\u6301\u5206\u9875\u67e5\u8be2",id:"support-paging-query",children:[]},{value:"\u652f\u6301\u8fc7\u6ee4\u8d44\u6e90",id:"support-filtering-query",children:[]}]},{value:"Route",id:"route",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"route-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"route-request-methods",children:[]},{value:"URI \u8bf7\u6c42\u53c2\u6570",id:"route-uri-request-parameters",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"route-request-body-parameters",children:[]},{value:"\u4f7f\u7528\u793a\u4f8b",id:"route-example",children:[]},{value:"\u5e94\u7b54\u53c2\u6570",id:"route-response-parameters",children:[]}]},{value:"Service",id:"service",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"service-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"service-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"service-request-body-parameters",children:[]},{value:"\u4f7f\u7528\u793a\u4f8b",id:"service-example",children:[]},{value:"\u5e94\u7b54\u53c2\u6570",id:"service-response-parameters",children:[]}]},{value:"Consumer",id:"consumer",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"consumer-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"consumer-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"consumer-body-request-methods",children:[]},{value:"\u4f7f\u7528\u793a\u4f8b",id:"consumer-example",children:[]},{value:"\u5e94\u7b54\u53c2\u6570",id:"consumer-response-parameters",children:[]}]},{value:"Upstream",id:"upstream",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"upstream-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"upstream-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"upstream-body-request-methods",children:[]},{value:"\u4f7f\u7528\u793a\u4f8b",id:"upstream-example",children:[]},{value:"\u5e94\u7b54\u53c2\u6570",id:"upstream-response-parameters",children:[]}]},{value:"SSL",id:"ssl",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"ssl-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"ssl-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"ssl-body-request-methods",children:[]}]},{value:"Global Rules",id:"global-rules",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"global-rule-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"global-rule-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"global-rule-body-request-parameters",children:[]}]},{value:"Consumer Group",id:"consumer-group",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"consumer-group-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"consumer-group-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"consumer-group-body-request-parameters",children:[]}]},{value:"Plugin Config",id:"plugin-config",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"plugin-config-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"plugin-config-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"plugin-config-body-request-parameters",children:[]}]},{value:"Plugin Metadata",id:"plugin-metadata",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"plugin-metadata-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"plugin-metadata-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"plugin-metadata-body-request-parameters",children:[]},{value:"\u4f7f\u7528\u793a\u4f8b",id:"plugin-metadata-example",children:[]}]},{value:"Plugin",id:"plugin",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"plugin-uri",children:[]},{value:"\u8bf7\u6c42\u53c2\u6570",id:"\u8bf7\u6c42\u53c2\u6570",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"plugin-request-methods",children:[]},{value:"\u4f7f\u7528\u793a\u4f8b",id:"plugin-example",children:[]}]},{value:"Stream Route",id:"stream-route",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"stream-route-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"stream-route-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"stream-route-body-request-parameters",children:[]}]},{value:"Secret",id:"secret",children:[{value:"\u8bf7\u6c42\u5730\u5740",id:"secret-config-uri",children:[]},{value:"\u8bf7\u6c42\u65b9\u6cd5",id:"secret-config-request-methods",children:[]},{value:"body \u8bf7\u6c42\u53c2\u6570",id:"secret-config-body-requset-parameters",children:[]},{value:"\u5e94\u7b54\u53c2\u6570",id:"secret-config-response-parameters",children:[]}]}],m={toc:d};function k(t){let{components:e,...a}=t;return(0,l.kt)("wrapper",(0,n.Z)({},m,a,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"description"},"\u63cf\u8ff0"),(0,l.kt)("p",null,"Admin API \u662f\u4e00\u7ec4\u7528\u4e8e\u914d\u7f6e Apache APISIX \u8def\u7531\u3001\u4e0a\u6e38\u3001\u670d\u52a1\u3001SSL \u8bc1\u4e66\u7b49\u529f\u80fd\u7684 RESTful API\u3002"),(0,l.kt)("p",null,"\u4f60\u53ef\u4ee5\u901a\u8fc7 Admin API \u6765\u83b7\u53d6\u3001\u521b\u5efa\u3001\u66f4\u65b0\u4ee5\u53ca\u5220\u9664\u8d44\u6e90\u3002\u540c\u65f6\u5f97\u76ca\u4e8e APISIX \u7684\u70ed\u52a0\u8f7d\u80fd\u529b\uff0c\u8d44\u6e90\u914d\u7f6e\u5b8c\u6210\u540e APISIX \u5c06\u4f1a\u81ea\u52a8\u66f4\u65b0\u914d\u7f6e\uff0c\u65e0\u9700\u91cd\u542f\u670d\u52a1\u3002\u5982\u679c\u4f60\u60f3\u8981\u4e86\u89e3\u5176\u5de5\u4f5c\u539f\u7406\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"p",href:"/zh/docs/apisix/3.10/architecture-design/apisix"},"Architecture Design"),"\u3002"),(0,l.kt)("h2",{id:"basic-configuration"},"\u76f8\u5173\u914d\u7f6e"),(0,l.kt)("p",null,"\u5f53 APISIX \u542f\u52a8\u65f6\uff0cAdmin API \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c06\u4f1a\u76d1\u542c ",(0,l.kt)("inlineCode",{parentName:"p"},"9180")," \u7aef\u53e3\uff0c\u5e76\u4e14\u4f1a\u5360\u7528\u524d\u7f00\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"/apisix/admin")," \u7684 API\u3002"),(0,l.kt)("p",null,"\u56e0\u6b64\uff0c\u4e3a\u4e86\u907f\u514d\u4f60\u8bbe\u8ba1\u7684 API \u4e0e ",(0,l.kt)("inlineCode",{parentName:"p"},"/apisix/admin")," \u51b2\u7a81\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/blob/master/conf/config.yaml"},(0,l.kt)("inlineCode",{parentName:"a"},"/conf/config.yaml"))," \u4e2d\u7684\u914d\u7f6e\u4fee\u6539\u9ed8\u8ba4\u76d1\u542c\u7aef\u53e3\u3002"),(0,l.kt)("p",null,"APISIX \u652f\u6301\u8bbe\u7f6e Admin API \u7684 IP \u8bbf\u95ee\u767d\u540d\u5355\uff0c\u9632\u6b62 APISIX \u88ab\u975e\u6cd5\u8bbf\u95ee\u548c\u653b\u51fb\u3002\u4f60\u53ef\u4ee5\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"./conf/config.yaml")," \u6587\u4ef6\u4e2d\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"deployment.admin.allow_admin")," \u9009\u9879\u4e2d\uff0c\u914d\u7f6e\u5141\u8bb8\u8bbf\u95ee\u7684 IP \u5730\u5740\u3002"),(0,l.kt)("p",null,"\u5728\u4e0b\u6587\u51fa\u73b0\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"X-API-KEY")," \u6307\u7684\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"./conf/config.yaml")," \u6587\u4ef6\u4e2d\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"deployment.admin.admin_key.key"),"\uff0c\u5b83\u662f Admin API \u7684\u8bbf\u95ee token\u3002"),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"\u63d0\u793a")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u5efa\u8bae\u4f60\u4fee\u6539 Admin API \u9ed8\u8ba4\u7684\u76d1\u542c\u7aef\u53e3\u3001IP \u8bbf\u95ee\u767d\u540d\u5355\u4ee5\u53ca Admin API \u7684 token\uff0c\u4ee5\u4fdd\u8bc1\u4f60\u7684 API \u5b89\u5168\u3002"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="./conf/config.yaml"',title:'"./conf/config.yaml"'},"deployment:\n    admin:\n        admin_key:\n        - name: admin\n            key: edd1c9f034335f136f87ad84b625c8f1  # \u4f7f\u7528\u9ed8\u8ba4\u7684 Admin API Key \u5b58\u5728\u5b89\u5168\u98ce\u9669\uff0c\u90e8\u7f72\u5230\u751f\u4ea7\u73af\u5883\u65f6\u8bf7\u53ca\u65f6\u66f4\u65b0\n            role: admin\n        allow_admin:                    # http://nginx.org/en/docs/http/ngx_http_access_module.html#allow\n            - 127.0.0.0/24\n        admin_listen:\n            ip: 0.0.0.0                 # Admin API \u76d1\u542c\u7684 IP\uff0c\u5982\u679c\u4e0d\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u4e3a\u201c0.0.0.0\u201d\u3002\n            port: 9180                  # Admin API \u76d1\u542c\u7684 \u7aef\u53e3\uff0c\u5fc5\u987b\u4f7f\u7528\u4e0e node_listen \u4e0d\u540c\u7684\u7aef\u53e3\u3002\n")),(0,l.kt)("h3",{id:"using-environment-variables"},"\u4f7f\u7528\u73af\u5883\u53d8\u91cf"),(0,l.kt)("p",null,"\u8981\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u8fdb\u884c\u914d\u7f6e\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"${{VAR}}")," \u8bed\u6cd5\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="./conf/config.yaml"',title:'"./conf/config.yaml"'},"deployment:\n  admin:\n    admin_key:\n    - name: admin\n      key: ${{ADMIN_KEY}}\n      role: admin\n    allow_admin:\n    - 127.0.0.0/24\n    admin_listen:\n      ip: 0.0.0.0\n      port: 9180\n")),(0,l.kt)("p",null,"\u7136\u540e\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"make init")," \u4e4b\u524d\u8fd0\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"export ADMIN_KEY=$your_admin_key"),"."),(0,l.kt)("p",null,"\u5982\u679c\u627e\u4e0d\u5230\u914d\u7f6e\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5c06\u629b\u51fa\u9519\u8bef\u3002"),(0,l.kt)("p",null,"\u6b64\u5916\uff0c\u5982\u679c\u8981\u5728\u672a\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u65f6\u4f7f\u7528\u9ed8\u8ba4\u503c\uff0c\u8bf7\u6539\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"${{VAR:=default_value}}"),"\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="./conf/config.yaml"',title:'"./conf/config.yaml"'},"deployment:\n  admin:\n    admin_key:\n    - name: admin\n      key: ${{ADMIN_KEY:=edd1c9f034335f136f87ad84b625c8f1}}\n      role: admin\n    allow_admin:\n    - 127.0.0.0/24\n    admin_listen:\n      ip: 0.0.0.0\n      port: 9180\n")),(0,l.kt)("p",null,"\u9996\u5148\u67e5\u627e\u73af\u5883\u53d8\u91cf ",(0,l.kt)("inlineCode",{parentName:"p"},"ADMIN_KEY"),"\uff0c\u5982\u679c\u8be5\u73af\u5883\u53d8\u91cf\u4e0d\u5b58\u5728\uff0c\u5b83\u5c06\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"edd1c9f034335f136f87ad84b625c8f1")," \u4f5c\u4e3a\u9ed8\u8ba4\u503c\u3002"),(0,l.kt)("p",null,"\u60a8\u8fd8\u53ef\u4ee5\u5728 yaml \u952e\u4e2d\u6307\u5b9a\u73af\u5883\u53d8\u91cf\u3002\u8fd9\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"standalone")," \u6a21\u5f0f \u4e2d\u7279\u522b\u6709\u7528\uff0c\u60a8\u53ef\u4ee5\u5728\u5176\u4e2d\u6307\u5b9a\u4e0a\u6e38\u8282\u70b9\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="./conf/apisix.yaml"',title:'"./conf/apisix.yaml"'},'routes:\n  -\n    uri: "/test"\n    upstream:\n      nodes:\n        "${{HOST_IP}}:${{PORT}}": 1\n      type: roundrobin\n#END\n')),(0,l.kt)("h3",{id:"force-delete"},"\u5f3a\u5236\u5220\u9664"),(0,l.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAdmin API \u4f1a\u68c0\u67e5\u8d44\u6e90\u95f4\u7684\u5f15\u7528\u5173\u7cfb\uff0c\u5c06\u4f1a\u62d2\u7edd\u5220\u9664\u6b63\u5728\u4f7f\u7528\u4e2d\u7684\u8d44\u6e90\u3002"),(0,l.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u5728\u5220\u9664\u8bf7\u6c42\u4e2d\u6dfb\u52a0\u8bf7\u6c42\u53c2\u6570 ",(0,l.kt)("inlineCode",{parentName:"p"},"force=true")," \u6765\u8fdb\u884c\u5f3a\u5236\u5220\u9664\uff0c\u4f8b\u5982\uff1a"),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u60a8\u53ef\u4ee5\u8fd9\u6837\u4ece ",(0,l.kt)("inlineCode",{parentName:"p"},"config.yaml")," \u4e2d\u83b7\u53d6 ",(0,l.kt)("inlineCode",{parentName:"p"},"admin_key")," \u5e76\u5b58\u5165\u73af\u5883\u53d8\u91cf\uff1a"),(0,l.kt)("pre",{parentName:"div"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"admin_key=$(yq '.deployment.admin.admin_key[0].key' conf/config.yaml | sed 's/\"//g')\n")))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'$ curl http://127.0.0.1:9180/apisix/admin/upstreams/1 -H "X-API-KEY: $admin_key" -X PUT -d \'{\n    "nodes": {\n        "127.0.0.1:8080": 1\n    },\n    "type": "roundrobin"\n}\'\n$ curl http://127.0.0.1:9180/apisix/admin/routes/1 -H "X-API-KEY: $admin_key" -X PUT -d \'{\n    "uri": "/*",\n    "upstream_id": 1\n}\'\n{"value":{"priority":0,"upstream_id":1,"uri":"/*","create_time":1689038794,"id":"1","status":1,"update_time":1689038916},"key":"/apisix/routes/1"}\n\n$ curl http://127.0.0.1:9180/apisix/admin/upstreams/1 -H "X-API-KEY: $admin_key" -X DELETE\n{"error_msg":"can not delete this upstream, route [1] is still using it now"}\n$ curl "http://127.0.0.1:9180/apisix/admin/upstreams/1?force=anyvalue" -H "X-API-KEY: $admin_key" -X DELETE\n{"error_msg":"can not delete this upstream, route [1] is still using it now"}\n$ curl "http://127.0.0.1:9180/apisix/admin/upstreams/1?force=true" -H "X-API-KEY: $admin_key" -X DELETE\n{"deleted":"1","key":"/apisix/upstreams/1"}\n')),(0,l.kt)("h2",{id:"v3-new-function"},"v3 \u7248\u672c\u65b0\u529f\u80fd"),(0,l.kt)("p",null,"\u5728 APISIX v3 \u7248\u672c\u4e2d\uff0cAdmin API \u652f\u6301\u4e86\u4e00\u4e9b\u4e0d\u5411\u4e0b\u517c\u5bb9\u7684\u65b0\u7279\u6027\uff0c\u6bd4\u5982\u652f\u6301\u65b0\u7684\u54cd\u5e94\u4f53\u683c\u5f0f\u3001\u652f\u6301\u5206\u9875\u67e5\u8be2\u3001\u652f\u6301\u8fc7\u6ee4\u8d44\u6e90\u7b49\u3002"),(0,l.kt)("h3",{id:"support-new-response-body-format"},"\u652f\u6301\u65b0\u7684\u54cd\u5e94\u4f53\u683c\u5f0f"),(0,l.kt)("p",null,"APISIX \u5728 v3 \u7248\u672c\u5bf9\u54cd\u5e94\u4f53\u505a\u4e86\u4ee5\u4e0b\u8c03\u6574\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u79fb\u9664\u65e7\u7248\u672c\u54cd\u5e94\u4f53\u4e2d\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"action")," \u5b57\u6bb5\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u8c03\u6574\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u65f6\u7684\u54cd\u5e94\u4f53\u7ed3\u6784\uff0c\u65b0\u7684\u54cd\u5e94\u4f53\u7ed3\u6784\u793a\u4f8b\u5982\u4e0b\uff1a")),(0,l.kt)("p",null,"\u8fd4\u56de\u5355\u4e2a\u8d44\u6e90\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'    {\n    "modifiedIndex": 2685183,\n    "value": {\n        "id": "1",\n        ...\n    },\n    "key": "/apisix/routes/1",\n    "createdIndex": 2684956\n    }\n')),(0,l.kt)("p",null,"\u8fd4\u56de\u591a\u4e2a\u8d44\u6e90\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'    {\n    "list": [\n        {\n        "modifiedIndex": 2685183,\n        "value": {\n            "id": "1",\n            ...\n        },\n        "key": "/apisix/routes/1",\n        "createdIndex": 2684956\n        },\n        {\n        "modifiedIndex": 2685163,\n        "value": {\n            "id": "2",\n            ...\n        },\n        "key": "/apisix/routes/2",\n        "createdIndex": 2685163\n        }\n    ],\n    "total": 2\n    }\n')),(0,l.kt)("h3",{id:"support-paging-query"},"\u652f\u6301\u5206\u9875\u67e5\u8be2"),(0,l.kt)("p",null,"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u65f6\u652f\u6301\u5206\u9875\u67e5\u8be2\uff0c\u76ee\u524d\u652f\u6301\u5206\u9875\u67e5\u8be2\u7684\u8d44\u6e90\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#consumer"},"Consumer")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#consumer-group"},"Consumer Group")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#global-rules"},"Global Rules")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#plugin-config"},"Plugin Config")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://apisix.apache.org/zh/docs/apisix/plugins/grpc-transcode/#%E5%90%AF%E7%94%A8%E6%8F%92%E4%BB%B6"},"Protos")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#route"},"Route")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#service"},"Service")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#ssl"},"SSL")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#stream-route"},"Stream Route")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#upstream"},"Upstream"))),(0,l.kt)("p",null,"\u53c2\u6570\u5982\u4e0b\uff1a"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8303\u56f4"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"page"),(0,l.kt)("td",{parentName:"tr",align:null},"1"),(0,l.kt)("td",{parentName:"tr",align:null},"[1, ...]"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9875\u6570\uff0c\u9ed8\u8ba4\u5c55\u793a\u7b2c\u4e00\u9875\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"page_size"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"[10, 500]"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6bcf\u9875\u8d44\u6e90\u6570\u91cf\u3002\u5982\u679c\u4e0d\u914d\u7f6e\u8be5\u53c2\u6570\uff0c\u5219\u5c55\u793a\u6240\u6709\u67e5\u8be2\u5230\u7684\u8d44\u6e90\u3002")))),(0,l.kt)("p",null,"\u793a\u4f8b\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/routes?page=1&page_size=10" \\\n-H "X-API-KEY: $admin_key" -X GET\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "total": 1,\n  "list": [\n    {\n      ...\n    }\n  ]\n}\n')),(0,l.kt)("h3",{id:"support-filtering-query"},"\u652f\u6301\u8fc7\u6ee4\u8d44\u6e90"),(0,l.kt)("p",null,"\u5728 APISIX v3 \u7248\u672c\u4e2d\uff0c\u5728\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u65f6\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"name"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"label")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"uri")," \u53c2\u6570\u8fc7\u6ee4\u8d44\u6e90\u3002\u652f\u6301\u53c2\u6570\u5982\u4e0b\uff1a"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"name"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6839\u636e\u8d44\u6e90\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"name")," \u5c5e\u6027\u8fdb\u884c\u67e5\u8be2\uff0c\u5982\u679c\u8d44\u6e90\u672c\u8eab\u6ca1\u6709 ",(0,l.kt)("inlineCode",{parentName:"td"},"name")," \u5c5e\u6027\u5219\u4e0d\u4f1a\u51fa\u73b0\u5728\u67e5\u8be2\u7ed3\u679c\u4e2d\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"label"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6839\u636e\u8d44\u6e90\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"label")," \u5c5e\u6027\u8fdb\u884c\u67e5\u8be2\uff0c\u5982\u679c\u8d44\u6e90\u672c\u8eab\u6ca1\u6709 ",(0,l.kt)("inlineCode",{parentName:"td"},"label")," \u5c5e\u6027\u5219\u4e0d\u4f1a\u51fa\u73b0\u5728\u67e5\u8be2\u7ed3\u679c\u4e2d\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"uri"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8be5\u53c2\u6570\u4ec5\u5728 Route \u8d44\u6e90\u4e0a\u652f\u6301\u3002\u5982\u679c Route \u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"uri")," \u7b49\u4e8e\u67e5\u8be2\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"uri")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"td"},"uris")," \u5305\u542b\u67e5\u8be2\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"uri"),"\uff0c\u5219\u8be5 Route \u8d44\u6e90\u51fa\u73b0\u5728\u67e5\u8be2\u7ed3\u679c\u4e2d\u3002")))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"\u63d0\u793a")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u5f53\u4f7f\u7528\u591a\u4e2a\u8fc7\u6ee4\u53c2\u6570\u65f6\uff0cAPISIX \u5c06\u5bf9\u4e0d\u540c\u8fc7\u6ee4\u53c2\u6570\u7684\u67e5\u8be2\u7ed3\u679c\u53d6\u4ea4\u96c6\u3002"))),(0,l.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u5c06\u8fd4\u56de\u4e00\u4e2a\u8def\u7531\u5217\u8868\uff0c\u8be5\u8def\u7531\u5217\u8868\u4e2d\u7684\u6240\u6709\u8def\u7531\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a\u8def\u7531\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"name")," \u5305\u542b\u5b57\u7b26\u4e32 ",(0,l.kt)("inlineCode",{parentName:"p"},"test"),"\uff1b",(0,l.kt)("inlineCode",{parentName:"p"},"uri")," \u5305\u542b\u5b57\u7b26\u4e32 ",(0,l.kt)("inlineCode",{parentName:"p"},"foo"),"\uff1b\u5bf9\u8def\u7531\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"label")," \u6ca1\u6709\u9650\u5236\uff0c\u56e0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"label")," \u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"curl 'http://127.0.0.1:9180/apisix/admin/routes?name=test&uri=foo&label=' \\\n-H \"X-API-KEY: $admin_key\" -X GET\n")),(0,l.kt)("p",null,"\u8fd4\u56de\u7ed3\u679c\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "total": 1,\n  "list": [\n    {\n      ...\n    }\n  ]\n}\n')),(0,l.kt)("h2",{id:"route"},"Route"),(0,l.kt)("p",null,"Route \u4e5f\u79f0\u4e4b\u4e3a\u8def\u7531\uff0c\u53ef\u4ee5\u901a\u8fc7\u5b9a\u4e49\u4e00\u4e9b\u89c4\u5219\u6765\u5339\u914d\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u7136\u540e\u6839\u636e\u5339\u914d\u7ed3\u679c\u52a0\u8f7d\u5e76\u6267\u884c\u76f8\u5e94\u7684\u63d2\u4ef6\uff0c\u5e76\u628a\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u5230\u6307\u5b9a Upstream\uff08\u4e0a\u6e38\uff09\u3002"),(0,l.kt)("h3",{id:"route-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"\u8def\u7531\u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/routes/{id}?ttl=0"),(0,l.kt)("h3",{id:"route-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/routes"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/routes/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/routes/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6839\u636e id \u521b\u5efa\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"POST"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/routes"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u8d44\u6e90\uff0cid \u5c06\u4f1a\u81ea\u52a8\u751f\u6210\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/routes/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u6307\u5b9a\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/routes/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u51c6 PATCH\uff0c\u4fee\u6539\u6307\u5b9a Route \u7684\u90e8\u5206\u5c5e\u6027\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\uff1b\u5982\u679c\u4f60\u9700\u8981\u5220\u9664\u67d0\u4e2a\u5c5e\u6027\uff0c\u53ef\u4ee5\u5c06\u8be5\u5c5e\u6027\u7684\u503c\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"null"),"\uff1b\u5f53\u9700\u8981\u4fee\u6539\u5c5e\u6027\u7684\u503c\u4e3a\u6570\u7ec4\u65f6\uff0c\u8be5\u5c5e\u6027\u5c06\u5168\u91cf\u66f4\u65b0\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/routes/{id}/{path}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"SubPath PATCH\uff0c\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"td"},"{path}")," \u6307\u5b9a Route \u8981\u66f4\u65b0\u7684\u5c5e\u6027\uff0c\u5168\u91cf\u66f4\u65b0\u8be5\u5c5e\u6027\u7684\u6570\u636e\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\u3002\u4e24\u79cd PATCH \u7684\u533a\u522b\uff0c\u8bf7\u53c2\u8003\u4f7f\u7528\u793a\u4f8b\u3002")))),(0,l.kt)("h3",{id:"route-uri-request-parameters"},"URI \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"ttl"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8def\u7531\u7684\u6709\u6548\u671f\u3002\u8d85\u8fc7\u5b9a\u4e49\u7684\u65f6\u95f4\uff0cAPISIX \u5c06\u4f1a\u81ea\u52a8\u5220\u9664\u8def\u7531\uff0c\u5355\u4f4d\u4e3a\u79d2\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"ttl=1")))),(0,l.kt)("h3",{id:"route-request-body-parameters"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b\u503c"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"uri"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f\uff0c\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"uris")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9664\u4e86\u5982 ",(0,l.kt)("inlineCode",{parentName:"td"},"/foo/bar"),"\u3001",(0,l.kt)("inlineCode",{parentName:"td"},"/foo/gloo")," \u8fd9\u79cd\u5168\u91cf\u5339\u914d\u5916\uff0c\u4f7f\u7528\u4e0d\u540c ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/router"},"Router")," \u8fd8\u5141\u8bb8\u66f4\u9ad8\u7ea7\u5339\u914d\uff0c\u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/router"},"Router"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'"/hello"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"uris"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f\uff0c\u4e0d\u80fd\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"uri")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u975e\u7a7a\u6570\u7ec4\u5f62\u5f0f\uff0c\u53ef\u4ee5\u5339\u914d\u591a\u4e2a ",(0,l.kt)("inlineCode",{parentName:"td"},"uri"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'["/hello", "/world"]')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"plugins"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin \u914d\u7f6e\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/plugin"},"Plugin"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"script"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Script"),(0,l.kt)("td",{parentName:"tr",align:null},"Script \u914d\u7f6e\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/script"},"Script"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"upstream"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Upstream"),(0,l.kt)("td",{parentName:"tr",align:null},"Upstream \u914d\u7f6e\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/upstream"},"Upstream"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"upstream_id"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Upstream"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9700\u8981\u4f7f\u7528\u7684 Upstream id\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/upstream"},"Upstream"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"service_id"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Service"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9700\u8981\u7ed1\u5b9a\u7684 Service id\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/service"},"Service"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"plugin_config_id"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426\uff0c\u4e0d\u80fd\u4e0e Script \u5171\u540c\u4f7f\u7528\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9700\u8981\u7ed1\u5b9a\u7684 Plugin Config id\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/plugin-config"},"Plugin Config"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"name"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8def\u7531\u540d\u79f0\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"route-test")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"desc"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8def\u7531\u63cf\u8ff0\u4fe1\u606f\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7528\u6765\u6d4b\u8bd5\u7684\u8def\u7531\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"host"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426\uff0c\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"hosts")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5f53\u524d\u8bf7\u6c42\u57df\u540d\uff0c\u6bd4\u5982 ",(0,l.kt)("inlineCode",{parentName:"td"},"foo.com"),"\uff1b\u4e5f\u652f\u6301\u6cdb\u57df\u540d\uff0c\u6bd4\u5982 ",(0,l.kt)("inlineCode",{parentName:"td"},"*.foo.com"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'"foo.com"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"hosts"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426\uff0c\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"host")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u975e\u7a7a\u5217\u8868\u5f62\u6001\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"host"),"\uff0c\u8868\u793a\u5141\u8bb8\u6709\u591a\u4e2a\u4e0d\u540c ",(0,l.kt)("inlineCode",{parentName:"td"},"host"),"\uff0c\u5339\u914d\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u5373\u53ef\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'["foo.com", "',"*",'.bar.com"]')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"remote_addr"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426\uff0c\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"remote_addrs")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684 IP \u5730\u5740\u3002\u652f\u6301 IPv4 \u5730\u5740\uff0c\u5982\uff1a",(0,l.kt)("inlineCode",{parentName:"td"},"192.168.1.101")," \u4ee5\u53ca CIDR \u683c\u5f0f\u7684\u652f\u6301 ",(0,l.kt)("inlineCode",{parentName:"td"},"192.168.1.0/24"),"\uff1b\u652f\u6301 IPv6 \u5730\u5740\u5339\u914d\uff0c\u5982 ",(0,l.kt)("inlineCode",{parentName:"td"},"::1"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"fe80::1"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"fe80::1/64")," \u7b49\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'"192.168.1.0/24"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"remote_addrs"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426\uff0c\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"remote_addr")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u975e\u7a7a\u5217\u8868\u5f62\u6001\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"remote_addr"),"\uff0c\u8868\u793a\u5141\u8bb8\u6709\u591a\u4e2a\u4e0d\u540c IP \u5730\u5740\uff0c\u7b26\u5408\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u5373\u53ef\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'["127.0.0.1", "192.0.0.0/8", "::1"]')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"methods"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5982\u679c\u4e3a\u7a7a\u6216\u6ca1\u6709\u8be5\u9009\u9879\uff0c\u5219\u8868\u793a\u6ca1\u6709\u4efb\u4f55 ",(0,l.kt)("inlineCode",{parentName:"td"},"method")," \u9650\u5236\u3002\u4f60\u4e5f\u53ef\u4ee5\u914d\u7f6e\u4e00\u4e2a\u6216\u591a\u4e2a\u7684\u7ec4\u5408\uff1a",(0,l.kt)("inlineCode",{parentName:"td"},"GET"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"POST"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"PUT"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"DELETE"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"PATCH"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"HEAD"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"OPTIONS"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"CONNECT"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"TRACE"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"PURGE"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'["GET", "POST"]')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"priority"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5982\u679c\u4e0d\u540c\u8def\u7531\u5305\u542b\u76f8\u540c\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"uri"),"\uff0c\u5219\u6839\u636e\u5c5e\u6027 ",(0,l.kt)("inlineCode",{parentName:"td"},"priority")," \u786e\u5b9a\u54ea\u4e2a ",(0,l.kt)("inlineCode",{parentName:"td"},"route")," \u88ab\u4f18\u5148\u5339\u914d\uff0c\u503c\u8d8a\u5927\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u9ed8\u8ba4\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"0"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"priority = 10")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"vars"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7531\u4e00\u4e2a\u6216\u591a\u4e2a",(0,l.kt)("inlineCode",{parentName:"td"},"[var, operator, val]"),"\u5143\u7d20\u7ec4\u6210\u7684\u5217\u8868\uff0c\u7c7b\u4f3c ",(0,l.kt)("inlineCode",{parentName:"td"},"[[var, operator, val], [var, operator, val], ...]]"),"\u3002\u4f8b\u5982\uff1a",(0,l.kt)("inlineCode",{parentName:"td"},'["arg_name", "==", "json"]')," \u5219\u8868\u793a\u5f53\u524d\u8bf7\u6c42\u53c2\u6570 ",(0,l.kt)("inlineCode",{parentName:"td"},"name")," \u662f ",(0,l.kt)("inlineCode",{parentName:"td"},"json"),"\u3002\u6b64\u5904 ",(0,l.kt)("inlineCode",{parentName:"td"},"var")," \u4e0e NGINX \u5185\u90e8\u81ea\u8eab\u53d8\u91cf\u547d\u540d\u662f\u4fdd\u6301\u4e00\u81f4\u7684\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"td"},"request_uri"),"\u3001",(0,l.kt)("inlineCode",{parentName:"td"},"host")," \u7b49\u3002\u66f4\u591a\u7ec6\u8282\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"https://github.com/api7/lua-resty-expr"},"lua-resty-expr"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"[",'["arg_name", "==", "json"]',", ",'["arg_age", ">", 18]',"]")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"filter_func"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u8fc7\u6ee4\u51fd\u6570\u3002\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u5b9e\u73b0\u7279\u6b8a\u573a\u666f\u7684\u5339\u914d\u8981\u6c42\u5b9e\u73b0\u3002\u8be5\u51fd\u6570\u9ed8\u8ba4\u63a5\u53d7\u4e00\u4e2a\u540d\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"vars")," \u7684\u8f93\u5165\u53c2\u6570\uff0c\u53ef\u4ee5\u7528\u5b83\u6765\u83b7\u53d6 NGINX \u53d8\u91cf\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"function(vars) return vars",'["arg_name"]',' == "json" end')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"labels"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u9644\u52a0\u5c5e\u6027\u7684\u952e\u503c\u5bf9\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'{"version":"v2","build":"16","env":"production"}')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"timeout"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u4e3a Route \u8bbe\u7f6e Upstream \u8fde\u63a5\u3001\u53d1\u9001\u6d88\u606f\u548c\u63a5\u6536\u6d88\u606f\u7684\u8d85\u65f6\u65f6\u95f4\uff08\u5355\u4f4d\u4e3a\u79d2\uff09\u3002\u8be5\u914d\u7f6e\u5c06\u4f1a\u8986\u76d6\u5728 Upstream \u4e2d\u914d\u7f6e\u7684 ",(0,l.kt)("a",{parentName:"td",href:"#upstream"},"timeout")," \u9009\u9879\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'{"connect": 3, "send": 3, "read": 3}')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"enable_websocket"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5f53\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"true")," \u65f6\uff0c\u542f\u7528 ",(0,l.kt)("inlineCode",{parentName:"td"},"websocket"),"(boolean), \u9ed8\u8ba4\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"false"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"status"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5f53\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"1")," \u65f6\uff0c\u542f\u7528\u8be5\u8def\u7531\uff0c\u9ed8\u8ba4\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"1"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"1")," \u8868\u793a\u542f\u7528\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"0")," \u8868\u793a\u7981\u7528\u3002")))),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"\u6ce8\u610f")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("ul",{parentName:"div"},(0,l.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u540c\u4e00\u7c7b\u53c2\u6570\u6bd4\u5982 ",(0,l.kt)("inlineCode",{parentName:"li"},"uri"),"\u4e0e ",(0,l.kt)("inlineCode",{parentName:"li"},"uris"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"upstream")," \u4e0e ",(0,l.kt)("inlineCode",{parentName:"li"},"upstream_id"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"host")," \u4e0e ",(0,l.kt)("inlineCode",{parentName:"li"},"hosts"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"remote_addr")," \u4e0e ",(0,l.kt)("inlineCode",{parentName:"li"},"remote_addrs")," \u7b49\uff0c\u662f\u4e0d\u80fd\u540c\u65f6\u5b58\u5728\uff0c\u4e8c\u8005\u53ea\u80fd\u9009\u62e9\u5176\u4e00\u3002\u5982\u679c\u540c\u65f6\u542f\u7528\uff0c\u5219\u4f1a\u51fa\u73b0\u5f02\u5e38\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5728 ",(0,l.kt)("inlineCode",{parentName:"li"},"vars")," \u4e2d\uff0c\u5f53\u83b7\u53d6 Cookie \u7684\u503c\u65f6\uff0cCookie name \u662f",(0,l.kt)("strong",{parentName:"li"},"\u533a\u5206\u5927\u5c0f\u5199\u5b57\u6bcd"),"\u7684\u3002\u4f8b\u5982\uff1a",(0,l.kt)("inlineCode",{parentName:"li"},"var = cookie_x_foo")," \u4e0e ",(0,l.kt)("inlineCode",{parentName:"li"},"var  = cookie_X_Foo")," \u8868\u793a\u4e0d\u540c\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"cookie"),"\u3002")))),(0,l.kt)("p",null,"Route \u5bf9\u8c61 JSON \u914d\u7f6e\u793a\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'{\n    "id": "1",                            # id\uff0c\u975e\u5fc5\u586b\n    "uris": ["/a","/b"],                  # \u4e00\u7ec4 URL \u8def\u5f84\n    "methods": ["GET","POST"],            # \u53ef\u4ee5\u586b\u591a\u4e2a\u65b9\u6cd5\n    "hosts": ["a.com","b.com"],           # \u4e00\u7ec4 host \u57df\u540d\n    "plugins": {},                        # \u6307\u5b9a route \u7ed1\u5b9a\u7684\u63d2\u4ef6\n    "priority": 0,                        # apisix \u652f\u6301\u591a\u79cd\u5339\u914d\u65b9\u5f0f\uff0c\u53ef\u80fd\u4f1a\u5728\u4e00\u6b21\u5339\u914d\u4e2d\u540c\u65f6\u5339\u914d\u5230\u591a\u6761\u8def\u7531\uff0c\u6b64\u65f6\u4f18\u5148\u7ea7\u9ad8\u7684\u4f18\u5148\u5339\u914d\u4e2d\n    "name": "\u8def\u7531 xxx",\n    "desc": "hello world",\n    "remote_addrs": ["127.0.0.1"],        # \u4e00\u7ec4\u5ba2\u6237\u7aef\u8bf7\u6c42 IP \u5730\u5740\n    "vars": [["http_user", "==", "ios"]], # \u7531\u4e00\u4e2a\u6216\u591a\u4e2a [var, operator, val] \u5143\u7d20\u7ec4\u6210\u7684\u5217\u8868\n    "upstream_id": "1",                   # upstream \u5bf9\u8c61\u5728 etcd \u4e2d\u7684 id\uff0c\u5efa\u8bae\u4f7f\u7528\u6b64\u503c\n    "upstream": {},                       # upstream \u4fe1\u606f\u5bf9\u8c61\uff0c\u5efa\u8bae\u5c3d\u91cf\u4e0d\u8981\u4f7f\u7528\n    "timeout": {                          # \u4e3a route \u8bbe\u7f6e upstream \u7684\u8fde\u63a5\u3001\u53d1\u9001\u6d88\u606f\u3001\u63a5\u6536\u6d88\u606f\u7684\u8d85\u65f6\u65f6\u95f4\u3002\n        "connect": 3,\n        "send": 3,\n        "read": 3\n    },\n    "filter_func": ""                     # \u7528\u6237\u81ea\u5b9a\u4e49\u7684\u8fc7\u6ee4\u51fd\u6570\uff0c\u975e\u5fc5\u586b\n}\n')),(0,l.kt)("h3",{id:"route-example"},"\u4f7f\u7528\u793a\u4f8b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2a\u8def\u7531\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/routes/1 \\\n-H "X-API-KEY: $admin_key" -X PUT -i -d \'\n{\n    "uri": "/index.html",\n    "hosts": ["foo.com", "*.bar.com"],\n    "remote_addrs": ["127.0.0.0/8"],\n    "methods": ["PUT", "GET"],\n    "enable_websocket": true,\n    "upstream": {\n        "type": "roundrobin",\n        "nodes": {\n            "127.0.0.1:1980": 1\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 201 Created\nDate: Sat, 31 Aug 2019 01:17:15 GMT\n...\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2a\u6709\u6548\u671f\u4e3a 60 \u79d2\u7684\u8def\u7531\uff0c\u8fc7\u671f\u540e\u81ea\u52a8\u5220\u9664\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl \'http://127.0.0.1:9180/apisix/admin/routes/2?ttl=60\' \\\n-H "X-API-KEY: $admin_key" -X PUT -i -d \'\n{\n    "uri": "/aa/index.html",\n    "upstream": {\n        "type": "roundrobin",\n        "nodes": {\n            "127.0.0.1:1980": 1\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 201 Created\nDate: Sat, 31 Aug 2019 01:17:15 GMT\n...\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5728\u8def\u7531\u4e2d\u65b0\u589e\u4e00\u4e2a\u4e0a\u6e38\u8282\u70b9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/routes/1 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "upstream": {\n        "nodes": {\n            "127.0.0.1:1981": 1\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c\u4e0a\u6e38\u8282\u70b9\u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1980": 1,\n    "127.0.0.1:1981": 1\n}\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u66f4\u65b0\u8def\u7531\u4e2d\u4e0a\u6e38\u8282\u70b9\u7684\u6743\u91cd\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/routes/1 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "upstream": {\n        "nodes": {\n            "127.0.0.1:1981": 10\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c\u4e0a\u6e38\u8282\u70b9\u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1980": 1,\n    "127.0.0.1:1981": 10\n}\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4ece\u8def\u7531\u4e2d\u5220\u9664\u4e00\u4e2a\u4e0a\u6e38\u8282\u70b9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/routes/1 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "upstream": {\n        "nodes": {\n            "127.0.0.1:1980": null\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0cUpstream ",(0,l.kt)("inlineCode",{parentName:"p"},"nodes")," \u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'{\n    "127.0.0.1:1981": 10\n}\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u66f4\u65b0\u8def\u7531\u4e2d\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"methods")," \u6570\u7ec4"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/routes/1 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'{\n    "methods": ["GET", "POST"]\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"methods")," \u5c06\u4e0d\u4fdd\u7559\u539f\u6765\u7684\u6570\u636e\uff0c\u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'["GET", "POST"]\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"sub path")," \u66f4\u65b0\u8def\u7531\u4e2d\u7684\u4e0a\u6e38\u8282\u70b9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/routes/1/upstream/nodes \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "127.0.0.1:1982": 1\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"nodes")," \u5c06\u4e0d\u4fdd\u7559\u539f\u6765\u7684\u6570\u636e\uff0c\u6574\u4e2a\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1982": 1\n}\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"sub path")," \u66f4\u65b0\u8def\u7531\u4e2d\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"methods"),"\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/routes/1/methods \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'["POST", "DELETE", "PATCH"]\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"methods")," \u5c06\u4e0d\u4fdd\u7559\u539f\u6765\u7684\u6570\u636e\uff0c\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'["POST", "DELETE", "PATCH"]\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u7981\u7528\u8def\u7531"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/routes/1 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "status": 0\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"status")," \u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "status": 0\n}\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u542f\u7528\u8def\u7531"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/routes/1 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "status": 1\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"status")," \u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "status": 1\n}\n')))),(0,l.kt)("h3",{id:"route-response-parameters"},"\u5e94\u7b54\u53c2\u6570"),(0,l.kt)("p",null,"\u76ee\u524d\u662f\u76f4\u63a5\u8fd4\u56de\u4e0e etcd \u4ea4\u4e92\u540e\u7684\u7ed3\u679c\u3002"),(0,l.kt)("h2",{id:"service"},"Service"),(0,l.kt)("p",null,"Service \u662f\u67d0\u7c7b API \u7684\u62bd\u8c61\uff08\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u7ec4 Route \u7684\u62bd\u8c61\uff09\u3002\u5b83\u901a\u5e38\u4e0e\u4e0a\u6e38\u670d\u52a1\u62bd\u8c61\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"Route")," \u4e0e ",(0,l.kt)("inlineCode",{parentName:"p"},"Service")," \u4e4b\u95f4\uff0c\u901a\u5e38\u662f N:1 \u7684\u5173\u7cfb\u3002"),(0,l.kt)("h3",{id:"service-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"\u670d\u52a1\u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/services/{id}"),(0,l.kt)("h3",{id:"service-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/services"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/services/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/services/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u6307\u5b9a id \u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"POST"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/services"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u8d44\u6e90\uff0cid \u7531\u540e\u53f0\u670d\u52a1\u81ea\u52a8\u751f\u6210\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/services/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/services/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u51c6 PATCH\uff0c\u4fee\u6539\u5df2\u6709 Service \u7684\u90e8\u5206\u5c5e\u6027\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\uff1b\u5982\u679c\u4f60\u8981\u5220\u9664\u67d0\u4e2a\u5c5e\u6027\uff0c\u5c06\u8be5\u5c5e\u6027\u7684\u503c\u8bbe\u7f6e\u4e3a null \u5373\u53ef\u5220\u9664\uff1b",(0,l.kt)("strong",{parentName:"td"},"\u6ce8\u610f"),"\uff1a\u5f53\u9700\u8981\u4fee\u6539\u5c5e\u6027\u7684\u503c\u4e3a\u6570\u7ec4\u65f6\uff0c\u8be5\u5c5e\u6027\u5c06\u5168\u91cf\u66f4\u65b0\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/services/{id}/{path}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"SubPath PATCH\uff0c\u901a\u8fc7 {path} \u6307\u5b9a Service \u9700\u8981\u66f4\u65b0\u7684\u5c5e\u6027\uff0c\u5168\u91cf\u66f4\u65b0\u8be5\u5c5e\u6027\u7684\u6570\u636e\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\u3002")))),(0,l.kt)("h3",{id:"service-request-body-parameters"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"plugins"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin \u914d\u7f6e\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/plugin"},"Plugin"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"upstream"),(0,l.kt)("td",{parentName:"tr",align:null},"\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"upstream_id")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"Upstream"),(0,l.kt)("td",{parentName:"tr",align:null},"Upstream \u914d\u7f6e\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/upstream"},"Upstream"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"upstream_id"),(0,l.kt)("td",{parentName:"tr",align:null},"\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"upstream")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"Upstream"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9700\u8981\u4f7f\u7528\u7684 upstream id\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/upstream"},"Upstream"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"name"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u670d\u52a1\u540d\u79f0\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"desc"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u670d\u52a1\u63cf\u8ff0\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"labels"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u9644\u52a0\u5c5e\u6027\u7684\u952e\u503c\u5bf9\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'{"version":"v2","build":"16","env":"production"}')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"enable_websocket"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"websocket"),"(boolean) \u914d\u7f6e\uff0c\u9ed8\u8ba4\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"false"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"hosts"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u975e\u7a7a\u5217\u8868\u5f62\u6001\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"host"),"\uff0c\u8868\u793a\u5141\u8bb8\u6709\u591a\u4e2a\u4e0d\u540c ",(0,l.kt)("inlineCode",{parentName:"td"},"host"),"\uff0c\u5339\u914d\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u5373\u53ef\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'["foo.com", "',"*",'.bar.com"]')))),(0,l.kt)("p",null,"Service \u5bf9\u8c61 JSON \u914d\u7f6e\u793a\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'{\n    "id": "1",                # id\n    "plugins": {},            # \u6307\u5b9a service \u7ed1\u5b9a\u7684\u63d2\u4ef6\n    "upstream_id": "1",       # upstream \u5bf9\u8c61\u5728 etcd \u4e2d\u7684 id\uff0c\u5efa\u8bae\u4f7f\u7528\u6b64\u503c\n    "upstream": {},           # upstream \u4fe1\u606f\u5bf9\u8c61\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\n    "name": "test svc",       # service \u540d\u79f0\n    "desc": "hello world",    # service \u63cf\u8ff0\n    "enable_websocket": true, # \u542f\u52a8 websocket \u529f\u80fd\n    "hosts": ["foo.com"]\n}\n')),(0,l.kt)("h3",{id:"service-example"},"\u4f7f\u7528\u793a\u4f8b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2a Service\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/services/201  \\\n-H "X-API-KEY: $admin_key" -X PUT -i -d \'\n{\n    "plugins": {\n        "limit-count": {\n            "count": 2,\n            "time_window": 60,\n            "rejected_code": 503,\n            "key": "remote_addr"\n        }\n    },\n    "enable_websocket": true,\n    "upstream": {\n        "type": "roundrobin",\n        "nodes": {\n            "127.0.0.1:1980": 1\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 201 Created\n...\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5728 Service \u4e2d\u6dfb\u52a0\u4e00\u4e2a\u4e0a\u6e38\u8282\u70b9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/services/201 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "upstream": {\n        "nodes": {\n            "127.0.0.1:1981": 1\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c\u4e0a\u6e38\u8282\u70b9\u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "127.0.0.1:1980": 1,\n    "127.0.0.1:1981": 1\n}\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u66f4\u65b0\u4e00\u4e2a\u4e0a\u6e38\u8282\u70b9\u7684\u6743\u91cd\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/services/201 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "upstream": {\n        "nodes": {\n            "127.0.0.1:1981": 10\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c\u4e0a\u6e38\u8282\u70b9\u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1980": 1,\n    "127.0.0.1:1981": 10\n}\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5220\u9664 Service \u4e2d\u7684\u4e00\u4e2a\u4e0a\u6e38\u8282\u70b9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/services/201 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "upstream": {\n        "nodes": {\n            "127.0.0.1:1980": null\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c\u4e0a\u6e38\u8282\u70b9\u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1981": 10\n}\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u66ff\u6362 Service \u7684\u4e0a\u6e38\u8282\u70b9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/services/201/upstream/nodes \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "127.0.0.1:1982": 1\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"  \u6267\u884c\u6210\u529f\u540e\uff0c\u4e0a\u6e38\u8282\u70b9\u4e0d\u518d\u4fdd\u7559\u539f\u6765\u7684\u6570\u636e\uff0c\u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1982": 1\n}\n')))),(0,l.kt)("h3",{id:"service-response-parameters"},"\u5e94\u7b54\u53c2\u6570"),(0,l.kt)("p",null,"\u76ee\u524d\u662f\u76f4\u63a5\u8fd4\u56de\u4e0e etcd \u4ea4\u4e92\u540e\u7684\u7ed3\u679c\u3002"),(0,l.kt)("h2",{id:"consumer"},"Consumer"),(0,l.kt)("p",null,"Consumer \u662f\u67d0\u7c7b\u670d\u52a1\u7684\u6d88\u8d39\u8005\uff0c\u9700\u8981\u4e0e\u7528\u6237\u8ba4\u8bc1\u4f53\u7cfb\u914d\u5408\u624d\u80fd\u4f7f\u7528\u3002Consumer \u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"username")," \u4f5c\u4e3a\u552f\u4e00\u6807\u8bc6\uff0c\u4ec5\u652f\u6301\u4f7f\u7528 HTTP ",(0,l.kt)("inlineCode",{parentName:"p"},"PUT")," \u65b9\u6cd5\u521b\u5efa Consumer\u3002"),(0,l.kt)("h3",{id:"consumer-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"Consumer \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/consumers/{username}"),(0,l.kt)("h3",{id:"consumer-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumers"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumers/{username}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumers"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumers/{username}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u8d44\u6e90\u3002")))),(0,l.kt)("h3",{id:"consumer-body-request-methods"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b\u503c"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"username"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"Consumer \u540d\u79f0\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"group_id"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"Consumer Group \u540d\u79f0\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"plugins"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8be5 Consumer \u5bf9\u5e94\u7684\u63d2\u4ef6\u914d\u7f6e\uff0c\u5b83\u7684\u4f18\u5148\u7ea7\u662f\u6700\u9ad8\u7684\uff1aConsumer > Route > Plugin Config > Service\u3002\u5bf9\u4e8e\u5177\u4f53\u63d2\u4ef6\u914d\u7f6e\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"#plugin"},"Plugins"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"desc"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"consumer \u63cf\u8ff0\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"labels"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u9644\u52a0\u5c5e\u6027\u7684\u952e\u503c\u5bf9\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'{"version":"v2","build":"16","env":"production"}')))),(0,l.kt)("p",null,"Consumer \u5bf9\u8c61 JSON \u914d\u7f6e\u793a\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'{\n    "plugins": {},          # \u6307\u5b9a consumer \u7ed1\u5b9a\u7684\u63d2\u4ef6\n    "username": "name",     # \u5fc5\u586b\n    "desc": "hello world"   # consumer \u63cf\u8ff0\n}\n')),(0,l.kt)("p",null,"\u5f53\u8ba4\u8bc1\u63d2\u4ef6\u4e0e Consumer \u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u9700\u8981\u63d0\u4f9b\u7528\u6237\u540d\u3001\u5bc6\u7801\u7b49\u4fe1\u606f\uff1b\u5f53\u8ba4\u8bc1\u63d2\u4ef6\u4e0e Route \u6216 Service \u7ed1\u5b9a\u65f6\uff0c\u5219\u4e0d\u9700\u8981\u4efb\u4f55\u53c2\u6570\uff0c\u56e0\u4e3a\u6b64\u65f6 APISIX \u662f\u6839\u636e\u7528\u6237\u8bf7\u6c42\u6570\u636e\u6765\u5224\u65ad\u7528\u6237\u5bf9\u5e94\u7684\u662f\u54ea\u4e2a Consumer\u3002"),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"\u6ce8\u610f")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u4ece APISIX v2.2 \u7248\u672c\u5f00\u59cb\uff0c\u540c\u4e00\u4e2a Consumer \u53ef\u4ee5\u7ed1\u5b9a\u591a\u4e2a\u8ba4\u8bc1\u63d2\u4ef6\u3002"))),(0,l.kt)("h3",{id:"consumer-example"},"\u4f7f\u7528\u793a\u4f8b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa Consumer\uff0c\u5e76\u6307\u5b9a\u8ba4\u8bc1\u63d2\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"key-auth"),"\uff0c\u5e76\u5f00\u542f\u6307\u5b9a\u63d2\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"limit-count"),"\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/consumers  \\\n-H "X-API-KEY: $admin_key" -X PUT -i -d \'\n{\n    "username": "jack",\n    "plugins": {\n        "key-auth": {\n            "key": "auth-one"\n        },\n        "limit-count": {\n            "count": 2,\n            "time_window": 60,\n            "rejected_code": 503,\n            "key": "remote_addr"\n        }\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'HTTP/1.1 200 OK\nDate: Thu, 26 Dec 2019 08:17:49 GMT\n...\n\n{"key":"\\/apisix\\/consumers\\/jack","value":{"username":"jack","update_time":1666260780,"plugins":{"limit-count":{"key_type":"var","count":2,"rejected_code":503,"show_limit_quota_header":true,"time_window":60,"key":"remote_addr","allow_degradation":false,"policy":"local"},"key-auth":{"key":"auth-one"}},"create_time":1666260780}}\n')))),(0,l.kt)("h3",{id:"consumer-response-parameters"},"\u5e94\u7b54\u53c2\u6570"),(0,l.kt)("p",null,"\u76ee\u524d\u662f\u76f4\u63a5\u8fd4\u56de\u4e0e etcd \u4ea4\u4e92\u540e\u7684\u7ed3\u679c\u3002"),(0,l.kt)("h2",{id:"upstream"},"Upstream"),(0,l.kt)("p",null,"Upstream \u662f\u865a\u62df\u4e3b\u673a\u62bd\u8c61\uff0c\u5bf9\u7ed9\u5b9a\u7684\u591a\u4e2a\u670d\u52a1\u8282\u70b9\u6309\u7167\u914d\u7f6e\u89c4\u5219\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u3002Upstream \u7684\u5730\u5740\u4fe1\u606f\u53ef\u4ee5\u76f4\u63a5\u914d\u7f6e\u5230 ",(0,l.kt)("inlineCode",{parentName:"p"},"Route"),"\uff08\u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"Service"),") \u4e0a\uff0c\u5f53 Upstream \u6709\u91cd\u590d\u65f6\uff0c\u9700\u8981\u7528\u201c\u5f15\u7528\u201d\u65b9\u5f0f\u907f\u514d\u91cd\u590d\u3002"),(0,l.kt)("h3",{id:"upstream-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"Upstream \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/upstreams/{id}"),(0,l.kt)("h3",{id:"upstream-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/upstreams/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/upstreams/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u6307\u5b9a id \u7684\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"POST"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/upstreams"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u8d44\u6e90\uff0cid \u7531\u540e\u53f0\u670d\u52a1\u81ea\u52a8\u751f\u6210\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/upstreams/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/upstreams/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u51c6 PATCH\uff0c\u4fee\u6539\u5df2\u6709 Upstream \u7684\u90e8\u5206\u5c5e\u6027\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\uff1b\u5982\u679c\u9700\u8981\u5220\u9664\u67d0\u4e2a\u5c5e\u6027\uff0c\u53ef\u5c06\u8be5\u5c5e\u6027\u7684\u503c\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"null"),"\uff1b",(0,l.kt)("strong",{parentName:"td"},"\u6ce8\u610f"),"\uff1a\u5f53\u9700\u8981\u4fee\u6539\u5c5e\u6027\u7684\u503c\u4e3a\u6570\u7ec4\u65f6\uff0c\u8be5\u5c5e\u6027\u5c06\u5168\u91cf\u66f4\u65b0\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/upstreams/{id}/{path}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"SubPath PATCH\uff0c\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"td"},"{path}")," \u6307\u5b9a Upstream \u9700\u8981\u66f4\u65b0\u7684\u5c5e\u6027\uff0c\u5168\u91cf\u66f4\u65b0\u8be5\u5c5e\u6027\u7684\u6570\u636e\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\u3002")))),(0,l.kt)("h3",{id:"upstream-body-request-methods"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("p",null,"APISIX \u7684 Upstream \u9664\u4e86\u57fa\u672c\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u9009\u62e9\u5916\uff0c\u8fd8\u652f\u6301\u5bf9\u4e0a\u6e38\u505a\u4e3b\u88ab\u52a8\u5065\u5eb7\u68c0\u67e5\u3001\u91cd\u8bd5\u7b49\u903b\u8f91\u3002\u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b\uff1a"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"type"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u679a\u4e3e"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u9ed8\u8ba4\u503c\u662f",(0,l.kt)("inlineCode",{parentName:"td"},"roundrobin"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"nodes"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f\uff0c\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"service_name")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"Node"),(0,l.kt)("td",{parentName:"tr",align:null},"\u54c8\u5e0c\u8868\u6216\u6570\u7ec4\u3002\u5f53\u5b83\u662f\u54c8\u5e0c\u8868\u65f6\uff0c\u5185\u90e8\u5143\u7d20\u7684 key \u662f\u4e0a\u6e38\u673a\u5668\u5730\u5740\u5217\u8868\uff0c\u683c\u5f0f\u4e3a",(0,l.kt)("inlineCode",{parentName:"td"},"\u5730\u5740 +\uff08\u53ef\u9009\u7684\uff09\u7aef\u53e3"),"\uff0c\u5176\u4e2d\u5730\u5740\u90e8\u5206\u53ef\u4ee5\u662f IP \u4e5f\u53ef\u4ee5\u662f\u57df\u540d\uff0c\u6bd4\u5982 ",(0,l.kt)("inlineCode",{parentName:"td"},"192.168.1.100:80"),"\u3001",(0,l.kt)("inlineCode",{parentName:"td"},"foo.com:80"),"\u7b49\u3002\u5bf9\u4e8e\u54c8\u5e0c\u8868\u7684\u60c5\u51b5\uff0c\u5982\u679c key \u662f IPv6 \u5730\u5740\u52a0\u7aef\u53e3\uff0c\u5219\u5fc5\u987b\u7528\u4e2d\u62ec\u53f7\u5c06 IPv6 \u5730\u5740\u62ec\u8d77\u6765\u3002",(0,l.kt)("inlineCode",{parentName:"td"},"value")," \u5219\u662f\u8282\u70b9\u7684\u6743\u91cd\u3002\u5f53\u5b83\u662f\u6570\u7ec4\u65f6\uff0c\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2a\u54c8\u5e0c\u8868\uff0c\u5176\u4e2d\u5305\u542b ",(0,l.kt)("inlineCode",{parentName:"td"},"host"),"\u3001",(0,l.kt)("inlineCode",{parentName:"td"},"weight")," \u4ee5\u53ca\u53ef\u9009\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"port"),"\u3001",(0,l.kt)("inlineCode",{parentName:"td"},"priority"),"\u3002",(0,l.kt)("inlineCode",{parentName:"td"},"nodes")," \u53ef\u4ee5\u4e3a\u7a7a\uff0c\u8fd9\u901a\u5e38\u7528\u4f5c\u5360\u4f4d\u7b26\u3002\u5ba2\u6237\u7aef\u547d\u4e2d\u8fd9\u6837\u7684\u4e0a\u6e38\u4f1a\u8fd4\u56de ",(0,l.kt)("inlineCode",{parentName:"td"},"502"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"192.168.1.100:80"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"[::1]:80"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"service_name"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f\uff0c\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"nodes")," \u4e8c\u9009\u4e00\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u670d\u52a1\u53d1\u73b0\u65f6\u4f7f\u7528\u7684\u670d\u52a1\u540d\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/discovery"},"\u96c6\u6210\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u4e2d\u5fc3"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"a-bootiful-client"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"discovery_type"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f\uff0c\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"service_name")," \u914d\u5408\u4f7f\u7528\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u670d\u52a1\u53d1\u73b0\u7c7b\u578b\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/discovery"},"\u96c6\u6210\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u4e2d\u5fc3"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"eureka"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"key"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6761\u4ef6\u5fc5\u9700"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u7c7b\u578b"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8be5\u9009\u9879\u53ea\u6709\u7c7b\u578b\u662f ",(0,l.kt)("inlineCode",{parentName:"td"},"chash")," \u624d\u6709\u6548\u3002\u6839\u636e ",(0,l.kt)("inlineCode",{parentName:"td"},"key")," \u6765\u67e5\u627e\u5bf9\u5e94\u7684\u8282\u70b9 ",(0,l.kt)("inlineCode",{parentName:"td"},"id"),"\uff0c\u76f8\u540c\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"key")," \u5728\u540c\u4e00\u4e2a\u5bf9\u8c61\u4e2d\uff0c\u5219\u8fd4\u56de\u76f8\u540c id\u3002\u76ee\u524d\u652f\u6301\u7684 NGINX \u5185\u7f6e\u53d8\u91cf\u6709 ",(0,l.kt)("inlineCode",{parentName:"td"},"uri, server_name, server_addr, request_uri, remote_port, remote_addr, query_string, host, hostname, arg_***"),"\uff0c\u5176\u4e2d ",(0,l.kt)("inlineCode",{parentName:"td"},"arg_***")," \u662f\u6765\u81ea URL \u7684\u8bf7\u6c42\u53c2\u6570\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"http://nginx.org/en/docs/varindex.html"},"NGINX \u53d8\u91cf\u5217\u8868"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"checks"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"health_checker"),(0,l.kt)("td",{parentName:"tr",align:null},"\u914d\u7f6e\u5065\u5eb7\u68c0\u67e5\u7684\u53c2\u6570\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/tutorials/health-check"},"health-check"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"retries"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6574\u578b"),(0,l.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528 NGINX \u91cd\u8bd5\u673a\u5236\u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a\u4e0a\u6e38\uff0c\u9ed8\u8ba4\u542f\u7528\u91cd\u8bd5\u673a\u5236\u4e14\u6b21\u6570\u4e3a\u540e\u7aef\u53ef\u7528\u7684\u8282\u70b9\u6570\u91cf\u3002\u5982\u679c\u6307\u5b9a\u4e86\u5177\u4f53\u91cd\u8bd5\u6b21\u6570\uff0c\u5b83\u5c06\u8986\u76d6\u9ed8\u8ba4\u503c\u3002\u5f53\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"0")," \u65f6\uff0c\u8868\u793a\u4e0d\u542f\u7528\u91cd\u8bd5\u673a\u5236\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"retry_timeout"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"number"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9650\u5236\u662f\u5426\u7ee7\u7eed\u91cd\u8bd5\u7684\u65f6\u95f4\uff0c\u82e5\u4e4b\u524d\u7684\u8bf7\u6c42\u548c\u91cd\u8bd5\u8bf7\u6c42\u82b1\u8d39\u592a\u591a\u65f6\u95f4\u5c31\u4e0d\u518d\u7ee7\u7eed\u91cd\u8bd5\u3002\u5f53\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"0")," \u65f6\uff0c\u8868\u793a\u4e0d\u542f\u7528\u91cd\u8bd5\u8d85\u65f6\u673a\u5236\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"timeout"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8d85\u65f6\u65f6\u95f4\u5bf9\u8c61"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u8fde\u63a5\u3001\u53d1\u9001\u6d88\u606f\u3001\u63a5\u6536\u6d88\u606f\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'{"connect": 0.5,"send": 0.5,"read": 0.5}'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"hash_on"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"hash_on")," \u652f\u6301\u7684\u7c7b\u578b\u6709 ",(0,l.kt)("inlineCode",{parentName:"td"},"vars"),"\uff08NGINX \u5185\u7f6e\u53d8\u91cf\uff09\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"header"),"\uff08\u81ea\u5b9a\u4e49 header\uff09\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"cookie"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"consumer"),"\uff0c\u9ed8\u8ba4\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"vars"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"name"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u4e0a\u6e38\u670d\u52a1\u540d\u79f0\u3001\u4f7f\u7528\u573a\u666f\u7b49\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"desc"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u4e0a\u6e38\u670d\u52a1\u63cf\u8ff0\u3001\u4f7f\u7528\u573a\u666f\u7b49\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"pass_host"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u679a\u4e3e"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bf7\u6c42\u53d1\u7ed9\u4e0a\u6e38\u65f6\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"host")," \u8bbe\u7f6e\u9009\u578b\u3002 ","[",(0,l.kt)("inlineCode",{parentName:"td"},"pass"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"node"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"rewrite"),"]"," \u4e4b\u4e00\uff0c\u9ed8\u8ba4\u662f ",(0,l.kt)("inlineCode",{parentName:"td"},"pass"),"\u3002",(0,l.kt)("inlineCode",{parentName:"td"},"pass"),": \u5c06\u5ba2\u6237\u7aef\u7684 host \u900f\u4f20\u7ed9\u4e0a\u6e38\uff1b ",(0,l.kt)("inlineCode",{parentName:"td"},"node"),": \u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"td"},"upstream")," node \u4e2d\u914d\u7f6e\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"host"),"\uff1b ",(0,l.kt)("inlineCode",{parentName:"td"},"rewrite"),": \u4f7f\u7528\u914d\u7f6e\u9879 ",(0,l.kt)("inlineCode",{parentName:"td"},"upstream_host")," \u7684\u503c\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"upstream_host"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6307\u5b9a\u4e0a\u6e38\u8bf7\u6c42\u7684 host\uff0c\u53ea\u5728 ",(0,l.kt)("inlineCode",{parentName:"td"},"pass_host")," \u914d\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"rewrite")," \u65f6\u6709\u6548\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"scheme"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8ddf\u4e0a\u6e38\u901a\u4fe1\u65f6\u4f7f\u7528\u7684 scheme\u3002\u5bf9\u4e8e 7 \u5c42\u4ee3\u7406\uff0c\u53ef\u9009\u503c\u4e3a ","[",(0,l.kt)("inlineCode",{parentName:"td"},"http"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"https"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"grpc"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"grpcs"),"]","\u3002\u5bf9\u4e8e 4 \u5c42\u4ee3\u7406\uff0c\u53ef\u9009\u503c\u4e3a ","[",(0,l.kt)("inlineCode",{parentName:"td"},"tcp"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"udp"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"tls"),"]","\u3002\u9ed8\u8ba4\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"http"),"\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003\u4e0b\u6587\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"labels"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u9644\u52a0\u5c5e\u6027\u7684\u952e\u503c\u5bf9\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'{"version":"v2","build":"16","env":"production"}')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"tls.client_cert"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426\uff0c\u4e0d\u80fd\u548c ",(0,l.kt)("inlineCode",{parentName:"td"},"tls.client_cert_id")," \u4e00\u8d77\u4f7f\u7528"),(0,l.kt)("td",{parentName:"tr",align:null},"https \u8bc1\u4e66"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u8ddf\u4e0a\u6e38\u901a\u4fe1\u65f6\u7684\u5ba2\u6237\u7aef\u8bc1\u4e66\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003\u4e0b\u6587\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"tls.client_key"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426\uff0c\u4e0d\u80fd\u548c ",(0,l.kt)("inlineCode",{parentName:"td"},"tls.client_cert_id")," \u4e00\u8d77\u4f7f\u7528"),(0,l.kt)("td",{parentName:"tr",align:null},"https \u8bc1\u4e66\u79c1\u94a5"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u8ddf\u4e0a\u6e38\u901a\u4fe1\u65f6\u7684\u5ba2\u6237\u7aef\u79c1\u94a5\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003\u4e0b\u6587\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"tls.client_cert_id"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426\uff0c\u4e0d\u80fd\u548c ",(0,l.kt)("inlineCode",{parentName:"td"},"tls.client_cert"),"\u3001",(0,l.kt)("inlineCode",{parentName:"td"},"tls.client_key")," \u4e00\u8d77\u4f7f\u7528"),(0,l.kt)("td",{parentName:"tr",align:null},"SSL"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5f15\u7528\u7684 SSL id\uff0c\u8be6\u89c1 ",(0,l.kt)("a",{parentName:"td",href:"#ssl"},"SSL"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keepalive_pool.size"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u52a8\u6001\u8bbe\u7f6e ",(0,l.kt)("inlineCode",{parentName:"td"},"keepalive")," \u6307\u4ee4\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003\u4e0b\u6587\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keepalive_pool.idle_timeout"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u52a8\u6001\u8bbe\u7f6e ",(0,l.kt)("inlineCode",{parentName:"td"},"keepalive_timeout")," \u6307\u4ee4\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003\u4e0b\u6587\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keepalive_pool.requests"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u52a8\u6001\u8bbe\u7f6e ",(0,l.kt)("inlineCode",{parentName:"td"},"keepalive_requests")," \u6307\u4ee4\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003\u4e0b\u6587\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"type")," \u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"roundrobin"),": \u5e26\u6743\u91cd\u7684 Round Robin\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"chash"),": \u4e00\u81f4\u6027\u54c8\u5e0c\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"ewma"),": \u9009\u62e9\u5ef6\u8fdf\u6700\u5c0f\u7684\u8282\u70b9\uff0c\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/EWMA_chart"},"EWMA_chart"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"least_conn"),": \u9009\u62e9 ",(0,l.kt)("inlineCode",{parentName:"li"},"(active_conn + 1) / weight")," \u6700\u5c0f\u7684\u8282\u70b9\u3002\u6b64\u5904\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"active connection")," \u6982\u5ff5\u8ddf NGINX \u7684\u76f8\u540c\uff0c\u5b83\u662f\u5f53\u524d\u6b63\u5728\u88ab\u8bf7\u6c42\u4f7f\u7528\u7684\u8fde\u63a5\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u7528\u6237\u81ea\u5b9a\u4e49\u7684 balancer\uff0c\u9700\u8981\u53ef\u4ee5\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"li"},'require("apisix.balancer.your_balancer")')," \u6765\u52a0\u8f7d\u3002")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"hash_on")," \u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u8bbe\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"vars")," \u65f6\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"key")," \u4e3a\u5fc5\u4f20\u53c2\u6570\uff0c\u76ee\u524d\u652f\u6301\u7684 NGINX \u5185\u7f6e\u53d8\u91cf\u6709 ",(0,l.kt)("inlineCode",{parentName:"li"},"uri, server_name, server_addr, request_uri, remote_port, remote_addr, query_string, host, hostname, arg_***"),"\uff0c\u5176\u4e2d ",(0,l.kt)("inlineCode",{parentName:"li"},"arg_***")," \u662f\u6765\u81ea URL \u7684\u8bf7\u6c42\u53c2\u6570\u3002\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"li",href:"http://nginx.org/en/docs/varindex.html"},"NGINX \u53d8\u91cf\u5217\u8868"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u8bbe\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"header")," \u65f6\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"key"),' \u4e3a\u5fc5\u4f20\u53c2\u6570\uff0c\u5176\u503c\u4e3a\u81ea\u5b9a\u4e49\u7684 Header name\uff0c\u5373 "http',"_",(0,l.kt)("inlineCode",{parentName:"li"},"key"),'"\u3002'),(0,l.kt)("li",{parentName:"ul"},"\u8bbe\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"cookie")," \u65f6\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"key"),' \u4e3a\u5fc5\u4f20\u53c2\u6570\uff0c\u5176\u503c\u4e3a\u81ea\u5b9a\u4e49\u7684 cookie name\uff0c\u5373 "cookie',"_",(0,l.kt)("inlineCode",{parentName:"li"},"key"),'"\u3002\u8bf7\u6ce8\u610f cookie name \u662f',(0,l.kt)("strong",{parentName:"li"},"\u533a\u5206\u5927\u5c0f\u5199\u5b57\u6bcd"),"\u7684\u3002\u4f8b\u5982\uff1a",(0,l.kt)("inlineCode",{parentName:"li"},"cookie_x_foo")," \u4e0e ",(0,l.kt)("inlineCode",{parentName:"li"},"cookie_X_Foo")," \u8868\u793a\u4e0d\u540c\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"cookie"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u8bbe\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"consumer")," \u65f6\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"key")," \u4e0d\u9700\u8981\u8bbe\u7f6e\u3002\u6b64\u65f6\u54c8\u5e0c\u7b97\u6cd5\u91c7\u7528\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"key")," \u4e3a\u8ba4\u8bc1\u901a\u8fc7\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"consumer_name"),"\u3002")),(0,l.kt)("p",null,"\u4ee5\u4e0b\u7279\u6027\u9700\u8981 APISIX \u8fd0\u884c\u4e8e ",(0,l.kt)("a",{parentName:"p",href:"/zh/docs/apisix/3.10/FAQ#%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA-APISIX-Runtime-%E7%8E%AF%E5%A2%83%EF%BC%9F"},"APISIX-Runtime"),"\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"scheme")," \u53ef\u4ee5\u8bbe\u7f6e\u6210 ",(0,l.kt)("inlineCode",{parentName:"li"},"tls"),"\uff0c\u8868\u793a ",(0,l.kt)("inlineCode",{parentName:"li"},"TLS over TCP"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"tls.client_cert/key")," \u53ef\u4ee5\u7528\u6765\u8ddf\u4e0a\u6e38\u8fdb\u884c mTLS \u901a\u4fe1\u3002\u4ed6\u4eec\u7684\u683c\u5f0f\u548c SSL \u5bf9\u8c61\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"cert")," \u548c ",(0,l.kt)("inlineCode",{parentName:"li"},"key")," \u4e00\u6837\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"tls.client_cert_id")," \u53ef\u4ee5\u7528\u6765\u6307\u5b9a\u5f15\u7528\u7684 SSL \u5bf9\u8c61\u3002\u53ea\u6709\u5f53 SSL \u5bf9\u8c61\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"type")," \u5b57\u6bb5\u4e3a client \u65f6\u624d\u80fd\u88ab\u5f15\u7528\uff0c\u5426\u5219\u8bf7\u6c42\u4f1a\u88ab APISIX \u62d2\u7edd\u3002\u53e6\u5916\uff0cSSL \u5bf9\u8c61\u4e2d\u53ea\u6709 ",(0,l.kt)("inlineCode",{parentName:"li"},"cert")," \u548c ",(0,l.kt)("inlineCode",{parentName:"li"},"key")," \u4f1a\u88ab\u4f7f\u7528\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"keepalive_pool")," \u5141\u8bb8 Upstream \u6709\u81ea\u5df1\u5355\u72ec\u7684\u8fde\u63a5\u6c60\u3002\u5b83\u4e0b\u5c5e\u7684\u5b57\u6bb5\uff0c\u6bd4\u5982 ",(0,l.kt)("inlineCode",{parentName:"li"},"requests"),"\uff0c\u53ef\u4ee5\u7528\u4e8e\u914d\u7f6e\u4e0a\u6e38\u8fde\u63a5\u4fdd\u6301\u7684\u53c2\u6570\u3002")),(0,l.kt)("p",null,"Upstream \u5bf9\u8c61 JSON \u914d\u7f6e\u793a\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'{\n    "id": "1",                  # id\n    "retries": 1,               # \u8bf7\u6c42\u91cd\u8bd5\u6b21\u6570\n    "timeout": {                # \u8bbe\u7f6e\u8fde\u63a5\u3001\u53d1\u9001\u6d88\u606f\u3001\u63a5\u6536\u6d88\u606f\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u6bcf\u9879\u90fd\u4e3a 15 \u79d2\n        "connect":15,\n        "send":15,\n        "read":15\n    },\n    "nodes": {"host:80": 100},  # \u4e0a\u6e38\u673a\u5668\u5730\u5740\u5217\u8868\uff0c\u683c\u5f0f\u4e3a`\u5730\u5740 + \u7aef\u53e3`\n                                # \u7b49\u4ef7\u4e8e "nodes": [ {"host":"host", "port":80, "weight": 100} ],\n    "type":"roundrobin",\n    "checks": {},               # \u914d\u7f6e\u5065\u5eb7\u68c0\u67e5\u7684\u53c2\u6570\n    "hash_on": "",\n    "key": "",\n    "name": "upstream-xxx",     # upstream \u540d\u79f0\n    "desc": "hello world",      # upstream \u63cf\u8ff0\n    "scheme": "http"            # \u8ddf\u4e0a\u6e38\u901a\u4fe1\u65f6\u4f7f\u7528\u7684 scheme\uff0c\u9ed8\u8ba4\u662f `http`\n}\n')),(0,l.kt)("h3",{id:"upstream-example"},"\u4f7f\u7528\u793a\u4f8b"),(0,l.kt)("h4",{id:"create-upstream"},"\u521b\u5efa Upstream \u5e76\u5bf9 ",(0,l.kt)("inlineCode",{parentName:"h4"},"nodes")," \u7684\u6570\u636e\u8fdb\u884c\u4fee\u6539"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa Upstream\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/upstreams/100  \\\n-H "X-API-KEY: $admin_key" -i -X PUT -d \'\n{\n    "type":"roundrobin",\n    "nodes":{\n        "127.0.0.1:1980": 1\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 201 Created\n...\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5728 Upstream \u4e2d\u6dfb\u52a0\u4e00\u4e2a\u8282\u70b9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/upstreams/100 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "nodes": {\n        "127.0.0.1:1981": 1\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"\u6267\u884c\u6210\u529f\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"nodes")," \u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1980": 1,\n    "127.0.0.1:1981": 1\n}\n'))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u66f4\u65b0 Upstream \u4e2d\u5355\u4e2a\u8282\u70b9\u7684\u6743\u91cd\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/upstreams/100 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "nodes": {\n        "127.0.0.1:1981": 10\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"\u6267\u884c\u6210\u529f\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"nodes")," \u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1980": 1,\n    "127.0.0.1:1981": 10\n}\n'))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5220\u9664 Upstream \u4e2d\u7684\u4e00\u4e2a\u8282\u70b9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/upstreams/100 \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "nodes": {\n        "127.0.0.1:1980": null\n    }\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"\u6267\u884c\u6210\u529f\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"nodes")," \u5c06\u66f4\u65b0\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1981": 10\n}\n'))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u66f4\u65b0 Upstream \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"nodes"),"\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/upstreams/100/nodes \\\n-H "X-API-KEY: $admin_key" -X PATCH -i -d \'\n{\n    "127.0.0.1:1982": 1\n}\'\n')),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\n...\n")),(0,l.kt)("p",{parentName:"li"},"\u6267\u884c\u6210\u529f\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"nodes")," \u5c06\u4e0d\u518d\u4fdd\u7559\u539f\u6765\u7684\u6570\u636e\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'{\n    "127.0.0.1:1982": 1\n}\n')))),(0,l.kt)("h4",{id:"proxy-https"},"\u5c06\u5ba2\u6237\u7aef\u8bf7\u6c42\u4ee3\u7406\u5230\u4e0a\u6e38 ",(0,l.kt)("inlineCode",{parentName:"h4"},"https")," \u670d\u52a1"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa Route \u5e76\u914d\u7f6e Upstream \u7684 Scheme \u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"https"),"\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i http://127.0.0.1:9180/apisix/admin/routes/1 \\\n-H "X-API-KEY: $admin_key" -X PUT -d \'\n{\n    "uri": "/get",\n    "upstream": {\n        "type": "roundrobin",\n        "scheme": "https",\n        "nodes": {\n            "httpbin.org:443": 1\n        }\n    }\n}\'\n')),(0,l.kt)("p",{parentName:"li"},"\u6267\u884c\u6210\u529f\u540e\uff0c\u8bf7\u6c42\u4e0e\u4e0a\u6e38\u901a\u4fe1\u65f6\u7684 Scheme \u5c06\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"https"),"\u3002")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u53d1\u9001\u8bf7\u6c42\u8fdb\u884c\u6d4b\u8bd5\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"curl http://127.0.0.1:9080/get\n")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'{\n"args": {},\n"headers": {\n    "Accept": "*/*",\n    "Host": "127.0.0.1",\n    "User-Agent": "curl/7.29.0",\n    "X-Amzn-Trace-Id": "Root=1-6058324a-0e898a7f04a5e95b526bb183",\n    "X-Forwarded-Host": "127.0.0.1"\n},\n"origin": "127.0.0.1",\n"url": "https://127.0.0.1/get"\n}\n')),(0,l.kt)("p",{parentName:"li"},"\u8bf7\u6c42\u6210\u529f\uff0c\u8868\u793a\u4ee3\u7406\u4e0a\u6e38 ",(0,l.kt)("inlineCode",{parentName:"p"},"https")," \u751f\u6548\u4e86\u3002"),(0,l.kt)("div",{parentName:"li",className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"\u63d0\u793a")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u6bcf\u4e2a\u8282\u70b9\u5747\u53ef\u4ee5\u914d\u7f6e\u4f18\u5148\u7ea7\uff0c\u53ea\u6709\u5728\u9ad8\u4f18\u5148\u7ea7\u7684\u8282\u70b9\u4e0d\u53ef\u7528\u6216\u8005\u5c1d\u8bd5\u8fc7\uff0c\u624d\u4f1a\u8bbf\u95ee\u4e00\u4e2a\u4f4e\u4f18\u5148\u7ea7\u7684\u8282\u70b9\u3002"))),(0,l.kt)("p",{parentName:"li"},"\u7531\u4e8e\u4e0a\u6e38\u8282\u70b9\u7684\u9ed8\u8ba4\u4f18\u5148\u7ea7\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"0"),"\uff0c\u4f60\u53ef\u4ee5\u5c06\u4e00\u4e9b\u8282\u70b9\u7684\u4f18\u5148\u7ea7\u8bbe\u7f6e\u4e3a\u8d1f\u6570\uff0c\u8ba9\u5176\u4f5c\u4e3a\u5907\u4efd\u8282\u70b9\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-JSON"},'{\n    "uri": "/hello",\n    "upstream": {\n        "type": "roundrobin",\n        "nodes": [\n            {"host": "127.0.0.1", "port": 1980, "weight": 2000},\n            {"host": "127.0.0.1", "port": 1981, "weight": 1, "priority": -1}\n        ],\n        "checks": {\n            "active": {\n                "http_path": "/status",\n                "healthy": {\n                    "interval": 1,\n                    "successes": 1\n                },\n                "unhealthy": {\n                    "interval": 1,\n                    "http_failures": 1\n                }\n            }\n        }\n    }\n}\n')),(0,l.kt)("p",{parentName:"li"},"\u8282\u70b9 ",(0,l.kt)("inlineCode",{parentName:"p"},"127.0.0.2")," \u53ea\u6709\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"127.0.0.1")," \u4e0d\u53ef\u7528\u6216\u8005\u5c1d\u8bd5\u8fc7\u4e4b\u540e\u624d\u4f1a\u88ab\u8bbf\u95ee\uff0c\u56e0\u6b64\u5b83\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"127.0.0.1")," \u7684\u5907\u4efd\u3002"))),(0,l.kt)("h3",{id:"upstream-response-parameters"},"\u5e94\u7b54\u53c2\u6570"),(0,l.kt)("p",null,"\u76ee\u524d\u662f\u76f4\u63a5\u8fd4\u56de\u4e0e etcd \u4ea4\u4e92\u540e\u7684\u7ed3\u679c\u3002"),(0,l.kt)("h2",{id:"ssl"},"SSL"),(0,l.kt)("p",null,"\u4f60\u53ef\u4ee5\u4f7f\u7528\u8be5\u8d44\u6e90\u521b\u5efa SSL \u8bc1\u4e66\u3002"),(0,l.kt)("h3",{id:"ssl-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"SSL \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/ssls/{id}"),(0,l.kt)("h3",{id:"ssl-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/ssls"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/ssls/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/ssls/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u6307\u5b9a id \u7684\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"POST"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/ssls"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u8d44\u6e90\uff0cid \u7531\u540e\u53f0\u670d\u52a1\u81ea\u52a8\u751f\u6210\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/ssls/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u8d44\u6e90\u3002")))),(0,l.kt)("h3",{id:"ssl-body-request-methods"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"cert"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bc1\u4e66"),(0,l.kt)("td",{parentName:"tr",align:null},"HTTP \u8bc1\u4e66\u3002\u8be5\u5b57\u6bb5\u652f\u6301\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/secret"},"APISIX Secret")," \u8d44\u6e90\uff0c\u5c06\u503c\u4fdd\u5b58\u5728 Secret Manager \u4e2d\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"key"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u79c1\u94a5"),(0,l.kt)("td",{parentName:"tr",align:null},"HTTPS \u8bc1\u4e66\u79c1\u94a5\u3002\u8be5\u5b57\u6bb5\u652f\u6301\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/secret"},"APISIX Secret")," \u8d44\u6e90\uff0c\u5c06\u503c\u4fdd\u5b58\u5728 Secret Manager \u4e2d\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"certs"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bc1\u4e66\u5b57\u7b26\u4e32\u6570\u7ec4"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5f53\u4f60\u60f3\u7ed9\u540c\u4e00\u4e2a\u57df\u540d\u914d\u7f6e\u591a\u4e2a\u8bc1\u4e66\u65f6\uff0c\u9664\u4e86\u7b2c\u4e00\u4e2a\u8bc1\u4e66\u9700\u8981\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"td"},"cert")," \u4f20\u9012\u5916\uff0c\u5269\u4e0b\u7684\u8bc1\u4e66\u53ef\u4ee5\u901a\u8fc7\u8be5\u53c2\u6570\u4f20\u9012\u4e0a\u6765\u3002\u8be5\u5b57\u6bb5\u652f\u6301\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/secret"},"APISIX Secret")," \u8d44\u6e90\uff0c\u5c06\u503c\u4fdd\u5b58\u5728 Secret Manager \u4e2d\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keys"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u79c1\u94a5\u5b57\u7b26\u4e32\u6570\u7ec4"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"certs")," \u5bf9\u5e94\u7684\u8bc1\u4e66\u79c1\u94a5\uff0c\u9700\u8981\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"certs")," \u4e00\u4e00\u5bf9\u5e94\u3002\u8be5\u5b57\u6bb5\u652f\u6301\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/secret"},"APISIX Secret")," \u8d44\u6e90\uff0c\u5c06\u503c\u4fdd\u5b58\u5728 Secret Manager \u4e2d\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"client.ca"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bc1\u4e66"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5c06\u7528\u4e8e\u5ba2\u6237\u7aef\u8bc1\u4e66\u6821\u9a8c\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"CA")," \u8bc1\u4e66\u3002\u8be5\u7279\u6027\u9700\u8981 OpenResty \u4e3a 1.19 \u53ca\u4ee5\u4e0a\u7248\u672c\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"client.depth"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5ba2\u6237\u7aef\u8bc1\u4e66\u6821\u9a8c\u7684\u6df1\u5ea6\uff0c\u9ed8\u8ba4\u4e3a 1\u3002\u8be5\u7279\u6027\u9700\u8981 OpenResty \u4e3a 1.19 \u53ca\u4ee5\u4e0a\u7248\u672c\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"client.skip_mtls_uri_regex"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"PCRE \u6b63\u5219\u8868\u8fbe\u5f0f\u6570\u7ec4"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7528\u6765\u5339\u914d\u8bf7\u6c42\u7684 URI\uff0c\u5982\u679c\u5339\u914d\uff0c\u5219\u8be5\u8bf7\u6c42\u5c06\u7ed5\u8fc7\u5ba2\u6237\u7aef\u8bc1\u4e66\u7684\u68c0\u67e5\uff0c\u4e5f\u5c31\u662f\u8df3\u8fc7 MTLS\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'["/hello',"[0-9]",'+", "/foobar"]')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"snis"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u975e\u7a7a\u6570\u7ec4\u5f62\u5f0f\uff0c\u53ef\u4ee5\u5339\u914d\u591a\u4e2a SNI\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"labels"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u89c4\u5219"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u9644\u52a0\u5c5e\u6027\u7684\u952e\u503c\u5bf9\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'{"version":"v2","build":"16","env":"production"}')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"type"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u8bc1\u4e66\u7684\u7c7b\u578b\uff0c\u9ed8\u8ba4\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"server"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"client")," \u8868\u793a\u8bc1\u4e66\u662f\u5ba2\u6237\u7aef\u8bc1\u4e66\uff0cAPISIX \u8bbf\u95ee\u4e0a\u6e38\u65f6\u4f7f\u7528\uff1b",(0,l.kt)("inlineCode",{parentName:"td"},"server")," \u8868\u793a\u8bc1\u4e66\u662f\u670d\u52a1\u7aef\u8bc1\u4e66\uff0cAPISIX \u9a8c\u8bc1\u5ba2\u6237\u7aef\u8bf7\u6c42\u65f6\u4f7f\u7528\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"status"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5f53\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"1")," \u65f6\uff0c\u542f\u7528\u6b64 SSL\uff0c\u9ed8\u8ba4\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"1"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"1")," \u8868\u793a\u542f\u7528\uff0c",(0,l.kt)("inlineCode",{parentName:"td"},"0")," \u8868\u793a\u7981\u7528")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"ssl_protocols"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"tls \u534f\u8bae\u5b57\u7b26\u4e32\u6570\u7ec4"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7528\u4e8e\u63a7\u5236\u670d\u52a1\u5668\u4e0e\u5ba2\u6237\u7aef\u4e4b\u95f4\u4f7f\u7528\u7684 SSL/TLS \u534f\u8bae\u7248\u672c\u3002\u66f4\u591a\u7684\u914d\u7f6e\u793a\u4f8b\uff0c\u8bf7\u53c2\u8003",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/ssl-protocol"},"SSL \u534f\u8bae"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("p",null,"SSL \u5bf9\u8c61 JSON \u914d\u7f6e\u793a\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'{\n    "id": "1",          # id\n    "cert": "cert",     # \u8bc1\u4e66\n    "key": "key",       # \u79c1\u94a5\n    "snis": ["t.com"]   # HTTPS \u63e1\u624b\u65f6\u5ba2\u6237\u7aef\u53d1\u9001\u7684 SNI\n}\n')),(0,l.kt)("p",null,"\u66f4\u591a\u7684\u914d\u7f6e\u793a\u4f8b\uff0c\u8bf7\u53c2\u8003",(0,l.kt)("a",{parentName:"p",href:"/zh/docs/apisix/3.10/certificate"},"\u8bc1\u4e66"),"\u3002"),(0,l.kt)("h2",{id:"global-rules"},"Global Rules"),(0,l.kt)("p",null,"Global Rule \u53ef\u4ee5\u8bbe\u7f6e\u5168\u5c40\u8fd0\u884c\u7684\u63d2\u4ef6\uff0c\u8bbe\u7f6e\u4e3a\u5168\u5c40\u89c4\u5219\u7684\u63d2\u4ef6\u5c06\u5728\u6240\u6709\u8def\u7531\u7ea7\u522b\u7684\u63d2\u4ef6\u4e4b\u524d\u4f18\u5148\u8fd0\u884c\u3002"),(0,l.kt)("h3",{id:"global-rule-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"Global Rule \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/global_rules/{id}"),(0,l.kt)("h3",{id:"global-rule-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/global_rules"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/global_rules/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/global_rules/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5c06\u521b\u5efa\u6307\u5b9a id \u7684\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/global_rules/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/global_rules/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u51c6 PATCH\uff0c\u4fee\u6539\u5df2\u6709 Global Rule \u7684\u90e8\u5206\u5c5e\u6027\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\uff1b\u5982\u679c\u4f60\u8981\u5220\u9664\u67d0\u4e2a\u5c5e\u6027\uff0c\u5c06\u8be5\u5c5e\u6027\u7684\u503c\u8bbe\u7f6e\u4e3a null \u5373\u53ef\u5220\u9664\uff1b",(0,l.kt)("strong",{parentName:"td"},"\u6ce8\u610f"),"\uff1a\u5f53\u9700\u8981\u4fee\u6539\u5c5e\u6027\u7684\u503c\u4e3a\u6570\u7ec4\u65f6\uff0c\u8be5\u5c5e\u6027\u5c06\u5168\u91cf\u66f4\u65b0\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/global_rules/{id}/{path}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"SubPath PATCH\uff0c\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"td"},"{path}")," \u6307\u5b9a Global Rule \u8981\u66f4\u65b0\u7684\u5c5e\u6027\uff0c\u5168\u91cf\u66f4\u65b0\u8be5\u5c5e\u6027\u7684\u6570\u636e\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\u3002")))),(0,l.kt)("h3",{id:"global-rule-body-request-parameters"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b\u503c"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"plugins"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin"),(0,l.kt)("td",{parentName:"tr",align:null},"\u63d2\u4ef6\u914d\u7f6e\u3002\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/plugin"},"Plugin"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h2",{id:"consumer-group"},"Consumer Group"),(0,l.kt)("p",null,"\u4f60\u53ef\u4ee5\u4f7f\u7528\u8be5\u8d44\u6e90\u914d\u7f6e\u4e00\u7ec4\u53ef\u4ee5\u5728 Consumer \u95f4\u590d\u7528\u7684\u63d2\u4ef6\u3002"),(0,l.kt)("h3",{id:"consumer-group-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"Consumer Group \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/consumer_groups/{id}"),(0,l.kt)("h3",{id:"consumer-group-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumer_groups"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumer_groups/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumer_groups/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5c06\u521b\u5efa\u6307\u5b9a id \u7684\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumer_groups/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumer_groups/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u51c6 PATCH\uff0c\u4fee\u6539\u5df2\u6709 Consumer Group \u7684\u90e8\u5206\u5c5e\u6027\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\uff1b\u5982\u679c\u4f60\u8981\u5220\u9664\u67d0\u4e2a\u5c5e\u6027\uff0c\u5c06\u8be5\u5c5e\u6027\u7684\u503c\u8bbe\u7f6e\u4e3a null \u5373\u53ef\u5220\u9664\uff1b",(0,l.kt)("strong",{parentName:"td"},"\u6ce8\u610f"),"\uff1a\u5f53\u9700\u8981\u4fee\u6539\u5c5e\u6027\u7684\u503c\u4e3a\u6570\u7ec4\u65f6\uff0c\u8be5\u5c5e\u6027\u5c06\u5168\u91cf\u66f4\u65b0\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/consumer_groups/{id}/{path}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"SubPath PATCH\uff0c\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"td"},"{path}")," \u6307\u5b9a Consumer Group \u8981\u66f4\u65b0\u7684\u5c5e\u6027\uff0c\u5168\u91cf\u66f4\u65b0\u8be5\u5c5e\u6027\u7684\u6570\u636e\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\u3002")))),(0,l.kt)("h3",{id:"consumer-group-body-request-parameters"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b\u503c"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"plugins"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin"),(0,l.kt)("td",{parentName:"tr",align:null},"\u63d2\u4ef6\u914d\u7f6e\u3002\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/plugin"},"Plugin"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"desc"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u63cf\u8ff0\u3001\u4f7f\u7528\u573a\u666f\u7b49\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"Consumer \u6d4b\u8bd5\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"labels"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u9644\u52a0\u5c5e\u6027\u7684\u952e\u503c\u5bf9\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'{"version":"v2","build":"16","env":"production"}')))),(0,l.kt)("h2",{id:"plugin-config"},"Plugin Config"),(0,l.kt)("p",null,"\u4f60\u53ef\u4ee5\u4f7f\u7528 Plugin Config \u8d44\u6e90\u521b\u5efa\u4e00\u7ec4\u53ef\u4ee5\u5728\u8def\u7531\u95f4\u590d\u7528\u7684\u63d2\u4ef6\u3002"),(0,l.kt)("h3",{id:"plugin-config-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"Plugin Config \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/plugin_configs/{id}"),(0,l.kt)("h3",{id:"plugin-config-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugin_configs"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugin_configs/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugin_configs/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6839\u636e id \u521b\u5efa\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugin_configs/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugin_configs/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u51c6 PATCH\uff0c\u4fee\u6539\u5df2\u6709 Plugin Config \u7684\u90e8\u5206\u5c5e\u6027\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\uff1b\u5982\u679c\u4f60\u8981\u5220\u9664\u67d0\u4e2a\u5c5e\u6027\uff0c\u5c06\u8be5\u5c5e\u6027\u7684\u503c\u8bbe\u7f6e\u4e3a null \u5373\u53ef\u5220\u9664\uff1b",(0,l.kt)("strong",{parentName:"td"},"\u6ce8\u610f"),"\uff1a\u5f53\u9700\u8981\u4fee\u6539\u5c5e\u6027\u7684\u503c\u4e3a\u6570\u7ec4\u65f6\uff0c\u8be5\u5c5e\u6027\u5c06\u5168\u91cf\u66f4\u65b0\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugin_configs/{id}/{path}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"SubPath PATCH\uff0c\u901a\u8fc7 {path} \u6307\u5b9a Plugin Config \u8981\u66f4\u65b0\u7684\u5c5e\u6027\uff0c\u5168\u91cf\u66f4\u65b0\u8be5\u5c5e\u6027\u7684\u6570\u636e\uff0c\u5176\u4ed6\u4e0d\u6d89\u53ca\u7684\u5c5e\u6027\u4f1a\u539f\u6837\u4fdd\u7559\u3002")))),(0,l.kt)("h3",{id:"plugin-config-body-request-parameters"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b\u503c"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"plugins"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin"),(0,l.kt)("td",{parentName:"tr",align:null},"\u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/plugin"},"Plugin"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"desc"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u63cf\u8ff0\u3001\u4f7f\u7528\u573a\u666f\u7b49\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"customer xxxx")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"labels"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u8bc6\u9644\u52a0\u5c5e\u6027\u7684\u952e\u503c\u5bf9\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'{"version":"v2","build":"16","env":"production"}')))),(0,l.kt)("h2",{id:"plugin-metadata"},"Plugin Metadata"),(0,l.kt)("p",null,"\u4f60\u53ef\u4ee5\u4f7f\u7528 Plugin Metadata \u8d44\u6e90\u914d\u7f6e\u63d2\u4ef6\u5143\u6570\u636e\u3002"),(0,l.kt)("h3",{id:"plugin-metadata-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"Plugin Config \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/plugin_metadata/{plugin_name}"),(0,l.kt)("h3",{id:"plugin-metadata-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Method"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugin_metadata/{plugin_name}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugin_metadata/{plugin_name}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6839\u636e ",(0,l.kt)("inlineCode",{parentName:"td"},"plugin name")," \u521b\u5efa\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugin_metadata/{plugin_name}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u8d44\u6e90\u3002")))),(0,l.kt)("h3",{id:"plugin-metadata-body-request-parameters"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("p",null,"\u6839\u636e\u63d2\u4ef6 (",(0,l.kt)("inlineCode",{parentName:"p"},"{plugin_name}"),") \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"metadata_schema")," \u5b9a\u4e49\u7684\u6570\u636e\u7ed3\u6784\u7684  JSON \u5bf9\u8c61\u3002"),(0,l.kt)("h3",{id:"plugin-metadata-example"},"\u4f7f\u7528\u793a\u4f8b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/plugin_metadata/example-plugin  \\\n-H "X-API-KEY: $admin_key" -i -X PUT -d \'\n{\n    "skey": "val",\n    "ikey": 1\n}\'\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"HTTP/1.1 201 Created\nDate: Thu, 26 Dec 2019 04:19:34 GMT\nContent-Type: text/plain\n")),(0,l.kt)("h2",{id:"plugin"},"Plugin"),(0,l.kt)("p",null,"\u4f60\u53ef\u4ee5\u901a\u8fc7\u8be5\u8d44\u6e90\u83b7\u53d6\u63d2\u4ef6\u5217\u8868\u3002"),(0,l.kt)("h3",{id:"plugin-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"Plugin \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/plugins/{plugin_name}"),(0,l.kt)("h3",{id:"\u8bf7\u6c42\u53c2\u6570"},"\u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"subsystem"),(0,l.kt)("td",{parentName:"tr",align:null},"\u63d2\u4ef6\u5b50\u7cfb\u7edf\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"http")))),(0,l.kt)("p",null,"\u53ef\u4ee5\u5728\u5b50\u7cfb\u7edf\u4e0a\u8fc7\u6ee4\u63d2\u4ef6\uff0c\u4ee5\u4fbf\u5728\u901a\u8fc7\u67e5\u8be2\u53c2\u6570\u4f20\u9012\u7684\u5b50\u7cfb\u7edf\u4e2d\u641c\u7d22 ({plugin_name})"),(0,l.kt)("h3",{id:"plugin-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0 \xa0\xa0\xa0\xa0\xa0\xa0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0 \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET\xa0\xa0\xa0\xa0\xa0\xa0"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugins/list"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET\xa0\xa0\xa0\xa0\xa0\xa0"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugins/{plugin_name}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugins?all=true"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u6240\u6709\u63d2\u4ef6\u7684\u6240\u6709\u5c5e\u6027\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugins?all=true&subsystem=stream"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u6240\u6709 Stream \u63d2\u4ef6\u7684\u5c5e\u6027\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugins?all=true&subsystem=http"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u6240\u6709 HTTP \u63d2\u4ef6\u7684\u5c5e\u6027\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/plugins/reload"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6839\u636e\u4ee3\u7801\u4e2d\u6240\u505a\u7684\u66f4\u6539\u91cd\u65b0\u52a0\u8f7d\u63d2\u4ef6\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"apisix/admin/plugins/{plugin_name}?subsystem=stream"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u6307\u5b9a Stream \u63d2\u4ef6\u7684\u5c5e\u6027\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"apisix/admin/plugins/{plugin_name}?subsystem=http"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u6307\u5b9a HTTP \u63d2\u4ef6\u7684\u5c5e\u6027\u3002")))),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u83b7\u53d6\u6240\u6709\u63d2\u4ef6\u5c5e\u6027\u7684\u63a5\u53e3 ",(0,l.kt)("inlineCode",{parentName:"p"},"/apisix/admin/plugins?all=true")," \u5c06\u5f88\u5feb\u88ab\u5f03\u7528\u3002"))),(0,l.kt)("h3",{id:"plugin-example"},"\u4f7f\u7528\u793a\u4f8b"),(0,l.kt)("p",null,"\u83b7\u53d6\u63d2\u4ef6 \xa0(",(0,l.kt)("inlineCode",{parentName:"p"},"{plugin_name}"),")\xa0 \u6570\u636e\u7ed3\u6784\u7684 JSON \u5bf9\u8c61\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u83b7\u53d6\u63d2\u4ef6\u5217\u8868"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"curl\xa0\"http://127.0.0.1:9180/apisix/admin/plugins/list\"\xa0\\\n-H\xa0'X-API-KEY:\xa0edd1c9f034335f136f87ad84b625c8f1'\n")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'["zipkin","request-id",...]\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u83b7\u53d6\u6307\u5b9a\u63d2\u4ef6\u7684\u5c5e\u6027"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"curl\xa0\"http://127.0.0.1:9180/apisix/admin/plugins/key-auth?subsystem=http\"\xa0\\\n-H\xa0'X-API-KEY:\xa0edd1c9f034335f136f87ad84b625c8f1'\n")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{"$comment":"this is a mark for our injected plugin schema","properties":{"header":{"default":"apikey","type":"string"},"hide_credentials":{"default":false,"type":"boolean"},"_meta":{"properties":{"filter":{"type":"array","description":"filter determines whether the plugin needs to be executed at runtime"},"disable":{"type":"boolean"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"priority":{"type":"integer","description":"priority of plugins by customized order"}},"type":"object"},"query":{"default":"apikey","type":"string"}},"type":"object"}\n')))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"/apisix/admin/plugins?all=true")," \u63a5\u53e3\u83b7\u53d6\u6240\u6709\u63d2\u4ef6\u7684\u6240\u6709\u5c5e\u6027\uff0c\u6bcf\u4e2a\u63d2\u4ef6\u5305\u62ec ",(0,l.kt)("inlineCode",{parentName:"p"},"name"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"priority"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"type"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"schema"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"consumer_schema")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"version"),"\u3002"),(0,l.kt)("p",{parentName:"div"},"\u8fd9\u4e2a API \u5c06\u5f88\u5feb\u88ab\u5f03\u7528\u3002"))),(0,l.kt)("h2",{id:"stream-route"},"Stream Route"),(0,l.kt)("p",null,"Stream Route \u662f\u7528\u4e8e TCP/UDP \u52a8\u6001\u4ee3\u7406\u7684\u8def\u7531\u3002\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"p",href:"/zh/docs/apisix/3.10/stream-proxy"},"TCP/UDP \u52a8\u6001\u4ee3\u7406"),"\u3002"),(0,l.kt)("h3",{id:"stream-route-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"Plugin \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/stream_routes/{id}"),(0,l.kt)("h3",{id:"stream-route-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/stream_routes"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GET"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/stream_routes/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PUT"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/stream_routes/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u6307\u5b9a id \u7684\u8d44\u6e90\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"POST"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/stream_routes"),(0,l.kt)("td",{parentName:"tr",align:null},"{...}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u521b\u5efa\u8d44\u6e90\uff0cid \u7531\u540e\u53f0\u670d\u52a1\u81ea\u52a8\u751f\u6210\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:null},"/apisix/admin/stream_routes/{id}"),(0,l.kt)("td",{parentName:"tr",align:null},"\u65e0"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5220\u9664\u8d44\u6e90\u3002")))),(0,l.kt)("h3",{id:"stream-route-body-request-parameters"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b\u503c"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"upstream"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Upstream"),(0,l.kt)("td",{parentName:"tr",align:null},"Upstream \u914d\u7f6e\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/upstream"},"Upstream"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"upstream_id"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Upstream"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9700\u8981\u4f7f\u7528\u7684 Upstream id\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/upstream"},"Upstream"),"\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"service_id"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"String"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9700\u8981\u4f7f\u7528\u7684 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/3.10/terminology/service"},"Service")," id."),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"remote_addr"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"IPv4, IPv4 CIDR, IPv6"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8fc7\u6ee4\u9009\u9879\uff1a\u5982\u679c\u5ba2\u6237\u7aef IP \u5339\u914d\uff0c\u5219\u8f6c\u53d1\u5230\u4e0a\u6e38"),(0,l.kt)("td",{parentName:"tr",align:null},'"127.0.0.1" \u6216 "127.0.0.1/32" \u6216 "::1"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"server_addr"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"IPv4, IPv4 CIDR, IPv6"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8fc7\u6ee4\u9009\u9879\uff1a\u5982\u679c APISIX \u670d\u52a1\u5668\u7684 IP \u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"server_addr")," \u5339\u914d\uff0c\u5219\u8f6c\u53d1\u5230\u4e0a\u6e38\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'"127.0.0.1" \u6216 "127.0.0.1/32" \u6216 "::1"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"server_port"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6574\u6570"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8fc7\u6ee4\u9009\u9879\uff1a\u5982\u679c APISIX \u670d\u52a1\u5668\u7684\u7aef\u53e3 \u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"server_port")," \u5339\u914d\uff0c\u5219\u8f6c\u53d1\u5230\u4e0a\u6e38\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},"9090")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"sni"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"Host"),(0,l.kt)("td",{parentName:"tr",align:null},"\u670d\u52a1\u5668\u540d\u79f0\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'"test.com"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"protocol.name"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,l.kt)("td",{parentName:"tr",align:null},"xRPC \u6846\u67b6\u4ee3\u7406\u7684\u534f\u8bae\u7684\u540d\u79f0\u3002"),(0,l.kt)("td",{parentName:"tr",align:null},'"redis"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"protocol.conf"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u914d\u7f6e"),(0,l.kt)("td",{parentName:"tr",align:null},"\u534f\u8bae\u7279\u5b9a\u7684\u914d\u7f6e\u3002"),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("p",null,"\u4f60\u53ef\u4ee5\u67e5\u770b ",(0,l.kt)("a",{parentName:"p",href:"/zh/docs/apisix/3.10/stream-proxy#%E6%9B%B4%E5%A4%9A-route-%E5%8C%B9%E9%85%8D%E9%80%89%E9%A1%B9"},"Stream Proxy")," \u4e86\u89e3\u66f4\u591a\u8fc7\u6ee4\u5668\u7684\u4fe1\u606f\u3002"),(0,l.kt)("h2",{id:"secret"},"Secret"),(0,l.kt)("p",null,"Secret \u6307\u7684\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"Secrets Management"),"\uff08\u5bc6\u94a5\u7ba1\u7406\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u652f\u6301\u7684\u5bc6\u94a5\u7ba1\u7406\u5668\uff0c\u4f8b\u5982 ",(0,l.kt)("inlineCode",{parentName:"p"},"vault"),"\u3002"),(0,l.kt)("h3",{id:"secret-config-uri"},"\u8bf7\u6c42\u5730\u5740"),(0,l.kt)("p",null,"Secret \u8d44\u6e90\u8bf7\u6c42\u5730\u5740\uff1a/apisix/admin/secrets/{secretmanager}/{id}"),(0,l.kt)("h3",{id:"secret-config-request-methods"},"\u8bf7\u6c42\u65b9\u6cd5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:"center"},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:"center"},"\u8bf7\u6c42 URI"),(0,l.kt)("th",{parentName:"tr",align:"center"},"\u8bf7\u6c42 body"),(0,l.kt)("th",{parentName:"tr",align:"center"},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"GET"),(0,l.kt)("td",{parentName:"tr",align:"center"},"/apisix/admin/secrets"),(0,l.kt)("td",{parentName:"tr",align:"center"},"NULL"),(0,l.kt)("td",{parentName:"tr",align:"center"},"\u83b7\u53d6\u6240\u6709 secret \u7684\u5217\u8868\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"GET"),(0,l.kt)("td",{parentName:"tr",align:"center"},"/apisix/admin/secrets/{manager}/{id}"),(0,l.kt)("td",{parentName:"tr",align:"center"},"NULL"),(0,l.kt)("td",{parentName:"tr",align:"center"},"\u6839\u636e id \u83b7\u53d6\u6307\u5b9a\u7684 secret\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"PUT"),(0,l.kt)("td",{parentName:"tr",align:"center"},"/apisix/admin/secrets/{manager}"),(0,l.kt)("td",{parentName:"tr",align:"center"},"{...}"),(0,l.kt)("td",{parentName:"tr",align:"center"},"\u521b\u5efa\u65b0\u7684 secret \u914d\u7f6e\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"DELETE"),(0,l.kt)("td",{parentName:"tr",align:"center"},"/apisix/admin/secrets/{manager}/{id}"),(0,l.kt)("td",{parentName:"tr",align:"center"},"NULL"),(0,l.kt)("td",{parentName:"tr",align:"center"},"\u5220\u9664\u5177\u6709\u6307\u5b9a id \u7684 secret\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:"center"},"/apisix/admin/secrets/{manager}/{id}"),(0,l.kt)("td",{parentName:"tr",align:"center"},"{...}"),(0,l.kt)("td",{parentName:"tr",align:"center"},"\u66f4\u65b0\u6307\u5b9a secret \u7684\u9009\u5b9a\u5c5e\u6027\u3002\u5982\u679c\u8981\u5220\u9664\u4e00\u4e2a\u5c5e\u6027\uff0c\u53ef\u4ee5\u5c06\u8be5\u5c5e\u6027\u7684\u503c\u8bbe\u7f6e\u4e3a null\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"PATCH"),(0,l.kt)("td",{parentName:"tr",align:"center"},"/apisix/admin/secrets/{manager}/{id}/{path}"),(0,l.kt)("td",{parentName:"tr",align:"center"},"{...}"),(0,l.kt)("td",{parentName:"tr",align:"center"},"\u66f4\u65b0\u8def\u5f84\u4e2d\u6307\u5b9a\u7684\u5c5e\u6027\u3002\u5176\u4ed6\u5c5e\u6027\u7684\u503c\u4fdd\u6301\u4e0d\u53d8\u3002")))),(0,l.kt)("h3",{id:"secret-config-body-requset-parameters"},"body \u8bf7\u6c42\u53c2\u6570"),(0,l.kt)("p",null,"\u5f53 ",(0,l.kt)("inlineCode",{parentName:"p"},"{secretmanager}")," \u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"vault")," \u65f6\uff1a"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u4f8b\u5b50"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"uri"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"URI"),(0,l.kt)("td",{parentName:"tr",align:null},"Vault \u670d\u52a1\u5668\u7684 URI"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"prefix"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5bc6\u94a5\u524d\u7f00"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"token"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,l.kt)("td",{parentName:"tr",align:null},"Vault \u4ee4\u724c"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"namespace"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,l.kt)("td",{parentName:"tr",align:null},"Vault \u547d\u540d\u7a7a\u95f4\uff0c\u8be5\u5b57\u6bb5\u65e0\u9ed8\u8ba4\u503c"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"admin"))))),(0,l.kt)("p",null,"\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'{\n    "uri": "https://localhost/vault",\n    "prefix": "/apisix/kv",\n    "token": "343effad"\n}\n\n')),(0,l.kt)("p",null,"\u4f7f\u7528\u793a\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i http://127.0.0.1:9180/apisix/admin/secrets/vault/test2 \\\n-H "X-API-KEY: $admin_key" -X PUT -d \'\n{\n    "uri": "http://xxx/get",\n    "prefix" : "apisix",\n    "token" : "apisix"\n}\'\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'HTTP/1.1 200 OK\n...\n\n{"key":"\\/apisix\\/secrets\\/vault\\/test2","value":{"id":"vault\\/test2","token":"apisix","prefix":"apisix","update_time":1669625828,"create_time":1669625828,"uri":"http:\\/\\/xxx\\/get"}}\n')),(0,l.kt)("h3",{id:"secret-config-response-parameters"},"\u5e94\u7b54\u53c2\u6570"),(0,l.kt)("p",null,"\u5f53\u524d\u7684\u54cd\u5e94\u662f\u4ece etcd \u8fd4\u56de\u7684\u3002"))}k.isMDXComponent=!0}}]);