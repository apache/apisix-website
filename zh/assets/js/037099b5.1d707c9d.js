"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[77715],{3905:(e,t,n)=>{n.d(t,{Zo:()=>o,kt:()=>d});var a=n(67294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var k=a.createContext({}),u=function(e){var t=a.useContext(k),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},o=function(e){var t=u(e.components);return a.createElement(k.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},s=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,k=e.parentName,o=i(e,["components","mdxType","originalType","parentName"]),s=u(n),d=l,c=s["".concat(k,".").concat(d)]||s[d]||m[d]||r;return n?a.createElement(c,p(p({ref:t},o),{},{components:n})):a.createElement(c,p({ref:t},o))}));function d(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,p=new Array(r);p[0]=s;var i={};for(var k in t)hasOwnProperty.call(t,k)&&(i[k]=t[k]);i.originalType=e,i.mdxType="string"==typeof e?e:l,p[1]=i;for(var u=2;u<r;u++)p[u]=n[u];return a.createElement.apply(null,p)}return a.createElement.apply(null,n)}s.displayName="MDXCreateElement"},70961:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>p,default:()=>o,frontMatter:()=>r,metadata:()=>i,toc:()=>k});var a=n(87462),l=(n(67294),n(3905));const r={title:"jwt-auth",keywords:["Apache APISIX","API \u7f51\u5173","Plugin","JWT Auth","jwt-auth"],description:"jwt-auth \u63d2\u4ef6\u652f\u6301\u4f7f\u7528 JSON Web Token (JWT) \u4f5c\u4e3a\u5ba2\u6237\u7aef\u5728\u8bbf\u95ee\u4e0a\u6e38\u8d44\u6e90\u4e4b\u524d\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u673a\u5236\u3002"},p=void 0,i={unversionedId:"plugins/jwt-auth",id:"plugins/jwt-auth",isDocsHomePage:!1,title:"jwt-auth",description:"jwt-auth \u63d2\u4ef6\u652f\u6301\u4f7f\u7528 JSON Web Token (JWT) \u4f5c\u4e3a\u5ba2\u6237\u7aef\u5728\u8bbf\u95ee\u4e0a\u6e38\u8d44\u6e90\u4e4b\u524d\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u673a\u5236\u3002",source:"@site/i18n/zh/docusaurus-plugin-content-docs-docs-apisix/current/plugins/jwt-auth.md",sourceDirName:"plugins",slug:"/plugins/jwt-auth",permalink:"/zh/docs/apisix/next/plugins/jwt-auth",editUrl:"/zh/edit#https://github.com/apache/apisix/edit/master/docs/zh/latest/plugins/jwt-auth.md",tags:[],version:"current",frontMatter:{title:"jwt-auth",keywords:["Apache APISIX","API \u7f51\u5173","Plugin","JWT Auth","jwt-auth"],description:"jwt-auth \u63d2\u4ef6\u652f\u6301\u4f7f\u7528 JSON Web Token (JWT) \u4f5c\u4e3a\u5ba2\u6237\u7aef\u5728\u8bbf\u95ee\u4e0a\u6e38\u8d44\u6e90\u4e4b\u524d\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u673a\u5236\u3002"},sidebar:"docs",previous:{title:"key-auth",permalink:"/zh/docs/apisix/next/plugins/key-auth"},next:{title:"jwe-decrypt",permalink:"/zh/docs/apisix/next/plugins/jwe-decrypt"}},k=[{value:"\u63cf\u8ff0",id:"\u63cf\u8ff0",children:[]},{value:"\u5c5e\u6027",id:"\u5c5e\u6027",children:[]},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",children:[{value:"\u4f7f\u7528 JWT \u8fdb\u884c\u6d88\u8d39\u8005\u8eab\u4efd\u9a8c\u8bc1",id:"\u4f7f\u7528-jwt-\u8fdb\u884c\u6d88\u8d39\u8005\u8eab\u4efd\u9a8c\u8bc1",children:[]},{value:"\u5728\u8bf7\u6c42\u6807\u5934\u3001\u67e5\u8be2\u5b57\u7b26\u4e32\u6216 Cookie \u4e2d\u643a\u5e26 JWT",id:"\u5728\u8bf7\u6c42\u6807\u5934\u67e5\u8be2\u5b57\u7b26\u4e32\u6216-cookie-\u4e2d\u643a\u5e26-jwt",children:[]},{value:"\u5728\u73af\u5883\u53d8\u91cf\u4e2d\u7ba1\u7406\u5bc6\u94a5",id:"\u5728\u73af\u5883\u53d8\u91cf\u4e2d\u7ba1\u7406\u5bc6\u94a5",children:[]},{value:"\u5728 Secret Manager \u4e2d\u7ba1\u7406 Secret",id:"\u5728-secret-manager-\u4e2d\u7ba1\u7406-secret",children:[]},{value:"\u4f7f\u7528 RS256 \u7b97\u6cd5\u7b7e\u540d JWT",id:"\u4f7f\u7528-rs256-\u7b97\u6cd5\u7b7e\u540d-jwt",children:[]},{value:"\u5c06\u6d88\u8d39\u8005\u81ea\u5b9a\u4e49 ID \u6dfb\u52a0\u5230\u6807\u5934",id:"\u5c06\u6d88\u8d39\u8005\u81ea\u5b9a\u4e49-id-\u6dfb\u52a0\u5230\u6807\u5934",children:[]},{value:"\u533f\u540d\u6d88\u8d39\u8005\u7684\u901f\u7387\u9650\u5236",id:"\u533f\u540d\u6d88\u8d39\u8005\u7684\u901f\u7387\u9650\u5236",children:[]}]}],u={toc:k};function o(e){let{components:t,...n}=e;return(0,l.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"\u63cf\u8ff0"},"\u63cf\u8ff0"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u63d2\u4ef6\u652f\u6301\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io/"},"JSON Web Token (JWT)")," \u4f5c\u4e3a\u5ba2\u6237\u7aef\u5728\u8bbf\u95ee\u4e0a\u6e38\u8d44\u6e90\u4e4b\u524d\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u673a\u5236\u3002"),(0,l.kt)("p",null,"\u542f\u7528\u540e\uff0c\u8be5\u63d2\u4ef6\u4f1a\u516c\u5f00\u4e00\u4e2a\u7aef\u70b9\uff0c\u4f9b ",(0,l.kt)("a",{parentName:"p",href:"/zh/docs/apisix/next/terminology/consumer"},"\u6d88\u8d39\u8005")," \u521b\u5efa JWT \u51ed\u636e\u3002\u8be5\u8fc7\u7a0b\u4f1a\u751f\u6210\u4e00\u4e2a\u4ee4\u724c\uff0c\u5ba2\u6237\u7aef\u8bf7\u6c42\u5e94\u643a\u5e26\u8be5\u4ee4\u724c\u4ee5\u5411 APISIX \u6807\u8bc6\u81ea\u5df1\u3002\u8be5\u4ee4\u724c\u53ef\u4ee5\u5305\u542b\u5728\u8bf7\u6c42 URL \u67e5\u8be2\u5b57\u7b26\u4e32\u3001\u8bf7\u6c42\u6807\u5934\u6216 cookie \u4e2d\u3002\u7136\u540e\uff0cAPISIX \u5c06\u9a8c\u8bc1\u8be5\u4ee4\u724c\u4ee5\u786e\u5b9a\u662f\u5426\u5e94\u5141\u8bb8\u6216\u62d2\u7edd\u8bf7\u6c42\u8bbf\u95ee\u4e0a\u6e38\u8d44\u6e90\u3002"),(0,l.kt)("p",null,"\u5f53\u6d88\u8d39\u8005\u6210\u529f\u901a\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u540e\uff0cAPISIX \u4f1a\u5728\u5c06\u8bf7\u6c42\u4ee3\u7406\u5230\u4e0a\u6e38\u670d\u52a1\u4e4b\u524d\u5411\u8bf7\u6c42\u6dfb\u52a0\u5176\u4ed6\u6807\u5934\uff0c\u4f8b\u5982 ",(0,l.kt)("inlineCode",{parentName:"p"},"X-Consumer-Username"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"X-Credential-Indentifier")," \u548c\u5176\u4ed6\u6d88\u8d39\u8005\u81ea\u5b9a\u4e49\u6807\u5934\uff08\u5982\u5df2\u914d\u7f6e\uff09\u3002\u4e0a\u6e38\u670d\u52a1\u5c06\u80fd\u591f\u533a\u5206\u6d88\u8d39\u8005\u5e76\u6839\u636e\u9700\u8981\u5b9e\u65bd\u5176\u4ed6\u903b\u8f91\u3002\u5982\u679c\u4efb\u4f55\u4e00\u4e2a\u503c\u4e0d\u53ef\u7528\uff0c\u5219\u4e0d\u4f1a\u6dfb\u52a0\u76f8\u5e94\u7684\u6807\u9898\u3002"),(0,l.kt)("h2",{id:"\u5c5e\u6027"},"\u5c5e\u6027"),(0,l.kt)("p",null,"Consumer/Credential \u7aef\uff1a"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,l.kt)("th",{parentName:"tr",align:null},"\u6709\u6548\u503c"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"key"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"\u6d88\u8d39\u8005\u7684\u552f\u4e00\u5bc6\u94a5\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"secret"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"\u5f53\u4f7f\u7528\u5bf9\u79f0\u7b97\u6cd5\u65f6\uff0c\u7528\u4e8e\u5bf9 JWT \u8fdb\u884c\u7b7e\u540d\u548c\u9a8c\u8bc1\u7684\u5171\u4eab\u5bc6\u94a5\u3002\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"td"},"HS256")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"td"},"HS512")," \u4f5c\u4e3a\u7b97\u6cd5\u65f6\u5fc5\u586b\u3002\u8be5\u5b57\u6bb5\u652f\u6301\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/next/terminology/secret"},"APISIX Secret")," \u8d44\u6e90\uff0c\u5c06\u503c\u4fdd\u5b58\u5728 Secret Manager \u4e2d\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"public_key"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"RSA \u6216 ECDSA \u516c\u94a5\uff0c ",(0,l.kt)("inlineCode",{parentName:"td"},"algorithm")," \u5c5e\u6027\u9009\u62e9 ",(0,l.kt)("inlineCode",{parentName:"td"},"RS256")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"td"},"ES256")," \u7b97\u6cd5\u65f6\u5fc5\u9009\u3002\u8be5\u5b57\u6bb5\u652f\u6301\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"td",href:"/zh/docs/apisix/next/terminology/secret"},"APISIX Secret")," \u8d44\u6e90\uff0c\u5c06\u503c\u4fdd\u5b58\u5728 Secret Manager \u4e2d\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"algorithm"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},'"HS256"'),(0,l.kt)("td",{parentName:"tr",align:null},'["HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "EdDSA"]'),(0,l.kt)("td",{parentName:"tr",align:null},"\u52a0\u5bc6\u7b97\u6cd5\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"exp"),(0,l.kt)("td",{parentName:"tr",align:null},"integer"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"86400"),(0,l.kt)("td",{parentName:"tr",align:null},"[1,...]"),(0,l.kt)("td",{parentName:"tr",align:null},"token \u7684\u8d85\u65f6\u65f6\u95f4\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"base64_secret"),(0,l.kt)("td",{parentName:"tr",align:null},"boolean"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"false"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"\u5f53\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"true")," \u65f6\uff0c\u5bc6\u94a5\u4e3a base64 \u7f16\u7801\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"lifetime_grace_period"),(0,l.kt)("td",{parentName:"tr",align:null},"integer"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"0"),(0,l.kt)("td",{parentName:"tr",align:null},"[0,...]"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5bbd\u9650\u671f\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09\u3002\u7528\u4e8e\u89e3\u51b3\u751f\u6210 JWT \u7684\u670d\u52a1\u5668\u4e0e\u9a8c\u8bc1 JWT \u7684\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u65f6\u949f\u504f\u5dee\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"key_claim_name"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"key"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"JWT payload \u4e2d\u7684\u58f0\u660e\u7528\u4e8e\u6807\u8bc6\u76f8\u5173\u7684\u79d8\u5bc6\uff0c\u4f8b\u5982 ",(0,l.kt)("inlineCode",{parentName:"td"},"iss"),"\u3002")))),(0,l.kt)("p",null,"\u6ce8\u610f\uff1aschema \u4e2d\u8fd8\u5b9a\u4e49\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},'encrypt_fields = {"secret"}'),"\uff0c\u8fd9\u610f\u5473\u7740\u8be5\u5b57\u6bb5\u5c06\u4f1a\u88ab\u52a0\u5bc6\u5b58\u50a8\u5728 etcd \u4e2d\u3002\u5177\u4f53\u53c2\u8003 ",(0,l.kt)("a",{parentName:"p",href:"/zh/docs/apisix/next/plugin-develop#%E5%8A%A0%E5%AF%86%E5%AD%98%E5%82%A8%E5%AD%97%E6%AE%B5"},"\u52a0\u5bc6\u5b58\u50a8\u5b57\u6bb5"),"\u3002"),(0,l.kt)("p",null,"Route \u7aef\uff1a"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5fc5\u9009\u9879"),(0,l.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"header"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"authorization"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u6211\u4eec\u4ece\u54ea\u4e2a header \u83b7\u53d6 token\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"query"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"jwt"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u6211\u4eec\u4ece\u54ea\u4e2a query string \u83b7\u53d6 token\uff0c\u4f18\u5148\u7ea7\u4f4e\u4e8e header\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"cookie"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"jwt"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u6211\u4eec\u4ece\u54ea\u4e2a cookie \u83b7\u53d6 token\uff0c\u4f18\u5148\u7ea7\u4f4e\u4e8e query\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"hide_credentials"),(0,l.kt)("td",{parentName:"tr",align:null},"boolean"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"false"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5982\u679c\u4e3a true\uff0c\u5219\u4e0d\u8981\u5c06 header\u3001query \u6216\u5e26\u6709 JWT \u7684 cookie \u4f20\u9012\u7ed9\u4e0a\u6e38\u670d\u52a1\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"key_claim_name"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"key"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5305\u542b\u7528\u6237\u5bc6\u94a5\uff08\u5bf9\u5e94\u6d88\u8d39\u8005\u7684\u5bc6\u94a5\u5c5e\u6027\uff09\u7684 JWT \u58f0\u660e\u7684\u540d\u79f0\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"anonymous_consumer"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"false"),(0,l.kt)("td",{parentName:"tr",align:null},"\u533f\u540d\u6d88\u8d39\u8005\u540d\u79f0\u3002\u5982\u679c\u5df2\u914d\u7f6e\uff0c\u5219\u5141\u8bb8\u533f\u540d\u7528\u6237\u7ed5\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"store_in_ctx"),(0,l.kt)("td",{parentName:"tr",align:null},"boolean"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"false"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"td"},"true")," \u5c06\u4f1a\u5c06 JWT \u8d1f\u8f7d\u5b58\u50a8\u5728\u8bf7\u6c42\u4e0a\u4e0b\u6587 (",(0,l.kt)("inlineCode",{parentName:"td"},"ctx.jwt_auth_payload"),") \u4e2d\u3002\u8fd9\u5141\u8bb8\u5728\u540c\u4e00\u8bf7\u6c42\u4e0a\u968f\u540e\u8fd0\u884c\u7684\u4f4e\u4f18\u5148\u7ea7\u63d2\u4ef6\u68c0\u7d22\u548c\u4f7f\u7528 JWT \u4ee4\u724c\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"claims_to_verify"),(0,l.kt)("td",{parentName:"tr",align:null},"array","[string]"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},'["exp", "nbf"]'),(0,l.kt)("td",{parentName:"tr",align:null},'["exp", "nbf"]')))),(0,l.kt)("p",null,"\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://www.vaultproject.io/"},"HashiCorp Vault")," \u5b9e\u65bd ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth"),"\uff0c\u4ee5\u4ece\u5176",(0,l.kt)("a",{parentName:"p",href:"https://developer.hashicorp.com/vault/docs/secrets/kv"},"\u52a0\u5bc6\u7684 KV \u5f15\u64ce")," \u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"/zh/docs/apisix/next/terminology/secret"},"APISIX Secret")," \u8d44\u6e90\u3002"),(0,l.kt)("h2",{id:"\u793a\u4f8b"},"\u793a\u4f8b"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u5728\u4e0d\u540c\u573a\u666f\u4e2d\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u63d2\u4ef6\u3002"),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u60a8\u53ef\u4ee5\u8fd9\u6837\u4ece ",(0,l.kt)("inlineCode",{parentName:"p"},"config.yaml")," \u4e2d\u83b7\u53d6 ",(0,l.kt)("inlineCode",{parentName:"p"},"admin_key")," \u5e76\u5b58\u5165\u73af\u5883\u53d8\u91cf\uff1a"),(0,l.kt)("pre",{parentName:"div"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"admin_key=$(yq '.deployment.admin.admin_key[0].key' conf/config.yaml | sed 's/\"//g')\n")))),(0,l.kt)("h3",{id:"\u4f7f\u7528-jwt-\u8fdb\u884c\u6d88\u8d39\u8005\u8eab\u4efd\u9a8c\u8bc1"},"\u4f7f\u7528 JWT \u8fdb\u884c\u6d88\u8d39\u8005\u8eab\u4efd\u9a8c\u8bc1"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528 JWT \u8fdb\u884c\u6d88\u8d39\u8005\u5bc6\u94a5\u8eab\u4efd\u9a8c\u8bc1\u3002"),(0,l.kt)("p",null,"\u521b\u5efa\u6d88\u8d39\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "username": "jack"\n  }\'\n')),(0,l.kt)("p",null,"\u4e3a\u6d88\u8d39\u8005\u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u51ed\u8bc1\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers/jack/credentials" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "cred-jack-jwt-auth",\n    "plugins": {\n      "jwt-auth": {\n        "key": "jack-key",\n        "secret": "jack-hs256-secret-that-is-very-long"\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u63d2\u4ef6\u521b\u5efa\u8def\u7531\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/routes" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "jwt-route",\n    "uri": "/headers",\n    "plugins": {\n      "jwt-auth": {}\n    },\n    "upstream": {\n      "type": "roundrobin",\n      "nodes": {\n        "httpbin.org:80": 1\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u8981\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack")," \u9881\u53d1 JWT\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668")," \u6216\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u3002\u5982\u679c\u60a8\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668"),"\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u586b\u5199 ",(0,l.kt)("inlineCode",{parentName:"p"},"HS256")," \u4f5c\u4e3a\u7b97\u6cd5\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06 ",(0,l.kt)("strong",{parentName:"p"},"Valid secret")," \u90e8\u5206\u4e2d\u7684\u5bc6\u94a5\u66f4\u65b0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-hs256-secret-that-is-very-long"),"\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528\u6d88\u8d39\u8005\u5bc6\u94a5 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-key")," \u66f4\u65b0\u6709\u6548 payload\uff1b\u5e76\u6dfb\u52a0 ",(0,l.kt)("inlineCode",{parentName:"p"},"exp")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"nbf")," UNIX \u65f6\u95f4\u6233\u3002"),(0,l.kt)("p",{parentName:"li"},"\u60a8\u7684 payload \u5e94\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key": "jack-key",\n  "nbf": 1729132271\n}\n')))),(0,l.kt)("p",null,"\u5c06\u751f\u6210\u7684 JWT \u4fdd\u5b58\u5230\u53d8\u91cf\u4e2d\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"export jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.UEPXy5jpid624T1XpfjM0PLY73LZPjV3Qt8yZ92kVuU\n")),(0,l.kt)("p",null,"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"Authorization")," \u6807\u5934\u4e2d\u7684 JWT \u5411\u8def\u7531\u53d1\u9001\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i "http://127.0.0.1:9080/headers" -H "Authorization: ${jwt_token}"\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u6536\u5230\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP/1.1 200 OK")," \u54cd\u5e94\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "headers": {\n    "Accept": "*/*",\n    "Authorization": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3MjY2NDk2NDAsImtleSI6ImphY2sta2V5In0.kdhumNWrZFxjUvYzWLt4lFr546PNsr9TXuf0Az5opoM",\n    "Host": "127.0.0.1",\n    "User-Agent": "curl/8.6.0",\n    "X-Amzn-Trace-Id": "Root=1-66ea951a-4d740d724bd2a44f174d4daf",\n    "X-Consumer-Username": "jack",\n    "X-Credential-Identifier": "cred-jack-jwt-auth",\n    "X-Forwarded-Host": "127.0.0.1"\n  }\n}\n')),(0,l.kt)("p",null,"\u4f7f\u7528\u65e0\u6548\u7684\u4ee4\u724c\u53d1\u9001\u8bf7\u6c42\u4ee5\u9a8c\u8bc1\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i "http://127.0.0.1:9080/headers" -H "Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3MjY2NDk2NDAsImtleSI6ImphY2sta2V5In0.kdhumNWrZFxjU_random_random"\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u6536\u5230\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP/1.1 401 Unauthorized")," \u54cd\u5e94\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'{"message":"failed to verify jwt"}\n')),(0,l.kt)("h3",{id:"\u5728\u8bf7\u6c42\u6807\u5934\u67e5\u8be2\u5b57\u7b26\u4e32\u6216-cookie-\u4e2d\u643a\u5e26-jwt"},"\u5728\u8bf7\u6c42\u6807\u5934\u3001\u67e5\u8be2\u5b57\u7b26\u4e32\u6216 Cookie \u4e2d\u643a\u5e26 JWT"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u5982\u4f55\u5728\u6307\u5b9a\u7684\u6807\u5934\u3001\u67e5\u8be2\u5b57\u7b26\u4e32\u548c Cookie \u4e2d\u63a5\u53d7 JWT\u3002"),(0,l.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u6d88\u8d39\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "username": "jack"\n  }\'\n')),(0,l.kt)("p",null,"\u4e3a\u6d88\u8d39\u8005\u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u51ed\u8bc1\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers/jack/credentials" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "cred-jack-jwt-auth",\n    "plugins": {\n      "jwt-auth": {\n        "key": "jack-key",\n        "secret": "jack-hs256-secret-that-is-very-long"\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u5e26\u6709 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u63d2\u4ef6\u7684\u8def\u7531\uff0c\u5e76\u6307\u5b9a\u8bf7\u6c42\u53ef\u4ee5\u5728\u6807\u5934\u3001\u67e5\u8be2\u6216 cookie \u4e2d\u643a\u5e26\u4ee4\u724c\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/routes" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "jwt-route",\n    "uri": "/get",\n    "plugins": {\n      "jwt-auth": {\n        "header": "jwt-auth-header",\n        "query": "jwt-query",\n        "cookie": "jwt-cookie"\n      }\n    },\n    "upstream": {\n      "type": "roundrobin",\n      "nodes": {\n        "httpbin.org:80": 1\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u8981\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack")," \u9881\u53d1 JWT\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668")," \u6216\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u3002\u5982\u679c\u60a8\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668"),"\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u586b\u5199 ",(0,l.kt)("inlineCode",{parentName:"p"},"HS256")," \u4f5c\u4e3a\u7b97\u6cd5\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06 ",(0,l.kt)("strong",{parentName:"p"},"Valid secret")," \u90e8\u5206\u4e2d\u7684\u5bc6\u94a5\u66f4\u65b0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-hs256-secret-that-is-very-long"),"\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528\u6d88\u8d39\u8005\u5bc6\u94a5 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-key")," \u66f4\u65b0\u6709\u6548 payload\uff1b\u5e76\u6dfb\u52a0 ",(0,l.kt)("inlineCode",{parentName:"p"},"exp")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"nbf")," UNIX \u65f6\u95f4\u6233\u3002"),(0,l.kt)("p",{parentName:"li"},"\u60a8\u7684 payload \u5e94\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key": "jack-key",\n  "nbf": 1729132271\n}\n')))),(0,l.kt)("p",null,"\u5c06\u751f\u6210\u7684 JWT \u4fdd\u5b58\u5230\u53d8\u91cf\u4e2d\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"export jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.UEPXy5jpid624T1XpfjM0PLY73LZPjV3Qt8yZ92kVuU\n")),(0,l.kt)("h4",{id:"\u4f7f\u7528\u6807\u5934\u4e2d\u7684-jwt-\u8fdb\u884c\u9a8c\u8bc1"},"\u4f7f\u7528\u6807\u5934\u4e2d\u7684 JWT \u8fdb\u884c\u9a8c\u8bc1"),(0,l.kt)("p",null,"\u53d1\u9001\u6807\u5934\u4e2d\u5305\u542b JWT \u7684\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i "http://127.0.0.1:9080/get" -H "jwt-auth-header: ${jwt_token}"\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u6536\u5230\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP/1.1 200 OK")," \u54cd\u5e94\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "args": {},\n  "headers": {\n    "Accept": "*/*",\n    "Host": "127.0.0.1",\n    "Jwt-Auth-Header": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.UEPXy5jpid624T1XpfjM0PLY73LZPjV3Qt8yZ92kVuU",\n    ...\n  },\n  ...\n}\n')),(0,l.kt)("h4",{id:"\u5728\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528-jwt-\u8fdb\u884c\u9a8c\u8bc1"},"\u5728\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528 JWT \u8fdb\u884c\u9a8c\u8bc1"),(0,l.kt)("p",null,"\u5728\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528 JWT \u53d1\u9001\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i "http://127.0.0.1:9080/get?jwt-query=${jwt_token}"\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u6536\u5230\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP/1.1 200 OK")," \u54cd\u5e94\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "args": {\n    "jwt-query": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.UEPXy5jpid624T1XpfjM0PLY73LZPjV3Qt8yZ92kVuU"\n  },\n  "headers": {\n    "Accept": "*/*",\n    ...\n  },\n  "origin": "127.0.0.1, 183.17.233.107",\n  "url": "http://127.0.0.1/get?jwt-query=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJrZXkiOiJ1c2VyLWtleSIsImV4cCI6MTY5NTEyOTA0NH0.EiktFX7di_tBbspbjmqDKoWAD9JG39Wo_CAQ1LZ9voQ"\n}\n')),(0,l.kt)("h4",{id:"\u4f7f\u7528-cookie-\u4e2d\u7684-jwt-\u8fdb\u884c\u9a8c\u8bc1"},"\u4f7f\u7528 Cookie \u4e2d\u7684 JWT \u8fdb\u884c\u9a8c\u8bc1"),(0,l.kt)("p",null,"\u4f7f\u7528 cookie \u4e2d\u7684 JWT \u53d1\u9001\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i "http://127.0.0.1:9080/get" --cookie jwt-cookie=${jwt_token}\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u6536\u5230\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP/1.1 200 OK")," \u54cd\u5e94\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "args": {},\n  "headers": {\n    "Accept": "*/*",\n    "Cookie": "jwt-cookie=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.UEPXy5jpid624T1XpfjM0PLY73LZPjV3Qt8yZ92kVuU",\n    ...\n  },\n  ...\n}\n')),(0,l.kt)("h3",{id:"\u5728\u73af\u5883\u53d8\u91cf\u4e2d\u7ba1\u7406\u5bc6\u94a5"},"\u5728\u73af\u5883\u53d8\u91cf\u4e2d\u7ba1\u7406\u5bc6\u94a5"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u5c06 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u6d88\u8d39\u8005\u5bc6\u94a5\u4fdd\u5b58\u5230\u73af\u5883\u53d8\u91cf\u5e76\u5728\u914d\u7f6e\u4e2d\u5f15\u7528\u5b83\u3002"),(0,l.kt)("p",null,"APISIX \u652f\u6301\u5f15\u7528\u901a\u8fc7 ",(0,l.kt)("a",{parentName:"p",href:"https://nginx.org/en/docs/ngx_core_module.html#env"},"NGINX ",(0,l.kt)("inlineCode",{parentName:"a"},"env")," \u6307\u4ee4")," \u914d\u7f6e\u7684\u7cfb\u7edf\u548c\u7528\u6237\u73af\u5883\u53d8\u91cf\u3002"),(0,l.kt)("p",null,"\u5c06\u5bc6\u94a5\u4fdd\u5b58\u5230\u73af\u5883\u53d8\u91cf\u4e2d\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"export JACK_JWT_SECRET=jack-hs256-secret-that-is-very-long\n")),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u5982\u679c\u60a8\u5728 Docker \u4e2d\u8fd0\u884c APISIX\uff0c\u9700\u8981\u5728\u542f\u52a8\u5bb9\u5668\u65f6\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"-e")," flag \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002"))),(0,l.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u6d88\u8d39\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "username": "jack"\n  }\'\n')),(0,l.kt)("p",null,"\u4e3a\u6d88\u8d39\u8005\u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u51ed\u8bc1\u5e76\u5f15\u7528\u73af\u5883\u53d8\u91cf\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers/jack/credentials" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "cred-jack-jwt-auth",\n    "plugins": {\n      "jwt-auth": {\n        "key": "jack-key",\n        "secret": "$env://JACK_JWT_SECRET"\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u521b\u5efa\u542f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u7684\u8def\u7531\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/routes" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "jwt-route",\n    "uri": "/get",\n    "plugins": {\n      "jwt-auth": {}\n    },\n    "upstream": {\n      "type": "roundrobin",\n      "nodes": {\n        "httpbin.org:80": 1\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u8981\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack")," \u9881\u53d1 JWT\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668")," \u6216\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u3002\u5982\u679c\u60a8\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668"),"\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u586b\u5199 ",(0,l.kt)("inlineCode",{parentName:"p"},"HS256")," \u4f5c\u4e3a\u7b97\u6cd5\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06 ",(0,l.kt)("strong",{parentName:"p"},"Valid secret")," \u90e8\u5206\u4e2d\u7684\u5bc6\u94a5\u66f4\u65b0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-hs256-secret-that-is-very-long"),"\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528\u6d88\u8d39\u8005\u5bc6\u94a5 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-key")," \u66f4\u65b0\u6709\u6548 payload\uff1b\u5e76\u6dfb\u52a0 ",(0,l.kt)("inlineCode",{parentName:"p"},"exp")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"nbf")," UNIX \u65f6\u95f4\u6233\u3002"),(0,l.kt)("p",{parentName:"li"},"\u60a8\u7684 payload \u5e94\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key": "jack-key",\n  "nbf": 1729132271\n}\n')))),(0,l.kt)("p",null,"\u5c06\u751f\u6210\u7684 JWT \u4fdd\u5b58\u5230\u53d8\u91cf\u4e2d\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"export jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.UEPXy5jpid624T1XpfjM0PLY73LZPjV3Qt8yZ92kVuU\n")),(0,l.kt)("p",null,"\u53d1\u9001\u6807\u5934\u4e2d\u5305\u542b JWT \u7684\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i "http://127.0.0.1:9080/get" -H "Authorization: ${jwt_token}"\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u4f1a\u6536\u5230 ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP/1.1 200 OK")," \u54cd\u5e94\u3002"),(0,l.kt)("h3",{id:"\u5728-secret-manager-\u4e2d\u7ba1\u7406-secret"},"\u5728 Secret Manager \u4e2d\u7ba1\u7406 Secret"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u5728 ",(0,l.kt)("a",{parentName:"p",href:"https://www.vaultproject.io"},"HashiCorp Vault")," \u4e2d\u7ba1\u7406 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u6d88\u8d39\u8005\u5bc6\u94a5\uff0c\u5e76\u5728\u63d2\u4ef6\u914d\u7f6e\u4e2d\u5f15\u7528\u5b83\u3002"),(0,l.kt)("p",null,"\u5728 Docker \u4e2d\u542f\u52a8 Vault \u5f00\u53d1\u670d\u52a1\u5668\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"docker run -d \\\n  --name vault \\\n  -p 8200:8200 \\\n  --cap-add IPC_LOCK \\\n  -e VAULT_DEV_ROOT_TOKEN_ID=root \\\n  -e VAULT_DEV_LISTEN_ADDRESS=0.0.0.0:8200 \\\n  vault:1.9.0 \\\n  vault server -dev\n")),(0,l.kt)("p",null,"APISIX \u76ee\u524d\u652f\u6301 ",(0,l.kt)("a",{parentName:"p",href:"https://developer.hashicorp.com/vault/docs/secrets/kv#kv-version-1"},"Vault KV \u5f15\u64ce\u7248\u672c 1"),"\u3002\u8bf7\u5728 Vault \u4e2d\u542f\u7528\u5b83\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"docker exec -i vault sh -c \"VAULT_TOKEN='root' VAULT_ADDR='http://0.0.0.0:8200' vault secrets enable -path=kv -version=1 kv\"\n")),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u4f1a\u770b\u5230\u7c7b\u4f3c\u4ee5\u4e0b\u5185\u5bb9\u7684\u54cd\u5e94\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"Success! Enabled the kv secrets engine at: kv/\n")),(0,l.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a Secret\uff0c\u5e76\u914d\u7f6e Vault \u5730\u5740\u548c\u5176\u4ed6\u8fde\u63a5\u4fe1\u606f\u3002\u6839\u636e\u60c5\u51b5\u76f8\u5e94\u5730\u66f4\u65b0 Vault \u5730\u5740\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/secrets/vault/jwt" -X PUT \\\n  -H "X-API-KEY: ${ADMIN_API_KEY}" \\\n  -d \'{\n    "uri": "https://127.0.0.1:8200",\n    "prefix": "kv/apisix",\n    "token": "root"\n  }\'\n')),(0,l.kt)("p",null,"\u521b\u5efa\u6d88\u8d39\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers" -X PUT \\\n  -H "X-API-KEY: ${ADMIN_API_KEY}" \\\n  -d \'{\n    "username": "jack"\n  }\'\n')),(0,l.kt)("p",null,"\u4e3a\u6d88\u8d39\u8005\u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u51ed\u8bc1\u5e76\u5f15\u7528 Secret\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers/jack/credentials" -X PUT \\\n  -H "X-API-KEY: ${ADMIN_API_KEY}" \\\n  -d \'{\n    "id": "cred-jack-jwt-auth",\n    "plugins": {\n      "jwt-auth": {\n        "key": "jwt-vault-key",\n        "secret": "$secret://vault/jwt/jack/jwt-secret"\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u521b\u5efa\u542f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u7684\u8def\u7531\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/routes" -X PUT \\\n  -H "X-API-KEY: ${ADMIN_API_KEY}" \\\n  -d \'{\n    "id": "jwt-route",\n    "uri": "/get",\n    "plugins": {\n      "jwt-auth": {}\n    },\n    "upstream": {\n      "type": "roundrobin",\n      "nodes": {\n        "httpbin.org:80": 1\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u5728 Vault \u4e2d\u5c06 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u952e\u503c\u8bbe\u7f6e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"vault-hs256-secret-that-is-very-long"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"docker exec -i vault sh -c \"VAULT_TOKEN='root' VAULT_ADDR='http://0.0.0.0:8200' vault kv put kv/apisix/jack jwt-secret=vault-hs256-secret-that-is-very-long\"\n")),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u4f1a\u770b\u5230\u7c7b\u4f3c\u4ee5\u4e0b\u5185\u5bb9\u7684\u54cd\u5e94\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"Success! Data written to: kv/apisix/jack\n")),(0,l.kt)("p",null,"\u8981\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack")," \u9881\u53d1 JWT\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668")," \u6216\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u3002\u5982\u679c\u60a8\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668"),"\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u586b\u5199 ",(0,l.kt)("inlineCode",{parentName:"p"},"HS256")," \u4f5c\u4e3a\u7b97\u6cd5\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06 ",(0,l.kt)("strong",{parentName:"p"},"Valid secret")," \u90e8\u5206\u4e2d\u7684\u5bc6\u94a5\u66f4\u65b0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"vault-hs256-secret-that-is-very-long"),"\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528\u6d88\u8d39\u8005\u5bc6\u94a5 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-vault-key")," \u66f4\u65b0\u6709\u6548 payload\uff1b\u5e76\u6dfb\u52a0 ",(0,l.kt)("inlineCode",{parentName:"p"},"exp")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"nbf")," UNIX \u65f6\u95f4\u6233\u3002"),(0,l.kt)("p",{parentName:"li"},"\u60a8\u7684 payload \u5e94\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key": "jwt-vault-key",\n  "nbf": 1729132271\n}\n')))),(0,l.kt)("p",null,"\u590d\u5236\u751f\u6210\u7684 JWT \u5e76\u4fdd\u5b58\u5230\u53d8\u91cf\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"export jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqd3QtdmF1bHQta2V5IiwibmJmIjoxNzI5MTMyMjcxfQ.i2pLj7QcQvnlSjB7iV5V522tIV43boQRtee7L0rwlkQ\n")),(0,l.kt)("p",null,"\u53d1\u9001\u5e26\u6709\u4ee4\u724c\u4f5c\u4e3a\u6807\u5934\u7684\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i "http://127.0.0.1:9080/get" -H "Authorization: ${jwt_token}"\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u4f1a\u6536\u5230 ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP/1.1 200 OK")," \u54cd\u5e94\u3002"),(0,l.kt)("h3",{id:"\u4f7f\u7528-rs256-\u7b97\u6cd5\u7b7e\u540d-jwt"},"\u4f7f\u7528 RS256 \u7b97\u6cd5\u7b7e\u540d JWT"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u5728\u5b9e\u73b0 JWT \u6d88\u8d39\u8005\u8eab\u4efd\u9a8c\u8bc1\u65f6\u4f7f\u7528\u975e\u5bf9\u79f0\u7b97\u6cd5\uff08\u4f8b\u5982 RS256\uff09\u5bf9 JWT \u8fdb\u884c\u7b7e\u540d\u548c\u9a8c\u8bc1\u3002\u60a8\u5c06\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://openssl-library.org/source/"},"openssl")," \u751f\u6210 RSA \u5bc6\u94a5\u5bf9\uff0c\u5e76\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io")," \u751f\u6210 JWT\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u7406\u89e3 JWT \u7684\u7ec4\u6210\u3002"),(0,l.kt)("p",null,"\u751f\u6210\u4e00\u4e2a 2048 \u4f4d RSA \u79c1\u94a5\uff0c\u5e76\u63d0\u53d6\u76f8\u5e94\u7684 PEM \u683c\u5f0f\u516c\u94a5\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"openssl genrsa -out jwt-rsa256-private.pem 2048\nopenssl rsa -in jwt-rsa256-private.pem -pubout -out jwt-rsa256-public.pem\n")),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u770b\u5230\u5728\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e2d\u751f\u6210\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-rsa256-private.pem")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-rsa256-public.pem"),"\u3002"),(0,l.kt)("p",null,"\u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668")," \u5e76\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u586b\u5199 ",(0,l.kt)("inlineCode",{parentName:"p"},"RS256")," \u4f5c\u4e3a\u7b97\u6cd5\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06\u79c1\u94a5\u5185\u5bb9\u590d\u5236\u5e76\u7c98\u8d34\u5230 ",(0,l.kt)("strong",{parentName:"p"},"SIGN JWT: PRIVATE KEY")," \u90e8\u5206\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528\u6d88\u8d39\u8005\u5bc6\u94a5 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-key")," \u66f4\u65b0\u6709\u6548\u8d1f\u8f7d\uff1b\u5e76\u6dfb\u52a0 ",(0,l.kt)("inlineCode",{parentName:"p"},"exp")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"nbf")," UNIX \u65f6\u95f4\u6233\u3002"),(0,l.kt)("p",{parentName:"li"},"\u60a8\u7684 payload \u5e94\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key": "jack-key",\n  "nbf": 1729132271\n}\n')))),(0,l.kt)("p",null,"\u590d\u5236\u751f\u6210\u7684 JWT \u5e76\u4fdd\u5b58\u5230\u53d8\u91cf\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"export jwt_token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.K-I13em84kAcyH1jfIJl7ls_4jlwg1GzEzo5_xrDu-3wt3Xa3irS6naUsWpxX-a-hmcZZxRa9zqunqQjUP4kvn5e3xg2f_KyCR-_ZbwqYEPk3bXeFV1l4iypv6z5L7W1Niharun-dpMU03b1Tz64vhFx6UwxNL5UIZ7bunDAo_BXZ7Xe8rFhNHvIHyBFsDEXIBgx8lNYMq8QJk3iKxZhZZ5Om7lgYjOOKRgew4WkhBAY0v1AkO77nTlvSK0OEeeiwhkROyntggyx-S-U222ykMQ6mBLxkP4Cq5qHwXD8AUcLk5mhEij-3QhboYnt7yhKeZ3wDSpcjDvvL2aasC25ng\n")),(0,l.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u6d88\u8d39\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "username": "jack"\n  }\'\n')),(0,l.kt)("p",null,"\u4e3a\u6d88\u8d39\u8005\u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u51ed\u8bc1\u5e76\u914d\u7f6e RSA \u5bc6\u94a5\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers/jack/credentials" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "cred-jack-jwt-auth",\n    "plugins": {\n      "jwt-auth": {\n        "key": "jack-key",\n        "algorithm": "RS256",\n        "public_key": "-----BEGIN PUBLIC KEY-----\\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoTxe7ZPycrEP0SK4OBA2\\n0OUQsDN9gSFSHVvx/t++nZNrFxzZnV6q6/TRsihNXUIgwaOu5icFlIcxPL9Mf9UJ\\na5/XCQExp1TxpuSmjkhIFAJ/x5zXrC8SGTztP3SjkhYnQO9PKVXI6ljwgakVCfpl\\numuTYqI+ev7e45NdK8gJoJxPp8bPMdf8/nHfLXZuqhO/btrDg1x+j7frDNrEw+6B\\nCK2SsuypmYN+LwHfaH4Of7MQFk3LNIxyBz0mdbsKJBzp360rbWnQeauWtDymZxLT\\nATRNBVyl3nCNsURRTkc7eyknLaDt2N5xTIoUGHTUFYSdE68QWmukYMVGcEHEEPkp\\naQIDAQAB\\n-----END PUBLIC KEY-----"\n      }\n    }\n  }\'\n')),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"\u60a8\u5e94\u8be5\u5728\u8d77\u59cb\u884c\u4e4b\u540e\u548c\u7ed3\u675f\u884c\u4e4b\u524d\u6dfb\u52a0\u6362\u884c\u7b26\uff0c\u4f8b\u5982 ",(0,l.kt)("inlineCode",{parentName:"p"},"-----BEGIN PUBLIC KEY-----\\n......\\n-----END PUBLIC KEY-----"),"\u3002"),(0,l.kt)("p",{parentName:"div"},"\u5bc6\u94a5\u5185\u5bb9\u53ef\u4ee5\u76f4\u63a5\u8fde\u63a5\u3002"))),(0,l.kt)("p",null,"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u63d2\u4ef6\u521b\u5efa\u8def\u7531\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/routes" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "jwt-route",\n    "uri": "/headers",\n    "plugins": {\n      "jwt-auth": {}\n    },\n    "upstream": {\n      "type": "roundrobin",\n      "nodes": {\n        "httpbin.org:80": 1\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"Authorization")," \u6807\u5934\u4e2d\u7684 JWT \u5411\u8def\u7531\u53d1\u9001\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i "http://127.0.0.1:9080/headers" -H "Authorization: ${jwt_token}"\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u4f1a\u6536\u5230 ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP/1.1 200 OK")," \u54cd\u5e94\u3002"),(0,l.kt)("h3",{id:"\u5c06\u6d88\u8d39\u8005\u81ea\u5b9a\u4e49-id-\u6dfb\u52a0\u5230\u6807\u5934"},"\u5c06\u6d88\u8d39\u8005\u81ea\u5b9a\u4e49 ID \u6dfb\u52a0\u5230\u6807\u5934"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"Consumer-Custom-Id")," \u6807\u5934\u4e2d\u5c06\u6d88\u8d39\u8005\u81ea\u5b9a\u4e49 ID \u9644\u52a0\u5230\u5df2\u9a8c\u8bc1\u7684\u8bf7\u6c42\uff0c\u8be5 ID \u53ef\u7528\u4e8e\u6839\u636e\u9700\u8981\u5b9e\u73b0\u5176\u4ed6\u903b\u8f91\u3002"),(0,l.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u5e26\u6709\u81ea\u5b9a\u4e49 ID \u6807\u7b7e\u7684\u6d88\u8d39\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "username": "jack",\n    "labels": {\n      "custom_id": "495aec6a"\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u4e3a\u6d88\u8d39\u8005\u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u51ed\u8bc1\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers/jack/credentials" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "cred-jack-jwt-auth",\n    "plugins": {\n      "jwt-auth": {\n        "key": "jack-key",\n        "secret": "jack-hs256-secret-that-is-very-long"\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u521b\u5efa\u8def\u7531\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/routes" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "jwt-auth-route",\n    "uri": "/anything",\n    "plugins": {\n      "jwt-auth": {}\n    },\n    "upstream": {\n      "type": "roundrobin",\n      "nodes": {\n        "httpbin.org:80": 1\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u8981\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack")," \u9881\u53d1 JWT\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668")," \u6216\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u3002\u5982\u679c\u60a8\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668"),"\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u586b\u5199 ",(0,l.kt)("inlineCode",{parentName:"p"},"HS256")," \u4f5c\u4e3a\u7b97\u6cd5\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06 ",(0,l.kt)("strong",{parentName:"p"},"Valid secret")," \u90e8\u5206\u4e2d\u7684\u5bc6\u94a5\u66f4\u65b0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-hs256-secret-that-is-very-long"),"\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528\u6d88\u8d39\u8005\u5bc6\u94a5 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-key")," \u66f4\u65b0\u6709\u6548 payload\uff1b\u5e76\u6dfb\u52a0 ",(0,l.kt)("inlineCode",{parentName:"p"},"exp")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"nbf")," UNIX \u65f6\u95f4\u6233\u3002"),(0,l.kt)("p",{parentName:"li"},"\u60a8\u7684 payload \u5e94\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key": "jack-key",\n  "nbf": 1729132271\n}\n')))),(0,l.kt)("p",null,"\u590d\u5236\u751f\u6210\u7684 JWT \u5e76\u4fdd\u5b58\u5230\u53d8\u91cf\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"export jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.UEPXy5jpid624T1XpfjM0PLY73LZPjV3Qt8yZ92kVuU\n")),(0,l.kt)("p",null,"\u4e3a\u4e86\u9a8c\u8bc1\uff0c\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"Authorization")," \u6807\u5934\u4e2d\u7684 JWT \u5411\u8def\u7531\u53d1\u9001\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl -i "http://127.0.0.1:9080/headers" -H "Authorization: ${jwt_token}"\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u4f1a\u770b\u5230\u7c7b\u4f3c\u4ee5\u4e0b\u5185\u5bb9\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP/1.1 200 OK")," \u54cd\u5e94\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "headers": {\n    "Accept": "*/*",\n    "Authorization": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.UEPXy5jpid624T1XpfjM0PLY73LZPjV3Qt8yZ92kVuU",\n    "Host": "127.0.0.1",\n    "User-Agent": "curl/8.6.0",\n    "X-Amzn-Trace-Id": "Root=1-6873b19d-329331db76e5e7194c942b47",\n    "X-Consumer-Custom-Id": "495aec6a",\n    "X-Consumer-Username": "jack",\n    "X-Credential-Identifier": "cred-jack-jwt-auth",\n    "X-Forwarded-Host": "127.0.0.1"\n  }\n}\n')),(0,l.kt)("h3",{id:"\u533f\u540d\u6d88\u8d39\u8005\u7684\u901f\u7387\u9650\u5236"},"\u533f\u540d\u6d88\u8d39\u8005\u7684\u901f\u7387\u9650\u5236"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4e3a\u666e\u901a\u6d88\u8d39\u8005\u548c\u533f\u540d\u6d88\u8d39\u8005\u914d\u7f6e\u4e0d\u540c\u7684\u901f\u7387\u9650\u5236\u7b56\u7565\uff0c\u5176\u4e2d\u533f\u540d\u6d88\u8d39\u8005\u65e0\u9700\u8eab\u4efd\u9a8c\u8bc1\uff0c\u4e14\u914d\u989d\u8f83\u5c11\u3002"),(0,l.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u6d88\u8d39\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack"),"\uff0c\u5e76\u914d\u7f6e ",(0,l.kt)("inlineCode",{parentName:"p"},"limit-count")," \u63d2\u4ef6\uff0c\u5141\u8bb8\u5728 30 \u79d2\u5185\u4f7f\u7528 3 \u4e2a\u914d\u989d\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "username": "jack",\n    "plugins": {\n      "limit-count": {\n        "count": 3,\n        "time_window": 30,\n        "rejected_code": 429\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u4e3a\u6d88\u8d39\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack")," \u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u51ed\u8bc1\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers/jack/credentials" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "cred-jack-jwt-auth",\n    "plugins": {\n      "jwt-auth": {\n        "key": "jack-key",\n        "secret": "jack-hs256-secret-that-is-very-long"\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u521b\u5efa\u533f\u540d\u7528\u6237 ",(0,l.kt)("inlineCode",{parentName:"p"},"anonymous"),"\uff0c\u5e76\u914d\u7f6e ",(0,l.kt)("inlineCode",{parentName:"p"},"limit-count")," \u63d2\u4ef6\uff0c\u4ee5\u5141\u8bb8 30 \u79d2\u5185\u914d\u989d\u4e3a 1\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/consumers" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "username": "anonymous",\n    "plugins": {\n      "limit-count": {\n        "count": 1,\n        "time_window": 30,\n        "rejected_code": 429\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u8def\u7531\u5e76\u914d\u7f6e ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt-auth")," \u63d2\u4ef6\u4ee5\u63a5\u53d7\u533f\u540d\u6d88\u8d39\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"anonymous")," \u7ed5\u8fc7\u8eab\u4efd\u9a8c\u8bc1\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/routes" -X PUT \\\n  -H "X-API-KEY: ${admin_key}" \\\n  -d \'{\n    "id": "jwt-auth-route",\n    "uri": "/anything",\n    "plugins": {\n      "jwt-auth": {\n        "anonymous_consumer": "anonymous"\n      }\n    },\n    "upstream": {\n      "type": "roundrobin",\n      "nodes": {\n        "httpbin.org:80": 1\n      }\n    }\n  }\'\n')),(0,l.kt)("p",null,"\u8981\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack")," \u9881\u53d1 JWT\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668")," \u6216\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u3002\u5982\u679c\u60a8\u4f7f\u7528 ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT.io \u7684 JWT \u7f16\u7801\u5668"),"\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u586b\u5199 ",(0,l.kt)("inlineCode",{parentName:"p"},"HS256")," \u4f5c\u4e3a\u7b97\u6cd5\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06 ",(0,l.kt)("strong",{parentName:"p"},"Valid secret")," \u90e8\u5206\u4e2d\u7684\u5bc6\u94a5\u66f4\u65b0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-hs256-secret-that-is-very-long"),"\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528\u6d88\u8d39\u8005\u5bc6\u94a5 ",(0,l.kt)("inlineCode",{parentName:"p"},"jack-key")," \u66f4\u65b0\u6709\u6548 payload\uff1b\u5e76\u6dfb\u52a0 ",(0,l.kt)("inlineCode",{parentName:"p"},"exp")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"nbf")," UNIX \u65f6\u95f4\u6233\u3002"),(0,l.kt)("p",{parentName:"li"},"\u60a8\u7684 payload \u5e94\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key": "jack-key",\n  "nbf": 1729132271\n}\n')))),(0,l.kt)("p",null,"\u5c06\u751f\u6210\u7684 JWT \u590d\u5236\u5230 ",(0,l.kt)("strong",{parentName:"p"},"Encoded")," \u90e8\u5206\u5e76\u4fdd\u5b58\u5230\u53d8\u91cf\u4e2d\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"export jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJqYWNrLWtleSIsIm5iZiI6MTcyOTEzMjI3MX0.UEPXy5jpid624T1XpfjM0PLY73LZPjV3Qt8yZ92kVuU\n")),(0,l.kt)("p",null,"\u4e3a\u4e86\u9a8c\u8bc1\u901f\u7387\u9650\u5236\uff0c\u8bf7\u4f7f\u7528 jack \u7684 JWT \u8fde\u7eed\u53d1\u9001\u4e94\u4e2a\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'resp=$(seq 5 | xargs -I{} curl "http://127.0.0.1:9080/anything" -H "Authorization: ${jwt_token}" -o /dev/null -s -w "%{http_code}\\n") && \\\n  count_200=$(echo "$resp" | grep "200" | wc -l) && \\\n  count_429=$(echo "$resp" | grep "429" | wc -l) && \\\n  echo "200": $count_200, "429": $count_429\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u770b\u5230\u4ee5\u4e0b\u54cd\u5e94\uff0c\u663e\u793a\u5728 5 \u4e2a\u8bf7\u6c42\u4e2d\uff0c3 \u4e2a\u8bf7\u6c42\u6210\u529f\uff08\u72b6\u6001\u4ee3\u7801 200\uff09\uff0c\u800c\u5176\u4ed6\u8bf7\u6c42\u88ab\u62d2\u7edd\uff08\u72b6\u6001\u4ee3\u7801 429\uff09\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"200:    3, 429:    2\n")),(0,l.kt)("p",null,"\u53d1\u9001\u4e94\u4e2a\u533f\u540d\u8bf7\u6c42\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'resp=$(seq 5 | xargs -I{} curl "http://127.0.0.1:9080/anything" -o /dev/null -s -w "%{http_code}\\n") && \\\n  count_200=$(echo "$resp" | grep "200" | wc -l) && \\\n  count_429=$(echo "$resp" | grep "429" | wc -l) && \\\n  echo "200": $count_200, "429": $count_429\n')),(0,l.kt)("p",null,"\u60a8\u5e94\u8be5\u770b\u5230\u4ee5\u4e0b\u54cd\u5e94\uff0c\u8868\u660e\u53ea\u6709\u4e00\u4e2a\u8bf7\u6c42\u6210\u529f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"200:    1, 429:    4\n")))}o.isMDXComponent=!0}}]);