"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[40632],{35318:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>d});var n=a(27378);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),c=p(a),d=i,m=c["".concat(s,".").concat(d)]||c[d]||h[d]||r;return a?n.createElement(m,l(l({ref:t},u),{},{components:a})):n.createElement(m,l({ref:t},u))}));function d(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,l=new Array(r);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var p=2;p<r;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},74750:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var n=a(25773),i=(a(27378),a(35318));const r={title:"Release Apache APISIX 3.10.0",authors:[{name:"Abhishek Choudhary",title:"Author",url:"https://github.com/shreemaan-abhishek",image_url:"https://github.com/shreemaan-abhishek.png"},{name:"Traky Deng",title:"Technical Writer",url:"https://github.com/kayx23",image_url:"https://github.com/kayx23.png"}],keywords:["Apache APISIX","API Gateway","API Management Platform","New Release","Cloud Native"],description:"The Apache APISIX 3.10.0 version is released on August 14, 2024. This release includes a few changes, new features, bug fixes, and other improvements to user experiences.",tags:["Community"]},l=void 0,o={permalink:"/blog/2024/08/14/release-apache-apisix-3.10.0",source:"@site/blog/2024/08/14/release-apache-apisix-3.10.0.md",title:"Release Apache APISIX 3.10.0",description:"The Apache APISIX 3.10.0 version is released on August 14, 2024. This release includes a few changes, new features, bug fixes, and other improvements to user experiences.",date:"2024-08-14T00:00:00.000Z",formattedDate:"August 14, 2024",tags:[{label:"Community",permalink:"/blog/tags/community"}],readingTime:4.91,truncated:!0,authors:[{name:"Abhishek Choudhary",title:"Author",url:"https://github.com/shreemaan-abhishek",image_url:"https://github.com/shreemaan-abhishek.png",imageURL:"https://github.com/shreemaan-abhishek.png"},{name:"Traky Deng",title:"Technical Writer",url:"https://github.com/kayx23",image_url:"https://github.com/kayx23.png",imageURL:"https://github.com/kayx23.png"}],prevItem:{title:"Monthly Report (August 01 - August 31)",permalink:"/blog/2024/08/31/monthly-report"},nextItem:{title:"Free tier API with Apache APISIX",permalink:"/blog/2024/08/01/free-tier-api-apisix"}},s={authorsImageUrls:[void 0,void 0]},p=[{value:"Breaking Changes",id:"breaking-changes",children:[{value:"Autogenerate Admin API key if not configured",id:"autogenerate-admin-api-key-if-not-configured",children:[],level:3},{value:"Enable data encryption by default",id:"enable-data-encryption-by-default",children:[],level:3},{value:"Categorize more sensitive plugin fields for encryption",id:"categorize-more-sensitive-plugin-fields-for-encryption",children:[],level:3},{value:"Introduce max request and response body sizes to <code>kafka-logger</code> plugin",id:"introduce-max-request-and-response-body-sizes-to-kafka-logger-plugin",children:[],level:3},{value:"Remove <code>core.grpc</code> module",id:"remove-coregrpc-module",children:[],level:3}],level:2},{value:"New Features",id:"new-features",children:[{value:"Support add-on headers in the <code>openid-connect</code> plugin",id:"support-add-on-headers-in-the-openid-connect-plugin",children:[],level:3},{value:"Print warning message in log when requesting external services without TLS",id:"print-warning-message-in-log-when-requesting-external-services-without-tls",children:[],level:3},{value:"Support storing SSL certs and keys in secrets manager",id:"support-storing-ssl-certs-and-keys-in-secrets-manager",children:[],level:3},{value:"Support HashiCorp Vault namespace",id:"support-hashicorp-vault-namespace",children:[],level:3},{value:"List K8s cluster endpoints in Control API discovery memory dump",id:"list-k8s-cluster-endpoints-in-control-api-discovery-memory-dump",children:[],level:3}],level:2},{value:"Other Updates",id:"other-updates",children:[],level:2},{value:"Changelog",id:"changelog",children:[],level:2}],u={toc:p};function h(e){let{components:t,...a}=e;return(0,i.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"We are glad to present Apache APISIX 3.10.0 with exciting new features, bug fixes, and other improvements to user experiences."),(0,i.kt)("p",null,"This new release adds a number of new features, including the support for add-on headers in the ",(0,i.kt)("inlineCode",{parentName:"p"},"openid-connect")," plugin, storing SSL certs and keys in secrets manager, autogeneration of Admin API key, and more."),(0,i.kt)("p",null,"There are a few important changes included in this release. Should you find these changes impacting your operations, please plan accordingly for a seamless upgrade."),(0,i.kt)("h2",{id:"breaking-changes"},"Breaking Changes"),(0,i.kt)("h3",{id:"autogenerate-admin-api-key-if-not-configured"},"Autogenerate Admin API key if not configured"),(0,i.kt)("p",null,"The default Admin API key ",(0,i.kt)("inlineCode",{parentName:"p"},"edd1c9f034335f136f87ad84b625c8f1")," is now removed. If no custom Admin API key is configured in ",(0,i.kt)("inlineCode",{parentName:"p"},"config.yaml"),", APISIX will autogenerate an Admin API key."),(0,i.kt)("p",null,"For more details, see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11080"},"PR #11080"),"."),(0,i.kt)("h3",{id:"enable-data-encryption-by-default"},"Enable data encryption by default"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"data_encryption.enable_encrypt_fields")," option, previously defaults to ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),", now defaults to ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," to enhance data security. This means that by default, sensitive plugin fields (defined in the ",(0,i.kt)("inlineCode",{parentName:"p"},"encrypt_fields")," attribute of plugin schema) and TLS certificate private key are now encrypted."),(0,i.kt)("p",null,"The configuration only applies when the configuration center is etcd. Encryption does not take place when the configuration center is YAML (i.e. standalone mode) to avoid unexpected failures."),(0,i.kt)("p",null,"For more details, see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11076"},"PR #11076"),"."),(0,i.kt)("h3",{id:"categorize-more-sensitive-plugin-fields-for-encryption"},"Categorize more sensitive plugin fields for encryption"),(0,i.kt)("p",null,"Categorize more sensitive plugin data fields under the ",(0,i.kt)("inlineCode",{parentName:"p"},"encrypt_fields")," attributes, which should be encrypted when ",(0,i.kt)("inlineCode",{parentName:"p"},"data_encryption.enable_encrypt_fields")," option is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,i.kt)("p",null,"For more information, see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11095"},"PR #11095"),"."),(0,i.kt)("h3",{id:"introduce-max-request-and-response-body-sizes-to-kafka-logger-plugin"},"Introduce max request and response body sizes to ",(0,i.kt)("inlineCode",{parentName:"h3"},"kafka-logger")," plugin"),(0,i.kt)("p",null,"Introduce maximum request and response body size attributes ",(0,i.kt)("inlineCode",{parentName:"p"},"max_req_body_bytes")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"max_resp_body_bytes")," to the ",(0,i.kt)("inlineCode",{parentName:"p"},"kafka-logger")," plugin. The default values are set to 524288 bytes, or 512 KiB."),(0,i.kt)("p",null,"This helps mitigates the situation when ",(0,i.kt)("inlineCode",{parentName:"p"},"include_req_body")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"include_resp_body")," is enabled and the request or response body is very large, leading to high CPU usage."),(0,i.kt)("p",null,"For more details, see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11133"},"PR #11133"),"."),(0,i.kt)("h3",{id:"remove-coregrpc-module"},"Remove ",(0,i.kt)("inlineCode",{parentName:"h3"},"core.grpc")," module"),(0,i.kt)("p",null,"As the ",(0,i.kt)("inlineCode",{parentName:"p"},"core.grpc")," module is observed to be unstable in production and APISIX no longer depends on it, this release removes the module."),(0,i.kt)("p",null,"For users that depend on the gRPC module for custom functionalities, please plan accordingly."),(0,i.kt)("p",null,"For more details, see ",(0,i.kt)("a",{parentName:"p",href:"https://lists.apache.org/thread/05xvcbvty1txr1owx61vyktsmgs2pdd5"},"proposal")," and ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11427"},"PR #11427"),"."),(0,i.kt)("h2",{id:"new-features"},"New Features"),(0,i.kt)("h3",{id:"support-add-on-headers-in-the-openid-connect-plugin"},"Support add-on headers in the ",(0,i.kt)("inlineCode",{parentName:"h3"},"openid-connect")," plugin"),(0,i.kt)("p",null,"You can now append additional header values to the introspection request in the ",(0,i.kt)("inlineCode",{parentName:"p"},"introspection_addon_headers")," field when working with the ",(0,i.kt)("inlineCode",{parentName:"p"},"openid-connect")," plugin."),(0,i.kt)("p",null,"For more information, see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11090"},"PR #11090"),"."),(0,i.kt)("h3",{id:"print-warning-message-in-log-when-requesting-external-services-without-tls"},"Print warning message in log when requesting external services without TLS"),(0,i.kt)("p",null,"If you request external services without TLS, for example, using the ",(0,i.kt)("inlineCode",{parentName:"p"},"authz-casdoor")," plugin, you should now see warning messages similar to the following in the error log:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"Using authz-casdoor endpoint_addr with no TLS is a security risk\nUsing authz-casdoor callback_url with no TLS is a security risk\n")),(0,i.kt)("p",null,"For more information, see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11403"},"PR #11403"),"."),(0,i.kt)("h3",{id:"support-storing-ssl-certs-and-keys-in-secrets-manager"},"Support storing SSL certs and keys in secrets manager"),(0,i.kt)("p",null,"Support storing certificates ",(0,i.kt)("inlineCode",{parentName:"p"},"certs")," and private keys ",(0,i.kt)("inlineCode",{parentName:"p"},"keys")," on SSL resource in secrets manager. In the earlier releases, only ",(0,i.kt)("inlineCode",{parentName:"p"},"cert")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"key")," support secrets manager."),(0,i.kt)("p",null,"You can now configure a SSL resource such as the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/ssls" -X PUT -d \'\n{\n  "id": "sample-ssl",\n  "sni": "test.com",\n  "cert": "$secret://vault/test/ssl/test.com.crt",\n  "key": "$secret://vault/test/ssl/test.com.key",\n  "certs": ["$secret://vault/test/ssl/test.com.crt"],\n  "keys": ["$secret://vault/test/ssl/test.com.key"]\n}\'\n')),(0,i.kt)("p",null,"For more information, see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11339"},"PR #11339"),"."),(0,i.kt)("h3",{id:"support-hashicorp-vault-namespace"},"Support HashiCorp Vault namespace"),(0,i.kt)("p",null,"Support specifying HashiCorp Vault namespace in SSL resource, for example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/ssls" -X PUT -d \'\n{\n  "id": "sample-ssl",\n  "sni": "test.com",\n  "certs": "$secret://vault/test/ssl/test.com.crt",\n  "keys": "$secret://vault/test/ssl/test.com.key"],\n  "namespace": "apisix"\n}\'\n')),(0,i.kt)("p",null,"For more information, see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11277"},"PR #11277"),"."),(0,i.kt)("h3",{id:"list-k8s-cluster-endpoints-in-control-api-discovery-memory-dump"},"List K8s cluster endpoints in Control API discovery memory dump"),(0,i.kt)("p",null,"The Control API ",(0,i.kt)("inlineCode",{parentName:"p"},"/v1/discovery/kubernetes/dump")," endpoint now lists K8s cluster endpoints. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"curl http://127.0.0.1:9090/v1/discovery/kubernetes/dump | jq\n")),(0,i.kt)("p",null,"You will see the cluster endpoints:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "endpoints": [\n    {\n      "endpoints": [\n        {\n          "value": "{\\"https\\":[{\\"host\\":\\"172.18.164.170\\",\\"port\\":6443,\\"weight\\":50},{\\"host\\":\\"172.18.164.171\\",\\"port\\":6443,\\"weight\\":50},{\\"host\\":\\"172.18.164.172\\",\\"port\\":6443,\\"weight\\":50}]}",\n          "name": "default/kubernetes"\n        },\n        {\n          "value": "{\\"metrics\\":[{\\"host\\":\\"172.18.164.170\\",\\"port\\":2379,\\"weight\\":50},{\\"host\\":\\"172.18.164.171\\",\\"port\\":2379,\\"weight\\":50},{\\"host\\":\\"172.18.164.172\\",\\"port\\":2379,\\"weight\\":50}]}",\n          "name": "kube-system/etcd"\n        },\n        {\n          "value": "{\\"http-85\\":[{\\"host\\":\\"172.64.89.2\\",\\"port\\":85,\\"weight\\":50}]}",\n          "name": "test-ws/testing"\n        }\n      ],\n      "id": "first"\n    }\n  ],\n  "config": [\n    {\n      "default_weight": 50,\n      "id": "first",\n      "client": {\n        "token": "xxx"\n      },\n      "service": {\n        "host": "172.18.164.170",\n        "port": "6443",\n        "schema": "https"\n      },\n      "shared_size": "1m"\n    }\n  ]\n}\n')),(0,i.kt)("p",null,"For more information, see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11111"},"PR #11111"),"."),(0,i.kt)("h2",{id:"other-updates"},"Other Updates"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Use LRU cache in secret fetching to improve performance (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11201"},"PR #11201"),")"),(0,i.kt)("li",{parentName:"ul"},"Move default configurations in ",(0,i.kt)("inlineCode",{parentName:"li"},"config-default.yaml")," to a hardcoded Lua file (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11343"},"PR #11343"),")"),(0,i.kt)("li",{parentName:"ul"},"Fix etcd sync data checker (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11457"},"PR #11457"),")"),(0,i.kt)("li",{parentName:"ul"},"Add plugin metadata ID to avoid the etcd checker failure (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11452"},"PR #11452"),")"),(0,i.kt)("li",{parentName:"ul"},"Allow trailing period in SNI and CN for SSL (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11414"},"PR #11414"),")"),(0,i.kt)("li",{parentName:"ul"},"Upgrade ",(0,i.kt)("inlineCode",{parentName:"li"},"lua-protobuf")," dependency version to filter out illegal ",(0,i.kt)("inlineCode",{parentName:"li"},"INT(string)")," formats in the ",(0,i.kt)("inlineCode",{parentName:"li"},"grpc-transcode")," plugin (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11367"},"PR #11367"),")"),(0,i.kt)("li",{parentName:"ul"},"Rectify the error message when API key is missing (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11370"},"PR #11370"),")"),(0,i.kt)("li",{parentName:"ul"},"Fix the failure of reporting consumer username tag using the ",(0,i.kt)("inlineCode",{parentName:"li"},"datadog")," plugin (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11354"},"PR #11354"),")"),(0,i.kt)("li",{parentName:"ul"},"Fix request error caused by SSL key rotation (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11305"},"PR #11305"),")"),(0,i.kt)("li",{parentName:"ul"},"Ensure that all etcd events are handled properly (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11268"},"PR #11268"),")"),(0,i.kt)("li",{parentName:"ul"},"Fix stream route matcher being ",(0,i.kt)("inlineCode",{parentName:"li"},"nil")," after the first match (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11269"},"PR #11269"),")"),(0,i.kt)("li",{parentName:"ul"},"Rectify the way to fetch secret resource by ID (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11164"},"PR #11164"),")"),(0,i.kt)("li",{parentName:"ul"},"Fix the 500 error thrown when using the default configuration in the ",(0,i.kt)("inlineCode",{parentName:"li"},"multi-auth")," plugin (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11145"},"PR #11145"),")"),(0,i.kt)("li",{parentName:"ul"},"Avoid overwriting the ",(0,i.kt)("inlineCode",{parentName:"li"},"Access-Control-Expose-Headers")," response header in the ",(0,i.kt)("inlineCode",{parentName:"li"},"cors")," plugin (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11136"},"PR #11136"),")"),(0,i.kt)("li",{parentName:"ul"},"Close session in case of error to avoid blocked session (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11089"},"PR #11089"),")"),(0,i.kt)("li",{parentName:"ul"},"Restore pb state before other operations in the kafka pubsub module (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11135"},"PR #11135"),")"),(0,i.kt)("li",{parentName:"ul"},"Add a default limit of 100 for request headers to limit security risks (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11140"},"PR #11140"),")"),(0,i.kt)("li",{parentName:"ul"},"Allow disabling prometheus metric export server when ",(0,i.kt)("inlineCode",{parentName:"li"},"prometheus")," plugin is turned off (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11117"},"PR #11117"),")"),(0,i.kt)("li",{parentName:"ul"},"Add POST request headers only if the ",(0,i.kt)("inlineCode",{parentName:"li"},"request_method")," is set to POST in the ",(0,i.kt)("inlineCode",{parentName:"li"},"forward-auth")," plugin (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11021"},"PR #11021"),")"),(0,i.kt)("li",{parentName:"ul"},"Fix the 500 error in the ",(0,i.kt)("inlineCode",{parentName:"li"},"hmac-auth")," plugin when using duplicate signature header (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11127"},"PR #11127"),")"),(0,i.kt)("li",{parentName:"ul"},"Fix brotli partial response (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11087"},"PR #11087"),")"),(0,i.kt)("li",{parentName:"ul"},"Update the upstream schema to disallow port value greater than 65535 (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/11043"},"PR #11043"),")")),(0,i.kt)("h2",{id:"changelog"},"Changelog"),(0,i.kt)("p",null,"For a complete list of changes in this release, please see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/blob/master/CHANGELOG.md#3100"},"CHANGELOG"),"."))}h.isMDXComponent=!0}}]);