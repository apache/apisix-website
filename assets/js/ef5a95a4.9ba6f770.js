"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[3118],{35318:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var i=n(27378);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=i.createContext({}),s=function(e){var t=i.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=s(e.components);return i.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},h=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),h=s(n),d=a,m=h["".concat(p,".").concat(d)]||h[d]||u[d]||r;return n?i.createElement(m,l(l({ref:t},c),{},{components:n})):i.createElement(m,l({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=h;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var s=2;s<r;s++)l[s]=n[s];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}h.displayName="MDXCreateElement"},16978:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>s});var i=n(25773),a=(n(27378),n(35318));const r={title:"Release Apache APISIX 3.9.0",authors:[{name:"Abhishek Choudhary",title:"Author",url:"https://github.com/shreemaan-abhishek",image_url:"https://github.com/shreemaan-abhishek.png"},{name:"Traky Deng",title:"Technical Writer",url:"https://github.com/kayx23",image_url:"https://github.com/kayx23.png"}],keywords:["Apache APISIX","API Gateway","API Management Platform","New Release","Cloud Native"],description:"The Apache APISIX 3.9.0 version is released on March 29, 2024. This release includes a few new features, bug fixes, and other improvements to user experiences.",tags:["Community"]},l=void 0,o={permalink:"/blog/2024/03/29/release-apache-apisix-3.9.0",source:"@site/blog/2024/03/29/release-apache-apisix-3.9.0.md",title:"Release Apache APISIX 3.9.0",description:"The Apache APISIX 3.9.0 version is released on March 29, 2024. This release includes a few new features, bug fixes, and other improvements to user experiences.",date:"2024-03-29T00:00:00.000Z",formattedDate:"March 29, 2024",tags:[{label:"Community",permalink:"/blog/tags/community"}],readingTime:3.465,truncated:!0,authors:[{name:"Abhishek Choudhary",title:"Author",url:"https://github.com/shreemaan-abhishek",image_url:"https://github.com/shreemaan-abhishek.png",imageURL:"https://github.com/shreemaan-abhishek.png"},{name:"Traky Deng",title:"Technical Writer",url:"https://github.com/kayx23",image_url:"https://github.com/kayx23.png",imageURL:"https://github.com/kayx23.png"}],prevItem:{title:"Monthly Report (March 01 - March 31)",permalink:"/blog/2024/04/01/monthly-report"},nextItem:{title:"Apache APISIX North America Tour",permalink:"/blog/2024/03/28/apisix-north-america-tour"}},p={authorsImageUrls:[void 0,void 0]},s=[{value:"Breaking Changes",id:"breaking-changes",children:[{value:"Enable HTTP/2",id:"enable-http2",children:[],level:3},{value:"Consolidate <code>keyring</code> and <code>key_encrypt_salt</code> fields",id:"consolidate-keyring-and-key_encrypt_salt-fields",children:[],level:3}],level:2},{value:"New Features",id:"new-features",children:[{value:"Support HTTP/3 between client and APISIX",id:"support-http3-between-client-and-apisix",children:[],level:3},{value:"Add plugin reload endpoint to Control API",id:"add-plugin-reload-endpoint-to-control-api",children:[],level:3},{value:"Support setting session cookie lifetime in <code>openid-connect</code> plugin",id:"support-setting-session-cookie-lifetime-in-openid-connect-plugin",children:[],level:3},{value:"Support setting expiration time for Prometheus metrics",id:"support-setting-expiration-time-for-prometheus-metrics",children:[],level:3},{value:"Support <code>redis</code> and <code>redis-cluster</code> policies in <code>limit-req</code> and <code>limit-conn</code> plugins",id:"support-redis-and-redis-cluster-policies-in-limit-req-and-limit-conn-plugins",children:[],level:3},{value:"Support OCSP Stapling",id:"support-ocsp-stapling",children:[],level:3},{value:"Support transforming between HTTP and Dubbo",id:"support-transforming-between-http-and-dubbo",children:[],level:3}],level:2},{value:"Other Updates",id:"other-updates",children:[],level:2},{value:"Changelog",id:"changelog",children:[],level:2}],c={toc:s};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"We are glad to present Apache APISIX 3.9.0 with exciting new features, bug fixes, and other improvements to user experiences."),(0,a.kt)("p",null,"This new release adds a number of new features, including the support for HTTP/3 between client and APISIX, the addition of plugin reload endpoint to Control API, the configuration of Prometheus metrics expiration, and more."),(0,a.kt)("p",null,"There are a few important changes included in this release. Should you find these changes impacting your operations, please plan accordingly for a seamless upgrade."),(0,a.kt)("h2",{id:"breaking-changes"},"Breaking Changes"),(0,a.kt)("h3",{id:"enable-http2"},"Enable HTTP/2"),(0,a.kt)("p",null,"In the earlier versions, HTTP/2 can be enabled by setting ",(0,a.kt)("inlineCode",{parentName:"p"},"apisix.node_listen.enable_http2")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"apisix.ssl.listen.enable_http2")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"true")," in the configuration file. These options have been deprecated in this release. Starting from 3.9.0, HTTP/2 can be enabled with ",(0,a.kt)("inlineCode",{parentName:"p"},"apisix.enable_http2"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="config.yaml"',title:'"config.yaml"'},"apisix:\n  enable_http2: true\n")),(0,a.kt)("p",null,"For more information, see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11032"},"PR #11032"),"."),(0,a.kt)("h3",{id:"consolidate-keyring-and-key_encrypt_salt-fields"},"Consolidate ",(0,a.kt)("inlineCode",{parentName:"h3"},"keyring")," and ",(0,a.kt)("inlineCode",{parentName:"h3"},"key_encrypt_salt")," fields"),(0,a.kt)("p",null,"In the earlier versions, ",(0,a.kt)("inlineCode",{parentName:"p"},"key_encrypt_salt")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"keyring")," are two configuration options both used for data encryption and decryption in a similar manner. This release removes ",(0,a.kt)("inlineCode",{parentName:"p"},"key_encrypt_salt")," as it is redundant, and you should only configure ",(0,a.kt)("inlineCode",{parentName:"p"},"keyring"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="config.yaml"',title:'"config.yaml"'},"apisix:\n  data_encryption:\n    keyring:\n      - qeddd145sfvddff3\n")),(0,a.kt)("p",null,"For more information, see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/10771"},"PR #10771"),"."),(0,a.kt)("h2",{id:"new-features"},"New Features"),(0,a.kt)("h3",{id:"support-http3-between-client-and-apisix"},"Support HTTP/3 between client and APISIX"),(0,a.kt)("p",null,"Support HTTP/3 between clients and APISIX as an experimental feature. HTTP/3 with upstream services is not yet supported."),(0,a.kt)("p",null,"HTTP/3 requires TLS v1.3. To enable HTTP/3 on a given port in APISIX, update the configuration file as such:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="config.yaml"',title:'"config.yaml"'},"apisix:\n  ssl:\n    listen:\n      - port: 9443\n        enable_http3: true\n")),(0,a.kt)("p",null,"Next, configure TLS certificates between client and APISIX:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/ssls" -X PUT \\\n  -H "X-API-KEY: ${ADMIN_API_KEY}" \\\n  -d \'{\n    "id": "tls-client-ssl",\n    "sni": "example.com",\n    "cert": "\'"${server_cert}"\'",\n    "key": "\'"${server_key}"\'"\n  }\'\n')),(0,a.kt)("p",null,"For more information, see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/10989"},"PR #10989"),", ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11010"},"PR #11010"),", and ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/11027"},"PR #11027"),"."),(0,a.kt)("h3",{id:"add-plugin-reload-endpoint-to-control-api"},"Add plugin reload endpoint to Control API"),(0,a.kt)("p",null,"The plugin reload endpoint, which previously existed in Admin API to hot reload all plugins, is now added to ",(0,a.kt)("a",{parentName:"p",href:"https://apisix.apache.org/docs/apisix/next/control-api/#put-v1pluginsreload"},"Control API"),", such that the plugin reload can be called from control plane:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9090/v1/plugins/reload" -X PUT\n')),(0,a.kt)("p",null,"For backward compatibility, the plugin reload endpoint in Admin API is retained."),(0,a.kt)("p",null,"For more information, see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/10905"},"PR #10905"),"."),(0,a.kt)("h3",{id:"support-setting-session-cookie-lifetime-in-openid-connect-plugin"},"Support setting session cookie lifetime in ",(0,a.kt)("inlineCode",{parentName:"h3"},"openid-connect")," plugin"),(0,a.kt)("p",null,"You can now configure the session cookie lifetime in the ",(0,a.kt)("inlineCode",{parentName:"p"},"openid-connect")," plugin as such:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'curl "http://127.0.0.1:9180/apisix/admin/routes" -X PUT -d \'\n{\n  "id": "auth-with-oidc",\n  "uri":"/anything/*",\n  "plugins": {\n    "openid-connect": {\n      "client_id": "\'"$OIDC_CLIENT_ID"\'",\n      "client_secret": "\'"$OIDC_CLIENT_SECRET"\'",\n      "discovery": "\'"$OIDC_DISCOVERY"\'",\n      "session": {\n        "secret": "6S8IO+Pydgb33LIor8T9ClER0T/sglFAjClFeAF3RsY=",\n        "cookie" : {\n          "lifetime": 86400\n        }\n      },\n      "redirect_uri": "http://localhost:9080/anything/callback"\n    }\n  },\n  "upstream":{\n    "type":"roundrobin",\n    "nodes":{\n      "httpbin.org:80":1\n    }\n  }\n}\'\n')),(0,a.kt)("p",null,"This is to address the issue where the lifetime of the access token is longer than the session lifetime."),(0,a.kt)("p",null,"For more information, see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/10919"},"PR #10919"),"."),(0,a.kt)("h3",{id:"support-setting-expiration-time-for-prometheus-metrics"},"Support setting expiration time for Prometheus metrics"),(0,a.kt)("p",null,"You can now set the expiration time in seconds after Prometheus metrics have become inactive to reduce resource consumption:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="config.yaml"',title:'"config.yaml"'},"plugin_attr:\n  prometheus:\n    expire: 0    # time in seconds. 0 means the metrics will not expire.\n")),(0,a.kt)("p",null,"For more information, see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/10869"},"PR #10869"),"."),(0,a.kt)("h3",{id:"support-redis-and-redis-cluster-policies-in-limit-req-and-limit-conn-plugins"},"Support ",(0,a.kt)("inlineCode",{parentName:"h3"},"redis")," and ",(0,a.kt)("inlineCode",{parentName:"h3"},"redis-cluster")," policies in ",(0,a.kt)("inlineCode",{parentName:"h3"},"limit-req")," and ",(0,a.kt)("inlineCode",{parentName:"h3"},"limit-conn")," plugins"),(0,a.kt)("p",null,"Support ",(0,a.kt)("inlineCode",{parentName:"p"},"redis")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"redis-cluster")," policies in ",(0,a.kt)("inlineCode",{parentName:"p"},"limit-req")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"limit-conn")," plugins, so that rate limiting counters can be shared among APISIX instances."),(0,a.kt)("p",null,"For more information, see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/10874"},"PR #10874")," and ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/10866"},"PR #10866"),"."),(0,a.kt)("h3",{id:"support-ocsp-stapling"},"Support OCSP Stapling"),(0,a.kt)("p",null,"Support OCSP stapling using the ",(0,a.kt)("inlineCode",{parentName:"p"},"ocsp-stapling")," plugin."),(0,a.kt)("p",null,"For more information, see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/blob/master/docs/en/latest/plugins/ocsp-stapling.md"},"plugin doc")," and ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/10817"},"PR #10817"),"."),(0,a.kt)("h3",{id:"support-transforming-between-http-and-dubbo"},"Support transforming between HTTP and Dubbo"),(0,a.kt)("p",null,"Support transforming between HTTP and Dubbo with the ",(0,a.kt)("inlineCode",{parentName:"p"},"http-dubbo")," plugin."),(0,a.kt)("p",null,"For more information, see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/pull/10703"},"PR #10703"),"."),(0,a.kt)("h2",{id:"other-updates"},"Other Updates"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Support EndpointSlice in Kubernetes service discovery (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/10916"},"PR #10916"),")"),(0,a.kt)("li",{parentName:"ul"},"Add ",(0,a.kt)("inlineCode",{parentName:"li"},"cors_allow_headers")," attribute to the ",(0,a.kt)("inlineCode",{parentName:"li"},"grpc-web")," plugin to allow cross-origin resources (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/10904"},"PR #10904"),")"),(0,a.kt)("li",{parentName:"ul"},"Allow customization of the error response code in the ",(0,a.kt)("inlineCode",{parentName:"li"},"forward-auth")," plugin (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/10898"},"PR #10898"),")"),(0,a.kt)("li",{parentName:"ul"},"Support the inclusion of request and response bodies in loggers (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/10888"},"PR #10888"),")"),(0,a.kt)("li",{parentName:"ul"},"Support compressed responses in loggers (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/10884"},"PR #10884"),")"),(0,a.kt)("li",{parentName:"ul"},"Support built-in variables in ",(0,a.kt)("inlineCode",{parentName:"li"},"response_headers")," in the ",(0,a.kt)("inlineCode",{parentName:"li"},"mocking")," plugin (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/10872"},"PR #10872"),")"),(0,a.kt)("li",{parentName:"ul"},"Fix for unnecessary YAML config reloads (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/9065"},"PR #9065"),")"),(0,a.kt)("li",{parentName:"ul"},"Prevent real payload to be overridden by malicious payload in the ",(0,a.kt)("inlineCode",{parentName:"li"},"jwt-auth")," plugin (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache/apisix/pull/10982"},"PR #10982"),")")),(0,a.kt)("h2",{id:"changelog"},"Changelog"),(0,a.kt)("p",null,"For a complete list of changes in this release, please see ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/apisix/blob/master/CHANGELOG.md#390"},"CHANGELOG"),"."))}u.isMDXComponent=!0}}]);