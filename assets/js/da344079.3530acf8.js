"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[4088],{35318:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>h});var i=a(27378);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=i.createContext({}),c=function(e){var t=i.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),m=c(a),h=n,d=m["".concat(l,".").concat(h)]||m[h]||p[h]||r;return a?i.createElement(d,s(s({ref:t},u),{},{components:a})):i.createElement(d,s({ref:t},u))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,s=new Array(r);s[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:n,s[1]=o;for(var c=2;c<r;c++)s[c]=a[c];return i.createElement.apply(null,s)}return i.createElement.apply(null,a)}m.displayName="MDXCreateElement"},10101:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var i=a(25773),n=(a(27378),a(35318));const r={title:"Why Do Microservices Need an API Gateway",authors:[{name:"API7.ai",title:"Author",url:"https://github.com/api7",image_url:"https://avatars.githubusercontent.com/u/61078451?s=200&v=4"}],keywords:["Apache APISIX","Microservices","Alternatives to Kong"],description:"Let's learn the importance of API gateway in the microservices architecture, and compare common API gateways.",tags:["Ecosystem"],image:"https://static.apiseven.com/uploads/2023/02/16/CHqaC3Xw_Ecosystem%20%E6%A8%A1%E6%9D%BF1.png",canonical_url:"https://api7.ai/blog/why-do-microservices-need-an-api-gateway"},s=void 0,o={permalink:"/blog/2023/05/19/why-do-microservices-need-an-api-gateway",source:"@site/blog/2023/05/19/why-do-microservices-need-an-api-gateway.md",title:"Why Do Microservices Need an API Gateway",description:"Let's learn the importance of API gateway in the microservices architecture, and compare common API gateways.",date:"2023-05-19T00:00:00.000Z",formattedDate:"May 19, 2023",tags:[{label:"Ecosystem",permalink:"/blog/tags/ecosystem"}],readingTime:9.315,truncated:!0,authors:[{name:"API7.ai",title:"Author",url:"https://github.com/api7",image_url:"https://avatars.githubusercontent.com/u/61078451?s=200&v=4",imageURL:"https://avatars.githubusercontent.com/u/61078451?s=200&v=4"}],prevItem:{title:"Biweekly Report (May 08 - May 22)",permalink:"/blog/2023/05/24/weekly-report-0524"},nextItem:{title:"Biweekly Report (Apr 24 - May 07)",permalink:"/blog/2023/05/12/weekly-report-0512"}},l={authorsImageUrls:[void 0]},c=[{value:"What Are Microservices",id:"what-are-microservices",children:[],level:2},{value:"What Is an API Gateway?",id:"what-is-an-api-gateway",children:[],level:2},{value:"Why Do Microservices Need an API Gateway?",id:"why-do-microservices-need-an-api-gateway",children:[{value:"Challenges Faced by Microservices",id:"challenges-faced-by-microservices",children:[],level:3},{value:"Solutions",id:"solutions",children:[],level:3},{value:"Selection of Mainstream Gateways",id:"selection-of-mainstream-gateways",children:[],level:3}],level:2},{value:"Summary",id:"summary",children:[],level:2}],u={toc:c};function p(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,i.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"The microservices architecture has been widely adopted by many companies. As the data and API quantity of microservices increases, it is crucial to choose an excellent API gateway for high-traffic governance: APISIX.")),(0,n.kt)("h2",{id:"what-are-microservices"},"What Are Microservices"),(0,n.kt)("p",null,"Microservice architecture, usually referred to as ",(0,n.kt)("a",{parentName:"p",href:"https://api7.ai/blog/what-are-microservices"},"microservices"),", is a type of architecture used to develop applications. With microservices, large applications can be broken down into multiple independent components, each with its own responsibilities. When processing a user request, an application based on microservices may call many internal microservices to generate its response jointly. Microservices are a result of internet development, and the rapid growth of internet has caused the architecture of systems to change constantly."),(0,n.kt)("p",null,"Overall, the architecture of systems has roughly evolved from monolithic architecture to SOA architecture to microservice architecture. The specific progression and pros/cons of each architecture are outlined in the table below."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Architecture Type"),(0,n.kt)("th",{parentName:"tr",align:null},"Description"),(0,n.kt)("th",{parentName:"tr",align:null},"Advantages"),(0,n.kt)("th",{parentName:"tr",align:null},"Disadvantages"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Monolithic Application Architecture"),(0,n.kt)("td",{parentName:"tr",align:null},"Pack all functional code into a single service."),(0,n.kt)("td",{parentName:"tr",align:null},"1. Simple architecture with low project development and maintenance costs."),(0,n.kt)("td",{parentName:"tr",align:null},"Coupling all modules together is beneficial for developing and maintaining small projects, but it can create issues for large projects, including ",(0,n.kt)("br",null)," 1. The modules in the project are too tightly coupled, and a performance issue in one module may cause the entire project to become unavailable;",(0,n.kt)("br",null)," 2. The project needs better scalability.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://en.wikipedia.org/wiki/Service-oriented_architecture"},"SOA Architecture")),(0,n.kt)("td",{parentName:"tr",align:null},'The term stands for "service-oriented architecture," which typically involves multiple services. ',(0,n.kt)("br",null),"A service typically exists independently in an operating system process, and communication between services is achieved through dependencies or communication mechanisms, ",(0,n.kt)("br",null)," Ultimately, it provides a series of functions."),(0,n.kt)("td",{parentName:"tr",align:null},"1. System integration: From a systemic perspective, it resolves communication issues between enterprise systems by converting their previously disordered and unstructured network connections into a managed and structured star configuration.",(0,n.kt)("br",null)," 2. Service-oriented system: From a functional perspective, it abstracts business logic into reusable and combinable services and uses service orchestration to achieve the rapid reconstruction of business processes.",(0,n.kt)("br",null)," 3. Business service-oriented: From the perspective of the enterprise, it abstracts enterprise functions into reusable and combinable services."),(0,n.kt)("td",{parentName:"tr",align:null},"1. Centralizing services creates dependencies between services, and a malfunction in one service can trigger a cascading failure across other services. ",(0,n.kt)("br",null)," 2. The dependencies and invocation relationships between services are complex, making testing and deployment difficult.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Microservice Architecture"),(0,n.kt)("td",{parentName:"tr",align:null},'Microservices are the sublimation of SOA. One of the key emphases of the microservices architecture is "the need to thoroughly componentize and serviceize business", ',(0,n.kt)("br",null),"The original single business system will be split into multiple parts that can be developed, designed, and deployed independently.",(0,n.kt)("br",null),"These parts will run as small, independent applications. Each application will collaborate and communicate with the others to achieve integration and interactivity, which is the essence of a microservices architecture."),(0,n.kt)("td",{parentName:"tr",align:null},"1. Decentralization;",(0,n.kt)("br",null)," 2. Componentization achieved through services;",(0,n.kt)("br",null)," 3. Dividing services and development teams based on business capabilities;",(0,n.kt)("br",null)," 4. Infrastructure automation (DevOps, automated deployment)."),(0,n.kt)("td",{parentName:"tr",align:null},"1. The development cost is relatively high;",(0,n.kt)("br",null)," 2. Cause fault tolerance issues for services; ",(0,n.kt)("br",null)," 3. Cause data consistency issues\uff1b",(0,n.kt)("br",null)," 4. Involve distributed transactions")))),(0,n.kt)("p",null,"Therefore, microservices are an inevitable result of Internet development, and the system architecture of many traditional companies is gradually becoming microservice-oriented."),(0,n.kt)("p",null,"However, with Internet business development, the number of APIs is also increasing dramatically, and gateways for unified API management will also face challenges. Choosing a more robust API gateway can effectively enhance the system's capabilities in monitoring, disaster recovery, authentication, and rate limiting."),(0,n.kt)("h2",{id:"what-is-an-api-gateway"},"What Is an API Gateway?"),(0,n.kt)("p",null,"API gateway provides a unified interface for interactions between clients and service systems and serves as a central point for managing requests and responses. Choosing a suitable API gateway can simplify development and improve system operation and management efficiency."),(0,n.kt)("p",null,"In a microservices architecture, an API gateway serves as a solution for system design by integrating various microservices from different modules and coordinating services in a unified manner."),(0,n.kt)("p",null,"As a system access aspect, the API gateway provides a unified entry point for clients, hides the implementation details of the system architecture, and makes microservices more user-friendly. It also integrates some common features such as ",(0,n.kt)("a",{parentName:"p",href:"https://api7.ai/blog/api-gateway-authentication"},"authentication"),", ",(0,n.kt)("a",{parentName:"p",href:"https://api7.ai/blog/rate-limiting-in-api-management"},"rate limiting"),", and circuit breaking to avoid individual development of each microservice, improve efficiency, and standardize the system, such as identity authentication, monitoring, load balancing, rate limiting, degradation, and application detection."),(0,n.kt)("h2",{id:"why-do-microservices-need-an-api-gateway"},"Why Do Microservices Need an API Gateway?"),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://static.apiseven.com/uploads/2023/02/16/IQnuGi7N_111.jpg",alt:"API gateway in microservices"})),(0,n.kt)("p",null,"As shown in the above diagram, the API gateway serves as an intermediate layer between the client and microservices. It can provide microservices to the outside world at a unified address and route the traffic to the correct service nodes within the internal cluster based on appropriate rules."),(0,n.kt)("p",null,"Without an API gateway, the inlets and outlets of the traffic are not unified, and the client needs to know the access information of all services. The significance of microservices will not exist. Therefore, a microservices gateway is necessary for a microservice architecture. Additionally, the API gateway plays a vital role in system observability, identity authentication, stability, and ",(0,n.kt)("a",{parentName:"p",href:"https://api7.ai/blog/what-is-service-discovery-in-microservices"},"service discovery"),"."),(0,n.kt)("h3",{id:"challenges-faced-by-microservices"},"Challenges Faced by Microservices"),(0,n.kt)("p",null,"The microservices gateway should first have API routing capabilities. As the number of microservices increases, so does the number of APIs. The gateway can also be used as a traffic filter in specific scenarios to provide certain optional features. Therefore, higher demands are placed on the microservices API gateway, such as:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Observability: In the past, troubleshooting in monolithic applications was often done by checking logs for error messages and exception stacks. However, in a microservices architecture with many services, problem diagnosis becomes very difficult. Therefore, how to monitor the operation of microservices and provide rapid alarms when anomalies occur poses a great challenge to developers."),(0,n.kt)("li",{parentName:"ul"},"Authentication and Authorization: In a microservices architecture, an application is divided into several micro-applications, which need to authenticate access and be aware of the current user and their permissions.The ",(0,n.kt)("a",{parentName:"li",href:"https://api7.ai/blog/understanding-microservices-authentication-services"},"authentication")," method in monolithic application architecture is unsuitable, especially when access is not only from a browser but also from other service calls. In a microservices architecture, various authentication scenarios must be considered, including external application access, user-service authentication, and service-service authentication."),(0,n.kt)("li",{parentName:"ul"},"System stability: If the number of requests exceeds the processing capacity of a microservice, it may overwhelm the service, even causing a cascading effect that affects the system's overall stability."),(0,n.kt)("li",{parentName:"ul"},"Service discovery: The decentralized management of microservices also presents challenges for implementing load balancing.")),(0,n.kt)("h3",{id:"solutions"},"Solutions"),(0,n.kt)("p",null,"API gateway, as the intermediate bridge between the client and the server, provides a unified management mechanism for the microservices system. In addition to basic functions such as request distribution, API management, and conditional routing, it also includes identity authentication, monitoring and alarm, tracing analysis, load balancing, rate limiting, isolation, and circuit breaking."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Identity authentication"),": The following diagram illustrates how microservices are united with an API gateway for identity authentication, where all requests go through the gateway, effectively hiding the microservices."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://static.apiseven.com/uploads/2023/02/16/zk9D3gB5_222.jpg",alt:"API gateway authentication in microservices"})),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Monitoring and Alerting/Tracing Analysis"),":"),(0,n.kt)("p",null,"As the intermediary between the client and server, the API gateway is an excellent carrier for monitoring microservices."),(0,n.kt)("p",null,"The primary responsibility of the API gateway's monitoring function is to detect connection anomalies between the gateway and the backend servers in a timely manner. Users can view log information, monitoring information, tracing, etc. on the monitoring platform for the API. Furthermore, any anomalies that arise on the host will be automatically reported to the control panel. Specific gateways can issue dual alerts to both the client and server."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://static.apiseven.com/uploads/2023/02/16/s0CwNZmu_333.jpeg",alt:"Monitoring and Tracing Analysis Diagram"})),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Rate limiting, isolation, and circuit breaking"),":"),(0,n.kt)("p",null,"As the scale of internet businesses continues to increase, so does the concurrency of systems. Multiple services are often called by each other, and a core link may call up to ten services. If the RT (response time) of a certain service rises sharply and upstream services continue to request, a vicious cycle will occur. The more upstream waiting for results, the more upstream services will be blocked, and the entire process will eventually become unusable, leading to a service avalanche."),(0,n.kt)("p",null,"Therefore, it is necessary to regulate and manage the incoming traffic. The following diagram shows how microservice systems combine API gateways to perform rate limiting, isolation, and circuit breaking."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://static.apiseven.com/uploads/2023/02/16/6IssHFUK_444.jpg",alt:"Rate limiting, isolation, and circuit breaking"})),(0,n.kt)("h3",{id:"selection-of-mainstream-gateways"},"Selection of Mainstream Gateways"),(0,n.kt)("p",null,'Many open-source gateway implementations are available in microservices, including NGINX, Kong, Apache APISIX, and Envoy. For the Java technology stack, there are options such as Netflix Zuul, Spring Cloud Gateway, Soul, etc. But you may wonder, "',(0,n.kt)("a",{parentName:"p",href:"https://api7.ai/blog/why-choose-apisix-instead-of-nginx-or-kong"},"Why would you choose Apache APISIX instead of NGINX and Kong"),'?"'),(0,n.kt)("p",null,"Here's a brief comparison."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Gateway"),(0,n.kt)("th",{parentName:"tr",align:null},"Painpoints"),(0,n.kt)("th",{parentName:"tr",align:null},"Advantages"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://www.nginx.com/"},"NGINX")),(0,n.kt)("td",{parentName:"tr",align:null},"1. Reloading is required for changes to take effect in the configuration, which can't keep pace with the progress of cloud-native technologies."),(0,n.kt)("td",{parentName:"tr",align:null},"1. old-style applications;",(0,n.kt)("br",null)," 2. Stable, reliable, and time-tested; ",(0,n.kt)("br",null)," 3. High Performance")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://apisix.apache.org/"},"Apache APISIX")),(0,n.kt)("td",{parentName:"tr",align:null},"1. The documentation is not rich or clear enough and needs improvement."),(0,n.kt)("td",{parentName:"tr",align:null},"1. Apache Foundation Top-Level Project;",(0,n.kt)("br",null)," 2. The technical architecture is more in line with cloud-native principles;",(0,n.kt)("br",null)," 3. Excellent performance;",(0,n.kt)("br",null)," 4. Rich ecosystem;",(0,n.kt)("br",null)," 5. In addition to supporting Lua development plugins, it also supports language plugins for Java, Go, Python, Node, and others.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://konghq.com/"},"Kong")),(0,n.kt)("td",{parentName:"tr",align:null},"1. The default use of PostgreSQL or Cassandra databases makes the entire architecture very bloated and can bring about high availability issues;",(0,n.kt)("br",null)," 2. The routing uses a traversal search algorithm, which can lead to a significant decrease in performance when there are more than thousands of routes in the gateway;",(0,n.kt)("br",null)," 3. Some important features require payment;"),(0,n.kt)("td",{parentName:"tr",align:null},"1. The pioneer of open-source API gateways with a large user base;",(0,n.kt)("br",null)," 2. Performance meets the needs of most users;",(0,n.kt)("br",null)," 3. Rich ecosystem;",(0,n.kt)("br",null)," 4. It supports Lua and Go plugin development;")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://envoy.com/"},"Envoy")),(0,n.kt)("td",{parentName:"tr",align:null},"1. It is developed in C++, which makes it difficult for secondary development;",(0,n.kt)("br",null)," 2. In addition to developing filters with C++, it also supports WASM and Lua."),(0,n.kt)("td",{parentName:"tr",align:null},"1. The CNCF graduated project is more suitable for service mesh scenarios and supports the deployment of multi-language architectures;")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://cloud.spring.io/spring-cloud-gateway/reference/html/"},"Spring Cloud Gateway")),(0,n.kt)("td",{parentName:"tr",align:null},"1. Although the Spring community is mature, there is a lack of resources for Gateway."),(0,n.kt)("td",{parentName:"tr",align:null},"1. The gateway provides a wealth of out-of-the-box features, which can be used through SpringBoot configuration or hand-coded calls; ",(0,n.kt)("br",null)," 2. Spring framework is highly extensible with strong scalability, easy configuration, and good maintainability;    ",(0,n.kt)("br",null)," 3. The Spring community is mature; ",(0,n.kt)("br",null)," 4. Easy to use;",(0,n.kt)("br",null)," 5. Convenient for the Java technology stack.")))),(0,n.kt)("h2",{id:"summary"},"Summary"),(0,n.kt)("p",null,"As the internet world continues to develop, enterprises rapidly evolve, leading to constant changes in system architecture. The microservices architecture has been widely adopted by many companies."),(0,n.kt)("p",null,"As the data and API quantity of microservices increases, it is crucial to choose an excellent API gateway for high-traffic governance."),(0,n.kt)("p",null,"This article compares common API gateways, highlighting their respective advantages and disadvantages. Suppose you are in the process of selecting an API gateway technology, encountering performance issues in your microservice system, or looking to build an efficient and stable microservice system. In that case, this article aims to provide you with some helpful insights."))}p.isMDXComponent=!0}}]);